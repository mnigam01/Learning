---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Text Elements
Problem statement. ^zmpmmOha

We have a application which experiences normal traffic till now but suddenly few clients starts sending large number of requests. ^I0xGQIHZ

There could be several reasons for this. May be our client is a web service and due to it's huge traffic surge this application is also experiencing same. Or simply some of those are ^jbtwwIdQ

malicious clients. Because of this our application will become slow and users will experience high latency. Also operational cost will increase. ^v8lChBEo

To deal with this issue we can introduce throttling. ^NiccO1N0

We can decide a limiting rate and any request which exceeds this rate is throttled (dropped or processing delayed). ^m80hjm3B

One thing we can propose to interviewer if our server is experiencing high traffic can we just increase no. of servers (scaling)? ^hUAeuP1S

Functional requirement ^4Gb4BLWZ

Should be able to throttle a request if it is above rate limit in a period. ^PjPdWRFp

Non-Functional ^SUXcomRI

low latency ^pWUSwCdj

accurate ^2YgYnLtg

scalable ^d0C7l2cd

What about high availability and fault tolerance two most common requirement for distributed systems? ^vgxCzAYo

Here let's assume in case of failure we won't throttle the request. ^N03GTrmh

Back of the envelope calculations ^dzSo2xOh

********rate limiting solution for a single server first.************ ^7qAYzRmr

Diagram 1. ^Hghdiy6q

Rules can be stored in file or stored in a database. ^EtZYJdA2

Rule service to manage all the rules (CURD operations). ^z4jOpi10

Rules retriever calls rules service (periodically) to fetch latest rules and stores rules in memory for fast lookup. ^v3xn0r8z

Client identifier identify client based on login id, user_id or ip_address. ^gOpunDFa

The client unique identifible key is then passed to rate limiter for making decision. ^hva4TLnv

Rate limiter using the rules from cache and unique client key makes the decision. ^ZNe7OkBb

Do you want me to go deep into rate limiting algorithm? ^6V1bmyUH

Algorithms ^QpaIq14Z

Token Bucket ^UyI90ueD

Reverse Token Bucket ^HfBUTND1

Fixed sliding window ^dWEYzoNi

Dynamic Sliding Window ^bONYC0vK

Diagram 2. ^KA85ky00

Now, let's extend this design for multiple rate limit host (distributed system design) ^w1VEI2mN

When data needs to be shared between many hosts in a distributed system in a real time fashion we can use message broadcasting service. ^c7LgDzYo

. The first approach is that each and every host tell all other hosts everything. (Very slow) ^Oa54Uili

. The gossip approach where each user selects some random unique hosts and shares data with them. (A bit better than previous one) ^AzOihRpa

. Distributed cache. Store data in a separate inmemory cache which every host can access. ^gqFzqz5J

Data sharing or communication protocols: ^oXNC8naB

TCP and UDP ^ljs9Fhxh

Improvements. ^XkTPteZy

Millions for stale buckets will be stored. We can clear these buckets if no requests is coming within prior to some period. ^TRJ3udQr

When numbers of requests arrive at the same time. we can have a race condition in while updating number of tokens. ^NAwzfB39

To prevent this we can introduce lock but it will increase latency, so we need to see the trade-off. ^YOjKPoT5

%%
# Drawing
```json
{
	"type": "excalidraw",
	"version": 2,
	"source": "https://github.com/zsviczian/obsidian-excalidraw-plugin/releases/tag/2.1.1",
	"elements": [
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "zmpmmOha",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 420.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 189.37982177734375,
			"height": 25,
			"seed": 1959756502,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Problem statement.",
			"rawText": "Problem statement.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Problem statement.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "I0xGQIHZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 490.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1280.0987548828125,
			"height": 25,
			"seed": 603929994,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "We have a application which experiences normal traffic till now but suddenly few clients starts sending large number of requests.",
			"rawText": "We have a application which experiences normal traffic till now but suddenly few clients starts sending large number of requests.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "We have a application which experiences normal traffic till now but suddenly few clients starts sending large number of requests.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "jbtwwIdQ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 525.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1812.4384765625,
			"height": 25,
			"seed": 214218774,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "There could be several reasons for this. May be our client is a web service and due to it's huge traffic surge this application is also experiencing same. Or simply some of those are",
			"rawText": "There could be several reasons for this. May be our client is a web service and due to it's huge traffic surge this application is also experiencing same. Or simply some of those are",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "There could be several reasons for this. May be our client is a web service and due to it's huge traffic surge this application is also experiencing same. Or simply some of those are",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "v8lChBEo",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 560.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1379.0386962890625,
			"height": 25,
			"seed": 420674634,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "malicious clients. Because of this our application will become slow and users will experience high latency. Also operational cost will increase.",
			"rawText": "malicious clients. Because of this our application will become slow and users will experience high latency. Also operational cost will increase.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "malicious clients. Because of this our application will become slow and users will experience high latency. Also operational cost will increase.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "NiccO1N0",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 630.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 512.8395385742188,
			"height": 25,
			"seed": 1927365974,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "To deal with this issue we can introduce throttling.",
			"rawText": "To deal with this issue we can introduce throttling.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "To deal with this issue we can introduce throttling.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "m80hjm3B",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 665.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1149.419189453125,
			"height": 25,
			"seed": 448848650,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804607,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "We can decide a limiting rate and any request which exceeds this rate is throttled (dropped or processing delayed).",
			"rawText": "We can decide a limiting rate and any request which exceeds this rate is throttled (dropped or processing delayed).",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "We can decide a limiting rate and any request which exceeds this rate is throttled (dropped or processing delayed).",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "hUAeuP1S",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 735.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1254.2789306640625,
			"height": 25,
			"seed": 410659478,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "One thing we can propose to interviewer if our server is experiencing high traffic can we just increase no. of servers (scaling)?",
			"rawText": "One thing we can propose to interviewer if our server is experiencing high traffic can we just increase no. of servers (scaling)?",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "One thing we can propose to interviewer if our server is experiencing high traffic can we just increase no. of servers (scaling)?",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "4Gb4BLWZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 805.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 216.89981079101562,
			"height": 25,
			"seed": 1669591498,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Functional requirement",
			"rawText": "Functional requirement",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Functional requirement",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "PjPdWRFp",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 875.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 734.1593627929688,
			"height": 25,
			"seed": 2084857814,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Should be able to throttle a request if it is above rate limit in a period.",
			"rawText": "Should be able to throttle a request if it is above rate limit in a period.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Should be able to throttle a request if it is above rate limit in a period.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "SUXcomRI",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 945.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 138.43988037109375,
			"height": 25,
			"seed": 645343370,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Non-Functional",
			"rawText": "Non-Functional",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Non-Functional",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "pWUSwCdj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 980.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 108.11991882324219,
			"height": 25,
			"seed": 2119499030,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "low latency",
			"rawText": "low latency",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "low latency",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "2YgYnLtg",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1015.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 88.95993041992188,
			"height": 25,
			"seed": 2069202762,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "accurate",
			"rawText": "accurate",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "accurate",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "d0C7l2cd",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1050.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 79.19993591308594,
			"height": 25,
			"seed": 874572374,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "scalable",
			"rawText": "scalable",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "scalable",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "vgxCzAYo",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1120.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1030.619140625,
			"height": 25,
			"seed": 1249512970,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "What about high availability and fault tolerance two most common requirement for distributed systems?",
			"rawText": "What about high availability and fault tolerance two most common requirement for distributed systems?",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "What about high availability and fault tolerance two most common requirement for distributed systems?",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "N03GTrmh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1155.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 673.0194091796875,
			"height": 25,
			"seed": 1014837142,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Here let's assume in case of failure we won't throttle the request.",
			"rawText": "Here let's assume in case of failure we won't throttle the request.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Here let's assume in case of failure we won't throttle the request.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "dzSo2xOh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1225.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 334.9997253417969,
			"height": 25,
			"seed": 954186954,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804608,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Back of the envelope calculations",
			"rawText": "Back of the envelope calculations",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Back of the envelope calculations",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "7qAYzRmr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1295.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 661.2394409179688,
			"height": 25,
			"seed": 329174230,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "********rate limiting solution for a single server first.************",
			"rawText": "********rate limiting solution for a single server first.************",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "********rate limiting solution for a single server first.************",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "Hghdiy6q",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1365.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 98.83993530273438,
			"height": 25,
			"seed": 337744778,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Diagram 1.",
			"rawText": "Diagram 1.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Diagram 1.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "EtZYJdA2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1435.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 525.0195922851562,
			"height": 25,
			"seed": 1729806870,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Rules can be stored in file or stored in a database.",
			"rawText": "Rules can be stored in file or stored in a database.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Rules can be stored in file or stored in a database.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "z4jOpi10",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1470.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 559.99951171875,
			"height": 25,
			"seed": 1048220234,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Rule service to manage all the rules (CURD operations).",
			"rawText": "Rule service to manage all the rules (CURD operations).",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Rule service to manage all the rules (CURD operations).",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "v3xn0r8z",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1540.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1130.218994140625,
			"height": 25,
			"seed": 1776684886,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Rules retriever calls rules service (periodically) to fetch latest rules and stores rules in memory for fast lookup.",
			"rawText": "Rules retriever calls rules service (periodically) to fetch latest rules and stores rules in memory for fast lookup.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Rules retriever calls rules service (periodically) to fetch latest rules and stores rules in memory for fast lookup.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "gOpunDFa",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1610.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 706.9393310546875,
			"height": 25,
			"seed": 449165578,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Client identifier identify client based on login id, user_id or ip_address.",
			"rawText": "Client identifier identify client based on login id, user_id or ip_address.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Client identifier identify client based on login id, user_id or ip_address.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "hva4TLnv",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1680.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 813.479248046875,
			"height": 25,
			"seed": 676705430,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "The client unique identifible key is then passed to rate limiter for making decision.",
			"rawText": "The client unique identifible key is then passed to rate limiter for making decision.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "The client unique identifible key is then passed to rate limiter for making decision.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "ZNe7OkBb",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1715.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 799.279296875,
			"height": 25,
			"seed": 2021525450,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Rate limiter using the rules from cache and unique client key makes the decision.",
			"rawText": "Rate limiter using the rules from cache and unique client key makes the decision.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Rate limiter using the rules from cache and unique client key makes the decision.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "6V1bmyUH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1785.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 552.6995849609375,
			"height": 25,
			"seed": 1545515478,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Do you want me to go deep into rate limiting algorithm?",
			"rawText": "Do you want me to go deep into rate limiting algorithm?",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Do you want me to go deep into rate limiting algorithm?",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "QpaIq14Z",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1855.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 97.15989685058594,
			"height": 25,
			"seed": 2143190666,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Algorithms",
			"rawText": "Algorithms",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Algorithms",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "UyI90ueD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1890.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 135.09988403320312,
			"height": 25,
			"seed": 1079379734,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Token Bucket",
			"rawText": "Token Bucket",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Token Bucket",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "HfBUTND1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1925.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 221.39981079101562,
			"height": 25,
			"seed": 490872138,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Reverse Token Bucket",
			"rawText": "Reverse Token Bucket",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Reverse Token Bucket",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "dWEYzoNi",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1960.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 185.579833984375,
			"height": 25,
			"seed": 1701885014,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Fixed sliding window",
			"rawText": "Fixed sliding window",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Fixed sliding window",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "bONYC0vK",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 1995.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 214.93983459472656,
			"height": 25,
			"seed": 1852040202,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804609,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Dynamic Sliding Window",
			"rawText": "Dynamic Sliding Window",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Dynamic Sliding Window",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "KA85ky00",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2065.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 107.65992736816406,
			"height": 25,
			"seed": 88324502,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Diagram 2.",
			"rawText": "Diagram 2.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Diagram 2.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "w1VEI2mN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2135.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 833.1591796875,
			"height": 25,
			"seed": 756994762,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Now, let's extend this design for multiple rate limit host (distributed system design)",
			"rawText": "Now, let's extend this design for multiple rate limit host (distributed system design)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Now, let's extend this design for multiple rate limit host (distributed system design)",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "c7LgDzYo",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2205.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1397.21875,
			"height": 25,
			"seed": 1459885782,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "When data needs to be shared between many hosts in a distributed system in a real time fashion we can use message broadcasting service.",
			"rawText": "When data needs to be shared between many hosts in a distributed system in a real time fashion we can use message broadcasting service.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "When data needs to be shared between many hosts in a distributed system in a real time fashion we can use message broadcasting service.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "Oa54Uili",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2240.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 922.8191528320312,
			"height": 25,
			"seed": 470673802,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": ". The first approach is that each and every host tell all other hosts everything. (Very slow)",
			"rawText": ". The first approach is that each and every host tell all other hosts everything. (Very slow)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": ". The first approach is that each and every host tell all other hosts everything. (Very slow)",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "AzOihRpa",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2275.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1344.2786865234375,
			"height": 25,
			"seed": 1665584150,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": ". The gossip approach where each user selects some random unique hosts and shares data with them. (A bit better than previous one)",
			"rawText": ". The gossip approach where each user selects some random unique hosts and shares data with them. (A bit better than previous one)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": ". The gossip approach where each user selects some random unique hosts and shares data with them. (A bit better than previous one)",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "gqFzqz5J",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2310.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 912.4992065429688,
			"height": 25,
			"seed": 1919690826,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804610,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": ". Distributed cache. Store data in a separate inmemory cache which every host can access.",
			"rawText": ". Distributed cache. Store data in a separate inmemory cache which every host can access.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": ". Distributed cache. Store data in a separate inmemory cache which every host can access.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "oXNC8naB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2380.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 404.67962646484375,
			"height": 25,
			"seed": 1476450646,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Data sharing or communication protocols:",
			"rawText": "Data sharing or communication protocols:",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Data sharing or communication protocols:",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "ljs9Fhxh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2415.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 139.3399200439453,
			"height": 25,
			"seed": 1209306890,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "TCP and UDP",
			"rawText": "TCP and UDP",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "TCP and UDP",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "XkTPteZy",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2485.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 135.07986450195312,
			"height": 25,
			"seed": 1552367254,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Improvements.",
			"rawText": "Improvements.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Improvements.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "TRJ3udQr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2520.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1200.958984375,
			"height": 25,
			"seed": 25304522,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "Millions for stale buckets will be stored. We can clear these buckets if no requests is coming within prior to some period.",
			"rawText": "Millions for stale buckets will be stored. We can clear these buckets if no requests is coming within prior to some period.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Millions for stale buckets will be stored. We can clear these buckets if no requests is coming within prior to some period.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "NAwzfB39",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2555.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1160.198974609375,
			"height": 25,
			"seed": 1703869398,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "When numbers of requests arrive at the same time. we can have a race condition in while updating number of tokens.",
			"rawText": "When numbers of requests arrive at the same time. we can have a race condition in while updating number of tokens.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "When numbers of requests arrive at the same time. we can have a race condition in while updating number of tokens.",
			"lineHeight": 1.25
		},
		{
			"type": "text",
			"version": 1,
			"versionNonce": 0,
			"isDeleted": false,
			"id": "YOjKPoT5",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 120.5862573099414,
			"y": 2590.4347237481006,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 998.83935546875,
			"height": 25,
			"seed": 1003476106,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1713089804611,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 1,
			"text": "To prevent this we can introduce lock but it will increase latency, so we need to see the trade-off.",
			"rawText": "To prevent this we can introduce lock but it will increase latency, so we need to see the trade-off.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "To prevent this we can introduce lock but it will increase latency, so we need to see the trade-off.",
			"lineHeight": 1.25
		}
	],
	"appState": {
		"theme": "light",
		"viewBackgroundColor": "#ffffff",
		"currentItemStrokeColor": "#1e1e1e",
		"currentItemBackgroundColor": "transparent",
		"currentItemFillStyle": "solid",
		"currentItemStrokeWidth": 2,
		"currentItemStrokeStyle": "solid",
		"currentItemRoughness": 1,
		"currentItemOpacity": 100,
		"currentItemFontFamily": 1,
		"currentItemFontSize": 20,
		"currentItemTextAlign": "left",
		"currentItemStartArrowhead": null,
		"currentItemEndArrowhead": "arrow",
		"scrollX": 956.5278377421416,
		"scrollY": -728.0597440931529,
		"zoom": {
			"value": 0.30000000000000004
		},
		"currentItemRoundness": "round",
		"gridSize": null,
		"gridColor": {
			"Bold": "#C9C9C9FF",
			"Regular": "#EDEDEDFF"
		},
		"currentStrokeOptions": null,
		"previousGridSize": null,
		"frameRendering": {
			"enabled": true,
			"clip": true,
			"name": true,
			"outline": true
		}
	},
	"files": {}
}
```
%%
---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Text Elements
URL SHORTENER

SDFC APPROACH

FR

get short url for a given long url
redirect to long url given short url
(analytics on clicked links) ^BOB6VUHt

NFR

low latency
high availability
scalable
eventual consistency (since we are not using links directly
after generating)

 ^tSzTyTwH

Numbers

10M links shortened per day
100:1 read to write ratio
1kb avg long url size
 ^pH13iop9

estimation

write qps = 10M/100K = 100 links generated per sec
read qps = 100*100 = 10,000 links clicks per sec

 ^kvlTjTSt

api design

POST /shortenLink
request
{
longUrl: https://youtube.com
}
response
{
shortUrl: https://tinyurl.com/defabcf
}


GET tinyurl.com/defabcf
in headers
longUrl: https://youtube.com

 ^EpQrdLEI

user ^ILjQyPaa

user ^uLpiL6pF

Load
Balancer ^HAm9RN4n

link shortening service ^SwokcTBe

redirect service ^rPS0r203

Load
Balancer ^VreSj7Ij

zookeeper ^H43VBIvJ

returns a range of available range for use ^uAWvQ8NV

at start of application this call is made to get range or when 
range is exhausted. ^Vi3JxW2b

ack ^rYSlkEXS

{
id:1234
shortUrl: https://tinyurl.com/adbkdie
longUrl: https://youtube.com
userId: (optional)
} ^RfXhJHOQ

user ^3cqleQgQ

user ^OlcTJwZD

link shortening service ^eaDDsykY

Load
Balancer ^59OHqULq

redirect service ^9dPY36EE

Load
Balancer ^qgD143KI

zookeeper ^vn3qKzWI

returns a range of available range for use ^qdvFfgGD

at start of application this call is made to get range or when 
range is exhausted. ^D1c9x0vZ

ack ^EHuc3ZIJ

{
id:1234
shortUrl: https://tinyurl.com/adbkdie
longUrl: https://youtube.com
userId: (optional)
} ^W0jZ8NZU

Message Q ^GdQUjVRP

kafka ^0xCpm3Ss

task runner ^kqzPtnOV

task runner ^v5ajxqwo

reddis ^Ac44bt5v

along with ttl
 ^ht06hGxZ

first store in db then in reddis to make sure db is ahead of cache
 ^WU0kzyDR

1 ^5r2T2RMC

2 ^CPqdbbT2

check in cache firsta ^JMbyUKt2

if not found check in db ^OPyT4jum

lsm based db   (cassandra)

Can handle write heavy
operations pretty easily



btree based db  (dynamodb)

can handle ready heavy 
operation easily

 ^EsaCQaXL

db triggers

like once stored on db, a lambda script get triggered to store
in reddis. I think it carries some overhead ^iJk9W4P5

idempotent operation

if you do a same operation multiple time, you get the same result
each time
 ^ZSqjxfmq

multiple instance of redis nodes for hot keys ^l22NcE7y

cache for 1 year

10M*365 = 4B links in a year

let say each record is 2 kb
4B*2kb = 8B kb
       = 8 tb

we can get 16 gb ram on a machine
so 8tb/16 gb = 8000gb/16 = 500 machines ^XTIUSoBB

dynamodb ^oTI5qIim

10M records in a day
10M*365 in a year
10M*365*10 in 10 year
36.5 B in 10 year

=each record is 2 kb

40B * 2kb
80 B kb
80 Tb

 ^2ycHu3dV

Hotel booking

SDFC APPROACH


FR
Customers can view available rooms
Customers can book rooms.
The frontdesk can view the reservation info to facilitate the checkin
Not two people should book same room

NFR
Scalable
High Consistency

 ^aHLYu46X

Numbers
3B views per month
30 million booking per month

so 100:1   read to write ratio
so 1% conversion 

read qps = 3*10^9/(30*10^5)
         = 1000 reads per sec

write qps = 30*10^6/(30*10^5)
          = 10 writes per sec


 ^nStgYRgm

Load
Balancer ^zwVDi6yG

Load
Balancer ^fOySkTh9

user ^l5w5Fn1r

listing
service ^6poHL9HA

user ^SImDd6K6

booking
service ^psfDohui

inventory
db ^t2gzkvIK

reservations
db ^Ue7DgiYy

update inventory ^dkNrOz7y

to handle large number of read we can 
have read replicas of inventory db
using leader follower model. ^E0chhgBe

1) receive request from user
2) update inventory

3) create a record in reservation
4) return a response to user


what if 3) steps fails so have inventory 
decreased but not actually used.

Thus you need to do either roll back for 
both 2) and 3) or roll forward means try again
for the failed one. ^dE8JToFa

1) receive request from user
2) update inventory PREPARE

3) create a record in reservation PREPARE
4) update inventory COMMIT
5) create a record in reservation COMMIT
6) return a response to user
 ^9YdbCteO

thus ^OzT3EfbP

browser/app frontdesk user ^myJkkiFW

admin backend service ^PJffngZA

Load
Balancer ^ennNSDym

{
buildingId: 12
roomTypeId: Double
roomId: 123
date: 10-06-2024
isAvailable: True
price: '$200'
} ^zCUKjLmU

{
buildingId: 12
roomTypeId: Double
roomId: 123
date: 10-06-2024
name: 'Mridul Kumar'
[paymentInfo]
} ^YleIbjpy

PostgreSql
(because low
no of writes
and reads only
when checkin. Also 
want acid properties.) ^osr6pdQ2

bcz read heavy want btree db
postgreSql or dynamodb with strong
consistency ^eHUuaaO4

user ^SeLtXQyE

browser/app frontdesk user ^WwnbNqt4

admin backend service ^XqvKharD

booking
service ^vCXxVPSO

user ^2JIa4WK8

Load
Balancer ^VJrbKPkM

Load
Balancer ^mXZzR1sM

listing
service ^rZZ3Pdlb

inventory
db ^giozTE6N

reservations
db ^0mhF9IGq

update inventory ^ftp7zPpr

to handle large number of read we can 
have read replicas of inventory db
using leader follower model. ^TxNLM1Xe

1) receive request from user
2)  get hold of your payment card  (something like prepare lock the fund in your fund for this transaction. Also check if available fund is there or not. Also allow a window like 10 minutes to make payment after it
expire that)
3) update inventory PREPARE

4) create a record in reservation PREPARE
5) update inventory COMMIT
6) create a record in reservation COMMIT
7)  debit money from your card (commit)
8) return a response to user
 ^czHVU3l1

Load
Balancer ^3PfQuaLS

{
buildingId: 12
roomTypeId: Double
roomId: 123
date: 10-06-2024
isAvailable: True
price: '$200'
} ^of5srPsu

{
buildingId: 12
roomTypeId: Double
roomId: 123
date: 10-06-2024
name: 'Mridul Kumar'
[paymentInfo]
} ^L6JbVlKL

PostgreSql
(because low
no of writes
and reads only
when checkin. Also 
want acid properties.) ^0ikBUPQk

bcz read heavy want btree db
postgreSql or dynamodb with strong
consistency ^RmJwlDLa

external payment
processor ^LHpNlrs1

code karle approach

how many characters to use for this short url?

if we are using alphanumeric characters then 62 characters allowed


10M links shortened in a day so in 10 years = 10*10^6*365*10
                                            = 10^8 * 400
                                            = 40B links generated in 10 year


1 character 62
2 character 62^2

7 character 62^7  ~ 3.5 trillion 

62^7>40B

so we'll use 7 character ^NVVRgQ69

user ^wQJI6ykG

Load
Balancer ^sYbplmvn

link shortening service
 ^tte7HfYn

centralized 
counter cache ^zCge4HKZ

will experience race condition,
to overcome it we can use locks
but it will inc the latency of
the system ^HdlJw3uO

user ^rM0cW7HF

Load
Balancer ^h600J1b0

link shortening service
 ^ZZcyHs1L

zookeeper
0-10000
10k-20k
 ^w8rqwdzR

asks for range at start of app or range gets exhausted. ^dfqUj1iZ

user ^ocvCDveI

Load
Balancer ^CxoFgtAt

redirect 
service ^2K5selIr

using no sql db here because need to store 4 trillion
so rdbms may start giving problems, of course we can shard 
the database but going here with nosql.
using dynamodb here as it supports large reads ^GGIkou7W

dynamodb ^eHV0lOwR

instead of zookeeper we can also use mysql db as 
we are giving range and that call happens very often.
Also in case two service request for a range at same time
we should give different range so we will need acid compliance. ^9cPV3xLs

here when redirect service directly sends the long url and done. But if we want analytics also.
We can put info in kafka. like platform where they have accessed the link from, ip address, broswer/mobile, etc.
Then kafka can process these messages and maybe put in hadoop where we can run analytics job.


However kafka will be under huge load bcz of the number of reads we are getting. so we can use mutliple kafka queues
and job runner service which take out message from one of the queue and push in hadoop.

Or a redirect service can aggregate the analytics for some time in a data structure and flush out the info periodically. 
This will reduce the load on one single queue.

However, it may happen one of the queue dies and we lose some analytics data in it. So that's okay. ^xGHJRn8j

if one of the link shortening service dies after without completing
a range, we'll lose the range, but that is totally okay. losing few
millions won't create huge impact. ^QbqSSLhc

here we are pushing in kafka as separate thread. 
one thread return result back to user while other
thread push analytics to hadoop ^lUvKQtBh

Code Karle approach


 ^VdpImqyT

FR

Hotel manager
- onboarding
- update rooms/images/info/pricing
- see bookings info, revenue, etc.

User
- search
- book
- check bookings details

Analytics ^zVufrloc

NFR

low latency
high availability
high consistency
scalable ^XarYbwUn

a UI that we give out to the hotel managers through this you it could be either a website or a mobile app but through this UI they would come on onboard onto our platform and the same UI would be used by them to modify the property. So let's say they want to add a new ^n1t7UStX

image or they want to add a new room or if they want to make any modifications this is the UI that they talk to. Now this UI talks to a Load Balancer through which it talks to a hotel service. This is basically a service which manages the hotel part which is basically 
the onboarding and the management. All right, now let's just say there's a spike in traffic ^KpJfq5Gz

so there could be multiple nodes of this hotel services that could be added here and so this becomes a horizontally scalable component. Now hotel data in itself is a very much ^EBKLOkae

relational data plus earlier we talked about the number of photos that's not too many so it doesn't even have a scale problem so we'll be using a clustered MySQL here with one master and multiple slaves slaves can be added as and when required. let's say there's a huge 
spike in Read traffic, we can add more slaves but this data resides within MySQL database ^NwSvDZyR

Now let's just say any image is added, so hotels can add images about the rooms about their whole building and all of that all those images would be stored into a CDN and the reference to the CDN which is basically a URL of the image would be stored in the database and 
that URL would be sent out to customers and whenever they want to render an image that would be looked up directly from the CDN. let's just say each time a modification is happening to a hotel let's just say a new hotel comes in we want to bubble up this hotel to the users 
who are going to search for this right, now there are multiple ways in which we can send out this information to the search piece, 
right. I'll be using a Kafka here so each modification that is happening ^gsZWtTUN

within hotel service will flow through a Kafka cluster and there'll be multiple consumers that will be sitting on top of this cluster which will populate their data store for ^aytsAwpH

serving the search traffic and for other traffic as well, right. So one of the consumers will be the search consumer what happens is let's say a hotel gets a new room, for example. There will be a payload that is put into Kafka which has all the information that is 
required Now the search consumer pulls up the payload from Kafka and it stores into its own database ^GZgqNhal

and this database would be used to power the search on the website. Okay, now for search, I am using an elastic search. So all the data ^wAlCzMZq

of each individual hotel, flows through the Kafka via the search consumer into this Elasticsearch cluster. Now on top of this Elasticsearch sits the Search Service. Now again let's just say there's a spike in traffic I can increase the number of nodes in Kafka cluster, I 
can increase the number of search consumers here and I can increase the number of nodes in Elasticsearch cluster. So till now whatever we have talked about is again horizontally scalable, right. And again coming to Search Service this is the service which powers the ^FcVqTEBH

search on the website So the user talks to through again a load balancer to the search service whenever they want  to search for a particular hotel again they will give a date range and a location for example as a search criteria and along with that they could also 
provide some tags. Now those tags would be the properties of the hotels. So again going back to my previous example a five star property is a tag. A beachfront property is a tag. Now the search on elasticity would be happening on either of these tags and the ranges 
that are provided basically the date range, price range and all of that. okay, so this takes care of the search flow. Now once the user has seen some of the results on the website they would want to book a hotel. The booking again happens through this UI. So I've made 
this UI saying that it's a search and book UI. Normally, it will be the same app or the same website through which they are searching  and then booking right. Now a booking request again comes to this load balancer and talks to Booking Service. Booking Service essentially 
again sits on top of a MySQL database now these are two different MySQL clusters. I am purposefully not using a same cluster here although we could use the same cluster and have two different databases in that but because we are talking about a fairly large system that 
has like a good enough amount of scale I would want to keep different clusters so as to you know take care of the scaling separately of each other Now, whenever a booking happens, that booking gets stored into this MySQL we go over the exact flow of booking when we go 
over the details of implementation within the Booking Service, but essentially this stores the data into this MySQL and it talks to a Payment Service Normally what will happen...  a booking request will come, it stores something, it will send the request for payment, 
once there's a success, it will mark the booking confirm. Now again, whenever a booking is happening, the data is flowing into the same Kafka, right. Why? so let's just say there was just one room available in a hotel right and that room is now booked i want to make sure 
that this hotel is not available for search now in that same date range, because it's not available. So all of those information is again sent to the same Kafka which is read by Search Consumer and then it takes care of even removing the hotels which are now completely 
booked. Now if you can see, there's something called an Archival Service here. What I have done is, I am just storing the live data into MySQL. By live data, I mean the bookings that are done but have not been completed thereby making sure that this is having a scale 
which is low enough that MySQL can easily handle, and once the booking moves to a terminal state so let's say booking is cancelled or booking is completed it will move through the archival service to a Cassandra cluster. The reason I'm using a Cassandra here is so 
cassandra is a very good database which can handle a huge amount of reads and writes. It has a constraint that it needs a partition key on which all the queries should happen. So let's say if I want to search by a "booking_id" my partition key has to be a "booking_id" 
in that case I cannot do any kinds of queries on a Cassandra therefore I did not use a Cassandra as a source of truth database. Because on this database I need to do a large variety of queries. We'll come to all of those when we go into the detail of Booking Service, but 
once it is archived we just need to do GETs on those. So therefore Cassandra makes a good enough sense over here. Now, once the booking is done, all of that is fine, but now we need to notify all the people right? So then comes the Notification Service. So let's say 
whenever a booking is made, or any changes are happening into a booking or it moves into a terminal state, there'll be a Notification Service that consumes events from this Kafka and notifies the people, so for example on each booking, we need to notify the hotel right. 
Whenever a booking is cancelled by the hotel we need to notify the consumer or in fact on each booking we need to notify the consumer with an invoice right. So all of those is taken care by this Notification Service. Now coming back to the UI for hotels and users. So each 
time a booking is done or even without that a user might want to see their old bookings or a hotel might want to see all the bookings that they have. This is more of a read-only view for them, right? That will be powered by this Booking Management Service, which talks to 
now two data sources. It talks to the MySQL cluster for all the active bookings, which are to happen sometime in future and to the Cassandra cluster, for the bookings that have already happened right. Now i am adding a Redis on top of this MySQL to reduce the load on 
this MySQL, so Redis will act as my Cache and whenever I have a query so for example something like get bookings of a user so I can cache this result into this Redis. And it'll be a write-through cache, so whenever a new booking is coming in this will get updated all 
right. Now this is the functional flow the bigger component here is how do we do the analytics on this so let's just say a business person wants to know how much revenue I'm making or how many bookings I'm having or what are my best performing hotels and stuff like that. 
So they need to do a lot of analytics Now mostly while designing the system we'll never always know what kind of analytics is required right so what I've done for that is I've used a Hadoop Cluster on which I'm pushing in all the events that are going into my Kafka. Which 
is basically information about all my hotels, about all my bookings, about all the transactions that happen in my system. So there will be a Spark Streaming Consumer that runs somewhere that reads from this Kafka and puts all the data into a Hadoop Cluster on which 
I can do Hive queries or any ^hUhCMRI6

different kind of queries and build up a lot of reporting. So this is overall how the system looks like and how the data flows. Now let's go into the details of some of the components. Now let's look at what Hotel Service internally is.  So it's not a very complicated 
service it is basically a CRUD Service which provides Create, Update, Read, Delete operations on the hotel data store. And it is the source of truth for hotel data. Now, this is not an exhaustive list of neither the APIs nor the DB Schema that you see here there will be a 
lot more things, but this will give you a feel of how it should be. So let's look at some of the APIs. to create a hotel which will be part of their onboarding process. GET /hotel/{hotel_id} which will give back the information of the hotel which can be rendered on the
 screen and the hotel guy can see it. PUT /hotel/id which will be used to update any information of a hotel. PUT /hotel/{hotel_id}/room/{room_id} which would be used to update the room information or create new rooms and all of that. Now this is not an exhaustive list 
there'll be a lot more APIs that you can add it as in when you know there's a requirement to add. Now let's look at how the DB schema might look like. So there are a couple of important tables now this is again not an exhaustive list of databases of the tables so there's 
one hotel table into this hotel DB but before that everything in red here is either a primary key or a foreign key. everything in blue is just a column now this hotel table contains your very standard things id, name, locality_id which is a foreign key to locality table 
description, original_images,  display_images and is_active. Now I have two columns for original and display images? so original_images is basically the artifact that the people have uploaded display_images could be a compressed version of that, that we've compressed, 
it could be a version that we have uploaded on the CDN, it could be something different than the original image but we still need to keep both of them so we have stored it here. is_active is basically like a soft delete flag Then coming to rooms table. It has a room id 
obviously, a hotel_id which references into this[hotel] table a display_name which could just be a identifier to tell the customer on what kind of a room it is, is_active again a soft delete flag, quantity basically tells how many such rooms are there in the hotel and a 
price_min and a price_max. Now why do I have do we have two prizes? Remember the hadoop cluster that we had in the original design that we made. it has a lot of data about various kinds of things we might as well run a machine learning model onto it and do some supply 
demand analytics and then come up with the optimal price! right? let's say supply is low there's a lot of demand there are just a few rooms left... might as well increase the price! or let's say if there are too many rooms and very few customers might as well reduce the 
price. So this price_min and price_max could be the ranges which the hotel provides, wherein the price could be fluctuated by the system. A good starting point could be an average of both these prices right.  Then there's a facilities table, which is basically a list of all
 the facilities that a hotel and a room can possibly have and these hotels_facilities and room_facilities are basically  mapping tables which is a many-to-many relationship between a hotel_id and a facility_id. again is_active flag everywhere is basically a soft delete 
flag. now again this is not a full list of tables there are a lot of information missing. I've skipped the auditing information, I've skipped the bookkeeping information like created_on, updated_time and all of that. A lot of information missing but this will give you a 
fair enough idea and it will be a good starting point for you to come up with a DB schema for this. One more thing to note here that if you remember the original design that we had I did not keep a Redis cache on top of this MySQL database but I did keep a Redis cache on the 
other MySQL database which was for Booking DB Now why is that? We could have kept the Cache on top of this and all these GET APIs could have been a bit more faster right, but this is not coming in the critical path of any high throughput business interaction right so all the 
customers are not querying this database, neither  this service, they are always querying the Search Service so if this service is a little bit slow that's okay but adding a Redis Cluster is a cost. So you need to do a trade-off analysis between what cost are you adding of an 
infrastructure and what benefit it adds to you if it is worth it you might as well go and add a Redis cluster here, but I don't think it is worth it and that's the reason I did not add it. Now let's look at the internal functioning of the Booking Service. We'll first start off 
just walking through the DB Schema again it's not a full-fledged schema there are a lot of details missing like bookkeeping information like created_time, updated_time and all of that but let's focus on the meaty part here. So it has a table called available_rooms which has 
a room_id it has a date, it has an initial_quantity that comes from the hotel service and it has a available_quantity available_quantity is basically the number of rooms that are remaining for that particular room_id for that particular date. Now, it has a constraint saying 
it cannot go negative. Here is where the true power of MySQL we are utilizing and that's the reason why I chose to use MySQL here the other table here is a booking table it has a booking_id which is the primary key here, which will be referenced across the whole system it has 
a room_id, again comes from the room table it has a user_id, a start_date and an end_date for a particular booking, number_of_rooms which is how many rooms the person has booked, status and an invoice_id. looking at this design we can clearly understand that one booking 
cannot contain different room types you can have multiple rooms of the same room type but you cannot have like one deluxe room ^ejsSkm8Z

and one regular room in one booking. If you want that there'll be a small change required but i think that's a minor detail it can be taken care of easily. The important part here is the status column. it has these four values  - reserved, booked cancelled and completed. 
Now canceled and completed are the terminal statuses here so the booking gets first created into reserved status. Then based on the payment success it can either move to book or cancel. And once the user stays in that, it moves to complete. Now you can add more statuses 
depending upon your conversation with your interviewer but these four statuses are the main ones that will help us achieve what we initially thought of. Now, let's look at the API Signature so this will have one important API called a book API it will be a POST API which 
will take these five attributes. It will contain a user_id it will contain a room_id, it will contain the quantity. Now again if you want to make multiple rooms multiple quantity we'll have to change it a bit to have an array but let's stick to this for now it'll have a 
start_date and it'll have a end_date. The price will come from somewhere else let's assume for now. It'll actually come from the data store which contains the price for the room at this point in time we don't want to generally take the price from the user because then the 
request can be tampered with and that's not really a good design okay now let's do a quick revision of the design because i skipped some important details in the earlier larger diagram and we'll go over that now. So the way Booking Service actually works is when it gets a 
request to do a booking it first of all queries this table and the available_rooms table and check whether or not I have that many number of rooms remaining or not. So if there are no rooms left for that particular room_id for that particular date, there's no point of 
proceeding so we can error out from there. But in case that's a success and we have rooms then we actually go ahead with the blocking of the room saying that now I'll block it temporarily and if the payment is success I'll actually book the room. I'll do a quick dry run of 
what actually happens. Assuming this is the request that came in user_id: 1 | room_id: 5 | quantity: 1  for some date "dt" to "dt +1".   The room_id: 5 on that particular date "dt" has 7 available rooms. So our first check is a success that we have enough rooms. So what
 essentially will happen is there'll be a row created in this table with a booking_id: (some_uuid) | room_id: 5 user_id: 1 | start_date: dt whatever that is, end_date would be "dt + 1" whatever that is, number_of_rooms in the request is quantity:1, and status would be at
 this point in time, RESERVED. invoice_id at this point in time would be NULL because there is no invoice created till now Now, we have a record, along with that we also decrement the quantity here now here again we are utilizing a very important feature of MySQL which is 
part of the ACID property  and transactions. So we are creating a record here[booking table] and we are reducing the quantity here[available_rooms] to 6. what essentially we are trying to do is basically bounding this as part of one transaction so let's say there was just 
one room left and two three requests came in only one transaction would be successful to do both these things. Basically to insert this record and reduce the quantity because we have this constraint sitting over here which says that quantity cannot be negative. okay so 
only one of the transaction will be success, and only one of the rooms will be booked and no two users will be redirected to payment. That being taken care of what is the next step so i have written down the steps here if you want to actually look at so what we have gone 
through till now is step number one and step number two okay we've inserted in booking and reduces reduce the quantity in available_rooms our step number three is something that I did not cover as part of the larger design review because it was getting too much cluttered. 
Now we cannot keep this room reserved for an infinite amount of time. What we can say is if the payment is success in next five minutes, well and good, if not then we'll assume that the payment will not go through and will unblock the room so that somebody else could book 
it, okay. So there are multiple ways to implement that what I choose to implement here is something using the TTL(Time To Live) of Redis. So because we anyway are using a Redis we can utilize the same cluster of Redis for this use case as well. So what we'll do is we'll 
put the key in Redis saying some booking_id expires at some timestamp Now the time stamp could be a configurable number, it could be a fixed timestamp across the board, it could be a country specific timestamp, for India have an expiry time of five minutes, for US have 
expiry time of four minutes, something of that sort but whatever that time is, we'll insert that into redis. Now what redis does is, it has something called callbacks so one of the later versions of Redis has introduced this concept called callbacks so whenever a key is 
getting expired you'll get a notification, okay.  And you can do whatever you need to do at that point in time, right.  So, if you get a Success notification from payment, well and good. Success notification means the payment has gone through, then you will mark the 
booking as BOOKED but before that if you get a callback from Redis saying that the key has expired and you've not got the success from payment you will say that the booking is CANCELLED. Alternatively you could also get a failure from payment saying for whatever reason
 the payment didn't go through and you got a failure response from the Payment Service, in that again you can say CANCELLED. Now if you want a bifurcation of the varieties of CANCELLED, you can maybe make multiple statuses like cancel because of invoicing / cancel because 
of payment/ cancel because of expiry, whatever right or you could maybe add a status_reason column or something of that sort but that's a very minor detail we'll skip that for now, okay.  So let's go over what all possibilities are there in this and how each of them 
behaves, okay. So, first very simple thing is -  what happens when payment is a Sucess? so in case payment is a success everything remains the same just the status becomes BOOKED. okay, in that case, we do get some invoice_id as well. So basically we'll get an invoice_id 
from Payment Service whenever you know a booking is getting success and we'll just update the invoice_id there and then the regular Kafka events would also be sent saying the booking is now complete and here's the Kafka event for that in case somebody wants to do something 
on that. What happens when payment fails? Now in this we just have these four statuses so the booking status will become CANCELLED. okay there would be no invoice_id in this case Why? because if the payment did not go through there obviously is not an invoice that is 
generated. And everything else remains the same but, if the payment did not go through, we need to revert the available_quantity again. so available_quantity in that case would become seven. Now let's say your key expired so basically let's say the user was redirected to 
payment screen and there was no response from payment service for whatever reason what happens then if we get a call back from Redis and based on that call back we can say that okay now the payment has not gone through we will follow the same process as payment failure we 
will mark this CANCELLED okay we will mark this CANCELLED and we'll increment the quantity in available_quantity so that the room is now available for somebody else to use.  Again in that scenario there is no invoice generated. But this you do only if the status is 
RESERVED. Why? -  coming to the next case, what happens if both (3) and (1) happen. What happens if you get a key expiry event and a payment is also success. so there are two conditions if the payment has already been successful and the booking has already been moved to 
BOOKED status, after that if you get this key expired event then you don't do anything because that is any way bound to happen right? but what if it happens the other way around what if key expired first you move the booking to CANCELLED state but then you get a 
notification saying payment is success Now there are multiple directions in which you could take it based on your conversation with your interviewer and the non-functional requirements and in fact even the functional requirements for that matter you could do two three 
things. You could now either revert the payment saying for whatever reason we were not able to book the room so here's your payment back. Alternatively you could do something even more smarter. You could say that now I have anyway got the payment from the user, I can 
check if there are rooms available and I'll book them, right? Now this could be done based on what the requirement is and you could talk to your interviewer and implement it either ways. All good so far but there are a couple of caveats here. The TTL that you have talked 
about it is not a very precise measure so let's just say that a key was supposed to expire at 10:00 okay,  you will probably never ever get a call back at this point in time it will always have some delay. Now in this case it doesn't matter too much instead of at 10:00 if 
you get it at 10:01 it's possibly okay also. So it's not too big of a problem and the reason for that is because of the way expires are implemented in Redis I'll not go too much into detail of that but there's a background process that runs in Redis for keys that are not 
accessed and whenever that process gets to access a particular key is when it will expire it. So it is not necessary that it will acquire it at exactly the same time. ^7SbUmrYw

Now a couple of optimizations you could do. So, let's just say payment is success. You know that key will expire after some time, for sure, right? because it's there in Redis. You don't need to keep that key there you know the payment is success you can evict the key right, 
even if the for the payment failure case you know that payment has failed it will expire after five minutes might as well delete the key then and there, right. So these are certain optimizations that you could do over this implementation to make it even more better. But 
on and off this is how the booking flow works. Now again reiterating we have used a couple of important features of MySQL and that's what is helping us to make the code on application side much more smoother had we used some other database which doesn't provide for example 
if you were using Cassandra here we would not have had access to the transactions and the constraints and all of that you would have to implement it on application side. That's additional effort on our side to make sure things are consistent. in this case I would rather 
leave it to MySQL to implement all of those things.  Now coming back to the same architecture again i just want to call out that all of the components that you see here are individually horizontally scalable so let's just say there's a traffic spike happening on one of the 
components we could increase the number of nodes in that particular service maybe that particular database and then that should work just fine. As far as Kafka and hadoop cluster are concerned we could add more nodes into that as well and they should also scale to a much 
larger scale than what we need. Cool, so now let's look at what kind of alternates that we could have used instead of this particular design choice. So first of all why MySQL, we could use any other relational database here. We could use a Postgres we could use a SQL 
Server, anything which provides ACID guarantees should be fairly fine here. As far as Redis is concerned we could use a memcache or any other cache instead of Redis and that should also be good. Cassandra, I would still stick to Cassandra because that is exactly what we 
need here now technically in place of Cassandra we could also use a HBase here that would also work fine but it has a lot of operational overhead in terms of deployment and maintaining it over time so that's the reason I would prefer Cassandra over HBase or any other 
similar system The way cassandra works is every data in Cassandra is you know sharded across a partition key so each query has to happen on a partition key now the queries that we are doing are just of two varieties. There is no the third variety so we basically have two 
kinds of data which is distributed by two different partition keys on which the queries are happening. So this would be kind of a very good choice here. In place of Kafka,  we could have used an Active MQ or a Rabbit MQ or any other queueing mechanism there's an amazon 
queue(SQS) also we could have used that but i think Kafka scales much better than most of them so i think it's a fairly good choice here. Other than that in general we definitely need to monitor how are our CPUs and Memory is behaving.  So if I have a CPU spike at certain 
points in time that is something we need to kind of look at so across the whole infrastructure we need to keep an eye on how my CPU usage  percentage is, how my memory usage percentage is, how my disk usage for Redis is, how my disk usage for elastic search is all of these
 things are what we need to monitor now monitoring could be done through a Grafana kind of a tool on which i can set up alert. So if the let's say a particular metric has some threshold the moment I cross that threshold or with certain conditions I could send out an 
alert and the team could get notified that something is potentially wrong and they need to look at that. this will help us to make sure that we in the end achieve our NFRs that we talked about of latency and high availability. Because let's just say something goes wrong 
let's just say memory is you know utilize more than what we expected eventually it will lead to some machines going down and eventually it will lead to us having a lower availability that than what we expected so yeah these are the things that we need to monitor and
 alert on. Now in the next section let's look at how this whole thing would be spread across geographies, so for example let's say there's an earthquake in one of the data centers and everything just goes away out of the blue what do we do? So let's look at that next So
 let's say we have these four data centers data center 1, data center 2 data center 3, and data center 4 which are located in different geographical regions across the globe, okay. Now we want to create a topology in a way that we do get low latency and high availability
 okay so one very simple approach that we could do is say that DC 1 is our primary and all the three DC's are our secondary data centers and data is replicated to all the three data centers in near real time okay, so that's okay it's good enough. but it's not very good to 
be honest because we are just using 25 percent of our capacity as primary which is active and rest three data centers are sitting idle and not really doing anything. So let's try to improvise what we could instead do is divide the data centers and thus the globe into two 
parts.  What we could say is this is region one and this is region two okay now the countries or people accessing our services who are closer to this region(R1) will connect to this region(R1) and the people who are closer to that region(R2) will connect to that 
region(R2). Now how are we able to do that so the data in a hotel management system is fairly specific to a geography so all the hotels in let's say India can be you know separated from all the hotels in US. Similarly all the rooms all the bookings are now specific to 
hotels and thus specific to geography so we could kind of bifurcate the data as per geography right which gives us the leverage to divide the system into two halves right now what will happen here now let's just say DC1 is the primary in this region(R1) and DC3 is the 
primary in R2 okay now if DC1 goes down all the data in DC1 is getting replicated to DC2 in near real time so if that goes down DC2 can become active and all the clients who are connecting to DC1 and how will they connect so there will be bunch of clients who are 
connecting via some DNS to DC1 right if this goes down DNS can flip and connect to DC2 if this link is broken right similar thing can happen on this side so this way what we have is basically dividing our infrastructure into two halves thereby clients who are closer 
to this region are connecting to the servers that are closer to them thus giving them lower latency right. Now we could go even one step further we could say that we'll divide the region into four parts and we could do we could go as much as deep we want into this to 
increase the latency basically to reduce the latency and increase the availability but i think for all practical purposes at least for a Hotel Booking System this R1 R2 thing is more than sufficient to give us a good enough latency and a very high availability.  ^cqjTvMm9

Amazon

code karle approach

FR                                       NFR
- search
- (tell them if it is delivarable        low latency
to a certain pincode or not)             high availability (search + view orders + view products)
- add/remove to cart                     high consistency (payment + inventory counting)
- checkout                               scalable
- view past orders                       

 ^9RfWs4di

Things in green are basically the user interfaces. It could be browsers, mobile applications, anything.These two are basically not just load balancers but also reverse proxies and an

authorization and authentication layer in between that will authenticate all therequests that are coming from outside world into our system. All the things in

blue that you see here are basically the services that we have built. It could beKafka consumers, could be Spark jobs could be anything. And the things in red are

basically the databases or any clusters could be Kafka Cluster/Hadoop clusteror any public facing thing that we've used. Now let's look at the user

interface what all we'll have. So we mainly have two user interfaces.One is the home screen which would be the first screen that a user comes to it would by

default have some recommendations based on some past record of that user, or in caseof new user some general recommendations. In case of search page it would just be

a text box where in user head put in a text and will give them the search results.With that let's look at how the data flow begins. So a company like Amazon

would have various suppliers that they would have integrated with nowthese suppliers would be managed by various services on the supplier front

okay. I am abstracting out all of them assomething called as an Inbound Service. What that does is basically it talks to

various supplier system and get all of the dataNow let's say new item has come in. Or a supplier is basically onboarding

a new item. That information comes through a lot of services and through InboundService into a Kafka. That is basically a supplier word coming into the whole

search and user side of things. Now there are multiple consumers on thatKafka, which will process that particular piece of information to flow

into the user world. Let's look at what that is. So the veryfirst thing that will happen is basically something called as an Item Service.

So Item Service has a lot of peopletalking to it and if I start drawing all the lines, it become too cluttered so

I've not on any connection to item service but item service will be one ofthe important things that listen to this kafka topic and what it does is

it basically on board a new item.  Now it also is basically the source of truthfor all items in the ecosystem.  So it will provide various APIs to get an

item by item ID, add a new item, remove an item,update details of a particular item and it will also have an important API to bulk

GET a lot of items. So get a GET API with a lot of item IDs and it is in response itgives details about all of those items. Now Item Service sits on top of a

MongoDB. Why do we need a Mongo here?  - So item information is fundamentallyvery non structured. Different item types will have different attributes and all

of that needs to be stored in a queriable format. Now if we try to model that in astructured form into MySQL kind of database that will not be an optimimal choice.

So that's why we've used a Mongo. To take an example, let's say if you look ifyou look at attributes of some products like a shirt, it would have a size

attribute and it would probably have a color attribute right. Like a large sizet-shirt of red color. If you look at something like a television, it will have

a screen size, saying a 55 inch TV with the led display kind of a thing. There could beother things like a bread, which could have a type and weight. Like 400 grams of

bread of which is of wheat bread or a sweet bread or something of that sort.So, it's a fairly non-structured data and that's the reason I use a Mongo database here.

Now, coming to other consumers that will be sitting on that Kafka.So on this Kafka, there is something called as a Search Consumer. What this

does is basically whenever a new item comes in, this search consumer isresponsible for making sure that item is now available for the users to query on.

So what it does is all the items that are coming in it basically reads throughall of those items. It puts that in a format

that the search system understands and it stores it into its database.Now, search uses a database called Elastic search, which is again a NoSQL

database, which is very efficient at doing text-based queries. Now this wholesearch will happen either on the product name or product description and maybe it

will have some filters on the product attributes. Those kind of things issomething that elastic search is very good at. Plus in some cases you might

also want to do a fuzzy search, which is also supported very well by Elastic Search.Now on top of this Elastic Search, there is something called as a Search Service.

This Search Service is basically an interface that talks to the front endor any other component that wants to search anything within the ecosystem.

It provides various kinds of APIs to filter products, to search by a particularstring or anything of that sort. And the contract between Search Service and

Search Consumer is fixed so both of them understand what is the type of data thatis stored within Elastic Search. That is the reason consumer is able to write it

and the Search Service is able to search for it. Now, once .. a user wants to searchsomething, there are two main things around it.  One is basically trying to

figure out the right set of items that needs to be displayed but there is alsoan important aspect that we should not show items that we cannot deliver to the

customers. So for example, if a customer is staying in a very remote locationand if we are not able to deliver big sized items like refrigerator to that

pin code, we should not really show that search result to the user as wellbecause otherwise it's a bad experience that he will see the result but you will

not be able to order it, right.  So search service talks  to something called as aServiceability and TAT(Turn Around Time) Service. This basically does a lot of things

first of all it tries to figure out that, where exactly the product is. In what allwarehouses. Now given one of those Warehouse or some of those warehouses, it

tries to see - do I have a way to deliver products from  this warehouse to the customer's pincode?and if I have, then what kind of products can I carry on

that route. Now certain routes can carry all kinds of products but certain routesmight not be able to carry things like big products or

other kind of product, right. So all of those filtering stays within theServiceability and TAT Service. Now it also does one more thing that it tells

you in how much time I will be able to deliver, okay. So it would be like innumber of hours or days or anything of that sort it can say that probably I

will be able to deliver it in 12 hours,  or 24 hours or something of that sort.Now if serviceability tells that I

cannot deliver, search will simply filter out those results and ignore that andreturn the rest of the remaining things. Now Search might talk to User Service.

There's something called as a User Service here. We'll get into thatlater but the User Service is basically a service that is the source of true so

for the user data and it(Search) can query that(User  Service) to fetch some attributes of userprobably a default address or something of that sort, which can be used basically

which can be passed as an argument to Serviceability Service to check whetherI can deliver it or not, okay.  Now Search Service returns the response to the

user which can be rendered and the people can see whatever you knowthey want to see. Now each time a Search happens, an event is basically put into Kafka.

The reason behind this is whenever somebody is searching for something theyare basically telling you an intent to buy a kind of product, right? That is

a very good source for building a Recommendation. We'll look at howRecommendation can be build later on, but this is an input into the recommendation

engine and we will be using a Kafka to pass it along.So each search query goes into Kafka, saying this user ID searched for

this particular product. Now from the Search Screen user could be able towishlist a particular product or add it to cart and buy it, right? All of those

could be done using the Wishlist Service and Cart Service.Wishlist Service is the repository of all the wish lists in the ecosystem and

the cart services by repository of all the carts in the ecosystem. Carts are basicallya shopping bag, which when people put product into it and then

checkout.  Now both these services are built in exactly the same way(almost). Theyprovide APIs to add a product into user's cart or wishlist. Get a user's

Cart or Wishlist. Or delete a particular item from that.And they would have a very similar data model and they are both sitting on

their own MySQL databases. Now from a hardware standpoint I'd like to keepthese two  as separate Hardwares. Just in case, for example Wishlist size becomes too

big and it needs to scale out so we can scale this particular clusteraccordingly. But otherwise functionally both of them are totally same.

Now each time, a person is putting a product into Wishlist, they areagain giving you signal. Each time they are adding something into their cart

they are again giving a signal, about their preferences, things that likethat they want to buy and all of that, right? All of those could again be put

into Kafka for a very similar kind of analytics.  Now let's look at what thoseanalytics would be? - So from this Kafka there would be something like a

Spark Streaming Consumer. One of the very first things that itdoes is - kind of come up with some kind of reports on what products people are

buying right now. Those would be things like coming up with the report sayingwhat was the most bought item in the last 30 minutes, or what was the most

Wishlisted listed item in last 30 minutes, or in Electronics category what whichproduct is the most sought-after product. So all of those would be inferred by

this Spark Streaming. Other than that it also puts all the data to Hadoopsaying this user has liked this product, this user has searched for this product

anything that happens, right. On top of it, we could run various ML Algorithms. I'vetalked about those in detail in another video(Netflix Video), but the idea is - given a user and a

certain kinds of products that they like, we could be able to figure of two kindsof information. One is what other products this user might like okay and

the other thing is how similar is this user to other users and based onproducts that other users have already purchased we would recommend a

particular product to the user. So all of those is calculated by this Spark Clusteron top of which we can run various ML jobs to come up with this data.

Once we calculate those recommendations,  this Spark Cluster basically talks tosomething called as a Recommendation Service.

Which is basically the repository of all the recommendations, and it has various kinds ofrecommendations. One is given a user ID, if you store general recommendations saying

what are the most recommended products for this user. And it will also store thesame information for each category. Saying for electronics for this user

these are the recommendations. For the food kind of a thing, for this user, theseare the recommendations. So when a person is actually on home page they will first

see all in just general recommendations and if they navigate into a particularcategory they'll see the specific recommendations we are specific to the category.

Now we have skipped a couple of components. User Service is a verystraightforward service which basically you can look at any other of my videos

that have talked about it in detail(Airbnb Video), but it's a repository of all the users.It provides various API is to Get details of a user, Update details of user and all

of that. It'll sit on top of a MySQL database and a Redis Cache on top of it.Now let's say Search Service wants to get details of a user the way it will

work is, it will first query Redis to get the details of the user. If theuser is present, it will return from there. But if the user is not present in

Redis it will then query the MySQL Database (one of the slaves of that MYSQLcluster), get the user information, store it in Redis, and return it back.

So that's how User Services will work. Now there are some other components that are here.One is Logistic Service and one is Warehouse service.

Normally these two components come in once the order is placed. But inthis scenario this Serviceability Service might query either of these two

services not a runtime, but before catching the information to fetchvarious attributes. So for example it might query this Warehouse Service to get a

repository of all the items that are in the warehouse or it might query LogisticService to get details of all the pin codes that are existing or maybe details

about or the Courier Partners that work in a particular locality and all of withthat all of the information this Serviceability Service will basically

create a graph kind of a thing saying what is the shortest path to go frompoint A to point B and in how much time can I get there.

Now we have not covered this service in detail. I have also made another video onimplementation of Google Maps. This is very similar to that. So if you

want to get into details you can look at that(Google Maps Video) but just to just to call it outthis doesn't really do any calculation at runtime. You store all the

information in a cache and whenever anybody queries, it willquery the cache and return the results from the cache itself, and no runtime

calculation because those kind of calculations are fairly slow. And it willpre-calculate all possible requests that can come to it. Basically if there are

N Pincodes and M Warehouses, it will do a M x N and calculate all possiblecombinations of requests that can come to the service, and store it in a cache.

Now let's look at what happens when a User tries to place an order. So the userinteraction, to place an order is represented as this User Burchase Flow.

This could be access to apps, mobile apps or web browsers or anything. Now wheneverUser says that I am ready to place an order take me to the payment screen

which is the last piece in the app flow then basically the request goes tosomething called as the Order Taking Service. Think of Order Taking Service as

a part of Order Management System which takes the order.Now Order Management System sits on top of a MySQL database. Why MYSQL? - because if you

look at order and table form for order, it will have a lot of tables, some withorder information, some with customer information, some with item

information and there are a lot of updates that happen on to the OrderDatabase, right, for each order.  Now we need to make sure that those updates are

atomic and they can form a transaction so as to make sure that there are nopartial updates happening. And because MYSQL provides that out of the box we

would leverage that here. So that's why MySQL.  Now whenever this gets calledthe very first thing that happens is a record gets created for an order,

an order ID gets generated. Now the next thing that we do is we put an entryinto this Redis saying, this order ID was created at some point in time and this

record expires at some point. Why is it being used, we'll come to. But think of it asan entry that goes in something like - Order id: "O1", gets placed

and 10:00 let's say. it expires at 10:05. Something of that sort.Now the record that goes into this MySQL Database has an initial status.

Think of it as a Status of: "CREATED". So basically the record thatgoes into this table is something like - order O1, was created at 10:00 with

status: "CREATED". You can have different set of names also that's fine.The third thing that happens is we basically call Inventory Service. The idea of

calling Invented Service is we want to block the inventory. So let's say ifthere were five units of a television that a user wanted to purchase, we will

reduce the inventory count at this point in time, and then send the user to payment.Why do we do that? - Let's just say there was just one TV and three users want to

come in at the same time. Now we want to make sure only one of them buys the TVand for two of them it should show that it is out of stock, right? We can easily

enforce that, through this Inventory Service, by having a constraint on to thetable which has the 'count' column saying that 'count' cannot go negative. Now each

time you basically want to place that order for a TV, only one of the.. if thecount is one, only one of the users will be able to do that transaction where the

count reduces. For the other two, it'll be a Constraint Violation Exception becausethe count cannot be negative. So only one of them will go through with the

inventory, right! Now once the inventory is updated then the user is taken tosomething called as a Payment Service. Think of it as an abstraction over the

whole payment flow where in this service talks to your Payment Gateways and takescare of all of the interaction with the payment. We will not go into details

of how that works, but the interaction with the Payment Service can lead to two-threeoutcomes. One of them is that payment service could come back saying the payment was

successful. Or it could say that the payment failed due to some reason, couldbe a lot of reasons. Or the person could just close the browser window after

going to the payment gateway and not come backin which case payment service would not give a response. So these are there are

these three possibilities. Now let's see what can happen, okay. So one of the veryfirst thing that can happen is let's just say

at 10:01, we got a confirmation from Payment saying payment was successful.In that case it'll.. the order would get confirmed, right. So let's say we call it

and that status is now "PLACED", or any other name for that matter. So nowonce the payment has been successful, we update the status of the order over here

in the database saying that order is PLACED. Now the work is done. At thatpoint in time an event would be send in to Kafka, staying an order has been

placed, with so-and-so details, okay! Another option - it could(Payment Service) couldcome back saying that.. the payment failed. Let's say there was no money in

the account or whatever happened.  Now once the payment has failed, we need todo a lot of things. First of all, we need to cancel the order, because the payment

has not happened. So let's say the other possible scenario is the order could beCANCELLED, right? Now.. if the payment has failed

we need to increment the inventory count again. so we'll basically again callInventory Service and saying that - you decremented the quantity for this

particular order ID, now let's increment it back. So that's a rollback transactionkind of a thing, that is happening here, okay. So that is one more thing we'll do.

And also we'll have a Reconciliation Service that sits on top of this wholesystem which reconciles basically checks every once in a while that if there were

ten orders overall I do have the correct inventory count at the end, just to handlecases with due to some reason we missed update of inventory count or the write

fail. So all of those scenarios can be handled by the Reconciliation flow.Now there is one more scenario that can happen. Payment Service could not at all

come back, right? The user close the browser window, the flow ends there,payment service doesn't respond back to us. Now what do we do? We can't keep the

inventive blocked. So let's say there was just one television available this userhas gone to the payment screen, closed the window and gone away. Now we still have

that one television physically available in our warehouse but the database saysit's not available. We need to bring it back, right. So for

that the Redis comes in. So at 10:05 what will happen is Redisthis record will get expired, right.  Redis will have a will have a expiry. We'll have a expiry

call back on top of Redis which will basically be invoked saying that thisparticular report whatever you insert inserted, it has got expired. Now do

whatever you want. At that point in time Order Taking Service will catch thatevent and say that now this particular record has expired,

I'll basically follow the same flow that was followed for payment cancellationbasically I'll time out the payment and mark it CANCELLED, okay. So at that point

in time again at 10:05, this order would be moved to CANCELLED State in the Databaseand the inventory would get updated back again, right. So everything is good but

there are a couple of scenarios here.  So there could be potential risk conditions.What happens if your payment success event and your expiry happens at the

same time. What do you do then? So there are two three scenarios in which itwould happen. The first scenario is that payment success comes first and then

expiry happens. So in that... that is a scenario that will always happen.So whenever a payment is success let's say at 10:01 payment got success

anywhere at 10:05 this expiry would have happened, right? So this is something thatis bound to happen for all the  the orders. So one optimization we could do

here is each time we get a payment success or payment failure event, we candelete the entry form Redis, so as to make sure it's expiry event does not come in.

The other scenario is that expiry comes first and then paymentsuccess. Now whenever we would have got.. let's say expiry came at 10:05 and

payment success happens at 10:07. Now whenever we get the expiry event wewould have canceled the order, we would have decremented the inventory count.

But now the payment has happened, that we got to know. There we could do 2-3 things.We could either refund the money back to the customers saying that for

whatever reason we are not able to process, here's your money back. Alternatively,we could also say that now we have anyway got the money from the customer. We know

what the person was able to... was trying to order. Due to a issue one our sidepossibly the order didn't go through. So we could

create a new order mark this payment for that order, and then put that directlyinto PLACED status. So that is another thing that we could do.

Assuming for all the orders as soon as we get a payment success and paymentfailure, we will delete these entries from Redis so to make sure there are no..

these conditions do not happen too frequently. That will help us to save thememory footprint as well, because the lesser amount of data we have in

Redis, the lesser RAM it would consume, and it will be much more efficient okay.Now one thing I want to call out about this Redis expiry is - this is not very

accurate. So let's say if it was the supposed to expire at 10:05, we might not getthe call back exactly a 10:05. We might get a callback at 10:06, 10:07 or sometime

after 10:05 and that is because of the way it is expiry works. So Redis doesn'texpire all the records at that point in time. It basically it checks all the

records every once in a while for expiry and whenever it finds some of the docs/some of the keys that are expired then it expires that. So it might happen

that it'll expire after a few minutes. Now in this scenario it doesn't really matterso I think we should be okay with this kind of an approach but if you are

trying to do something which is much more mission-critical, then possibly youmight have to do a different approach. But even you should talk

about this to your interviewer, and if they say then you might also change theimplementation a bit. You might implement a queue and keep polling that queue every

second or something of that sort. Okay. Now once the payment has happenedor not happened or whatever happened, you would put all of those events into Kafka

anyway. There is one more reason why you want to put two events. So let's saythere was this one item one television left okay and somebody has purchased

that. Now you want to make sure that nobody else is able to see thetelevision because anyway the count has become.. inventory count has become zero

you cannot take an order, right. So you need to... basically make sure that itshould be removed from search.  Now remember there was a Search Consumer

that we looked at in the previous section. That Search Consumer wouldalso take care of inventory kind of things. So as soon as an item goes out of stock

it would basically remove that element from in the listing. Basically it willremove the documents pertaining to that particular set of items. Now there is one

problem in this whole thing that we have decided/built. This MySQL can veryquickly become a bottleneck. Way? - Because there are a lot of Orders. So for

a company like Amazon they will probably have like millions of Orders in a day acouple of millions at-least. And that number could bloat up significantly

over an year. And normally you would have to keep Order Data for a couple of yearsfor auditing purposes, right. So this Database is going massively big. we need to

do something about it. So remember the whole use case of having this MySQLis to take care of atomicity, transaction, basically the acid properties for orders that are

being updated. But for the orders that are not being updated, we don't reallyneed any of these functionalities, right. So what we can do is once you order

reaches a terminal state, let's just say an order is DELIVERED or CANCELLED, wecan basically move it to Cassandra. So there is something called as Archival

Service, which is a cron kind of a thing, which runs every one day/12 hours atsome frequency and it pulls all the orders which have reached the

terminal status from this MYSQL and puts it into Cassandra. Now how does itdo that? - so you can see these two services. There's the Order Processing

Service and there's a Historical Order Service. These two are againcomponent of the whole larger Order Management System which are do certain

things of their own. So Order Processing Service is the service which takes care ofthe whole lifecycle of the order. So once the order has been placed any changes to

that order happen through this. This will also provide APId to Get the orders ifsomebody wants to get Order details. Again, similarly, Historical Order Service

will provide all kinds of the APIs to fetch information about HistoricalOrders. Now Archival Service will basically query Order Processing Service

to fetch all the orders who have reached terminal status, get all of those details,call Historical Order Service to insert all of those entries

into its Cassandra, and once it has got a success saying I've inserted intoCassandra, replicated in all the right places, then it will basically call Order

Processing Service to delete that. Let's say there is some error, somethingbreaks in between, it will retry the whole thing and because it is idempotent

it doesn't really matter we can replay it as many number of times as we want.Cool. Now coming to the...once the user has placed the order all of the things will

happen, logistics and all can happen behind the scenes. Now the user can go and seetheir past orders, right. That will be powered by this Orders View. So Orders

View will basically...there will be a service here which kind of is the back end ofOrders View, but that'll clutter the diagram too much. Assume there's a

service here which talks to the Order View, and that talks to these two services.So basically what it will do is, it will basically query Order Processing Service

to fetch information about all the live orders who are in transit it. It'll callHistorical Order Service for all the orders that have been completed. It will

merge the data and it will return back to display on the App or website orwherever, cool. Now why did we use a Cassandra here? - So Historical Order

Service will be used in a very limited set of query patterns.So some of the queries that will run is:  1) Get information of a

particular order ID  2) Get all the orders of a particular user ID3) possibly get all the orders of a particular seller. But there will be a

small number of type of queries that will run on this Cassandra and Cassandra verygood when you have that finite number of queries(by type) but a large set of data.

that's the reason we have used Cassandra. Now coming to whenever anorder is placed we want to notify the customer that your order has been successfully

placed. It will be delivered to in 3 days or something of that sort.You'll have to possibly notify a seller, you might have to notify somebody else

or when something happens. Let's say an order is cancelled by the seller youwant to notify the customers. So all of those notifications would be taken care

by this Notification Service. Think of it as an abstraction which can abstract outall various kinds of notification like SMSs, Emails and all of that. I made

another video(on Notification Service Design)  which talks about in detail of how doyou implement Notification Service.  So you can go have a look at that as well.

While ... a user is placing all the orders, all of those things are happening,all the events are going into this Kafka on which we are running a Spark Streaming

Consumer. It does a lot of things.  One of the... very first thingsthat it does is it can publish a report saying in the last one hour what are our

items which have been ordered the most. Or which category has generated the mostamount of revenue like electronics or food or something of that sort, right. So

it can publish out some of the reporting metrics that we want to quickly look at.Other than that,  it will also put the whole of the data into Hadoop cluster. Now we have

real order information of a user which is a very good thing for recommendationsSo on top of it, will have some spark jobs which will run some very

standard ALS kind of algorithms, which would be predicting that this particularuser, given that he's ordered certain things in the past, what are the next set

of things that this person might order. Or because this customer lookslike that customer and that customer ordered so-and-so product, so this

customer might also order so-and-so product. So there could be, a lot of kind ofmodels that you can run to predict what are the right set of recommendations for

this user, which would be then send to this Recommendation Service which we lookedat in the last section, it will store it into its Cassandra and the next time when

the user comes in, we'll show them those kind of recommendations. It would notjust have like recommendations based on your orders but also similarity, so again

taking the same example if you have ordered a white board you willdefinitely want to order marker. So all of those things would also be taken care by this. ^FM420z12

chat application like whatsapp/facebook messenger ^czQPSYsT

code karle approach ^kyE39vV2

FR

support one to one chat
group chat, a user can send message
to group of people
read receipt (delivered, sent and seen)
last seen status of user
(notification to recipient if online) ^B2J8BJfr

NFR

low latency
high availability
high consistency
scalable ^qqrJaWo1

Numbers

2B users
1.6B monthly active users
65B chat messages/day ^cm9BZbVD

We will support a One-to-One Chat wherein a person can send a message to another person or a user.There would be something called a Group Chat where

somebody could make a group of people and whenever anybody in the groupsends a message to the group, that message is received by everybody in the group.

The messages could contain text, it could contain images, it could contain videosand then it could extend to other kind of documents as well.

There is something called Read Receipt, which is basically the single tick whenthe message is sent,

double tick when the message is delivered to theuser and a blue tick when the person sees the message.

We'll also show Last Seen time of a particular user.Coming to the non-functional requirements,

this platform needs to have a very very low latency becausefor a chat application it needs to look very real-time so,

while you are sending a message, the other person should immediately be able to see that message.And obviously it should have a very high availability. This system

should not go down, no matter what happens.Also, there should not be any lag.

In other videos that we have talked about in the past,we were able to live with a lot of lag as well.

But in this video, we cannot have a lag because again, it needs to be a very real-time systemwherein I am typing something to you and you can see it then and there and then respond to it.

Coming to some scale numbers, these are approximate numbers of WhatsApp.Again, I do not know if these are actually correct or not but I just read somewhere.

WhatsApp has roughly 2 billion users, out of which 1.6 billion users accessit on a monthly basis. These are unique users.

Each day WhatsApp has somewhere close to 65 billion messages being sent across all the users.And that's a very big number.

We will try to look at how can we design a systemthat can deliver all of these functional requirements, with a very low latency

and can live with these kind of numbers.Numbers for Facebook Messenger are approximately similar

and other chat application could also be running at a very same scale.Let's look at the overall architecture of the whole system.

We'll first start with the Chatting Solution and thenwe'll look at other small pieces that surround it.

Let's start with the User flow.All of these things that you see here are basically user devices.

Could be mobile phones, could be web browsers,could be wearable devices like smart watch and all of that.

Let's say user1 wants to send a message to user2.So, the flow goes like this -

user1 wants to send a message to user2 with a message id, m1.What happens is - user1 is talking to something called a WebSocket Handler 1.

There will be a lot of these WebSocket Handlers.What this is - is basically,

a WebSocket Handler is a server on our backend,which is keeping open connections with all the active users, right now.

These are the live users, who are having an active internet connection kind of a thing.All of these users are connected to some of the machines.

Then, there'll be a lot of these machines.And, all of these would be distributed across the globe.

So that, people in certain geography,talk to the servers which are nearer to them, so as to have a lesser latency.

Let's just say, user1 is connectedto this WebSocket Handler 1 and it sends this message to WebSocket Handler 1 saying,

send this message m1 to user U2.Now, this WebSocket Handler does 2 - 3 things when this happens.

It talks to something called a WebSocket Manager.WebSocket Manager is a repository of the fact that, which device is connected to what all users.

Because these are probably thousands of devices,we need to keep that information at some central place,

which is this WebSocket Manager Service.It sits on top of a Redis, which stores two information mainly.

First of all, it stores that user1 is connected to WebSocket Handler 1and WebSocket Handler 1 is connected to user1, user10, user20, something of that sort.

So, a list of user ids that a particular machine is connected to,that information gets stored in Redis.

Let's say, a connection breaks between a user and a machine.And now, the user is connected to a different machine.

So, that information is updated through this WebSocket Manager, into this Redis.The second thing that WebSocket Handler 1 does is - talk to something called Message Service.

Message Service is basically the repository of all the messages in the system.It will have APIs to get a message by message id, get the message by user ids and various filters.

So, if you want to fetch all the unread messagesby a particular user and all of that, that would be powered by this Message Service.

It sits on top of a Cassandra database.Why Cassandra? Because, again we have these billions of users,

who will send many many billions of messages so,Cassandra is a fairly good data store to store that kind of a volume.

Plus, the query pattern that we have fairly aligns with the query pattern that Cassandra is good at.So that's the reason we choose a Cassandra here.

There are two kinds of message services that we can build.Basically there are two kind of messaging platforms that we have.

One is something like a Facebook, which stores all of your messages. So,in that case everything would be stored in a Cassandra permanently.

And, then there is something like a WhatsApp,which stores the messages only till the time it is not delivered to the user.

Once it gets a delivery acknowledgement, then it deletes the message.So, if we want to build a WhatsApp kind of system, we could delete the message from here also.

Deletes are a bit inefficient in Cassandra so, if we were tobuild that kind of a system, we might choose some other data store as well.

But for now, Cassandra would work fairly fine.Coming back to.. we were at WebSocket Handler 1,

which got this message saying U1 wants to send to U2, a message m1.Talk to both of these services and it would happen parallelly so, it can happen in any order.

Message Service would save the message into Cassandra and give the message id.Let's say message id is m1.

WebSocket Manager will now tell WebSocket Handler 1,saying, user U2 is connected to this WebSocket Handler 2.

Now, do whatever you want to do.Now, this guy, WebSocket Handler 1

will talk to WebSocket Handler 2 saying that I have got a message for U2.I believe that guy's connected to you. Go send them that message.

Now, there are 2 - 3 possibilities.WebSocket Handler 2 could actually be connected to that user still and he will send the message.

Or it could not be connected. It will say that I am not connected to the user. Theperson has probably gone offline.

So, he will not do anything and the flow ends there.Let's say, the WebSocket Handler 2 sends this message to U2.

Now there are 2 - 3 things that can happen.Maybe the user is not using the app actively but the message got delivered.

So, this device will send a message to WebSocket Handler 2,saying that I have received the message.

Or the second option could be - the person is actually open on the chatof this user U1 and could see the message then and there.

So, that device would send a message saying, I have received and seen the message m1.Now, this guy, WebSocket Handler 2 again queries WebSocket Manager,

saying that this message was now either delivered or read.I need to inform user U1 so tell me which machine is talking to user U1.

It will get this particular machine's IP, saying this guy is now handlinguser U1 and it will send this message to WebSocket Handler 1,

saying this particular message id m1, has now been read or received, whateverand go inform the user and this will be informed to the user.

How are these connections happening?These are WebSocket connections, which is basically a bi-directional connection.

So, there's no client and server here.Any party can send a message. So, that's how even server is able to send a message to the client.

These are built on top of TCP.In this whole process, we queried WebSocket Manager a lot of times.

User U1 calling for U2, U2 calling for U1 and all of that.Now, at the same time, if the user sends multiple messages, again, we'll try to do that.

Let's try to cache this information somewhere.Each machine will cache 2 kinds of things.

One it will cache is - the list of users that are connected to itself.So, if user U2 was also connected to the same machine,

it would have the data in memory. It would never have to call this manager.The other thing is - it would temporarily,

for a very short duration of time, maybe 10, 20, 30 seconds,cache the information about conversations that it has had recently.

So, if user U2 was connected to this handler H2,this guy (H1) will keep it in cache, saying user U2 is on this particular machine.

Because if U1 sends another message to this U2, it now need not call this WebSocket Manager.But, keep in mind, this second cache needs to

be stored with a very low time to live (TTL) and it should expire every 30 odd seconds.Because remember, these are global users.

Let's say, if somebody is connecting from Sri Lanka,you would probably get connected to a server in India.

That's a fairly large amount of distance and that communication might break in betweenand the person might get connected to a different machine, the next time.

So to, kind of, handle those things easily, we'll keep this cache at a very low TTL.There are another set of things.

Now, the receipts that we have sent to user U1 and user U2,all those receipts.. we need to decide whether we want to store them or not.

So if, let's say, we want to store the read receipts also,we can store that as a, probably, status in Cassandra, in the same table saying,

this particular message has a, to start with, status as sent.Then it will move to received. Then it will move to read.

We can decide.. you can decide that basedon your conversation with the interviewer, whether you want to store this information

or even whether you want to store the messages in the first place or not.All of those things are a conversation that you need to have with your interviewer.

But, you still need to store it, for at least some time.Let's just say that - user U1 sent a message to user U2 and then went offline.

Now, the receipts wouldn't go back.So at least, for a short duration of time, those read receipts need to be stored in the database

and whenever user U1 comes online, then he'll get that.Let's just say, user U1 wanted to send a message to user U3.

So, a second message.. user U1 is sending a messageto user U3, which is some message m2, with some text.

Now, what will happen is -again, it will store in, through Message Service,

it will call WebSocket Manager, to get who is the machine which is handling user U3.User U3 is offline. There is no machine that is talking to user U3.

So now, WebSocket Manager will return a response saying, I don't have a machine.That flow ends there.

This WebSocket Handler 1 does not inform anybody because there is no machine talking to user U3.So, the flow breaks there.

Now, when user U3 comes online, let's just say that, user U3 gets connected to thisWebSocket Handler H3.

What this WebSocket Handler does in the very first place is - to query Message Service and ask for -are there any messages for user U3 that are not in received or read status.

This Message Service will respond back and user U3 will see all those messages.Then, when, as those messages are being received and read,

those communications will flow back through the same flowlike we discussed earlier.

So, then, these machines will start talking to each other,for user U3 as well and those receipts, will go on to other users as well.

There is a potential race condition here.When user U1 was sending a message for user U3,

assume, at the exact same time user U3 came online.We said these are parallel calls, wherein a person is figuring out the machine

which is being used for user U3 and storing the message.Let's just say that, the very first thing that happened was - WebSocket

Manager returned that there is no machine that is talking to user U3.The next thing that happens was - user U3

comes online and queries Message Service, saying that get me all the messages.The third thing that happens is - it stores into WebSocket Manager that

this machine 3 is handling user U3.The fourth thing that happens is - this message gets stored into this Message Service.

Now, WebSocket Handler 3 thinks that - it has fetched all themessages for user U3 and displayed it on the device.

This WebSocket Handler 1 thinks that - user U3 isoffline and I have stored the messages and done my work.

But fundamentally, whatever this message m2 was, that has not been received by this guy (U3).Because, before that message was stored, this WebSocket Handler 3 retrieved all the messages.

These kind of race conditions could happen when you are doing parallel calls.There are multiple ways to handle it.

You can either do itsequentially but that will increase the latencies. So, I'll not recommend that.

What another solution you could possibly do is - this WebSocketHandler keeps pulling the server once in a while,

saying are there any messages that I still missed. So, all of those messages could be pulled.But, that would happen at a fairly low frequency and those could be bulk calls, something like -

are there any messages for user U1, U2, U3 to U100 which are in sent status,for all the active users that this machine is connected to.

And, if it finds any messages, it will send all of those messages as well.There are certain things that happen on the device itself.

Let's say user U1 was offline. And,you can still send message onto some user's chat, while you are offline.

So, let's say, U1 sent another message to somebody while it was offline.So, what would happen is - it will try to connect. Because internet is not there,

it will not be able to connect to any servers.In that scenario, what will happen.. even, in all other scenarios also..

all the messages would be stored in a local database which is persisted onto the device disk.Let's say, it's an android application.

It could use any kind of a android database likea SQLite or anything and store all those messages on the disk.

Now, whenever the device gets the internet connection,it will pull those messages from a queue kind of a thing or that database

and send those messages. So,this is how it would be able to handle scenarios where the device was offline.

Now, we have the next thing as group messages. How does that work?Group messages almost work in a very similar way.

Let's say, another scenario, U1 wanted to send a message to group g1, a message called m3.What would happen is - in case of groups, the behaviour is slightly different.

This WebSocket Handler wouldn't take care of fanning out to all the groups.This is a very lightweight service,

which just takes a message from a user and sends it to somebodyor gets a message from somebody and sends it to a user. It doesn't have a lot of logic.

For group messages, what it will do is - it will just send a message to Message Service,saying user U1 wants to send a message m3 to group g1, store it and do whatever you need to do.

So, this message service will insert that into Cassandra saying the message is stored.Along with that, what it will also do,

for all the group messages, it will put all of those messages into a Kafka topic sayingthere's a group message that I've got, which is this user U1, sending to group g1,

a message m3. Go send it out.From Kafka, there will be something called a Group Message Handler.

This is basically a Kafka consumer, which is listening on to the same topicand it is responsible for sending out all the group messages.

First of all, it does some validations that it needs to, assuming that's out of scope for us,saying whether U1 is even in the group to be able to send it to g1,

but assuming that's not a part of scope.It basically queries Group Service, to get all the users that are into group g1.

It gets a list of users, then it will remove the user U1 from that list.And now it has a list of the users that are supposed to get this message.

Now, it follows the exact same flow that was used for one -to- one messagesbut, for all of these users.

So, it basically calls WebSocket Managersaying, give me all the machines that these users are connected with.

It will get a response saying machine 1 is connected to user U3; U4; U5,machine 2 is connected to some other set of users and all of that.

Then it will send the messages to individual machines saying,to this user send this message, to this user send this message.

And then the receipts and all will follow the exact same flow that was handled earlier.The next thing - what happens when people are

uploading assets like images or videos or anything of that sort.The very first thing that happens when you are trying to upload

any content is that - there is some kind of a compression that happens.Now, in real WhatsApp, there is encryption also that happens right at device

and the encrypted messages are sent out.And when the messages are received, even the encrypted messages are

received and they're decrypted but we'll keep that out of scope.We'll just think of some compression there.

Let's say, U3 is sending a image to U2. So, what will happen is - U3 is sending to U2, some image.This is basically a two-step process.

The first step is - upload an image to a server and get an image idand then send that image id via the regular route to user U2. And then, U2 can fetch the image.

How the image upload works is - again, these arelightweight servers they wouldn't have any logic. So, very first thing is -

compression of the image, over here or video or anything. Then,it will talk to something called this Asset Service.

So, this U3 is talking to Asset Service through this Load Balancer. Again,all the authentication, authorization will happen at this layer and

Asset Service now gets the whole image or video or whatever.Asset Service will use Amazon S3 as a data store and it will store all the images there.

Now, based on which image is getting what kind ofhits on S3, it might decide to move some of the images on CDN

and it could also decide to replicate into multiple CDNs or some CDNs,from where it is getting traffic.

But assuming, it has uploaded the image on S3 and it sends a response saying,let's say, it is a image i1. It will come as a regular message to U2,

through this WebSocket Handler (H3).. these two WebSocket Handlers saying,send this message and the receipts will happen in the same way that we talked about earlier.

There could be one optimization that can happen.Let's say, there's a political event or a sports event

and a lot of people are sharing the same image for some reason.Do we need to upload the same image multiple times,

if five people are uploading the same image? Probably not!!So, before it even uploads to Asset Service, the first thing that the device will do is -

take a hash of those images and send the hash content to Asset Service.Basically, it's a way of asking - do you have this image already or not?

If you have it, then just send it to user U2.If you don't have it, then ask me and I'll upload it. Something of that sort.

Of course, when it's about hashing,there would be various problems like duplicate hash outputs and collisions and all of that.

So, instead of taking one hash, we could probably take five differenthash algorithms and use all of them to get five different hashes

and if all the five hashes are matching against an image,then we'll say that, an image is already there.

If it's not matching, then we'll say that, the image needs to be uploadedand it will follow the regular route that we talked about.

And if it is already there, then anyway it's there, it just sends a message.Now, let's look at remaining few components and how they help in the whole system.

So, this is the user app, which talks to all of these components. It could be a browser as well.The very first thing is - something called User Service. This is basically a

service, which owns the user profile information.It could be - their name, their user id,

their profile picture in case of WhatsApp and some user preferences. In case of Facebook, it will bea larger set of data. But all of that, whatever that data is,

it would be residing in a clustered MySQL, which runs the user database.All of those information would also be cached in Redis cluster,

very similar to the way we have implemented in other similar solutions.Against a key, we'll be having the user

profile information and a lot of other information as well.There's something called Group Service, which basically maintains all the group information.

It basically has information of - which group has what all users.Think of it as a many-to-many table, with a user id and a group id

and a time when user was added into the groupand maybe a status saying, whether the user is admin or something of that sort.

Again, this information would be stored in the MySQL cluster,which would be geographically distributed and it will have multiple slaves

through which the read queries will be run. It will also have a Redis sitting on top of it. So,all the APIs like, let's say, get users in a group

and something of that sort,would be powered by this Redis cluster and those APIs would be sitting within the Group Service.

Each time, either User Service or Group Service, queries Redis and it does not find the data,is when they actually query one of the salves

of these databases, fetch the information, put it into the Redis and respond back towhoever is calling them.

And then, group service was used in the group messaging workflow, that we looked at earlier.Each action that a user is taking on their app, gives us a lot of information.

For example, if a person is visiting some user's profile a lot of times,that tells us that the person is interested in this user.

It could be used for some kind of Analytics.Let's say, if a particular person is talking a lot about sports,

that does tell us that the person is a sports enthusiast.How could we do that?

All events that are happening,either they are events within the app or they are messages or anything of that sort,

would be sent either to this Analytics Service and then to Kafka,or directly to Kafka, in case of messages.

There could be a Spark Streaming Consumer running on top of this,which could do a lot of inferences.

First of all, it could do some message classification into some tags,like a message is a sports kind of a message or a general message or a

politics kind of a message and then try to classify users basis that. So,that is one kind of analytics.

Another thing could be, just simply,some information about what are people talking about, in general.

This is not possible if the messages are end to end encrypted.But if that's not the case, then we should be easily able to infer all of that.

There are two parts.One is - doing some logic, based on some streaming content.

That could be done by a simple Spark Streaming Consumer.And, that consumer would also put that data into Hadoop.

And then, you can run a lot of analytics queries, based on Hadoop.Something like, which are the people who talk about sports a lot or which

are the people who just talk about a particular kind of political party oranything of that sort. Those kind of analytics could be run out of that Hadoop cluster.

These events are also having one more usage.Each time a person does an activity on the app,

those events are listened by something called Last Seen Service.This Last Seen Service is basically, the service used to store the last seen time of a user.

This service.. I made it to sit on top of a Cassandra database,which has a column called user_id and a column called last_seen_time.

This could also alternatively sit on top of a Redis, if you have finite amount of data.But along with last seen time, if you want to store certain other information,

then Redis might have memory issues.So, in that scenario, you can use a Cassandra.

You might have a doubt that - when we use MySQL for user information,why don't we use a MySQL here? The reason is -

let's say, a user is on the app.Every five seconds, the app will send a notification that the user is live.

So, every five seconds, for each user, this will have ainsert into the database. What that means is - this is having an extremely high throughput

and MySQL might not be able to support that because these are all the writes,which will go into the master node of MySQL.

But, if it's a Cassandra, it could be spread out easily across a lot of users.Redis might also have those update problem because

for all the users, you are doing a lot of inserts. So, Redis might not be able to scale.But, if it's a Cassandra, it should easily be able to scale to any amount of traffic,

any amount of users and those things coming at any frequency.One more thing - There are two kinds of events that are spawned.

One are the events that are spawned by the app and one are the events that are spawned by the users.Example of events spawn by app could be - as soon as you turn the internet on,

the app would make a WebSocket connectionand pull in some requests. That is not a user activity. So,

that would not be captured as a, you know, activity of a user in the Last Seen Service.But, as soon as the person opens the app or closes the app

or does anything within the context of an app,those are actually the events that Last Seen Service would be looking at.

In general, all the services that we looked at, we are looking at here,in the other previous section, all of those are, as usual, horizontally scalable.

So, when your number of users or anything increases,you just add more number of nodes and that should be able to handle itself.

Other than that, you will obviously need to do a lot of monitoring,alerting - basically to ensure that you are able to get to your NFRs of

no lag, low latency and high availability.So, some of the important things that you want to,

kind of, keep a track of from a monitoring perspective is -the CPU memory utilization of your services, your disk utilization in the databases,

your throughputs and latency onto your web servicesand the disk utilization in your Kafka and more importantly the lag in Kafka.

Let's say, if your lag increases, you need to add more number of consumers.So, all of those metrics you can capture, store it into a

Grafana kind of a store and plot some graphs out of it.And also, you can build some alerting out of it. In case

your numbers go beyond a certain threshold, you can send out alerts.Those alerts could be used to make some decisions.

For example, if your throughput is increasing significantly,you could add more machines into a particular service

and in fact those things could be automated as well.So, if you're using AWS kind of a thing, you might write a script which

looks at your throughput and it adds more nodes or removes certain nodes.All of those things are very important when it comes to

a chat application because one of your very critical NFR is that it needs to be actuallyreal time. If it's not real time, then it will give a very

bad experience and then people will kind of drop out of your platform.
 ^n0uZxXyV

SDFC (Approach) ^6HV6XxZi

kafka is pull based while redis pub-sub is push based ^kD4jp7Hd

Notification Serive

code karle approach

 ^h2Q3VR8v

Let's design a notification service that is scalable enough.This is never a stand alone system but this is always embedded in some

other system design. Even I have used it in a lot of othersystem designs videos that I have made. Let's say if you are building a

e-commerce application or a booking system or anything of that sort.You'll always have a notification service which will be used to notify your consumers.

Let's look at how can we build a notification service.Now let's look at some Functional (FRs) and Non Functional Requirements (NFRs)

that this platform should support.The very obvious first thing is that it should be able to send notifications.

The next thing is that it should be pluggable. Now what does pluggable mean?So let's say we want to support SMS and email as one form of notification. Now, tomorrow somebody

might want to say that I want to support in-app notifications as well.So it should be easy enough to add that. It can be further extended to a lot of kinds of notifications.

So, for example, you could have something like a WhatsApp notification or anything of that sort.So, extendability is something that should be taken care of.

The next thing is that it should be built as a SaaS product. Why SaaS? because the main idea isyou should know who's sending what number of notifications.

And it should be possible for you to rate limit.There are two use cases where you'll need that.

So rate limiting as a offering you'll need, if you are giving out to other companies as a product to use.But, even internally, you would need to do some kind of rate limiting.

Let's just say its being used by a company like Amazon.Now there are multiple business verticals.

If all of them send you notifications, then you'll end up getting hundreds of notifications in a day.So that's a very bad user experience.

So notification system should be able to overall put a rate limit across all the usersacross all the platforms saying a particular user should not get more than five notifications in a day.

There could be certain amount of classifications done.So there are two kinds of notifications.

One is a transactional notification saying you have made an order, this much amount of moneyhas been deducted from your account, something of that sort.

So transactional notifications are ok to get.But promotional notifications should always have a rate limit.

So if you're building for within your company, then you'll build a user level rate limiting.But if you're giving it out externally to other companies as a product, then you might want to put

a rate limiting saying how many requests can you make for this server.Or maybe make billing tiers and price them accordingly.

So basically this is something that you need to capture at least and then act upon.The next thing is prioritization. Again...

we'll support multiple priorities of messages.So the idea of priorities is that some messages are low priority and certain messages are high priority.

Let's say, if you are sending a one time password (OTP), thenthat's a very high priority message. Why? Because if the user wouldn't get that SMS or email or anything,

then they would not log into your platform and they'll not do the transaction that they wanted to do.But if it's a promotional message, it is okay if it's low priority and if it gets delayed, if it goes to the

user let's say half an hour late also, it doesn't really matter.So we'll have this prioritization, basis which you'll always process the high priority messages first

and then the low priority messages.Coming to the non functional requirements (NFRs). This platform should always be available. Why?

Because, if you are planning to build it as a  SaaS product which can be usedby other companies, then down time would really cost us a lot.

Plus, it should be built in a way that it's easy enough to add more clients.And whenever we want, we should be able to attribute saying

how many clients have made us how many number of requests.Now, let's look at the overall architecture of the whole system. Just a disclaimer to start with,

if you are building it for a small enough use case like let's just say if you want to send out someemail notifications to some customers, given some criteria,

you can build all of this as one deployable service and put all the logic in one place.But if you truly want to build it as a SaaS product wherein enormous number of clients would be

using it for a lot of notifications, then this kind of a system would probably be worth it.Let's just look at the starting point.

The starting point of the whole system is then a couple of clients i.e. Client 1, Client 2,could be any number of clients, who want to send out a notification.

Now, there are 2-3 kinds of requests that they can send you. But all of those requests would comeinto something called as a Notification service, which is an interface for us to talk to the other

teams in the company, other companies or anything that we want.There are two kinds of request mainly. One is where they tell you that I want to send this

particular content to this particular user, let's say a email id kind of a thing, as an e-mail.This is one of the requests. Other request could be saying, I have this user id and send them

this notification.And you decide how do you want to send, whether as an email or as a SMS or whatever?

Normally the first kind of a model would be used by other companies where they want to decide thatthey need to send as SMS or email or whatever. The second model would generally be used when you

are building this to be consumed within your own company.But normally as a SaaS product, its good to have both the interfaces. The idea

of notification service is, for most kind of requests,it will just take the request, put it into Kafka and respond back to the client saying, I have taken

the request and I will send the notification in a couple of seconds at max.You could make this transaction as a synchronous flow but that will take a bit more time

and that will keep the client blocked.So, it's probably best to take the request and dump it into a Kafka and move on.

But let's just say if for a very critical scenario, you need it to be a synchronous flow.You can basically make the whole process synchronous through API calls.

But assuming its a Kafka for now, let's look at what happens next.This Notification service would just do a very basic set of validations saying that email id should not be

null or user id should not be null, content should not be null, something of that sort.There might be a lot of other validations, given certain kinds of events that you want to do.

All of those validationswould happen in this component which is called Notification Validater and Prioritizer.

It does a couple of things. Validations is one part of it.The main thing that it does, it decides the priority for a message.

So based on some attribute within the message, let's say, we''ll keep a message type identifier kindof a thing in a request and based on that, it will decide the priority of a message.

Normally, OTP is something which will be high priority because if the user can't login into thesystem, they can't place an order and things like that.

The second most high priority thing would be a transactional messagesaying your order has been placed, it will be delivered by so and so time.

The third, least priority one would would a promotional messagewherein you are sending out offers and coupons and stuff like that.

So, it decides the priority and puts the event into a Kafka topic, specific for each priority.So there'll be a topic for high priority messages, there'll be a different topic for medium priority,

there'll be a different topic for low priority.And while consuming, the consumers will first consume the high priority messages

and then the medium and low priority.The idea is - we don't want any lag in the high priority messages, but we should be at times okay if

there's a spike on low priority message and if it takes time, that's okay.Now comes something called as a Rate Limiter. These two components can be interchanged

depending upon the conversation with your interviewer. But I'm keeping Rate Limiterbefore it because the next component is a slightly heavier component.

Rate Limiter does two kinds of rate limiting. 1) It checks that the client who's calling me,is that client allowed to call me these many number of times. That is the first thing.

2) The user whom I'm sending this notification,am I supposed to send this notification to this user these many number of times.

Let's go into detail.So there could be a subscription that we have with a certain client

that they can call us maybe 10 times in a second.All of those kind of rate limiting, would be one kind of rate limiting.

The other thing is there could be a configuration saying I cannot send more than threepromotional messages to a particular user in a day. That would be another kind of rate limiting.

Both these rate limiting would be implemented in a very similar way.Saying there would be a key.

It could be a client id, user id, anything.And whenever you get a request, you basically increment that key into this Redis for a certain timestamp.

Or maybe the timestamp need not be a exact timestamp,it could be day, it could be second,

it could be at a minute level or any level.The moment you exceed that threshold is when you drop that request.

There's one more thing that it does, which is called request counting.Let's just say with some of the clients you have a pay for use kind of a subscription model,

saying they can call you any number of times, there is no rate limiting as suchbut as the number of calls increases, the amount of money we charge them also increases.

So they pay at a request basis.For those kind of clients, we'll implement it in a very similar way. Just that we will not restrict the

request. We'll keep incrementing the counter and then there can be reporting built on top of it.The next component is something called as a Notification Handler and User Preferences.

First let's look at what are user preferences. User might give us a preference sayingdon't send me SMS, send me emails instead.

Or a user could have said that I want to unsubscribe from all your promotional messages.So all of those would be handled by this User Preference Service.

It has two components that it talks to. One is a Preferences DB, which is a single source oftruth for all the user preferences that we have in our system.

This would be mainly used when we are building it for our own use.Let's say Amazon is building this notification system for their own use.

This will normally not be used when you're integrating with third parties.Third parties would handle this piece on their end. The second thing it will talk to is a User service

which is basically - let's say you got a request saying to this user id 123, sendthis particular text.

What is that user 123? It's something that you can search from user serviceto get the email id or phone number or anything of that sort, given a user id.

This basically could handle one more kind of rate limiting. A user might say that don't send memore than three promotional messages in a week or one promotional message in a week.

So, if that kind of a rate limiting also exists and want to support that,then this whole Rate Limiting module would come after this Notification Handler.

But, because this is a very light weight thing and this calls a DB, calls an external service,that's the reason I have kept it after the Rate Limiter.

But based on your conversation with your interviewer, you could swap either of these.Once we have all of this finalized, we basically have a full fledged system

that we can actually use to notify.We have a phone number,

we know that we'll send it as an SMS and we have the content or we have the email id,we know we'll send it as an e-mail and we have the content.

All of that is put into another Kafka for basically sending it out.Why do we need so many Kafkas?

Because let's just say we had a lot of SMSes and this SMS service is not able to handle it.One way is to increase the number of consumers.

But if there are certain spikes in certain clients, it's probably not worth to add a hardware for allthe time for that.

So we might as well put into Kafka and this SMS Handler could handle things at its own pace.There are multiple handlers that sit on top of this Kafka. You could decide to build

all of these as one deployable unit, but again, with the SaaS (Software as a Service) thing in mind,I'll rather keep that as a separate service in each of them.

So there are multiple handlers. Let's take a couple of examples.So all the SMS requests that will come into this Kafka would be handled by this SMS Handler.

Plus, there could be different topics for each of these.So email could have one topic, SMS could have one topic and stuff like that.

Now SMS Handler might integrate with multiple vendors for sending SMSes.Let's say you are a global company. You have one vendor that deals with SMSes in Asia,

another vendor that deals with SMSes in USA , another vendor for Europe, stuff like that.So you could have multiple vendors that you are integrated with and all the SMS vendor integration

could be done through this SMS Handler.Now, let's say if you have... if you are in India and you have 5 vendors that work in India.

So what request should go to which vendor?What is the priority?

How do we distribute request amongst them?That piece could also be handled within this own handler. Same thing, you have for emails.

You have a Email Handler. And by the way, this communication with the handler and vendorcould be a sync call.

Moving back to Email Handler. Email Handler takes all the e-mail requests and calls the email vendorwhich will send out the real emails.

This email vendor could be a simple SMTP server that you have at your end.Then you will have In-App Handler, which basically handles all the in-app notifications that you want to

send out or a push notification, kind of a thing.You can use a Firebase for Android and probably use a Apple push notification service for

sending out such notifications on iOS platform.You could also have a IVRS Handler. A classic example would be, I don't know,

either Amazon or Flipkart, one of them.When you place a very high value cash on delivery (CoD) order, they actually send you an IVRS call,

saying that we have got this order from you, do you, are you really sure you have kept this as a cash ondelivery order and you can press 1 or 2 to kind of confirm or reject.

So all of those things could be handled by the IVRS Handler.This is a very low throughput scenario and it would happen once in a while when compared to SMS

or emails or anything of that sort.You can again scale these independently based on the kind of traffic you have.

Now coming to pluggability.Let's say somebody comes and says that you need to add WhatsApp aslo as a notification mechanism.

So basically you just need to add a WhatsApp Handler and basically introduce a type calledWhatsApp Messaging at this layer and all of that can flow through all the way. This Kafka...

this basically Notification Handler will have a new topic for WhatsApp messages and aWhatsApp Handler will basically take care of sending those notifications out.

So that's how you can make it fairly pluggable.Now coming to what this Notification Tracker is? You always need to keep a track of what all

notifications you have sent. In case somebody sues you or there is someauditing required, you need to know what all communication you have sent out.

So for all of that, you have a Notification Tracker which puts all the notifications that you havesent out on its own Cassandra. This is normally a write only thing, which would be read

once in a while when there's an audit or something of that sort.Depending upon your traffic and the throughput, you could decide to club some of these components.

So for example, you can decide to club all of these components as a single deployable service.You could also club both these components into a single deployable service and

you can move the Prioritizer right there andmake lesser number of components and try to club all of this as one service as well

if it's a very low throughput thing.You can decide it based on your conversation with your interviewer on how do you want to do that?

Now, let's do something different.What if you want to send bulk notifications?

What if you want to do something like - for all the users who have ordered a TV in last 24 hours,send them a notification like installation service or anything of that sort.

Or for all the users who had ordered milk 3 days back, send them a notification thatwhether do you want to order the same thing again or not?

So all of those things come under something called as a bulk notification.Now, how do you want to do that?

So the very first thing is there would be a UI kind of a thing, which is represented as Bulk Notification UI,which will talk to something called as a Bulk Notification service, which takes

a filter criteria and a notification and sends it out.Filter criteria would be something like find all the users who have placed a milk order,

anything in last three days and send them a notification with certain text.How does that work?

So there's something called as this User Transaction Data.This basically abstracts out a lot of services which are outside the scope of this notification service

but real business functional services.For example, again, taking the example of Amazon, let's say, there are a couple of services that handle

their e-commerce orders.There are a couple of services that handle their pantry orders. All of those services would be

putting their transactional information - that your order has been placed, it has been delivered,it has been canceled - all of those kind of attributes into various Kafka topics.

What we could do is basically build a search functionality on top of those topics.Normally, in most companies, you do have those kind of products already built.

But assuming you don't have that, let's try to build that.And if we have that, we can just leverage it. What will happen is - this will put information

into a lot of Kafkas, lot of topics. I am abstracting it  out as this one Kafka.All of those information would be listened by something called as a Transaction Data Parser.

Now, this Transaction Data Parser basically... first of all, parses all of that information.Now, because you have multiple clients

and multiple services who are sending data, they could be putting in multiple formats of json or XML.So, for example, pantry (Amazon) could have a separate signature and regular e-commerce

could have a separate signature.This data parser basically takes all of those messages, puts it in a format or converts it

in a format that it understands and then it puts it into its own data store.It could be Elasticsearch or a MongoDB kind of a structure where you could do

complicated aggregations and nested queries.On top of this data store, there's something called as a Query Engine. That Query Engine basically

takes a query, which could be like an aggregation plus a filter kind of a thing,saying, find out all the users who are in Bangalore let's say, who have ordered some food item

in the last few days, or find all the people who are having some items in their cart but have notplaced the order or any kind of a filter criteria that you want to build that would be powered by this

Query Engine. It would have its own DSL (Domain Specific Language), which would be a format -how do you kind of structure your query and that would be a signature that it exposes.

Now, this Query Engine would query that thing on this data store.So it also understands the schema of this data store and it basically would return us a list of users

that match that criteria.Now this Bulk Notification service has a list of users that it has got from Query Engine,

it has a message that it got from this UI, it basically call this Notification service saying sendthis notification to all of these users and these users, it would get from this Query Engine.

This Query Engine is not something which would just be used by this Notification service.It could be used by a lot of services.

You could have a very simple Rule Engine which possibly says that if a user has cancelled 10consecutive orders in last 3 days, go deactivate their account.

They are probably, you know, just doing fraud.Or, there could be a simple Fraud Engine running

which has some criteria and takes some action basis that.All these condition and action kind of a thing, wherever you have a condition running

and action happening, all of those could be, you know, powered by this kind of a thing.In fact, your Notification service itself is that kind of a thing.

So you have a filter criteria as your condition and action is basically the notification sending process.So this could also be a part of your Rule Engine.

Something like 5 days after an order has been delivered, send a mail to consumersfor giving a product review. So something of that sort.

And this could then also be used  to build a Search platform altogether.But overall, this is something that and if this is something that is already built in the company,

you could just leverage that andhave this Bulk Notification service talk to the querying platform of that whole platform.


 ^URXxK9yl

FR

send notification
saas product can be used by other services
pluggable / extensible to support other 
notification methods as well

support prioritization of messages

rate limit on promotional messages sent to user ^dQRmeEzB

NFR

Highly available
Support many clients
 ^p5KYGBRm

Cab Booking system (Uber, Lyft, Ola)

Code karle approach ^yXalUWY5

design a cab booking system, something like an Uber or OLA or Lyft.Let's start with the functional and non functional requirements that we want this system to support.

So, very first thing is - as a customer, when you open your app, you should be able to see what cabs are around you.So, that is the See Cab feature in your vicinity.

The next thing is - if you want to book a cab from one place, point A to point B let's say, you need to know how much time it will take to travelfrom point A to point B. And, you should be able to get an approximate price of how much would it cost you to book a cab via this platform.

The next thing is - you should obviously be able to book a cab.We'll not get into the varieties of.. types of cab like go, premium and all of that. We'll just assume that there is one type of cab.

You can add more features, simply! That's not a big trouble.The next thing is - there should be a very good location tracking of what driver was at what place at what point in time, for various reasons.

From a non-functional standpoint, this platform should be global and it should be accessible to people of all countries.At least, we'll design it in that way.

What that means is - you need to have servers in a lot of geographies so as to make sure that people in a certain geographyare accessing the servers near to them and thereby reducing the latency.

Next obvious thing - it needs to work at a fairly low latency.Though this is not very, very mission critical, but it still needs to be, you know, reasonably fast.

Availability should be very high.This system should not go down. It will cause a lot of problems to people who are stuck somewhere, if the system is down.

And at the same time, it should have high consistency.High Availability - High Consistency, might seem to you that it is trying to violate the CAP theorem, which basically says that -

assuming all the systems in the world are distributed nowadays, so out of availability and consistent, you can just get one.The idea is - certain components of this need to be very highly available and certain other components need to be very highly consistent,

not both at the same time.From a scale standpoint, this system should scale to a very good number.

If I look at just some of the statistics of Uber, there are roughly 100 million active users that use Uber on a monthly basis. These are unique users.And Uber, in general, does roughly 14 million rides per day.

So with that thought in mind, let's try to look at a system that can scale up to these numbers, with these criterion.Now, the main problem that companies like Uber are trying to solve is - when you have a customer's location, who wants to book a cab,

you try to find out some few drivers who are very near to this location and then using some logic,try to come up with the best driver who is suited to do this trip for this customer.

So the problem then becomes, how do you find these 2 - 3 closest drivers to this customer?There are multiple ways to do that. We'll go over one of the ways which uses a concept called segment and mapping segments, basically.

Now, this is a term that I just made up. It's not an industry standard term. So, just keep that in mind.Now let's just say, you have a city, something like this.

The idea is you basically divide it into rectangular segments.So, you kind of divide this city into multiple pieces.

And you say that - this is probably your segment id 1.This is your segment id 2, something of that sort.

Now, the idea is - you are dividing a city.It'll normally be divided into a lot more segments than what you can see here.

Now, the idea is - given certain coordinates of the segment boundary and given certain coordinates of a cab,you should be able to figure out which segment does a cab belong in.

Now, the problem looks trivial, and it is not difficult also.So, think of it like a standard coordinate system.

This is point (0,0). This is (0,1). This is (1,0). This is (1,1).Somewhere here.

Now, if a point lies somewhere in between here, let's say (0.4, 0.5),you should be able to mathematically say that this point lies within this boundary.

A very similar logic we'll try to use when we try to assign a particular segment to a cab.Also, keep in mind that cabs continuously moving and their locations are continuously changing.

So, we'll try to make sure that we get continuous pings from all the cabs and then keep a track of which segment do they belong in.A cab could be here right now. Could be in this particular segment. And the cab driver is going via a road, over here. Now, this changes the segment.

And this information would be calculated at runtime, as and when we are getting pings from the cab.So, we'll have something called a Maps Service.

This Maps Service will do a couple of things.The very first thing is that - it will be responsible for dividing the city into these segments and taking care of the segments.

The other thing it will also do is - given a lat long of a cab and given a lat long of a customer,tell which segment do these users belong to at this point in time.

This service will also be used to calculate ETA from point A to point B and the route from point A to point B and thus even the distance.But, we'll abstract out. We'll not go into much detail on how that ETA and distance piece is implemented.

Think of it for now as if we'll be using a Google Maps Service and we'll go over the details of implementation of thatwhen we do another system design video on implementing Google Maps.

With that being said, there is also one more thing that this service does.So let's just say, there is a huge amount of traffic or huge amount of cab drivers in this particular segment. And it is getting unmanageable.

So the idea of segment is - it should be a small set of drivers that are in the segment.So this service will take care of dividing this segment into multiple parts. It could do it into 4 parts. It could divide it into 6 parts.

That logic resides within Maps Service.Let's just say, there is very less traffic in some other locality.

So, it could also decide to merge a couple of segments into one segment and say, this whole thing is now one segment.So all the segment management remains within this service.

Now, let's look at the overall architecture and how individual users and drivers get connected to the system.All the users get connected through this User App, which talks to a Load Balancer, which talks to something called as a User Service.

This User Service is your repository of all the user information.Plus, it is also a proxy, that will connect to other services to get any information that a user wants.

So, for example, if a user wants to see their profile, update their profile, all the APIs to do that are powered by User Service.If somebody wants to fetch user information, any other service for example, then all the APIs for that are powered by this service.

Let's say, if a user wants to see their trips, then this User Service will talk to Trip Service, fetch all the trips for that user and send it back to the user.So that's the responsibility of User Service.

From a database standpoint, it sits on top of a MySQL cluster, which stores all the user information within that.And it also uses a Redis for caching the same information.

So let's say, a GET API to get a user's information is called, it first queries the Redis. If it has information, it returns from there. If it doesn't haveinformation, then it queries a MySQL slave, fetches that information, stores it in Redis and then returns back to whoever was calling.

The next flow that the user calls is basically when they try to book a cab.The whole screen that the customer, kind of, goes through when they are trying to book a cab is powered by this Cab Request Service.

Essentially what it does is -it basically makes a WebSocket connection with the User's App, which displays them a few cabs onto their UI  which are around them.

Also, it places a request with something called a Cab Finder. We'll go over this in the next section. Whenever Cab Finder responds back with a cab,this Cab Request Service talks to the User App, basically sends them a response, through this WebSocket connection,

saying that the cab is booked and these are the details and whatever is required.This is approximately the major user flows.

Now quickly, let's look at the driver flows.A driver basically talks via the Driver App.

Again, there is a very similar Driver Service, exactly similar to the User Service.But for drivers, again, all the APIs for getting, updating all the driver information is powered via this.

If a driver wants to see their payment information for example, their payment history, this Driver Service will expose an APIwhich the Driver App will call and Driver Service will internally call a Payment Service to get that information and respond back.

It could call Trip Service to get the trips of all the drivers. And, all the UI data gets powered by this service.This service sits on top of another MySQL which has all the driver information.

And it uses Redis for caching in exactly the same way the User Service does.This Driver App also talks to something called as a Location Service through a series of servers,

again maintaining a WebSocket connection with these servers.And, as and when a driver is moving through the city, every 5 seconds or 10 seconds, their location is being sent out to this Location Service,

which then queries the Map Service that we talked about earlier, to find out which segment does the driver belong to.And when the customer places this cab request, customer's segment is calculated, driver segments are calculated

and they are mixed and matched by the Cab Finder and a couple of other components to give the best suited driver for a particular trip.Now, let's look at how does a customer and driver come together.

All the active drivers in the system, who are online right now, ready for trips and all, are mentioned as D1, D2, D3.There'll be a lot more such drivers.

All those drivers.. each of them is connected to one of the servers through a WebSocket connection.And those servers are called out as WebSocket Handler 1, WebSocket Handler 2, WebSocket Handler 3.

Now, why do we need WebSocket here?So, we always need a connection between the driver and a service.. for a lot of reasons.

One of the very first things is that - a driver continuously sends location pings to the backend, telling about the location.Now, if each time they start creating a new connection, that's a kind of a heavy operation. So, we'll have this connection live.

Also, at times, the servers might want to talk to driver. So, let's say, if a trip is assigned to a driver, we need to inform the driver.So, we can reuse the same connection to talk to a driver and tell them that this is the trip information that you have to do right now.

For all of that, there are these WebSocket Handler servers.In the real world, there'll be hundreds of such servers, who are interfacing with all the drivers, which are throughout the world, geographically split.

Now, let's say, somebody in the system identifies that a trip is being given to a driver and to reach out to the driver,they first need to know that which out of these hundreds of WebSocket Handler servers, do I need to talk to.

For that, there is something called as a WebSocket Manager.Now, this WebSocket Manager is another distributed service which manages the fact that which server is connected to what all drivers.

So, let's say, D3 is a new driver that has come online right now and through the load balancer, it got connected to WebSocket Handler 3.So, this Handler will inform the Manager, saying I have now got connected to D3 also. So, if there's anything for D3, inform me.

And this Manager will store this in it's database.Now, let's say, this connection got broken and D3 is offline right now. Again this Handler will inform the  Manager that D3 is now offline.

Do not reach out to me for any communication of D3.This manager sits on top of a Redis cluster.

This Redis would not just be storing data in-memory, it will also be storing it in a persistent store on disk.And it will basically store 2 kinds of mapping.

One is saying that.. the most frequently used one, is that - which driver is connected to which host..which is saying something like D1 is connected to H1.

Similarly, there'll be an entry for each of the drivers in the system, saying which driver_id is connected to what host_id.It'll also have a reverse mapping, saying which host_id is connected to what all driver_id.

So, it could have a mapping saying H1 is connected to D1, D2, D3, so on and so forth. Because that mapping might be used for something.Coming to other things that this WebSocket is used for.

So these drivers/ devices send location pings to our backend, let's say, every 5 seconds.So, every 5 seconds, we get a hit about the location information.

All the location related information is managed by something called Location Service. It does a lot of things.One of the things that happens here is - it stores the information about the driver's location into it's Cassandra.

Why Cassandra?Because, again, there are like thousands probably or maybe even millions of drivers across the globe

who are sending their location updates every 5 seconds.So, there are a lot of updates happening. So, a Cassandra should be able to easily scale up to that number. That's the main reason.

There are 2 kinds of information that get stored here.One is - the live location of the driver, which is the last known location.

The other thing that is stored is - while a driver is doing a trip with a customer, we need to know exactly what was the route followed,for any auditing purpose or billing purpose.

Very common use case is - Once we know the points that the driver followed, we would be able to trace that out and then come upwith the real distance that the driver actually travelled and then use that to come up with the pricing.

So all of those things are basically responsibilities of Location Service.Location Service also talks to Map Service.

Remember, Map Service from the previous section. Map Service is a service that maintains the segments that we have createdthroughout the city and throughout the globe. So, Map Service maintains not just the segments, it also gives us the ETA, which will be the

time taken from point A to point B and the distance that will be followed and also the route that should be followed from point A to point B.Think of Map Service as an abstraction that we have. We'll not go into the details of implementation of Map Service right now.

I have made another video which is on the design of Google Maps, that goes into details of how Map Service is implemented.But, that being said, Location Service, as soon as it gets a ping from a driver,

it basically queries Map Service and tries to figure out that this lat long belongs to which segment.It then stores it into it's Redis, saying, this segment has these drivers.

This update happens only when a driver's segment changes. If he's in the same segment, then no change happens.This basically is used for a lot of purposes. So, let's say, we want to find out drivers in a vicinity,

we'll query this service saying who all are the drivers that are basically in S1.There is one more thing that Map Service does. It basically keeps a mapping of which all are the segments surrounding a particular segment.

Which, we'll come to in a while on how it is being used.There's something called as Trip Service. Trip Service is basically the source of truth for all the trip information.

It sits on top of a MySQL database and a Cassandra database.It uses MySQL for all the live information, basically information of all the trips that are either about to happen in some near future or are in progress.

Once the trip is completed, then it basically can move to Cassandra.Now, why don't we store all the information in MySQL? Because over time, this will become a very massive volume of data.

Plus, if it is just for read queries, Cassandra is also good enough. So, we don't really need to store it in MySQL.The main reason of storing it in MySQL is because trip would have a lot of information.

It would have information about the customers, about the divers, about potential start times; end times, about the potential distances,about the real values and maybe some events information that have come in between, maybe some payment information and a lot of other things.

Now, if you look at it in tables terms, these will be a lot of tables.And, for each event that comes in against a trip, we might need to update a lot of such tables.

And there, it is very good to have transactional properties.So, that's the reason we'll be using a MySQL for all the trips that will be updated.

And once the trip is completed, then we can move it to Cassandra.Now, this movement from MySQL to Cassandra is taken up by this Trip Archiver Service, which basically is a cron,

which spawns once in every probably 12 hours and pulls the data from MySQL and puts it into Cassandra.Coming back to Trip Service.. Trip Service will expose all the APIs around trips. So, if you want to get a trip by id or if you want to get all the trips

of a particular driver or all the trips of a user, all of those APIs would be powered by Trip Service.And let's say, if it's a search by a driver_id, it will query MySQL, it will query Cassandra, it will get the results from both of them, merge them

and then return it back to whoever was calling. So, that's how it's flow would be.Now, let's get to the main flow on what happens when a customer actually requests a cab.

The customer flow begins at this point where they basically make a request to Cab Request Service through againan open connection between both the parties, the Customer and this service.

And basically, what the customer says is - this is my source lat long. I need to go to a destination which is identified by certain lat long. Get me a cab.I'm assuming there is just one type of cab and no varieties and types of cab. If you want to implement, that is a straightforward thing to implement.

But given this request, Cab Request Service then queries something called as Cab Finder,which is responsible to come up with that one driver who will do the trip.

At the end of all of it, Cab Finder will respond back to Cab Request Service saying, this is your trip_id, this is your driver_id,go send it back to the customer.. in a nice form, with all the details about the driver and all of that. And Cab Service would send that.

Cab Finder will also put a notification into a Kafka, whether or not it was able to find a driver.Let's say, if it's not able to find a driver, may be because there is a scarcity of drivers, all of that would go into Kafka,

which can be used for further Analytics like for example, telling drivers that this is a location where there are more customers and less driversso why don't you go into that location to get more trips or something of that sort.

Coming to what Cab Finder does.The very first thing Cab Finder would do is basically - it has a source lat long, which is basically identifier of a particular location of a customer.

It will first of all query Location Service saying, get me the segment in which this customer currently is.Along with that, also give me a list of drivers that are near this customer.

What it does is - it first of all queries Map Service with the lat long of the customer, to get the segment which the customer is in.It then queries surrounding segments. So, I'll try to explain why do we need surrounding segments.

So, let's say, there is a rectangle like this and customer was sitting here.There were a couple of drivers in various locations in this segment. There could possibly be a driver just here.

But, if we query all the drivers within this segment, then we'll get a driver who is far away.But, a driver is just next to customer, maybe in another segment.

So, for doing that, we basically.. let's say if it is segment S1, we need to find all the segments that aresurrounding S1 and get the closest 10 drivers, let's say, in all of those segments.

So, let's say, there could be a couple of segments over here and maybe you can have something like this. This is S2, S3, S4, something of that sort.So, we'll query all of these segments. Basically, we'll not query, we'll just off load that job to Map Service saying, get me all the segments

that are surrounding this segment S1, that Location Service gets. Then, Location Service basically figures out all the driversand then tells Map Service to get the closest 10 drivers to this customer, out of a list of those drivers.

Distance between the customer and the driver is also something Map Service is good at.Remember, it is able to find and identify the distance between two points.

So, it can identify the distance between two customers and drivers, taking into account the road distance, not the aerial distance.Let's say, it got some 5 - 10 drivers which are close by to the customer. Location Service will return it to Cab Finder.

Now basically, we need to identify 1 driver out of these 10 who will do the trip.Now, there comes something called modes. There could be multiple modes in which this cab request could be served.

We could say that for certain kind of customers, just pick the best driver.Let's say, if it's a premium customer, then we just pick the best driver out of the lot and assign that.

Or, if it's an average customer, we might want to do some different thing.We might want to broadcast to all the drivers and whoever accepts first, we can assign that driver to the trip.

So, all of these modes are basically something that Cab Finder decides that which mode I want to run it in.Given whatever mode it is, it might need some additional inputs.

So, if it's the best driver mode, then it might need to stack rank all the drivers.So, all of these are basically something that is handled by Driver Priority Engine. We'll get to the logic, what it follows, later on.

Cab Finder then queries Driver Priority Engine saying, I have these drivers for this kind of a customer, you just arrange them and give me back.Then it gets a list of those drivers. And given the mode and given the list, it then tries to identify one of the drivers who will actually do that trip.

It then queries WebSocket Manager and asks WebSocket Manager saying,which was the host that was actually, you know, integrating with this particular driver. It will then call WebSocket Handler.

Let's say it chose D1, it will then call this Handler 1 saying, D1 you have a trip, go do it.The same notification would be sent via Cab Request Service to Customer saying, Customer, you have got a new driver, which is driver D1.

And then the regular flow follows wherein the driver starts moving to the customer's location.So, this is how we'll figure out, how to assign a driver to a customer.

Once a driver is assigned, basically, what it means is, a trip has to be created and updated.So, this will then basically update the Trip Service saying, I've created a trip with this customer, with this particular start point, this end point,

this driver and whatever information it needs to. And, that gets persisted into this MySQL via this Trip Service.So, this is basically the booking flow.

As part of the booking flow, we had inserted a lot of events.Whether Cab Finder was able to find a ride for the customer or not. And even the Location Service was putting in a lot of events into Kafka.

Now, let's try to look at how do we use those events.This Kafka is getting a lot of events like location update events, trip update events, no driver found events, a lot of things.

Let's look at some of the use cases where we can utilize those events to our benefit.One of the very common thing is - whenever a trip is completed, we need to initiate a payment to the driver.

That could be aggregated over a few hours or a few days or something of that sort. But, we still need to store information about a potential payment.There would be a Payment Service, which sits on top of this Kafka, which would have a Kafka consumer, which listens to all the

trip completion events. And as soon as a trip is completed, it would insert a record in it's Payment MySQL database, which says that -this particular driver, did this particular trip_id, for a user with user_id, and with lots of attributes like distance travelled, time taken and all of that.

And finally an amount of money that needs to be paid to this driver.If that needs to be an instantaneous payment, this Payment Service could talk to a Payment Gateway to deliver a payment.. like transact the money.

Or, if it needs to be aggregated, then it can basically run a cron which does the payment every once in a few days or something of that sort.If, let's say, a driver wants to see their payment history, there would be APIs that would be running out of this service,

which will give all the payment transaction information against a particular driver,which we talked about in the very first section that, could be powered through Driver service, talking to Payment Service.

Now, let's look at some other use cases.On top of this Kafka cluster, there would be a Spark Streaming Cluster in which some Spark streaming jobs would be running.

One of the very common things is to basically create a heat map.If, let's say, from a particular geography, we are getting a lot of events saying, there are no drivers found,

that means that, there is a surge of customers in that area and there are very few drivers.So, we can create a heat map within Driver App, powered by this Streaming, which kind of shows a particular segment or a few areas,

which are having this kind of a scarcity so drivers can move to locations to get more tips.This is a classic example of a Streaming kind of an application.

What it will also do is - it will basically put all the events into a Hadoop cluster, which can be used for further Analytics.On top of this Hadoop cluster, we could run a lot of ML jobs or regular Spark jobs, which will do a lot of things.

So, the very first thing is basically to do a customer classification into various categories.So, if a customer takes a trip with us every day, we'll classify them as a premium customer.

If it's a once in a while coming customer, then it would be just another customer for us.Same classification could be done for drivers.

So, there'll be these User Profiling and Driver Profiling jobs, which would ideally be a ML classification model running,which will classify those users as premium or regular, or drivers as premium drivers or regular drivers.

The same information would also be used to create an ML model, which can do the Driver Priority that we talked about in the previous section.So, based on certain attributes of drivers, for example, their ratings or the customer feedback or their ETA..

basically the accuracy of how much ETA was supposed to happen and how much ETA did actually the driver take.There could be a lot of attributes on which we stack rank the drivers.

All of those could be aggregated in these jobs and drivers could be given a score.And using those scores, drivers could be ranked by Driver Priority Engine. So, something of that sort could also be built.

Now, we could also power the same... I forgot to make this link.This same information could be used to generate a fraud score.

Let's say, if there is a very high correlation between a driver and a customer. Let's say, if all the location pings say thata customer and driver move together or if all the trips done by a driver are against a particular customer.

For most of them, we can safely say that this customer and driver are either friends or that's the same personusing two mobile phones to book a trip by this customer and do a trip and thereby, you know, using the..

there's something called as incentive programme run by these ubers and all the other companies.So, it's basically a way to exploit that kind of a programme. So, all those kind of frauds could be captured by these kind of models again.

The same data could be used as an input into Map Service.Let's say, if we don't have traffic information into maps. All these lat longs could basically power the traffic information of Map Service.

We can safely assume that - we'll not know the exact number of people traveling on the road,but, if some road has more of our cars, then we can safely assume that probably there is more traffic also there.

If we are at a Uber scale, we can safely assume that.So, that could be an input into Map Service or at least the traffic data and some of the road condition data also.

So, if the average speed of a driver on certain roads is very high, we can safely assume that that's a freeway or a highway or a good road.If the average speed is very low, we can assume that there is either high traffic or the road is not in good condition.

Or there is something wrong with the road.And also the same information could then be used to come up with a better, enhanced ETA Calculation Engine.

Exact details of it, we'll go over in the Google Maps video. So, I would recommend that you look at that.But this could be one of the use cases where we use all of these information.
 ^r6prEPDs

SDFC approach

 ^ufGBW57t

sdfc approach
 ^zDkyguCH

Proximity Service (Yelp)

FR

User: 
    Search for a place near to his lat, long
    (Give rating/review to a place)
Business:
    Onboard
    (Add photos)

 ^nhyVjvOz

NFR

high availability
scalable
high consistency for user view
each user should see same rating, review
 ^a6pdZcXL

Numbers

178M total users
60M dau
500M places

 ^VmKGddZY

nearby ^RiLVEWDw

store user information like user id, user phone number, gmail, etc.
store driver information like licence no, car details, name of driver, age, etc.
store trip information like trip id, from, to, driver_id, user_id, status, amount, invoice

store driver live location for some time. I'll not store data for more than a day.
 ^UGatZIbr

Understanding Polling: Polling means to continuously check the status or retrieve data from multiple sources at predefined intervals. 
Unlike event-driven approaches where systems respond only to specific triggers, polling actively queries devices or services to gather information.


Short Polling : Where we check for new message at regular interval and if there is not message we return null otherwise return message.
Long Polling : Where we check for new message at regular interval but we wait for sometime before return anything. Let's say I send a request to check
for message and wait for response for 3 seconds before returning Null. And if there is message i can directly return  ^hTNsy3Hl

Twitter

code karle approach

 ^5b4sAUQN

FR
tweet (text 140 character/images/short videos/gifs)
retweet
follow/unfollow
search
like ^6eR5Ye3N

NFR

read heavy platform
fast rendering
fast tweet
low latency
high available
some delay of post arriving in my timeline
is ok. Let say modi tweeted it's ok if i see it
5 sec later. but other delay like page load, tweet
delay is not ok
 ^OnBNEXo8

inactive is deleted accounts we don't delete account but soft delete
the users who didn't use twitter in last 30 days are moved to passive
live are who are using it right now
active means offline but used the app in last 30 days
famous is politician, actors or anyone with huge fan base ^ig80S1YH

so user has two timelines first his own and then his home in home he has posts from all 
following users while in his timelines all post made by him.

tweet service provides all apis to interact with tweet db. all get api by tweet id, user id,
etc.

timeline service also talks with graph service to get all following users.

fetching all following then getting tweets from them from cassandra is not efficient so we'll
cache this timeline

so there is a tweet processor which consumes tweet from kafka. so for this tweet made by
elon musk let me find his followers. Now for all the followers build their timeline and put
it into cache


now timeline service can direcly serve timeline for active users from redis. however if a
passive user comes after long time it still needs to create timeline using not so efficient
method. Also store it back to redis for future. ^kqbLdAvO

for live user we'll handle it differently as soon as a new tweet is pulled from kafka by tweet 
processor to create a time line it store in redis and also put the timeline back in kafka. so 
user don't have to pull the timeline from their end. the live web socket connection reads that 
their is a message for this live user and give them their new timeline.
 ^NDiP8EJX

the current reddis approach is still inefficient for famous users. let say a famous celebrity
tweets and has 240 million subscribers we need to make 240M timelines ^hYby7TSA

also use user service 
to get status ^6ZoHHB3q

let say when building a timeline instead of only storing tweets with active user. we'll also store in redis who all famous celebrity this user follows. So when this user refreshes his timeline. we can query only those famous users for their tweets.


also we won't be updating in redis for 240M user in case the post is coming from famous user. 

time line servie will merge the data from normal active user. Also it will get the list for all famous user this person is following get their tweet and merge both and render.

to get tweet of all famous user first timeline service query graph service to find all famous users this user if following then call tweet service for their tweet.  ^PuOHqWMS

now let say elon musk is following donald trump both are famous, the above thing we can use from them also. otherwise since tweet processor is building tweet for normal active user following normal active user. we can add one logic like if post is from 
famous user only update feed for famous user following. ^TZtcP6Gg

cassandra, reddis and kafka are under huge pressure here ^OGUrlkeD

one thing u can do with spark streaming is what is the most searched word in last 1 hour ^yc5cTbC5

why are we using a notification service here? twitter can run a weekly cron job which sees 
all post in last week and create a newsletter and send to passive user like this week you 
missed these stuff to bring them back on platform. ^UL97gfcl

simplified ^pci0oUNJ

clients put message in kafka through notification service. Then notification validator performs simple checks like content should not be null, etc. and priortize the notification and puts the message in kafka, in kafka there will be 
topic for high, medium, low priority message. The consumers will give more priority to high then medium then low. Then we have rate limiter it does 2 kinds of rate limiting first it checks the clients who have made the request is he 
\allowed to make this request and 2nd am i allowed to send this user the notification these many times. So we'll use redis counter to for client or user. and once we send this we increment the counter. There are also rules for rate 
limiting but not going deep in that. can have different rules like client can call 4 times in a sec. Or can send 10 notification to this user. Then notification handler and user prefernces service it checks the user prefernces db to 
check what is the preferred mode of user to be notified. Or the user has opt for subscription. it also talks to user service to get email, phone no., etc. for communication. Then we can add the message along with communication details 
into kafka there will be topic for sms consumers, email consumers, etc. Then email, sms, handlers can consume these messages and talk to vendor to send notification. We are tracking the notification we have send using notification 
tracking service and saving it into cassandra ^6UmRdEQs

Facebook or News Feed system

 ^etzdfeCq

time ^sAwfdGLn

lag means if a user posts something it is ok if it takes 5-10 seconds to arrive on
my timeline, but latency wise it should be fast, fast page loads, fast success message
on posts, etc. ^wlWxcC0S

for graph db instead of my sql we'll use a graph db. ^Nt3ck4O6

asset service add or removes static content from cdn based on how frequently it is accessed.
When a new post is made it is accessed frequently so we can put it into cdn when after some
time we see frequency of that post accessed is decreased so asset service can remove that 
content to make room for new posts. ^07B6UXLz

post indigestion service puts a new post into cassandra and into kafka
 ^AVN2jA4E

analytics service is one of the consumer of kafka, there is spark streaming 
cluster, where machine learning models find tags for the post, people in the
post, etc. Now after find this info, we are again putting it in kafka. This
process will take some time however in our NFR we said some lag is okay to 
render new post to friends timeline. Now this post along with tags is 
consumed by post processor service which talks to user and friends/group
service to get friends of the user who has made post. it creates a timeline
for friends of this user and put this timeline with user_id like u3: [post1, post2, ....]

 ^Wr6nolRw

the post processor creates time line with posts from normal active user and put that in redis.
if someone famous makes a post creating timeline for all their friends/follower is inefficient.
So time line service can get all posts for a user time from redis (contain normal active users
posts). Also it can ask group service to get friends of this user and figure who are famous. Then 
it asks post service for posts from these famous users. Timeline service then aggregate the posts
and returns to user.

For live user, post processor after creating the timeline can push it back into one of the kafka
topic, where using a live user service sends the timeline to live user via web socket. ^lkhJGUSO

we have archival service which puts old timeline from redis to cassandra. this make sure we are 
removing old timeline from redis to free memory ^kvYNncYL

like service store all likes/dislikes done on a post in cassandra. schema looks something like this
postid, userid, type like/dislike/heart . We are also storing this info in redis, redis stores the 
number of likes on a post. Also we put this info in kafka for tracking ^5pAHZoTY

sharing a post is nothing but another new post but with parent id of original post ^XVbBtdby

activity tracker will save all activities in cassandra. like userid, timestamp, activity (new post 
with postid/ liked post along with postid/ commented with post id and comment/ search with search string)
all of these will be stored. ^DOgYyA9b

search service is similar to twitter puts everything in elastic db where we can search ^uqtyeS92

trends is similar to twitter what words/topics are trending now we'll store in redis with ttl like 1 day 
because next day it might change

User profiling is nothing but seeing what user likes or posts user interacts with show more of these pages or 
user as recommendation or give these post more priority

Group weight is nothing but like say i'm friend with u1, u3, u4 however i'm liking more posts of u1 as well 
commenting on his. Thus u1 weight will be more and i'll see more of his posts as a result ^3OxzPo1r

always ask if it is a high level question or low level 
let say design youtube don't straing away jump in design
clarify which components interview is more interested in 
what are out of scope

also check for scale of the application you are building 
let say design a chat application, the design is different
for 50 people using it or millions of people using it

time your solution, don't go deep in one component that you
leave others hanging. first propose a high level view. and 
ask interviewer where can i go deep

you are not expected to know everything, don't make up things
if you don't know

ask interview is it going in right direction, what additional 
things we can do here? Are you with me. Any questions for this
design or for me ^g7CnSBlq

Youtube or steaming platform

FR

1. people should be able to 
upload videos
2. homepage for user with recommendation/
most viewed videos and ability to 
search for video they like
3. play video
4. support all devices laptop/mobile/tablet
(like/comment/dislike a video) ^lDmmRV5s

NFR

no buffering (atleast as low as
possible)
low latency
high availability
no need for strong consistency ^647c9lnp

users of the system
 ^znTJCEk2

client is nothing but ur laptop, mobile, etc.
user is you who is viewing the content on some 
client.
production house is the user/entity who uploads
a video.
 ^IuzXaL9p

clients know which device it is on. and what
format it can support. so based on some logic
let say it asks for best quality. The video
comes in chunk. Let say for some reason client
figures out that 1080p next chunk are coming
late so it will lower the quality and ask for
low rated chunk ^FswBqwg4

store the video in amazon s3 and store video
metadata in cassandra, like video_id, user_id,etc.

asset onboarding service also put a message in
kafka  ^7MY4Ol6u

content processor has multiple tasks
first it chunks the raw video in 100s or 1000s of chunks then this is put in to kafka
the next service content filter picks this message from kafka, does some work and again put
into kafka, then content tagger does something same. transcoder convert raw file to 
different formats like mp4, mkv, mp3, etc. then each of these chunk and different files
are converted into different pixel ratio or quality
then these chunks are uploaded in cdn. Also each chunk knows the next chunk to it. ^nigqxDEP

asset service is consuming of the topic from kafka, it stores like how many chunk a video have formats etc in cassandra

notification service informs the user that full movie/video upload is done. And video is now fully uploaded. Note it inform the uploader of the video ^kHYHY5RK

analytics service can be used to track the people geography where they are login
from. User age group, etc. ^cWmLRkMQ

home page service fetches all those videos which needs to be displayed to this user.
 ^MbmSY9qV

user playing video talks to host identity service which knows where are u coming 
from it talks to asset service to get list of all cdns which has this video. Then
from the list HIS(hos identity service) will try to find the closest to user. ^J2CpLufT

stream stats logger generate analytics on watched content, like how much minutes video watched, how long video completed like 50% or something like that. Which can be
put in kafka for analytics again. ^B2Ux2e62

video call platform (zoom/google meeting)

 ^3xKpRBBO

video and screen share are basically similarly implemented like in video the input is your camera while in screen share input is screen ^hYTzjY1w

super fast means audio and video is lag is not good, so it should deliver the content fast ^xXQUn7ed

losing few frames in call is okay. ^nwbdkLGX

the communication between user and server ^Rqvz6cH7

TCP VS UDP ^UiLGuYYm

In UDP we may get out of order data packets, some packets missing. We should be okay with that if some frames are out of order or missing in video chat app.
We'll be using UDP for video/audio transfer only. For other we'll still be using normal TCP ^QxgGJ1f9

let say user u1 wants to initiate a video call with u2. u1 can inform web socket handler
telling i want to make a video call to user u2. Now few scenario can happen, u2 is offline
then we show either show error message to u1 or we show ringing sound and after some time
drop the call. but let say u2 is online then handler will send a request to u2 that you
have a incoming call from u1, do you accept it or not? if u2 accepts it, it follows the same
route and the call is established, if u2 rejects again same route but now we can show u1 some
error message that u2 has not picked your call. We should not be using same route for actual
video call because websocket protocol is build on top of TCP. and we want UDP for video call

UDP is a connectionless protocol(no connection), whenever u1 want to send a data to u2. it
is done like this send this data to this ip address with this port. Here u1 can directly
send data to u2 and vice versa without a need for central server. For this u1 needs u2 ip and 
vice versa. Connector job is identify ip address of both u1 and u2. Also inform them these ips. 

So first u1 calls connector it tells u1 it's ip address, similarly u2 calls connector and it
tell u2 it's ip address. Then through web socket handler they'll interchange ip address.
Then they'll start sending UDP message to each other. apart from that they'll also exchange 
attributes about their connection and configuration. Example U1 is on 5G and u2 is on 2G. So
a decision is made what quality data packets to send.


NOW SINCE UDP IS SUCH NICE WHY NOT UDP FOR ALL USE CASE. One of the reason is their are firewall
restriction which don't allow UDP connections ^EQTzlDTw

let's identify how each of the users identify their own public IP address. So, I have drawn a small diagram here to make it easy for us.

This is the same connector component.Let's say, connector has a IP address of 1.2.3.4.

And these are the three devices that we have in the system who want to understand their own public IP address.

Let's say, this laptop has a IP address of 192.160.1.1, which is a private series IP address. This mobile device again has a 192.160.1.2 IP address.

And this could be a smart tv, IP phone, anything, which has a IP address of 192.160.1.3. Let's say, if this laptop wants to identify its public IP address then, what exactly happens.

This laptop would then talk to ISP's router via a lot of routers. It could be talking to it's home router then a couple of more routers in between.

At the end it will talk to ISP's router. Let's say this laptop establishes this connection with this ISP's router on port P1.

Externally, let's say, the the public IP address of this router is A.B.C.D.

These routers will have firewalls. They'll have something called as a Network Address Translator and a lot of things.

This NAT essentially (Network Address Translator) converts this public IP address into this private IP address.

Let's see how would that work? So this device would send a message to this connector component asking for it's public IP address.

If you send a request essentially to 1.2.3.4, that request will go here. This router will forward the request to 1.2.3.4.

Now, when this connector gets the request, it will get to know that I have got a request from A.B.C.D from a particular port, let's say P1.

If this device was connected to port P1 of this particular router, then connector will get to know that P1 was the port through which I got the request.

So in the response, it will send this kind of a message. It will say to the same IP address, A.B.C.D of this router, on this port, let's say it is P1 in this case,

it will send the same message, saying your public IP address is A.B.C.D:P1.

This device will get to know that my public IP address is A.B.C.D on port P1.

Now, same thing happens when these devices connect. It will send a request to router connected on port P2 on the router. Then the request goes forward to connector.

Connector sends back a response because now it will know that it got connected to port P2 on this device. It will send that request.

NAT will convert that request, which was supposed to come for A.B.C.D:P2 (for the port) to this particular device's IP address.

And this guy will also get to know. Similarly, all three of them will get to know that their public IP address is A.B.C.D, with individual port - P1, P2, P3 whatever that is.

So, this is how a device gets to know their public IP address. ^HtbUBsgh

There is something called as a Symmetric NAT. 
What that is, is basically when this device wants to connect to this connector, it basically connects via port P1.
So, if there's a symmetric NAT, it will make sure that only this connector can talk back to P2.
What we are doing essentially is.. there is this user device U3 of another user who's also talking to the same port.
In the scenario, there was one connector which got to know of this port.
And then there is U1 which is also talking to the same port.
But in case there's a symmetric NAT, then this wouldn't work.
This firewall will block this connection of U3 trying to access this port.
And if that happens, this whole thing goes for a toss and then we cannot do any of it.
So what is the solution?
So the solution now is putting something called as a Call Server in between.
What this Call Server does is basically a combination of connector + data transfer.
 ^lXWpg736

This Call Server then, through a similar process, is able to identify each of their addresses. It gets to know. 
It sends them also. Then, this serves as a intermediate layer for these two parties to talk to each other. So, 
U1.. it doesn't send directly to U2 any information.. U1 basically sends all the information to Call Server. 
Call Server then redirects all the information to U2. U2 again sends the information to Call Server and Call Server 
sends the information to U1. This is how the communication, if it cannot happen in a peer to peer model, it would 
happen through something called as this Call Server.  This protocol is called webRTC
 ^FqkhuJZN

So, for group video calling, we will follow a slightly different and a hybrid approach.
First of all, we'll classify groups into two categories.
So, all the groups who have <= to five users will be the groups which have small number of users.
And other will be called as a group with large number of users.

Five is configurable here. Based on number of participant in call we'll figure out which approach to take ^ozACFAzD

these 4 users and they want to do a group video call amongst them.
Now, let's say, if U1 is actually talking about something, U1's data needs to be sent to U2, U3 and U4.
Now, let's just imagine if these are connected by a peer to peer model,
what exactly would happen is U1 would send a particular piece of information to U2, then to U3, then to U4, all separately.
Now, for 3 - 4 users, this this is a fairly fine thing.
But, let's imagine this for 100 users.
That's a problem.
So, we'll say that if these are small number of users, this is probably okay.
But if there are larger number of users, this wouldn't work and we'll follow the approach via the Call Server.
U1 will just send this piece of information to Call Server. Call Server would then send it to all the three users. ^CVr8qXWJ

also if you want to record the call, using call server approach is the only way. peer to peer approach 
won't work here. ^NI3u4gsu

This is not an insecure channel. 
If let's say, U1 and U2 are communicating with each other, hypothetically, let's say it's a one to one conversation.
When the handshake happens, they would also exchange a set of cryptographic keys through which the 
whole conversation would be encrypted. So, U1 would encrypt the piece of payload that it sends out to U2
and U2, when it receives the payload, it can decrypt the payload and then play the video.
So, anybody listening to that conversation in between would have no clue about what is happening. ^nkbpZ7la

signalling ^6xdQfrFL

stun ^kO1dGTPA

turn ^UxyZxBGC



Now, if you look at any videoconferencing platform, they always have a chat system along with that. We can use the same architecture we used for WhatsApp design

U1, wants to initiate a call with a user U2. All live users in the system are connected to one of the WebSocket Handler, similar to WhatsApp.
Then we have web socket manager who keeps tracks of which user is connected to which web socket handler. Web socket manager sits on top of redis, now redis
will not only keep this data inmemory but also flush the info to persistant data store to make it fault tolerant.


user U1 wants to initiate a call with user U2. It makes a call to WebSocket Handler, which basically calls something called as a Signalling Service.
Signalling Service is the one that initiates the conversation between two parties.
It will also have some policies, which will check for certain conditions. So, let's say, if you have something like a Facebook and you want to put a restriction saying, 
if you are not friends, then you cannot make a video call between two parties or to a user, then all of those things would sit within Signalling Service.
It would also use User Service, a repository of all the users in the system to power such functionalities.
Now, if there's something like Zoom, such a thing would not exist because there is a concept of guest user in Zoom.


Now, Signalling Service will basically talk to U2 and basically tell the WebSocket Handler of U2 to ask U2, if U2 wants to accept the call or not.
If U2 rejects the call or if U2 is offline, then it can be handled in certain ways.
But if let's say U2 accepts the call, then Signalling Server basically informs U1 that U2 has accepted your call.
Now we can initiate the conversation.
Then comes something called as a Connector.
So, all of the users will talk to all of these components.
I have not drawn the arrows because that will clutter the diagram.
But now at this point, what happens is - both U1 and U2 talk to this Connector component.
Remember the connector component in the previous segment, which was also called as the STUN Server in the WebRTC world.
So, this component is responsible for telling each of the parties about their publicly accessible IP addresses.
Now, through Connector, they'll get to know their public IP address.
And again, through this similar WebSocket Handler via Signalling Server, they would communicate these two things to each other,
saying my IP address is this, my IP address is that.
Now both of them know each other's IP addresses.
Then, they will also do another handshake which talks about what kind of a bitrate they can support,
what kind of codec they can support, what kind of bandwidth they have available.
So, all of those information would also be shared, again via WebSocket Handler.
Once that thing is established between both the parties, then they can start with the communication.
Basically then a regular peer to peer connection is established between U1 and U2
and they can start sending packets to each other and continue with the video call.
Now, the way video call would actually work
is those videos would not be bigger chunks like five - five seconds each.

In this scenario, we'll use much smaller chunks, which is of a few milliseconds kind of a thing,

or maybe one-fourth of a second or one-fifth of a second, something of that sort

and those big chunks would be sent across to each other

so that the experience is nearly seamless.

And it looks more of a real time thing.

Now, let's just say, it is not able to establish a peer to peer connection for whatever reason

maybe public IP address is not there, maybe that's a symmetric NAT,

whatever happens, if that is not something that can be done, then comes something called as a Call Server,

which in the WebRTC world is called as a TURN system.

Now, each of them communicate to each other through this TURN Server.

U1 sends a message to TURN Server and this server sends it to U2.

Similarly, U2 sends a message to this server and this server sends it to U1.

So, this basically becomes a point which is orchestrating communication between both the parties.

This is how your regular one-on-one connection or a regular one-on-one video call would work out.

Now, you remember, in the beginning of the call, there was a handshake which talked about what kind of bandwidth requirements we have.

Now, bandwidth is something that is not very constant.

While a call is happening, there could be a network that gets choked in between and..

let's say, U2's network got choked and U2 now wants to support a lower definition video instead of a high definition video

then, in the middle of the call also, it should be able to talk to U1, again via the WebSocket Handler saying now I don't have enough bandwidth.

Maybe earlier it was supporting a high definition video, but now it wants to support a low definition video.

Those things could be changed in the middle of the call as well, again via the same route of WebSocket Handler and Signalling Service.

Now, each time there is such a change happening in the video call, that does impact the experience, a little bit at least.

As a person who's made the system, you definitely want to be aware of all such changes.

So, whenever such a thing happens, Signalling Service would basically put out an event into Kafka.

So, once Signalling Service puts that event into Kafka saying,  bandwidth was changed,

it can be further used for some kind of processing to figure out how stable the networks are, in which geographies

and based on that, we can make some business decisions.

That is something that we need to capture.

Along with that, these devices could send some analytics information along with everything else

like maybe how frequently the Wi-Fi is changing, what kind of a battery usage is there while being on a video call,

how much data is being consumed while on the video call.

All of those details, each of the devices would send to WebSocket Handler

and WebSocket Handler would send to Analytics Service, which is basically, purely a system that is taking inputs for analytics,

Analytics Service then puts the events into Kafka, which we'll look at later on how can we process.

we might want to support a recording feature then comes something called as a Logger Service. 
Now, when U1 sends a message to Call Server to send to U2,

Call Server not only sends it to U2 but it also sends to something called as a Logger Service.

Similarly, when U2 is sending a message to U1 via Call Server,

it will not just send it to U1, but will also send to this Logger Service.

The Logger Service then basically aggregates all of those small - small chunks of data

and keeps storing that into a distributed file system.

You can use anything over here. You can use a network file system, or you could use a system

like S3 or you can just dump it into Hadoop.

You can use anything over here.

But the idea is - this Logger Service would be storing all of those small chunks in a permanent data store that is fault tolerant.

Now, it would be here just for a short period of time, till the time the call is active.

Once the call gets disconnected between U1 and U2, it, via WebSocket Handler,

Signalling Service would get to know that the call has been finished.

Signalling Service would then put an event into Kafka saying the call has been finished,

if somebody needs to do something, go do that.

Then comes something called as a File Creator.

Again, for a lack of better word, I have called it File Creator.

The idea of this is - whenever a call is terminated, this File Creator would listen to that event..

each call would have a meeting id kind of a thing..

and File Creator would get to know that this meeting id has terminated.

Similarly, all the file chunks that were stored in the distributed file system, would also be stored against that meeting id.

So, this File Creator would basically read all of that data, which is basically all the chunks of that whole

conversation, process them, make a video out of it and store it in another location.

I would want to use an Amazon S3 over here because now we need a fairly distributed store

because you don't know how many number of times that video would be seen. So, we can use this over here.

Similarly, you can use any other standard store as well.

Now, once it has created a file, it can send a notification to the users who are involved in the conversation,

saying your meeting has been recorded,

here is the file, here is the link, go access it.

So, that's how this flow would end.

Now, let's look at how does a group conversation happen.

So remember, group conversations, we were building them in two modes.

If there are small number of people like three or four people, we could possibly build a peer to peer communication between all of them.

But now, each packet of information would be sent to all the users.

That is one way.

The other way is through Call Server in case we have more number of users, let's say hundreds of users,

then, each device talking to hundreds of others, would be too much of a trouble to manage.

So then, Call Server comes in.

Now, one to one communication is slightly different because you just have two parties.

You just need to relay the information sent from one party to the other party.

But a group conversation is slightly tricky. Why? Because there you need to do something called as Transcoding.

If you have not looked at the video that I have made on Netflix, I would suggest to watch that because that

talks in much detail about what this transcoding means.

But the main idea of transcoding is -

if let's say, there is a source video and there are multiple users who are trying to access it.

Each user might be coming from a different kind of a bandwidth availability, different kind of a codec

that it can support, different kind of a file format that it can support.

So the idea of transcoding is to convert an original video into multiple such format in which you can

support all the devices, having a wide variety of bandwidth ranges, wide variety of bitrates and all of that.

Now, what happens in a group video call -

let's say there is a user U3 also over here.

Now, this user U3, is having a very, very bad internet connection, and user U1 and U2 want to have a high definition call.

And let's say there are hundreds of users let's say, but three for our example. Basic idea is I want to do the conversation through Call Server.

Now, U1 and U2 want to have a high definition call. U3 wants to have a low definition call.

Now, how do you do it?

So, what happens is - on the packets..

let's just say U1 is talking about something and that needs to be sent to U2 and U3.

So, the message would come back to this Call Server from U1.

Call Server knows that U2 is having a high definition ability.

So, it would send the same package that it got from U1, which was in high definition, directly to U2.

It also knows that U3 needs to have a low definition video.

So then, it will call something called as a transcoding service.

Now, this Transcoding Service could physically, from a hardware standpoint, be running on the same machine to minimize the latency.

But logically, it's a different component.

So then Call Server talks to Transcoding Service which transcodes the high definition video into a low definition format and sends that to U3.

On the other side, when U3 is talking about something, U3 anyway would talk in a low definition, right?

So transcoding can happen just one way.

You can convert a high definition video into a low definition video, but you cannot convert a low definition video into a high definition video.

So the video parts that U3 is sending to the Call Server, it knows that it's a low definition video,

I can anyway not convert it into high definition.

It would send that as it is to U1 and U2.

So all that intelligence is built within this Call Server

about each user and what kind of bandwidths and bitrates and all of those things they support.

And it would use a cache based on Redis to keep all of that information.

Now, again, when you have a group called, each of them could be having a wide variety of network connectivity.

And each of their bandwidth requirement might change during the call.

So, let's say, U3 started off with a high definition requirement, but in between it wanted to have a low definition requirement.

Something of that sort could also happen.

So, again, that communication would happen via Signalling Service and Call Server would get to know that

now U3 has moved to a low definition mode.

So, now I need to start using the Transcoding Service.

Maybe earlier it did not have the requirement to do this transcoding.

So all of those things would be handled by Call Server at runtime.

Now, let's look at the last component, which is basically Analytics.

So, there's something called as this Analytics Engine which will power all the analytics.

In the previous sections, we had put in a bunch of events into Kafka.

This analytics engine, would basically read all of those events and publish some kind of reports.

Now, if you want to do a very simple analytics, like just figuring out how many number of calls happened in a day

or something very trivial like, how many times people generally get dropped off in a call.

So, if it's a basic set of analytics, then you can basically put all of that information in a time series database and plot some graph on top of it.


But if you want to do some fancy analytics and some really smart things built on top of it,

then you can use a Hadoop cluster to put all of that data and you can run some Spark jobs to basically do a lot of

data crunching and publishing out some smarter reports.

Now, let's look at some intelligence that exists within the client.

So, let's take an example of U1 doing a video conversation with U2.

So, clients as we know are intelligent enough to identify what all bandwidths they can support,

what all bitrates they want to support, what all codecs that they can support and communicate that to the other party.

They are also intelligent enough to come up with a consensus on what configuration of the communication they would want to support.

Now, let's say U1 and U2 are talking in a peer to peer fashion.

Now, let's just say due to some reason, there is an issue in the network and the call is getting dropped off.

Or let's say the public IP address of one of the users is changing.

In that scenario, the clients would automatically be able to figure out that this is happening

and they would be intelligent enough to mutually decide that we would now move the call from a peer-to-peer fashion

to something via this Call Server.

And this would happen dynamically without users doing something about it.

So, that level of intelligence also exists within the client.

Now, how would that work?

So, let's say that these two communicate via this WebSocket Handler and this Signalling Service

and we need to now move the connection to the Call Server.

And it need not happen exactly at the same time.

Both of the clients can move the communication at their own pace to the Call Server.

So, let's say, U1 first gets to know that we have decided that we'll move the communication to Call Server.

So, U1 will send all the data to Call Server and Call Server will take care of sending that data to U2.

But U2 could still be sending the data to U1 directly.

And when U2 decides or gets to know that the communication needs to be moved to via this Call Server,

then U2 could basically follow this new route.

So, all of that can happen independently and each of the clients can do that at their own pace.

Now, the same thing could happen in a group conversation also.

So group conversation, if it is happening in a peer-to-peer fashion, the clients or the devices could then decide to move it

to a Call Server, at runtime, if they are having any issues.

Next, let's look at how do we use this system to support a live broadcast of some massive event.




Now, let's just say that there is a big sporting event happening somewhere. Let's just say, for example,

a India v/s Pakistan cricket World Cup final. Possibly millions of people would want to watch it.

So, let's see how can we scale this system to work at that scale where millions of users are trying to watch a livestream.

So, everything on this side of this red line is outside the scope of the system.

But this is because it's an input into our system. So that's why, I have put it.

So, in any kind of an event, whether it be a political event, a sporting event, whatever,

there would be multiple cameras and multiple audio devices that would be taking inputs.

So, there could be a bunch of cameras, there could also be a bunch of audio devices.

I'm assuming there is something called as an Input Manager.

It could be hardware. It could be software which basically aggregates all of that and decides that

which camera out of those three or five I want to stream right now, which audio device out of those many, I want to stream right now.

It then basically send me an audio plus video combination into the system that needs to be streamed.

We'll try to follow a very similar model that we had for a group conversation, using a Call Server.

Now, this Input Manager basically sends the request to a Call Server saying this is the stream,

now, send it across to whoever wants to watch it.

Now, the thing with these kind of massive scale live streams is, there are a lot of users on a wide variety of devices.

So in our example, let's say there are some.. or a lot of users on mobile devices.

There are a lot of users on TVs.

There are another lots of users on TVs for example,

and there are a lot of other users on laptops.

So these are the devices that we want to support.

Coming back to this Call Server which got our input stream.

What this Call Server will do is - it will basically forward the request to multiple transcoders.

Now, the thing with transcoders is - if it's a good enough hardware and we have one input stream and we want to

convert that into another output stream of a different format, it can do that in real time.

While the stream is coming in, it can transcode it and send it out.

All we need is - multiple transcoders, which is a function of how many output formats do we want.

Let's say, if in this example we have three kinds of users, we'll possibly have three kind of output formats

and therefore three sets of transcoders.

So it will send that to all those transcoders, which will then send the transcoded output to a set of Call Servers.

Now, what this Call Server gets is essentially the file format that would be sent out to one type of users.

So in this case, there are three file formats.

So there'll be three such Call Servers and three such transcoders. I have made just two for representation purposes.

Now, let's say, this Call Server gets all the data that is to be sent to mobile devices.

It would then send to multiple Call Servers.

Now, this Call Server is not sending directly to users. Why?

Because remember, any sporting event would probably be seen by a lot of people in a lot of geographies.

So, we need a CDN kind of a thing with which we can first distribute in a lot of geographies

and then from those geographies, we can distribute out to multiple users.

Kind of taking an inspiration from something that Netflix has done

wherein they put a hardware at a ISP's end and just send that request to the ISP first.

And then from ISP, it is sent out to users. So, a very similar approach I'm trying to follow here.

So, this Call Server would send to multiple such Call Servers and all these servers would be geographically distributed across the globe.

And then individual Call Sever will talk to one type of user.

So, each Call Server.. so, if one Call Server is dedicated for mobile users,

then it'll talk to thousands of users, but only mobile users so that it can just to work on one stream of data.

If there are multiple streams, then we'll have to have a lot of logic about

which stream to send out to which user, which will complicate the process.

So, this Server gets all the data, for example, for laptop users so it will send out to all those.

This Call Server, for example, gets the input stream for TV users. It will stream out to all of those users.

Similarly, as many number of Call servers as we need, they would send out the payload to the users that they work for.

Now, this management, that needs to be a system that kind of records that which Call Server is talking

to which user, in case there is a downtime on this Call Server, we can bring up another Call Server that can fulfill

those particular users. So, we can use something like a WebSocket Manager that we have used earlier, to orchestrate

the communication between these Call Servers.

But, that's a very minute detail.

So, I am skipping over that.

Now, the idea is - we want to keep these Call Servers as close to the users as possible because otherwise

if there are a lot of routers in between, all those routers will have to carry the same set of information multiple times.

So, if this Call Server is close to the users, that latency would be minimized

because this is just a couple of hops in between the Call Servers.

But from Call Sever to users, there could be a lot of hops.

So, we want to minimize the number of hops over here because this is where the data is getting replicated multiple times.

If there are more number of hops on this side, data is being sent only once.

So, that is still okay, if you have a larger path over here.

So, we'll try to push these servers as close to the users as possible.

 ^TZ2mnRxk

platform for live streaming to millions of users. ^Fbm0t2fW

google maps

FR
 ^3PYrazsY

given point a and b, what it the distance and time.
what road to follow.

pluggable means extensible traffic can be added later.
Constructions, accidents, etc. ^6gnlcBPn

should give good road accuracy, if it doesn't give the best 
route that's okay but that route should lead to our destination.


it is okay if it takes 2-3 sec to give route info or do behind the 
scene calculations.

 ^GOcvzo8d

or we can use floyd warshall algorithm to find
shortest distance b/w all vertices and cache this
info for each segment for fast lookup.
 ^EBKEik1Y

given the lat/longs we would be able toidentify an aerial distance between them. Let's just say that the aerial distance

between them is 10 kilometers, okay.  We also know that each segment is onekilometer by one kilometer in length and width right. So what we can say is we'll

at max go... so because this is 10 kilometers on aerial distance, what wecan say is.. adding some buffers we will not cross more than 20 Segments on each

directions either going from North to South or going from East to West. That 20number is basically a buffer that you can come up with based on your

conversation with your interviewer. But the idea is this number(10 KMs) will give us some input onto how many segments do I want to look at. So 20 segments on the

North-South side and 20 segments on East-West side is what we'll look at to come up withthe optimal route from point A to point B. Because normally what would happen is

there will be millions of roads into the world. And if you start doing aDijkstra across the whole globe just to calculate distance between these two

points, that will be very un-optimal.  So we have to break that Dijkstra at some point in time.So this number would be used to break that Dijkstra saying that we will not go

further that beyond this point. Now one obvious way to solve this is you haveall the roads connecting the whole city which cuts these two points as well.

Run a Dijkstra across the city and then come up with the shortest distance betweenpoint A to point B. But if you look at it and if you look at it that way that

there are probably millions of users querying at the same time to finddistance between any two points, Running those many number of Dijkstra's Algorithms

would be heavily inefficient. So we'll do some slight optimization there.What we'll do is, there are... we'll basically say that there are two exits

out of this block(Segment having A). Basically to reach this block(Segment having B) we need to exit this blockand there are these two ways. Let's say if we have calculated that these two are the only

exists within this segment. Let's say this a segment S1. So A belongs to S1 andthese two are the exits, this is S1E1 and this is S1E2 and they have

some great W 1 and W 2 let's say.  Now what we'll do is, this segment...this junction is basically having two points. One is S1E1.. two identifiers basically,

S1E1 and S2E1. this is segment ID S2 and this is exit number one of thatsegment so this has another identifier for S2. What we are saying then is this

has another point on the same route which is S2E1 and weight between them zero.similarly there'll be a lot of points. This graph will fan out.

On the other side for B, let's say B belongs to segment S4 thereare another two exits through which you can reach B. One is S4E2 and one

is this one which is S4E1 even.Now if we just connect all the exits to exits

for ten blocks(Segments) on the North side, ten blocks(Segments) on the South side, ten blockson this side and ten blocks on that side, we'll basically be able to come up with a

crisscross of a lot of Road whichconnects these four points right and

there'll be a lot of junctions within that, there'll be a lot of roads, but thesewill be basically just entry points and exit points of the segments. We don't

really care what are... what is happening within the segment when we are cuttingacross segments. Why? -  because to reach this segment we anyway need to cross all

of the other segments right. Now we don't care if this route which we are callingas let's say this is segment S6 and this point is S6E1, this point is S6E2

Now this is basically a calculated path from these two exit points. Thisexit point to that exit point basically. This real path would look something like

this right but we don't really care what's happening within the segment.All we care about is from this point(S6E1) to this point(S6E2), I know the distance, and I'll use that.

Then from this point to this point I know the distance I'll use that. So we'llbasically be using all the exit points distances and use them as weights,

and come up with this graph at runtime.Now given like ten  segments on each side, we'll probably have

this graph of a couple of hundreds of edges at max right. Now we can run aDijkstra on this graph staying with that what is the shortest path to go from

here(A) to here(B). This Dijkstra runs on top of the graph which was created byjust entry points and exit points in everything else, and entry point and

start point and entry point and end point in the starting and ending segments.Everything else was just a connector from individual end point to individuals

basically exits of a particular segment. Now this is fine when we have to travelfor like ten odd kilometers we can still create a graph of these 100-200 edges

and calculate. What if you want to go  inter-city? What if you want togo from City 1 to City 2 and then you want to calculate it? Then it becomes a

big trouble to... because let's say the distance between those two city isthousand kilometers then there are possibly thousands of segments

multiple thousands of segments that you'll look at, right. That would too complicatedto run a Dijkstra at runtime. Now like we extended the solution from one segment

to multiple segments, we can basically create a Mega-Segment, right? We cansay this whole thing that you see here is 1 Mega-Segment and there could be

this exit to this Mega Segment this exit to this Mega Segment and probably anexit here to this Mega Segment, right? And then what we can say is, let's say you

have this whole map of a country. I know it looks terrible but let's say this isone country, what you can say this is 1 mega segment you can basically divide

this country into mega segments. And then recursively solve for it evenfurther. Now when you were to if you are to solve in the mega segment world you

have basically converted this whole country into possibly 50 mega segmentsand now if you want to go from here to here, you basically need to just connect

the exit points of individual Mega Segments. You don't reallycare what is happening within a mega segment, you don't really care what is

happening within segments under those mega segments and roads under thosesegments. All you care about it from my start point how do I get to the nearest

exit or all the exits of that mega segment and from these exits of megasegments how do I get to further mega segments recursively and then somehow

reach this end point, right. Now you can have n levels of nesting. Ideally threelevels of nesting is more than enough. Now what is the ideal size of this mega

segment? - Again there is no right answer you can come up with based on somecalculation with your interview again on this. But the idea if you still want

to calculate this thing across cities or across states,  this segment approachwould still not scale you need to do an abstraction on top of segments which can

be represented as a Mega-Segment and then solve it recursively.All good so far but we have not really talked about how do we come up with the

weights on an edge and how do...what all weights do we even consider? So thevery first obvious weight is the amount of distance between two points right so

that is one thing that will definitely have.  Along with that we will also keepan ETA that normally under normal traffic conditions, in the normal weather

conditions, how much time does it take for a user to go from point A to point B.Now when we have both these information we can obviously keep a next

obvious thing saying what is the average speed of vehicles.Speed = (distance/time) so  basis that will be able to come up with an average speed.

Now you might think that the next obvious you things are weights liketraffic and weather condition and all of that but I would definitely not

recommend that. Even... let's assume this is what we have build already andnow somebody comes up and asks you to implement traffic data into this okay

now if you want to add traffic as a weight onto your edges that'll be avery very bad design. Why? - Because with an additional attribute that you are adding

you are basically changing the logic of your underlying Dijkstra which runs on asegment, right. Now let's say tomorrow somebody comes up asking you for a

weather information you will again change the whole logic of your Dijkstra.That piece is a bad design, okay. So ideally.. basically the set of things that a good

design should entail is basically that it should not restrict addition of newfeatures plus each change should be small enough and contained. It should not

basically impact the whole feature.  So what we'll say is traffic and all all ofthose in things are basically attributes which impact your speed okay and basis

whatever your average speed is you can calculate the ETA as a function ofdistance and average speed, right?  So all we'll say is traffic, weather, roadblocks all

of those they'll never be weights on your graph, okay. They would just be attributesthat impact your average speed. So average speed would be a function of

traffic, it could be a function of weatherit could be a function of any number of fields that you want. Let's say if you

want to add a accident, or construction work going on someplace or whatever you want to add.So all of those would basically impact your average speed. Now normally

you don't have to do all these fancy things, never ever! Why? - Because it's for acompany like Google Maps they know... let's say there are hundreds of people

going from point A to point B. They  anyway know how much time they tookright plus a very important feature about this kind of data is, this traffic

data would always be normally distributed. So if we want to plot, Let's saythis is basically any metrics let's say ETA of how much time it took for people

to go from point A to point B on a graph it would always look like a normaldistribution, okay. What that means is you do kwow that there is this point which

most of the users are hitting and as a... with some statistical calculations ofone standard deviation from each of these point you will be easily be able to

calculate this range that normally for most of your users at least 50-60-70%of your users, this is the window of time that it will take. Let's say this is

5 seconds this is 7 seconds and let's say average is 6 secondsfor example so statistically you can come up with this number as a function

of lot of users who are crossing the roads. So you don't really care how muchis the traffic, what is the weather, when you anyway have this real-time information

So for all the geographies where you have people usingyour application, there you have organic data from real users at this point in

time so you don't really care about traffic and all of that. Traffic and allother things will come into picture only in places where you can either not get

enough data from users or there is some other reason why you're maybe legallynot allowed to get information of users right because of which if you don't have

real data users, then is when you will bother about using traffic and weatherand all those attributes to come up with this average speed number basis

that you can even know the distance from point A to point B, you can come upwith a ETA, okay. Now how do we quantify traffic?

you cannot say that if there are 805 vehicles, it will take this much amountof time, right. The number of vehicles on a road and things like that cannot be

calculated at all. No matter how good technology you build right. So when thesethings cannot be quantified how do you use them as a measure? So what we

can say is basically create multiple "Tiers". Let's say this is traffic measurementand this is Weather Management.  All you can say is traffic is low or it is

medium or it is high and whether it is good or it is bad, right. So you willhave these kind of Tiers for each of the attributes that you have and all you can

say is every time traffic goes from here(Low) to here(Medium), it has a 20% increase ontoaverage speed or something of that sort. right every time traffic goes from low

to medium, average speed reduces by 20 percent. Basis these transitions oftraffic volume... now you can always say that traffic is low or high based on the

number of users that are probably using your application or from some othersources, right. Let's say you have this kind of a measure, so there are companies

like Waze and all, which will give you the kind of information that how's theweather, how is the traffic in a very abstracted form. Now once you have

this information you can calculate average speed as a relative number fromthe original value calculated. so let's say with the good weather, with the

medium traffic you knew the average speed was later 20 kilometers per hourNow if the traffic goes to high, you kind of reduce it by 20%, so it basically

becomes 16 kilometers per hour. Basis is this kind of a calculation, you willcalculate the ETA. Now as and when inputs are coming, you are making changes

into your weights on the graph. How does it impact the overall system? Socoming back to the previous drawing that we made remember we had something called

as a segment and we had lots of roads within the segment and let's say thetraffic increase we got a signal from some third party saying traffic has

increased on a particular Road. Now do whatever you want to. Now let's say therewas this one exit point and one exit point and distance between this was some

Let's say there are some X weight to this particular theoretically calculated road.And let's say it was actually using this particular road on which the

traffic is increased, let's say it  actually was following this kind of agraph, something of that sort. Now similarly all other roads are getting

changed. So all you can say is remember in this all the theoretically calculatedroads that we have to be calculated we were caching that what all real roads

are a part of this theoretically calculated road. Which is... it is not areal route, but a calculated edge.  So each time this thing changes, weight

changes on any real road, you basically try to infer, what all actual cachedroads are impacted. And then you basically make a change into the cached roads

also. So you say that okay the time taken initially was 10 seconds, for thispath, now it has become 15. So let me increase the value of this particular

calculated road from point E1 to E2 by 5 secondsNow let's say you do this for one segment, then what basically happens is

you recursively bubble it up over a lot of cached things. So let's sayif there was a mega segment who's...  who had this kind of an entry-exit point

that this is ME1 and this was in ME2 and you know that ME1, the route fromevery ME1 to ME2 uses this E1-E2. So what you will do is you will basically bubble

up the amount of time for this route by 5 seconds. So what we are essentiallysaying is as then when you get traffic data you basically update the ETA on a

particular road. Then update the ETA on all the calculated routes that this roadis a part of.  And update and then basically that becomes

at a segment level. And then do the same thing recursively for all the segmentsthat are a part of a mega segment.  So basically what you are doing is you're

bubbling of all the calculated values and then updating whole of the graph.Now these things are not happening at once not all the signals are coming

up at one, right. So as in when something changes you bubble up till the level whereit goes and then stop. So let's say this road was not a part of this ME1 ME2

for example, then it will stop at the segment level, right. But if it is a partof a mega segment road also, then it will bubble up in the mega segment level.

Now, other than just traffic and weather, there's also one very important factorthat you can use. So you can also use historical ETAs to come up with a real or

a predicted ETA for a particular Road. And this historical ETA isbasically calculated in a way that you basically look at the day of week and

the hour of day so let's say Monday, 5 p.m. this road takes 20 seconds tocover, but on Sundays 5 p.m. is this road takes just 10 seconds to cover so

something of that sort is what you can cache at a level of a day of week and hour of day.And then use that historical data to infer. So let's say if you do not have traffic

information also, then you can use this kind of an information to somehow comeup with the predicted ETA. Now coming back to the segment, due to some

activities within the segment so let's just say there are a lot of roads on thesegment. There is there are these two exit points and there are these points

which have some roads now let's say we've calculated that the ETA of fastestway to go from point SE1 to SE2, involves 500 units of time.

let's say 500 seconds, okay. And it uses the route SE1 to A to B to C to SE2, okay.Now let's just say that there's a traffic increase on A to B. Now we could

identify it by a lot of attributes. Let's just say people moving between A to Btheir average time increases right. Or we get a signal saying you know the

traffic is increasing significantly. For whatever reasonlet's say we increase the time of basically the ETA for going from point A to

point B. So it would impact the ETA from SE11 to SE2. Now there is alimit to which it can bubble up right so let's say it increases from 500 to let's

say 550 due to some increase in A to B so all that is okay. But let's just saythat we have real data of users, and for some reason it is taking a lot of time

for some people but we put to go from point A to point B and let's just saythis increases to let's say 850. Now a jump from 500 units of time to 850 units

of time is a very big jump. It is having a.. roughly a 70% right.So now it is possible that the fastest route from SE 1 to SE2 does not

include this route ABC! It could be some other route. So what we will do is if ETAincreases or decreases, generally in case of increase only we'll do this.

if ETA increases by greater than some percentage. It's a configurable amount.Let's just say we have it set that if the ETA increases by 30%

then we recalculate things within that segment. Because all the updatesthat you are getting are against a segment only. So whenever a

particular road's time increases you can calculate everything within thatsegment, right. Which means recalculating paths from SE1 to SE2.

Let's just say, that we figured out that now the new shortest path is not thispath and it is basically the pass from SE1 to A to H to G to F to E and to SE2.

So, this basically becomes your new shortest path, right. Now if it is the shortestpath, then we need to bubble up that information, right. First of all we need

to say that whoever was traveling from SE1 to SE2, now needs to follow a newpath right which is a path from  SE1-A- H - G - F - E - SE2, right. This is one

part of the things. But what if there was a mega segment over here whichencompasses a lot of segments, whose exit points were also including this

particular path. This is let us say ME1 and let's say ME2.Now if the exit point path of this Mega Segment also includes this part

then even that mega segments path would change so the part where they use ABCnow that would get converted into this, right. So these are the things that

you'll have to do each time a weight changes. so when the increases beyond thethreshold then you have to do. So let's just say increase happen from 500 to 510

then all of this calculation is probably not even worth it. Because the best youcan get is probably somewhere between 500 to 510. Now let's say 10 seconds

would not be too much of an enhancement right. But if it is such a big jump from500 to 850 for example then you might as well recalculate everything within the

segment and then bubble up whatever is required. Now you'll not just calculatewith respect to exit points, you'll also calculate the shortest path to reach

from let's say SE1 to A, or SE1 to B.  All of those will also be calculated butfor representation this was a good enough way to explain you the concept.

Now let's look at the architecture of the whole system. So we will do it in two parts:First we'll look at the flow wherein all

users are connected to the system wherein we are capturing their locationinformation from all the users even if they are not using our map service. This

is basically for improving our map service altogether and a bit of user profiling.In the next section we'll look at how does the actual navigation flow works

for the user who want to find the shortest route between two points andwhat are the systems required for that. And at the end we'll look at some of the analytics.

With that let's get started. A bit of a convention to start with:Things in green are basically user devices could be mostly these will be mobile

phones, could be web browsers as well. Things in black are load balancers plusreverse proxies plus an authentication authorization layer in between which

will authenticate all the external requests comingto the system. Things in blue are the

things that we have built on our own. Itcould be web services, Kafka consumers or anything of that sort.

Things in red are either some infrastructure component that we've used or somedatabases or some clusters like Kafka, Hadoop and all of that, cool. So let's look at

how the user flow begins. The very first interaction with the user is when theywhen they have the app installed on their phone, with their

location services turn on, so we get regular pings from a user's device every few seconds.Now if the user is stationary, the device will have the

logic to not send the location ping every five seconds and maybe send itevery five minutes or ten minutes or something of that sort, because that will

reduce the load on our system if the user is anyway at the same point + Better battery life.But while the user is in transit, we will increase the frequency, so as to make

our data more accurate. This talks to.. this basicallykeeps the persistent connection with the device. The reason for a persistent

connection is, so that we don't have to create a new connection everytime. Also this wouldbe generally a Websocket connection, because sometimes we might need to send

some information on to the user devices as well. So this WebSocket handler isbasically the service that talks to all the user devices. Now there would normally

be thousands of such WebSocket handlers for talking to all the users thatare currently online. So we need somebody who can manage the fact that

which handler machine is talking to which user. So then comes somethingcalled as a Web Socket Manager.  It basically keeps a track of which machine(read user)

is connected to which WebSocket handler, so which user device is basicallyconnected to which machine of this WebSocket Handler Service.

It basically keeps that information in a Redis. If let's say it lost thatinformation is lost we can kind of pull that information again from the servers.

So we don't need to kind of store that information in a persistent Data Store.The next thing what happens is, as in when users are sending their locations

the frequency of the location pings is handled by the device and then thedevice location comes to us basically coming at the Location Service.

Now Location Service is basically a repository of all the location related information .It basically has some endpoints through which you can ingest

some users information, something like a user ID with the timestamp with aparticular Lat/Long. That kind of a structure. It puts all of that

information into a Cassandra as a permanent data source to keep a track ofthe fact that which user was at what location at what point in time.

Remember this is not just for users who are using our app right now for navigation, but forall the users in the world. How this data would help us we'll come to in a while.

Now, as and when it's getting location pings, it is also putting all of thosepings into a Kafka. All the location pings that are

going into this Kafka, are basically read by this Spark Streaming Consumer.This does a lot of calculations,  some of them are here and some of them

we look at in the later sections. First of all what it does is, if let's say alot of users are traveling at a place where.. which we do not identify, okay. But

their movement pattern tells us it looks like a road. So thisbasically is a job which would be a Streaming Job which would look at last

ten minutes of data and see how the users are moving and basically it'll be usedto add new roads into our system. Now as and when a new road is added each

time a new road is added that would basically impact the particular Segmentwithin which the roads are added and then basis that all the Segment

related information that we calculated earlier that we talked about earlierthat would be recalculated. So that might impact a lot of segments and Mega Segments recursively

if that's a very critical new road thatwe've found. The next thing is basically an average speed job. What that

does is, it basically looks at again if we look at within a segment a lot ofpeople moving from point A to point B, it tries to figure out what is the average

speed that these users have over let's say last fifteen twenty minutes and usethat information to as a proxy for a real-time information and then suggest

that and basically it will then update theweights of the graph that we talked about earlier. Again that would

bubble up to various Segments and Mega Segments if that's a part of a critical road.Now how would that bubble of process happen? - So this Spark Streaming Job,

individual jobs would actually write back things into Kafka. So let's say if anew road is identified, it would write that to a separate topic saying

I've identified a new road which connects point X to point Y. Now therewill be a map update service which listens to that particular topic and it

updates it in a Data Store. It updates it in a graphs Cassandra, which is managedby this Graph Processing Service, so each time a new road is found,

Map Update Service would invoke Graph Processing Service to tell that I havefound a new road just store that in your Datastore which sits on top of a Cassandra.

Now what this service is, we'll look at in the next section in more detail.Now, each time average speed job finds out there is some change that has happened

it would again put an event into Kafka in a separate topic now and there'll besomething called as a Traffic Update Service that listens to this topic which

would update the traffic related information again into the sameCassandra through Graph Processing Service. There is something called as a

Hotspot Identifier. So let's just say there's a particular locality on whichthere is some average number of people per given area kind of a metric that we

have. Now let's have suddenly a lot of people start gathering in that areait gives us a signal that there is some activity happening at that point. It

could be that there is some social event, some sports thing happening or butsomething is happening there so that could be able to identify hotspots

within the graph. Because eventually once we identify that hotspot we'll know thatafter probably a while, there will be a lot of traffic in that area as well

right. So that could help us in certain ways. Now for certain things SparkStreaming would itself insert a lot of information and put out

events but in general it will dump all of that data into Hadoop cluster, whichhas location pings of all the users across a lot of time. Now we could do

some ML Jobs onto it which classify these certain other things. Solet's say if you've identified a new road but we do not know what kind of a

road that is. If it's a one-way, if it's a two-way Road, if it's a single lane roador maybe a six-lane Road. So all of those

things would be identified by this RoadClassifier and this particular job could

now put that event into that road topicand Map Update Service could now store that additional information saying now

that I have not just identified that road but now I also know that this is aprobably a six-lane Road or something of that sort

There could be somethingcalled as a Vehicle Identifier.

While you are getting location pings, if you start getting those pings at a veryhigh frequency let's say every one second if you are getting that you can

input a lot of information about the vehicle in which the person is traveling.So let's just say that the traffic is going normal at certain pace but one

particular person is stopping every few kilometres let's say, okay. Now what thatcould mean that could mean that either there's a red light or there's a traffic

jam there, possibly. But we know what are the junctions you know where the redlights can be we know how the traffic jam are because we know the

data for the user as well. Now if it's not any of these two criteria then thatmeans that the person is traveling in a public transport something like a bus

and then the bus is stopping at each bus stop, all right. Other kind of things thatwe can infer is if let's say the ride is bumpy or if the person is going left and

right here and there very frequently or having a very fast acceleration and veryfast breaking it's probably a two wheeler. if not in all other scenarios if

it's a smooth enough right stable enough acceleration going straight in one roadit is very likely a four-wheeler. Now we do tell information to Google

specifically that we are actually traveling in a two wheeler or fourwheeler while we select a map but if let's say that option is not available

then this kind of data would be good enough to infer which kind of vehicle aperson is traveling in, which will help us in a lot of other attributes. So these

individual jobs what all they identify they could put that into back into thesame Kafka in probably a separate topic for each

job and then those information could be analysed even further. Now let's look atthe user journey when they want to actually get the navigation from point A

to point B. So normally what people do is they search for a particular locationwhich then gets converted into a particular lat/long right. So all of

those is being done by Area Search Service. This basically does two kind ofthings. One is, it has some areas within Elastic Search on which it provides fuzzy

searching and once the person has search for a particular area orlocality or location anything. It then gets converted into a lat/long. So

basically it stores the lat/long along with the place name, description all ofthat, in a document. The other thing is it tries to dynamically figure out: Given an

address kind of a thing which lat/long that address points to. So it does thataddress resolution into a lat/long as well. Now let's say... so post the response

from this user will have a start point and end point as a latitude longitudeboth of them and then they would want to request the path, okay. First let's

quickly go over what is this Navigation Tracking Service. So while the person isactually started the navigation and they're going towards the destination

all of their location coordinates will be tracked as part of Navigation Tracking Service.This does two main things: 1)  If the user is deviating from the route

that we suggested, we will kind of inform the app back and then that will probablyshow a pop-up kind of a thing, saying that you are probably going wrong, maybe you

want to course-correct to the right path. 2) It will also store all thedata so it will push all of the data into Kafka, while the person is traveling

then that data could be used for later analysis saying, at this point in time aperson searched for a route from point A to point B, and this was the route that

we recommended. It could be used for figuring out how good the recommendationof the path is. That being said, let's jump to the main piece which actually

figures out how to connect point A to point B, okay. So all of those requestsare being handled by this Map Service. This Map Service over here is basically an

interface service which provides multiple interfaces for people torequest the directions from some point to some point. One of the interface is

given to the user devices. A similar interface could be given out tocompanies where in all the rate-limiting and their throughput calculation against

their account information is being calculated and stored, okay.It's not an intelligent service it just forwards the request to

something called as a Graph Processing Service. Graph Processing Servicebasically does a lot of things.  First of all it queries Segment Service which

sits on top of its own Database of Cassandra, in which it stores all thesegments and their corner coordinates along with a lot of information of those

segments. So let's see if they if the Graph Processing Service wants to figureout that what are the segment's for the start point and the end point, it

will get that information on the Segment Service. Now if it so happensthat both the points are within the same segment then it's a short duration ride.

Then the Graph Processing Service might choose to do a couple of thingsit might look up that, Do have this data already cached? if yes, it will

directly return to the Map Service saying there is a response. If not, it'll thendecide what do I do next? It can now if it is the same segment it

can probably say that I will run a proper Dijkstra's algorithm and then tryto figure out the shortest path between the two points. It can do that and then

return the response. Alternatively, if it's in different segments then it willtry to fan out into the whole basically it will try to create a pick the sub

graph of the main whole world's graph that we want to look up as part of theDijkstra and run it, okay. Now for doing that it will look up on a lot of things.

First of all it will look up for all the roads within those segments, theentry-exit points of the segments, into its Cassandra. It will also have

live traffic information which would have updated the ETAs into the graphagain from the same Cassandra. Now it

would have also got some input fromsomething called as a Third Party

Data Manager. Now it doesn't queryThird Party Data Manager at runtime.

Third Party Data Manager in fact, pushesdata into Graph Service which then impacts the live traffic information so

let's say if it says that there is a huge amount of traffic at certain pointit'll update that. Let's say if it says that there is a massive kind of a

rain happening somewhere, it will update the live traffic information thing there issome rain and that would probably cause some delays and the average speed would

slow down and ETA would increase, something of that sort. Now using all ofthat information it basically creates the whole graph that we looked at in the

previous sections and then it either looks up in the cache and returns theresult or it might run the Dijkstra's Algorithm or some Algorithm to basically

figure out the shortest path between two points and then return the result.let's say if it doesn't have any traffic information, any ETA information it might

also query Historical Data Service tofind out at this point in time how much

ETA can expect from point A to point B.if it doesn't have that information for

some of the points. Now Historical Data Servicesits on top of its own Cassandra

which basically stores the informationof the form that at some day, day of the

week like Sunday, Monday, Tuesday in somehour, let's say 4 PM, 5 PM, something of that sort,

from point A to point B, how much was the average speed of people normallyand how much ETA did it take. So all of

that kind of information would be storedin Historical Data Service. Bases all of

that, Graph Processing Service willreturn back the response to Map Service and then to the user going by the exact

same set of logic that we looked at in the previous sections. Now all ofthis is done a lot of events have gone into Kafka. One of the common events was

that by the Area Search Service which we didn't go over. So each time a search ishappening the service will put an event into Kafka. Now what that would do is it

will basically give us a list of areas that are being searched most often. So wecan do some optimizations for them. Another thing

would happen is, so not we can do a lot of analytic on top of this data okaythat is coming into Kafka. One of the very first thing we need to do is to

figure out that out of all the third party that we are integrated with whichof them is actually giving right information and which of them is

actually given the wrong information. How do we do that?So let's say some third party gave us some information saying from point A to

point B, there is a lot of traffic, and ETAs would increase. But our data if itsays that ETAs have not been impacted at all, that means that particular

information was incorrect, right. Now if that happens from the same Third Party alot of times, then we can safely say that, that third party has a wrong

information or it gives us wronginformation. right. Now this Third Party

Data Manager, abstracts out on a lot ofthird party companies, so we could be

pulling data from a lot of companies allof that is abstracted under this Third

Party Data Manager but the reporting would be done at an individualorganization level. That being said, there are a lot of other kinds of analytics

that we might want to do. First of all we might want to identify what is the roadthat a particular person is on, right? so as part of navigation you want to

probably have a audio kind of a thing saying turn right in ninety meters toget on Mahatma Gandhi Road,or something of that sort, right. All of that inferences

could be done by the Spark Streaming saying where exactly I am in how muchtime am I about to reach a junction and what is the road name on

which I will get to next. So all of that could be done by this. There are a lot ofother analytics that we could also do on top of this data. Let us look at it next.

So out of all the events that are being put into this Kafka, there is a lot ofanalytics that we can do and we should do. So one of the very important things

to analyze is how accurate our ETA predictions are? So let's just say wepredicted that it will take 40 minutes to cover a distance from point A to

point B and if it takes something around 38-39 minutes then that's fairly accurate.But if in real world it takes somewhere around 20 minutes then that's a fairly

bad prediction. So we need to have this data on how accurate our predictions areso that we can figure out that we need to invest more time into you know

upgrading that algorithm that comes up with the ETAs. Along with that it willalso give us some information about which of the routes are the ones that we

are recommending to people, but people are not taking. Maybe there is somethingwrong with the routes that exist in our database, right. So all of those things

could also be inferred. Some common things that we can infer is what are somecommon hotspots in the city that people gather at. These could be some social

gathering places or things of that sort. So that will kind of give us some pointsof interest that we can build over time using this data to start with. Other than that

some obvious things that we can also figure out is, what are the homelocations and work locations of some of the people. We could also infer user

profile data. So for example if a person is going to a lot of pubs for examplethen they are more of a social kind of a person. If a person is traveling

outside the city very frequently on weekends, the person likes travelling. Sothings like that can also be inferred basis just a location data. Coming to the

last thing, now this normally wouldn't be a part of a design interview but there'ssomething you should be aware of because this is an important thing that

companies like Google Maps have to take care of. So how do you handle disputedareas? So while in Google Maps there is a clear-cut boundary of states and

countries and all of that but if there is a disputed region how does Google Mapsdecide where to make the boundary of the country or state right. So a classic

example of this would be a dispute between the countries of India, Pakistanand China in the state of Jammu and Kashmir. So India claims that whole of

the land is under their territory. China claims that some of the parts of thatstate belongs to China and Pakistan claims that some of the parts of that

state belongs to Pakistan. So now how does Google decide or any such mappingprovider decides, that how where do they define the country boundaries, right. Now

this becomes very tricky for Google because they cannot take anybody's sideand whichever decision they make they are going to kind of piss off some of

the countries. Plus that's even worse in this scenario because these three countries combined together have more than one third of the world's population.

So that's a very rich source of revenue for Google. So how can you handle? -  so what Google does is something very smart and also very tricky. So what they do is, based

on the country where you are coming from they'll show you a different country boundary. So for people who are coming from India, to all of those people they

show that the whole part belongs to India. Now to the people of Pakistan they show that the part that they are claiming belongs to Pakistan and the

parts that are disputed between India and China are shown as the dotted line. Similarly for people coming from China they show the part that China claims is

theirs they show under China's territory and remaining disputed area between India and Pakistan is shown as a dotted line with no country boundary

specified. So this is something if if you come across this kind of the thing in aninterview could try to replicate but keep this out of the scope of the

interview at least, but still something good to know.  ^uIwvI3nh

# Embedded files
5f1056ba6b9a2c7f49e9d87d78593a1c35fde570: [[Pasted Image 20240607145627_747.png]]
e09329139f145a7f88a95908eafe2a793954be20: [[Pasted Image 20240607180625_377.png]]
8bd607c2ffe6097d130a0ecf9357bb2ffe3f3b95: [[Pasted Image 20240607180641_377.png]]
01038622d7310d09334aacf6b0b440a7d19de487: [[Pasted Image 20240607183331_383.png]]
7260455284a033b99861ee1622f2e9497de365c0: [[Pasted Image 20240607183738_001.png]]
3372d8a497d5fbd694405bb4cfcb847d686f7da4: [[Pasted Image 20240608100613_341.png]]
342aac54a4f3b8786bb876ee31445c3eb57a2068: [[Pasted Image 20240608102439_934.png]]
ab7fbd7e160c7216f5704f6bd1f6f7b43eaebd10: [[Pasted Image 20240608115954_340.png]]
91ab27c387504acea080612c47918f652eae3403: [[Pasted Image 20240608121205_343.png]]
5de2d05313beec61e0728b25c5f33d61d95167cd: [[Pasted Image 20240608134854_406.png]]
a1645b54dd28643e4706b2f39757923fde37e46d: [[Pasted Image 20240608142558_821.png]]
49a8da992758b9bdc0f8fd3fa7bed331342b3440: [[Pasted Image 20240608143657_339.png]]
5fde8a31dc23ccdd82f452e0a91b18fe4e260996: [[Pasted Image 20240608165811_441.png]]
553bf6185f9a3f51d39b203f59a8469e29767884: [[Pasted Image 20240608165842_436.png]]
07d911de136c5ed5288e016d6abdd377ace5a046: [[Pasted Image 20240608170110_440.png]]
a51cd2e9e27bb25effa8f3e63871fb32431bc107: [[Pasted Image 20240609095010_934.png]]
86f97602d9fa36226a2ae2fa5aed908113694349: [[Pasted Image 20240609110058_429.png]]
aa335dbc519481f82eb45ec0644f3ba75319d7ae: [[Pasted Image 20240609110804_434.png]]
c821b812d974068ae07d16bdb3a0c3186f1c28bf: [[Pasted Image 20240609112637_442.png]]
6750b87a45dcdcd4a4658d29857798a82be8c772: [[Pasted Image 20240609113537_441.png]]
8324497ac137c0afcafcca5f6a22f00634a79092: [[Pasted Image 20240609125750_103.png]]
7607f8c4c94fd1f870e7e138b6b46b8d38c7ec66: [[Pasted Image 20240609130310_439.png]]
59870602d9b0a55262c906f1e9ea6046819ea48e: [[Pasted Image 20240609131432_433.png]]
12012894797097ff86ae0f99cc1595a0a433bf8d: [[Pasted Image 20240609131910_431.png]]
cdfd687cd2ee6e0338809e73343d6e2a300867b7: [[Pasted Image 20240609132411_432.png]]
020ec1b001018c0f21f991f2e64cf6aeb823f93c: [[Pasted Image 20240610123150_107.png]]
9fad32f3bbb62a0bbca2ad026cb6906ba9604cb6: [[Pasted Image 20240610130336_169.png]]
76f92a4e37096e5fe9b8fc57f374365df5a71e94: [[Pasted Image 20240610180227_207.png]]
63ba5bffe509f9268fa4d1172fb21eb974cece29: [[Pasted Image 20240610180258_217.png]]
eeca2afad21f4895852ec17ce15fdb2443987bbd: [[Pasted Image 20240610180329_215.png]]
bb8d7a4a4796634a1a9c93ca0ca0374fb891e1b8: [[Pasted Image 20240610180400_213.png]]
c7e0c3405bc1ef38b40ef939199f34610208d1c8: [[Pasted Image 20240610180447_215.png]]
6fda8365b4b99a6ba01f69995e6adadedbc5dde9: [[Pasted Image 20240610182052_224.png]]
ef1076a542272126d3ce250d7f775c1317a4f872: [[Pasted Image 20240610182213_251.png]]
972dac4143327cd1bc33c8b761184ecc3d6baf98: [[Pasted Image 20240610182615_205.png]]
29d54a4fbc7c9206f7b3ee8fbde6d4a659ac8354: [[Pasted Image 20240610183140_672.png]]
7826b94a5e86cdd1e50404173cdae4c10498bb4a: [[Pasted Image 20240611141527_468.png]]
e258017b2d0fdc8ee943cc0b320a916ad71d2f35: [[Pasted Image 20240611141856_471.png]]
c3670fef905c01a0436178b1de5e8cc31d54c79c: [[Pasted Image 20240611150921_462.png]]
563b2ddb3b60aca3352945b7b44a0994021b1060: [[Pasted Image 20240611153300_085.png]]
4b3d6df109cbef0729335bc7b0f05c6efff0649b: [[Pasted Image 20240611161033_458.png]]
408f32e9287da6ef7b445bb5738c78e26d1d653d: [[Pasted Image 20240611194839_886.png]]
3851bec2a79b14494e2963f692f3292263900a91: [[Pasted Image 20240612084016_316.png]]
9730d6e75c6b7791934ae691d0dd422c256d5954: [[Pasted Image 20240612084650_047.png]]
db9311c325b7a5e103a5b0f0b34d7609400609a5: [[Pasted Image 20240612085732_314.png]]
1173ec89fb3aa9e68239fc5df57953dbe8bb3361: [[Pasted Image 20240612093336_328.png]]
873dd5f38896490492477fdee6d5871249189540: [[Pasted Image 20240612094847_309.png]]
90691b2f1307bae06a16df11b18248c610fd0d4f: [[Pasted Image 20240613183622_136.png]]
c18e296ea95154a898ceef8e623f2ca0d7dd8838: [[Pasted Image 20240613184007_133.png]]
9ee611bfa5007dc397a4b6fbc3d9fce11d523023: [[Pasted Image 20240613184927_106.png]]
9a9b187322d23803d1a00c7012a62d31bce8b120: [[Pasted Image 20240613192823_111.png]]
9cfc4549be808a2fe4899386af6dde183ec8de6f: [[Pasted Image 20240613200005_139.png]]
d5697fedd9830321acefb57f3e47510db401897f: [[Pasted Image 20240613201219_134.png]]
f3b39384feac3fee384fd87edfb26fce45a0d034: [[Pasted Image 20240613201323_108.png]]
34e5234ab65deb3906a849d234fc864a74f9ecee: [[Pasted Image 20240613201339_115.png]]
67e3f9705a6a3fb0e46cdb1d8bba459851b42f39: [[Pasted Image 20240613201355_109.png]]
827bda7cc58028264f9b5a17244cdb50ad9f2ae0: [[Pasted Image 20240613201427_112.png]]
194f7c6037246ba3202dcc17c5b0180b77ccf07c: [[Pasted Image 20240613201622_107.png]]
549351481f525fd919e9ca273ca170e6d6f0e50e: [[Pasted Image 20240614175750_751.png]]
71bc4072dd17380eecfe3e0b76211dd63ca3747e: [[Pasted Image 20240614180032_363.png]]
98db28127419166f1020c7589caa4fbe9bffc41f: [[Pasted Image 20240614180311_377.png]]
0884b62eec78e164990ca51806bb6d8f55237d5d: [[Pasted Image 20240614181141_299.png]]
88ca3ee87a6edabf3c877975e84585c8a2483bcf: [[Pasted Image 20240614182703_384.png]]
345d0655d876501dfda5772b281ac2c533be9f5c: [[Pasted Image 20240614184424_380.png]]
c01a4d619d82f34510090ec815aa296e688c1726: [[Pasted Image 20240614184542_359.png]]
2335b3be87ba5264142a34752f5b04a7271f17f8: [[Pasted Image 20240614185138_364.png]]
c4bfc9c79da4c950f1ff74c64787e9343e792136: [[Pasted Image 20240615100210_657.png]]
6143fc669f356267e04dc77a23ad2235aeaaa52e: [[Pasted Image 20240615100813_717.png]]
72cb5c325198512c48e4e83e10a10e6c28016544: [[Pasted Image 20240616143307_134.png]]
25193ec4a733878333fa0d7a90b4c0dd3443939d: [[Pasted Image 20240616143655_100.png]]
037d2d2d634b19f31e74cc578148046b396f9475: [[Pasted Image 20240616145806_086.png]]
09d6bda0215c9532f4dfedc2d3730ccc7e61b7e6: [[Pasted Image 20240616145822_109.png]]
9d101771299a99146400d583cc9004a8c03c9843: [[Pasted Image 20240616154427_122.png]]
f225c067dd2478ee07e414a6815205530bd1cc19: [[Pasted Image 20240616154600_102.png]]
fd2b74ccf6d6396606fdce0bcf611371627ae05d: [[Pasted Image 20240616154751_081.png]]
c7d4b696a6229f049fe0e3fca18e2b7199ce1b58: [[Pasted Image 20240616154857_852.png]]
18cc4074157ff008d62aa03731d04530a52b401e: [[Pasted Image 20240618120538_168.png]]
3a8b823b87bb195a9f4eec9206613525256cd793: [[Pasted Image 20240618122114_158.png]]

%%
# Drawing
```json
{
	"type": "excalidraw",
	"version": 2,
	"source": "https://github.com/zsviczian/obsidian-excalidraw-plugin/releases/tag/2.1.1",
	"elements": [
		{
			"type": "text",
			"version": 249,
			"versionNonce": 1475944192,
			"isDeleted": false,
			"id": "BOB6VUHt",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -409.9999694824219,
			"y": -211.03748321533203,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 337.5,
			"height": 172.79999999999998,
			"seed": 229956026,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "URL SHORTENER\n\nSDFC APPROACH\n\nFR\n\nget short url for a given long url\nredirect to long url given short url\n(analytics on clicked links)",
			"rawText": "URL SHORTENER\n\nSDFC APPROACH\n\nFR\n\nget short url for a given long url\nredirect to long url given short url\n(analytics on clicked links)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "URL SHORTENER\n\nSDFC APPROACH\n\nFR\n\nget short url for a given long url\nredirect to long url given short url\n(analytics on clicked links)",
			"lineHeight": 1.2
		},
		{
			"type": "line",
			"version": 209,
			"versionNonce": 384585984,
			"isDeleted": false,
			"id": "qThx1HazEWHbijAsX1QJ3",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -58.79998779296875,
			"y": -140.6374740600586,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 0.7999267578125,
			"height": 148.80001831054688,
			"seed": 1937820838,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.7999267578125,
					148.80001831054688
				]
			]
		},
		{
			"type": "text",
			"version": 245,
			"versionNonce": 1501380352,
			"isDeleted": false,
			"id": "tSzTyTwH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -32.39996337890625,
			"y": -134.23751068115234,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 553.125,
			"height": 172.79999999999998,
			"seed": 1498558906,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "NFR\n\nlow latency\nhigh availability\nscalable\neventual consistency (since we are not using links directly\nafter generating)\n\n",
			"rawText": "NFR\n\nlow latency\nhigh availability\nscalable\neventual consistency (since we are not using links directly\nafter generating)\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nlow latency\nhigh availability\nscalable\neventual consistency (since we are not using links directly\nafter generating)\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 75,
			"versionNonce": 2000302336,
			"isDeleted": false,
			"id": "oLlsATblZPV7zmtusKlpP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -423.6000061035156,
			"y": -221.43749237060547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 160.00003051757812,
			"height": 43.20001220703125,
			"seed": 1345791974,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 66,
			"versionNonce": 1434279680,
			"isDeleted": false,
			"id": "PMTPlEtl05fSUH64g0Sto",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -414,
			"y": -145.43749237060547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 131.20001220703125,
			"height": 1.600006103515625,
			"seed": 337263802,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					131.20001220703125,
					-1.600006103515625
				]
			]
		},
		{
			"type": "line",
			"version": 139,
			"versionNonce": 1389105408,
			"isDeleted": false,
			"id": "d1YRXU4l1jvOKYZu48xVC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -413.1999816894531,
			"y": -139.83748626708984,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 130.39999389648438,
			"height": 1.600006103515625,
			"seed": 768293926,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					130.39999389648438,
					-1.600006103515625
				]
			]
		},
		{
			"type": "text",
			"version": 156,
			"versionNonce": 477724416,
			"isDeleted": false,
			"id": "pH13iop9",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -416.3999938964844,
			"y": 59.36249542236328,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 253.125,
			"height": 115.19999999999999,
			"seed": 1837173862,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Numbers\n\n10M links shortened per day\n100:1 read to write ratio\n1kb avg long url size\n",
			"rawText": "Numbers\n\n10M links shortened per day\n100:1 read to write ratio\n1kb avg long url size\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Numbers\n\n10M links shortened per day\n100:1 read to write ratio\n1kb avg long url size\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 223,
			"versionNonce": 555872512,
			"isDeleted": false,
			"id": "kvlTjTSt",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -413.1999816894531,
			"y": 208.16251373291016,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 468.75,
			"height": 115.19999999999999,
			"seed": 443334202,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "estimation\n\nwrite qps = 10M/100K = 100 links generated per sec\nread qps = 100*100 = 10,000 links clicks per sec\n\n",
			"rawText": "estimation\n\nwrite qps = 10M/100K = 100 links generated per sec\nread qps = 100*100 = 10,000 links clicks per sec\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "estimation\n\nwrite qps = 10M/100K = 100 links generated per sec\nread qps = 100*100 = 10,000 links clicks per sec\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 287,
			"versionNonce": 1861328640,
			"isDeleted": false,
			"id": "EpQrdLEI",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 222,
			"y": 64.16251373291016,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 346.875,
			"height": 345.59999999999997,
			"seed": 339139258,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "api design\n\nPOST /shortenLink\nrequest\n{\nlongUrl: https://youtube.com\n}\nresponse\n{\nshortUrl: https://tinyurl.com/defabcf\n}\n\n\nGET tinyurl.com/defabcf\nin headers\nlongUrl: https://youtube.com\n\n",
			"rawText": "api design\n\nPOST /shortenLink\nrequest\n{\nlongUrl: https://youtube.com\n}\nresponse\n{\nshortUrl: https://tinyurl.com/defabcf\n}\n\n\nGET tinyurl.com/defabcf\nin headers\nlongUrl: https://youtube.com\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "api design\n\nPOST /shortenLink\nrequest\n{\nlongUrl: https://youtube.com\n}\nresponse\n{\nshortUrl: https://tinyurl.com/defabcf\n}\n\n\nGET tinyurl.com/defabcf\nin headers\nlongUrl: https://youtube.com\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1469,
			"versionNonce": 1773916416,
			"isDeleted": false,
			"id": "9W5zCunmZ73mDngdiyK72",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -436.4507623271379,
			"y": 755.4422959948106,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1988519290,
			"groupIds": [
				"DO1yP4nmRyzGIY2s4c5o9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "ILjQyPaa"
				}
			],
			"updated": 1718371996498,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 62,
			"versionNonce": 2103820032,
			"isDeleted": false,
			"id": "ILjQyPaa",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -406.5227532019975,
			"y": 795.1471471933218,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 578806202,
			"groupIds": [
				"DO1yP4nmRyzGIY2s4c5o9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996498,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "9W5zCunmZ73mDngdiyK72",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1535,
			"versionNonce": 1142534400,
			"isDeleted": false,
			"id": "JjsY1yV3LSAkZpQKKPpLV",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -425.6815315579072,
			"y": 1016.6153564853453,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1314751462,
			"groupIds": [
				"6I8MbTPMdCf08EyQhrW-B"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "uLpiL6pF"
				}
			],
			"updated": 1718371996498,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 97,
			"versionNonce": 1750458112,
			"isDeleted": false,
			"id": "uLpiL6pF",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -395.7535224327668,
			"y": 1056.3202076838563,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1067355558,
			"groupIds": [
				"6I8MbTPMdCf08EyQhrW-B"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "JjsY1yV3LSAkZpQKKPpLV",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1580,
			"versionNonce": 1471910144,
			"isDeleted": false,
			"id": "_5uh6j_FtgBmelNfuJKdP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -150.604580310912,
			"y": 746.7692120292159,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1111097082,
			"groupIds": [
				"z1D2mJLaBrkuF9od5HEDK"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1625,
			"versionNonce": 1078066944,
			"isDeleted": false,
			"id": "ed8lp6NK8IIYMP-7YLQfh",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -139.5276619290011,
			"y": 758.1537710736866,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 598758438,
			"groupIds": [
				"QMl2aKS9BvvIoB1hiCuKB"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "-g0RvmQm-MqAKIpVHlEmU",
					"type": "arrow"
				},
				{
					"id": "v8ZDgTfPan86X6k4fpWli",
					"type": "arrow"
				},
				{
					"id": "pY2YEnLrIRnFA_5cV9R7h",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1624,
			"versionNonce": 1545695488,
			"isDeleted": false,
			"id": "55tOspojD-Ehguu1scukr",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -124.75844524480613,
			"y": 771.6922138321004,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 460939962,
			"groupIds": [
				"j1BrDSK-2Nk2Oll6ojII_"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "SwokcTBe"
				},
				{
					"id": "xpauOSR5XEMkH0qJB_v2O",
					"type": "arrow"
				},
				{
					"id": "VafhyqDuQqM3uLQladcHE",
					"type": "arrow"
				},
				{
					"id": "wBlJqndMbn6iaipgDECrN",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 152,
			"versionNonce": 95035136,
			"isDeleted": false,
			"id": "SwokcTBe",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -118.2679361196657,
			"y": 792.1970650306115,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 57.599999999999994,
			"seed": 1050999162,
			"groupIds": [
				"j1BrDSK-2Nk2Oll6ojII_"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "link\nshortenin\ng service",
			"rawText": "link shortening service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "55tOspojD-Ehguu1scukr",
			"originalText": "link shortening service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2032,
			"versionNonce": 415977728,
			"isDeleted": false,
			"id": "pKcs08mYtXKaikYpL1UVN",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -265.0812300649828,
			"y": 742.0048809708708,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 1067741990,
			"groupIds": [
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "ZHx6m4BsdXk4f5l96gQ7l",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1851,
			"versionNonce": 688799488,
			"isDeleted": false,
			"id": "YcKT3OuM7l5abuYwdEJ7R",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -236.27194846459471,
			"y": 788.6832799330316,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1983323750,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "NG-Y_UTuZzTYhc1rKcDIa"
				},
				{
					"type": "arrow",
					"id": "JgNk4NomUZOHbV8f5IcdC"
				},
				{
					"id": "fax0MLraGjnTeTcDrkEWD",
					"type": "arrow"
				},
				{
					"id": "-g0RvmQm-MqAKIpVHlEmU",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2159,
			"versionNonce": 1698246912,
			"isDeleted": false,
			"id": "NTvuwzQdPz2M8nucQYx4G",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -260.3602614191209,
			"y": 786.7516499077158,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1943167398,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "fax0MLraGjnTeTcDrkEWD"
				},
				{
					"type": "arrow",
					"id": "NG-Y_UTuZzTYhc1rKcDIa"
				},
				{
					"type": "arrow",
					"id": "JgNk4NomUZOHbV8f5IcdC"
				},
				{
					"id": "BSK2uFP7rEfnLtQ7uVw5i",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2157,
			"versionNonce": 183394048,
			"isDeleted": false,
			"id": "D-sG8WFtbU0s7CBkBig1R",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -235.94348685492966,
			"y": 822.480644347834,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 2074295526,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "JgNk4NomUZOHbV8f5IcdC"
				},
				{
					"id": "pY2YEnLrIRnFA_5cV9R7h",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1873,
			"versionNonce": 686493952,
			"isDeleted": false,
			"id": "En_MbVOmwcD16g_P1Cs5N",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -236.39883106014327,
			"y": 754.2277980165886,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1664528422,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "NG-Y_UTuZzTYhc1rKcDIa"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6093,
			"versionNonce": 2076868352,
			"isDeleted": false,
			"id": "fax0MLraGjnTeTcDrkEWD",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -251.6309066034725,
			"y": 798.9181780659062,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 1182382950,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "NTvuwzQdPz2M8nucQYx4G",
				"focus": 0.24472012017707218,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 4793,
			"versionNonce": 1533079808,
			"isDeleted": false,
			"id": "JgNk4NomUZOHbV8f5IcdC",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -247.63310969021146,
			"y": 792.9120461642074,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 1002004134,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "NTvuwzQdPz2M8nucQYx4G",
				"focus": -0.05630840266131786,
				"gap": 1
			},
			"endBinding": {
				"elementId": "YcKT3OuM7l5abuYwdEJ7R",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 5756,
			"versionNonce": 1008901888,
			"isDeleted": false,
			"id": "NG-Y_UTuZzTYhc1rKcDIa",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -250.61444362856503,
			"y": 787.2652371006477,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 128096742,
			"groupIds": [
				"DTJNYUTooWLcIycga2LY8",
				"-jIt0zrUg85qErz_IyLAl",
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "NTvuwzQdPz2M8nucQYx4G",
				"focus": -0.08869372840675857,
				"gap": 1
			},
			"endBinding": {
				"elementId": "En_MbVOmwcD16g_P1Cs5N",
				"focus": -0.09679793421699488,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 930,
			"versionNonce": 68866304,
			"isDeleted": false,
			"id": "HAm9RN4n",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -262.8456772172745,
			"y": 846.4651277254457,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 1363307814,
			"groupIds": [
				"R9SzEewqLbVd6aryrwulF"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 225,
			"versionNonce": 2088156928,
			"isDeleted": false,
			"id": "BSK2uFP7rEfnLtQ7uVw5i",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -339.15735919658886,
			"y": 800.074072617751,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.84615384615387,
			"height": 0,
			"seed": 456709754,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "NTvuwzQdPz2M8nucQYx4G",
				"focus": -1.229174586275311,
				"gap": 7.2169741525997315
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					73.84615384615387,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 174,
			"versionNonce": 983085312,
			"isDeleted": false,
			"id": "-g0RvmQm-MqAKIpVHlEmU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -217.78787099104295,
			"y": 797.8313214028537,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.33335367838549,
			"height": 2.6666259765625,
			"seed": 243130982,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "YcKT3OuM7l5abuYwdEJ7R",
				"focus": 0.4461754147762542,
				"gap": 6.56556257461149
			},
			"endBinding": {
				"elementId": "ed8lp6NK8IIYMP-7YLQfh",
				"focus": 0.0866852084142509,
				"gap": 12.926855383656338
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					65.33335367838549,
					2.6666259765625
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1634,
			"versionNonce": 1564925696,
			"isDeleted": false,
			"id": "4B2M1DjuAXFznHhQtpGfQ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -144.81724874876357,
			"y": 1003.2034342892136,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 855068730,
			"groupIds": [
				"DTJFG_HnccQFVKDHN1zaB"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1677,
			"versionNonce": 643469568,
			"isDeleted": false,
			"id": "nTZ2OQzjtPecYriR5UfOA",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -133.74033036685267,
			"y": 1014.5879933336844,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1859467514,
			"groupIds": [
				"eJc2j3KAeEXuexw_i5DNd"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "_pnq1VLPv49zYwEtVaPEC",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1677,
			"versionNonce": 1863515904,
			"isDeleted": false,
			"id": "d-GZBw0_YbXyzvbdCvAqK",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -118.97111368265763,
			"y": 1028.1264360920982,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1886915002,
			"groupIds": [
				"l5KsM7CJFxHQ82WYWqCXm"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "rPS0r203"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 228,
			"versionNonce": 2128638208,
			"isDeleted": false,
			"id": "rPS0r203",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -107.79310455751721,
			"y": 1058.2312872906093,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 75,
			"height": 38.4,
			"seed": 2130887290,
			"groupIds": [
				"l5KsM7CJFxHQ82WYWqCXm"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "redirect\nservice",
			"rawText": "redirect service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "d-GZBw0_YbXyzvbdCvAqK",
			"originalText": "redirect service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2085,
			"versionNonce": 844832512,
			"isDeleted": false,
			"id": "dZKrEqipqa0K2Mgij7mZr",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -259.29389850283434,
			"y": 998.4391032308686,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 87581498,
			"groupIds": [
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1905,
			"versionNonce": 195711232,
			"isDeleted": false,
			"id": "K5sJREPpYe-WgmBQ1qfvf",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -230.48461690244625,
			"y": 1045.1175021930296,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 494660602,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "xxyREmPI-MWUhIpVrbfFh"
				},
				{
					"type": "arrow",
					"id": "BNxq8yeCvoCSY2wxqJ0i7"
				},
				{
					"id": "iTHSc4KVbO68YQ2GP123z",
					"type": "arrow"
				},
				{
					"id": "_pnq1VLPv49zYwEtVaPEC",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2214,
			"versionNonce": 396312320,
			"isDeleted": false,
			"id": "gOpI3uSk_xVUMddwVS0RF",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -254.5729298569724,
			"y": 1043.1858721677136,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 500194490,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "iTHSc4KVbO68YQ2GP123z"
				},
				{
					"type": "arrow",
					"id": "xxyREmPI-MWUhIpVrbfFh"
				},
				{
					"type": "arrow",
					"id": "BNxq8yeCvoCSY2wxqJ0i7"
				},
				{
					"id": "f0OyQj1pd4Em0geUHB5M_",
					"type": "arrow"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2210,
			"versionNonce": 607662336,
			"isDeleted": false,
			"id": "hw4HNysXan2WID7o4rA9r",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -230.1561552927812,
			"y": 1078.914866607832,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 601404794,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "BNxq8yeCvoCSY2wxqJ0i7"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1927,
			"versionNonce": 2136956672,
			"isDeleted": false,
			"id": "puAyU7RlcojczFJMsGn6z",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -230.61149949799477,
			"y": 1010.6620202765866,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 551024186,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "xxyREmPI-MWUhIpVrbfFh"
				}
			],
			"updated": 1718371996499,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6200,
			"versionNonce": 805966080,
			"isDeleted": false,
			"id": "iTHSc4KVbO68YQ2GP123z",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -245.84357504132407,
			"y": 1055.3524003259042,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 1706106618,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "gOpI3uSk_xVUMddwVS0RF",
				"focus": 0.2447201201771013,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 4952,
			"versionNonce": 974880512,
			"isDeleted": false,
			"id": "BNxq8yeCvoCSY2wxqJ0i7",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -241.845778128063,
			"y": 1049.3462684242052,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 786902970,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "gOpI3uSk_xVUMddwVS0RF",
				"focus": -0.056308402661317494,
				"gap": 1
			},
			"endBinding": {
				"elementId": "K5sJREPpYe-WgmBQ1qfvf",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 5916,
			"versionNonce": 648016128,
			"isDeleted": false,
			"id": "xxyREmPI-MWUhIpVrbfFh",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -244.82711206641653,
			"y": 1043.6994593606455,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 815605882,
			"groupIds": [
				"PS-f3OUROiRkx48da7_M6",
				"EVLPrOYGAUztRynGlQWb4",
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996499,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "gOpI3uSk_xVUMddwVS0RF",
				"focus": -0.08869372840675857,
				"gap": 1
			},
			"endBinding": {
				"elementId": "puAyU7RlcojczFJMsGn6z",
				"focus": -0.09679793421697189,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 984,
			"versionNonce": 139697920,
			"isDeleted": false,
			"id": "VreSj7Ij",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -257.05834565512606,
			"y": 1102.8993499854435,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 580258106,
			"groupIds": [
				"8iMekuUFgvu9vjiODM-n5"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 334,
			"versionNonce": 259641600,
			"isDeleted": false,
			"id": "_pnq1VLPv49zYwEtVaPEC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -212.00053942889446,
			"y": 1054.2655436628515,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.33335367838549,
			"height": 2.6666259765625,
			"seed": 1278530042,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "K5sJREPpYe-WgmBQ1qfvf",
				"focus": 0.44617541477621603,
				"gap": 6.565562574611456
			},
			"endBinding": {
				"elementId": "nTZ2OQzjtPecYriR5UfOA",
				"focus": 0.0866852084142509,
				"gap": 12.926855383656282
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					65.33335367838549,
					2.6666259765625
				]
			]
		},
		{
			"type": "arrow",
			"version": 278,
			"versionNonce": 445103872,
			"isDeleted": false,
			"id": "f0OyQj1pd4Em0geUHB5M_",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -329.04424055734904,
			"y": 1061.164705598817,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.84615384615387,
			"height": 0,
			"seed": 1792462330,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "gOpI3uSk_xVUMddwVS0RF",
				"focus": -2.008308582289884,
				"gap": 7.768584805169757
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					73.84615384615387,
					0
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1516,
			"versionNonce": 35107072,
			"isDeleted": false,
			"id": "75xGlMVMkDFqbSBgYZwEJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 47.53405884866049,
			"y": 518.5444842452152,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 126.68941261877036,
			"height": 128.32083213463252,
			"seed": 964814758,
			"groupIds": [
				"Cjd1ZSaELyxLPmYW34x2S"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "H43VBIvJ"
				},
				{
					"id": "v8ZDgTfPan86X6k4fpWli",
					"type": "arrow"
				},
				{
					"id": "xpauOSR5XEMkH0qJB_v2O",
					"type": "arrow"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 86,
			"versionNonce": 288874240,
			"isDeleted": false,
			"id": "H43VBIvJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 68.69126515804567,
			"y": 573.1049003125315,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 19.2,
			"seed": 849409786,
			"groupIds": [
				"Cjd1ZSaELyxLPmYW34x2S"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "zookeeper",
			"rawText": "zookeeper",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "75xGlMVMkDFqbSBgYZwEJ",
			"originalText": "zookeeper",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 274,
			"versionNonce": 1457620476,
			"isDeleted": false,
			"id": "v8ZDgTfPan86X6k4fpWli",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -75.12124501448038,
			"y": 741.8312603676974,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 118.66668701171879,
			"height": 128.00003051757824,
			"seed": 544164410,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474263,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "ed8lp6NK8IIYMP-7YLQfh",
				"gap": 16.322510705989203,
				"focus": -0.47796075016574624
			},
			"endBinding": {
				"elementId": "75xGlMVMkDFqbSBgYZwEJ",
				"gap": 3.98861685142208,
				"focus": 0.31325930444454114
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					118.66668701171879,
					-128.00003051757824
				]
			]
		},
		{
			"type": "arrow",
			"version": 482,
			"versionNonce": 1459435260,
			"isDeleted": false,
			"id": "xpauOSR5XEMkH0qJB_v2O",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 51.54542165218622,
			"y": 648.4979270343641,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 102.66662597656253,
			"height": 101.33336385091138,
			"seed": 1583245242,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474263,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "75xGlMVMkDFqbSBgYZwEJ",
				"gap": 1.6326106545164407,
				"focus": -0.05707343039216645
			},
			"endBinding": {
				"elementId": "55tOspojD-Ehguu1scukr",
				"gap": 21.86092294682487,
				"focus": -0.4779694994238978
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-102.66662597656253,
					101.33336385091138
				]
			]
		},
		{
			"type": "text",
			"version": 73,
			"versionNonce": 849309952,
			"isDeleted": false,
			"id": "uAWvQ8NV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 54.21214935400917,
			"y": 477.8312705402235,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 393.75,
			"height": 19.2,
			"seed": 104284646,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "returns a range of available range for use",
			"rawText": "returns a range of available range for use",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "returns a range of available range for use",
			"lineHeight": 1.2
		},
		{
			"type": "line",
			"version": 6065,
			"versionNonce": 1577852672,
			"isDeleted": false,
			"id": "ukm7sRgnENaU3TWtUa0VA",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 107.68266856362479,
			"y": 855.3655487208691,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 105.13790800281912,
			"height": 135.69716172292178,
			"seed": 1379396966,
			"groupIds": [
				"BG7FBBCGFnL50qkfounpN",
				"2NCtNM-68HSBHSbreNcb4",
				"SBSLkTU_0hv2bWjtuOnyl"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.34669082758835834,
					102.55917934137484
				],
				[
					0.016224316861414696,
					114.23509655012347
				],
				[
					5.414834790045288,
					119.28011599552745
				],
				[
					24.215226389708466,
					123.54983602450191
				],
				[
					55.993213732261204,
					124.87936305890467
				],
				[
					86.35497921748812,
					122.75657839475303
				],
				[
					102.48640876858191,
					117.67997726385636
				],
				[
					104.76152862158496,
					113.40034925511858
				],
				[
					105.08106096893086,
					104.0001534552872
				],
				[
					104.83026523118853,
					8.604142704364124
				],
				[
					104.2648911359812,
					-0.4090226359881599
				],
				[
					97.51397678010763,
					-5.446540035239639
				],
				[
					83.29799185081623,
					-8.36400355574524
				],
				[
					50.901682954262775,
					-10.817798664017113
				],
				[
					24.928059512961394,
					-9.354595115766912
				],
				[
					4.49998107259457,
					-4.391587213234938
				],
				[
					-0.056847033888255336,
					-0.06162409555958426
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6785,
			"versionNonce": 1871270144,
			"isDeleted": false,
			"id": "SHHZvc7GYvCXVdQN7sv1a",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 108.05540743698631,
			"y": 843.097133327871,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 104.46353624249109,
			"height": 21.126964293591094,
			"seed": 1424052390,
			"groupIds": [
				"BG7FBBCGFnL50qkfounpN",
				"2NCtNM-68HSBHSbreNcb4",
				"SBSLkTU_0hv2bWjtuOnyl"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 112,
			"versionNonce": 623918848,
			"isDeleted": false,
			"id": "Vi3JxW2b",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -68.45457834781382,
			"y": 668.4979270343641,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 590.625,
			"height": 38.4,
			"seed": 724646458,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "at start of application this call is made to get range or when \nrange is exhausted.",
			"rawText": "at start of application this call is made to get range or when \nrange is exhausted.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "at start of application this call is made to get range or when \nrange is exhausted.",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 159,
			"versionNonce": 1940620412,
			"isDeleted": false,
			"id": "VafhyqDuQqM3uLQladcHE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -19.121183979324087,
			"y": 811.1646038735569,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.33331298828125,
			"height": 62.666727701822765,
			"seed": 1820116218,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474262,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "55tOspojD-Ehguu1scukr",
				"gap": 8.281243015201191,
				"focus": -0.5272394438370172
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					121.33331298828125,
					62.666727701822765
				]
			]
		},
		{
			"type": "arrow",
			"version": 163,
			"versionNonce": 1094554876,
			"isDeleted": false,
			"id": "wBlJqndMbn6iaipgDECrN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 100.87881602067591,
			"y": 905.8312501951714,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 122.66672770182299,
			"height": 66.66666666666674,
			"seed": 114091642,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474262,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "55tOspojD-Ehguu1scukr",
				"gap": 5.614515313378199,
				"focus": -0.14967307292448015
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-122.66672770182299,
					-66.66666666666674
				]
			]
		},
		{
			"type": "text",
			"version": 54,
			"versionNonce": 1747521792,
			"isDeleted": false,
			"id": "rYSlkEXS",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 11.545421652186178,
			"y": 888.4979778969943,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 28.125,
			"height": 19.2,
			"seed": 204630970,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "ack",
			"rawText": "ack",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "ack",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 78,
			"versionNonce": 1466728192,
			"isDeleted": false,
			"id": "pY2YEnLrIRnFA_5cV9R7h",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -160.45449696760545,
			"y": 821.8313112303276,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 58.66668701171875,
			"height": 0,
			"seed": 1001708198,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "ed8lp6NK8IIYMP-7YLQfh",
				"focus": -0.2915065882718629,
				"gap": 20.92683503860433
			},
			"endBinding": {
				"elementId": "D-sG8WFtbU0s7CBkBig1R",
				"focus": -1.1086496739426959,
				"gap": 6.435426874705519
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-58.66668701171875,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 53,
			"versionNonce": 48165120,
			"isDeleted": false,
			"id": "ZHx6m4BsdXk4f5l96gQ7l",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -268.4545783478137,
			"y": 825.8312501951714,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.33333333333337,
			"height": 0,
			"seed": 2078814374,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "pKcs08mYtXKaikYpL1UVN",
				"focus": -0.24385772628600014,
				"gap": 3.373348282830932
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-73.33333333333337,
					0
				]
			]
		},
		{
			"type": "text",
			"version": 152,
			"versionNonce": 1401200384,
			"isDeleted": false,
			"id": "RfXhJHOQ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 271.5454216521862,
			"y": 839.1645835285046,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 346.875,
			"height": 115.19999999999999,
			"seed": 1095232422,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"rawText": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1617,
			"versionNonce": 198758656,
			"isDeleted": false,
			"id": "SWmjjKMGrvdoJDCjR2Y6G",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -431.22352401586136,
			"y": 1496.7461207873994,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 165936358,
			"groupIds": [
				"5JKyiqGgeVlDecarrpS40"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "3cqleQgQ"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 211,
			"versionNonce": 1469628160,
			"isDeleted": false,
			"id": "3cqleQgQ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -401.29551489072094,
			"y": 1536.4509719859104,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1801416742,
			"groupIds": [
				"5JKyiqGgeVlDecarrpS40"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "SWmjjKMGrvdoJDCjR2Y6G",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1702,
			"versionNonce": 446083328,
			"isDeleted": false,
			"id": "4fbin5gAnk2I0bz_xpSVf",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -452.45431359168265,
			"y": 2044.5858479446006,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1267366758,
			"groupIds": [
				"I_2BGi2j15FW-lOSN6DXB"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "OlcTJwZD"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 265,
			"versionNonce": 69787392,
			"isDeleted": false,
			"id": "OlcTJwZD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -422.52630446654223,
			"y": 2084.290699143112,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1622285990,
			"groupIds": [
				"I_2BGi2j15FW-lOSN6DXB"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "4fbin5gAnk2I0bz_xpSVf",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1728,
			"versionNonce": 1452839168,
			"isDeleted": false,
			"id": "JYP09sziB15maoi_hmyl4",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -145.37734199963546,
			"y": 1488.0730368218046,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 260266470,
			"groupIds": [
				"i4v04sVjXmsjGJRiHthB8"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1773,
			"versionNonce": 1773469440,
			"isDeleted": false,
			"id": "FoYr8NCYswd2a9pYJZaPB",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -134.30042361772456,
			"y": 1499.4575958662754,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 520826150,
			"groupIds": [
				"osSthXbkQwhfF2eSg-Okr"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "MtTu_W1r5M4bpysJX7zFE",
					"type": "arrow"
				},
				{
					"id": "78gPQkwR0TmUefBsuEG5X",
					"type": "arrow"
				},
				{
					"id": "pxELL8dnOAbWP9bwc5mDP",
					"type": "arrow"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1773,
			"versionNonce": 2002678016,
			"isDeleted": false,
			"id": "8yLS5Tq4sKIeR_eqqEN8e",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -119.53120693352957,
			"y": 1512.996038624689,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1823905894,
			"groupIds": [
				"trNFCsRtwKaPnGYSsdyup"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "eaDDsykY"
				},
				{
					"id": "XK_9EG3z3p-UNTSd_eKsn",
					"type": "arrow"
				},
				{
					"id": "1lEAjOmF8sIhcIQgmKlzX",
					"type": "arrow"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 301,
			"versionNonce": 146611968,
			"isDeleted": false,
			"id": "eaDDsykY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -113.04069780838915,
			"y": 1533.5008898232002,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 57.599999999999994,
			"seed": 542284710,
			"groupIds": [
				"trNFCsRtwKaPnGYSsdyup"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996500,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "link\nshortenin\ng service",
			"rawText": "link shortening service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "8yLS5Tq4sKIeR_eqqEN8e",
			"originalText": "link shortening service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2180,
			"versionNonce": 1147687168,
			"isDeleted": false,
			"id": "TGKSBn4TlDW2mU2o3mqCQ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -259.8539917537062,
			"y": 1483.3087057634593,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 1611413222,
			"groupIds": [
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "bve4IcTYFlEVpyfRCpchl",
					"type": "arrow"
				}
			],
			"updated": 1718371996500,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1999,
			"versionNonce": 1371619072,
			"isDeleted": false,
			"id": "gKiAFBUTEjFqaluqkw34l",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -231.0447101533182,
			"y": 1529.9871047256202,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 74476070,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "hkidYnCOIimEqyUHpzqke"
				},
				{
					"type": "arrow",
					"id": "mJ0_mMKEUmPuO7j3mMpYy"
				},
				{
					"id": "JPlJR3gM7S_ZJ5jY91eh9",
					"type": "arrow"
				},
				{
					"id": "MtTu_W1r5M4bpysJX7zFE",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2307,
			"versionNonce": 355873024,
			"isDeleted": false,
			"id": "Xca6hOhcM0_1sOgp3WPkX",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -255.13302310784434,
			"y": 1528.0554747003043,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1282159974,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "JPlJR3gM7S_ZJ5jY91eh9"
				},
				{
					"type": "arrow",
					"id": "hkidYnCOIimEqyUHpzqke"
				},
				{
					"type": "arrow",
					"id": "mJ0_mMKEUmPuO7j3mMpYy"
				},
				{
					"id": "IcVWs5eWZUMFCB_itn-Ow",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2305,
			"versionNonce": 625041152,
			"isDeleted": false,
			"id": "_H2H_CTj8xDqpVH9NUNxD",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -230.71624854365314,
			"y": 1563.7844691404225,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 290232486,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "mJ0_mMKEUmPuO7j3mMpYy"
				},
				{
					"id": "pxELL8dnOAbWP9bwc5mDP",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2021,
			"versionNonce": 1363677440,
			"isDeleted": false,
			"id": "iwb8GMk2IEyPIzu7JIF9t",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -231.17159274886671,
			"y": 1495.5316228091774,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 2059310054,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "hkidYnCOIimEqyUHpzqke"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6388,
			"versionNonce": 1404927744,
			"isDeleted": false,
			"id": "JPlJR3gM7S_ZJ5jY91eh9",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -246.40366829219596,
			"y": 1540.2220028584948,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 852436774,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Xca6hOhcM0_1sOgp3WPkX",
				"focus": 0.24472012017707218,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5234,
			"versionNonce": 1881010432,
			"isDeleted": false,
			"id": "mJ0_mMKEUmPuO7j3mMpYy",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -242.40587137893488,
			"y": 1534.2158709567962,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 434852454,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Xca6hOhcM0_1sOgp3WPkX",
				"focus": -0.05630840266128033,
				"gap": 1
			},
			"endBinding": {
				"elementId": "gKiAFBUTEjFqaluqkw34l",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6198,
			"versionNonce": 498441984,
			"isDeleted": false,
			"id": "hkidYnCOIimEqyUHpzqke",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -245.38720531728848,
			"y": 1528.5690618932363,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 2061505958,
			"groupIds": [
				"z5lwt-QGQj4zOY4NI7TzZ",
				"WAzIarytdH82INIdKDzB9",
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Xca6hOhcM0_1sOgp3WPkX",
				"focus": -0.08869372840675857,
				"gap": 1
			},
			"endBinding": {
				"elementId": "iwb8GMk2IEyPIzu7JIF9t",
				"focus": -0.09679793421697189,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1078,
			"versionNonce": 2033701120,
			"isDeleted": false,
			"id": "59OHqULq",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -257.61843890599795,
			"y": 1587.7689525180344,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 1054503142,
			"groupIds": [
				"X00yTHoO76Mt5_Nc7vX-E"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 520,
			"versionNonce": 866762496,
			"isDeleted": false,
			"id": "IcVWs5eWZUMFCB_itn-Ow",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -333.9301208853123,
			"y": 1541.3778974103398,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.84615384615387,
			"height": 0,
			"seed": 560423974,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "Xca6hOhcM0_1sOgp3WPkX",
				"focus": -1.2291745862753491,
				"gap": 7.21697415259986
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					73.84615384615387,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 616,
			"versionNonce": 68530432,
			"isDeleted": false,
			"id": "MtTu_W1r5M4bpysJX7zFE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -212.5606326797664,
			"y": 1539.1351461954423,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.33335367838549,
			"height": 2.6666259765625,
			"seed": 1685319526,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "gKiAFBUTEjFqaluqkw34l",
				"focus": 0.446175414776254,
				"gap": 6.565562574611515
			},
			"endBinding": {
				"elementId": "FoYr8NCYswd2a9pYJZaPB",
				"focus": 0.08668520841425531,
				"gap": 12.926855383656338
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					65.33335367838549,
					2.6666259765625
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1801,
			"versionNonce": 907665152,
			"isDeleted": false,
			"id": "t_ZL4LFbQDRh0eGfQBaTh",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -171.59003078253903,
			"y": 2031.173925748469,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 72159910,
			"groupIds": [
				"Zu_3nZ_sPmR45xTngHQTP"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "HGaA4O2OF30zf15etNqiL",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1843,
			"versionNonce": 943165696,
			"isDeleted": false,
			"id": "AjqyJ9DYBPrEkRshiFV1R",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -160.51311240062813,
			"y": 2042.5584847929397,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1805635046,
			"groupIds": [
				"ZPpVDFsS7zf3s_HpbBQAV"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "0XQYsxvouEkwG5IxJjv00",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1845,
			"versionNonce": 897974016,
			"isDeleted": false,
			"id": "Puu55YxvGYUSIMyWBp3eg",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -145.74389571643303,
			"y": 2056.0969275513535,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 662249766,
			"groupIds": [
				"Qmivy3Dmn4sKt10TsIUh0"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "9dPY36EE"
				},
				{
					"id": "e0sCDEObF-WqLoORJcKXp",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 397,
			"versionNonce": 1293775104,
			"isDeleted": false,
			"id": "9dPY36EE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -134.5658865912926,
			"y": 2086.201778749865,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 75,
			"height": 38.4,
			"seed": 457575526,
			"groupIds": [
				"Qmivy3Dmn4sKt10TsIUh0"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "redirect\nservice",
			"rawText": "redirect service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "Puu55YxvGYUSIMyWBp3eg",
			"originalText": "redirect service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2251,
			"versionNonce": 846077696,
			"isDeleted": false,
			"id": "zodoa9VI6yi6SCj6jhEdl",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -286.0666805366098,
			"y": 2026.409594690124,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 886280102,
			"groupIds": [
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2071,
			"versionNonce": 172445952,
			"isDeleted": false,
			"id": "IrPSqE6HQdPnDTM6CDKMp",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -257.2573989362217,
			"y": 2073.087993652285,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 542026470,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "g-ZU69huu0OiAPqcDD6WN"
				},
				{
					"type": "arrow",
					"id": "Kvq9Dj3HP81yAu817FlvB"
				},
				{
					"id": "zvBr4p8V5b3NqWvetn5Uy",
					"type": "arrow"
				},
				{
					"id": "0XQYsxvouEkwG5IxJjv00",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2380,
			"versionNonce": 491929344,
			"isDeleted": false,
			"id": "2nKi6XqykUgpn6fy24Pdl",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -281.34571189074785,
			"y": 2071.1563636269693,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 2084855334,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "zvBr4p8V5b3NqWvetn5Uy"
				},
				{
					"type": "arrow",
					"id": "g-ZU69huu0OiAPqcDD6WN"
				},
				{
					"type": "arrow",
					"id": "Kvq9Dj3HP81yAu817FlvB"
				},
				{
					"id": "fwXMjSpR4209MZ-LVlITr",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2376,
			"versionNonce": 1194668288,
			"isDeleted": false,
			"id": "F0fhIU2Y3iShA7pWrh7KN",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -256.92893732655665,
			"y": 2106.8853580670875,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 228698470,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "Kvq9Dj3HP81yAu817FlvB"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2093,
			"versionNonce": 1454530304,
			"isDeleted": false,
			"id": "aGNHdMR0K4yY8PvAf2yuP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -257.3842815317702,
			"y": 2038.6325117358422,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1941146790,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "g-ZU69huu0OiAPqcDD6WN"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6532,
			"versionNonce": 1801916672,
			"isDeleted": false,
			"id": "zvBr4p8V5b3NqWvetn5Uy",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -272.61635707509953,
			"y": 2083.3228917851593,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 1546061798,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "2nKi6XqykUgpn6fy24Pdl",
				"focus": 0.24472012017703654,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5448,
			"versionNonce": 789479168,
			"isDeleted": false,
			"id": "Kvq9Dj3HP81yAu817FlvB",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -268.61856016183845,
			"y": 2077.3167598834607,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 923343654,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "2nKi6XqykUgpn6fy24Pdl",
				"focus": -0.05630840266135519,
				"gap": 1
			},
			"endBinding": {
				"elementId": "IrPSqE6HQdPnDTM6CDKMp",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6414,
			"versionNonce": 1851584768,
			"isDeleted": false,
			"id": "g-ZU69huu0OiAPqcDD6WN",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -271.599894100192,
			"y": 2071.669950819901,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 1791411814,
			"groupIds": [
				"I-aNuXA_9KViBIH2oLQes",
				"vklJgTNSlSB9lAdnhp6QU",
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "2nKi6XqykUgpn6fy24Pdl",
				"focus": -0.08869372840680442,
				"gap": 1
			},
			"endBinding": {
				"elementId": "aGNHdMR0K4yY8PvAf2yuP",
				"focus": -0.09679793421697189,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1150,
			"versionNonce": 1726390016,
			"isDeleted": false,
			"id": "qgD143KI",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -283.8311276889015,
			"y": 2130.869841444699,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 137169318,
			"groupIds": [
				"xP4HifJonBfitCY5jHfAZ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 832,
			"versionNonce": 1469501696,
			"isDeleted": false,
			"id": "0XQYsxvouEkwG5IxJjv00",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -238.7733214626699,
			"y": 2082.236035122107,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.33335367838549,
			"height": 2.6666259765625,
			"seed": 2120803558,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "IrPSqE6HQdPnDTM6CDKMp",
				"focus": 0.44617541477617795,
				"gap": 6.565562574611399
			},
			"endBinding": {
				"elementId": "AjqyJ9DYBPrEkRshiFV1R",
				"focus": 0.0866852084142465,
				"gap": 12.926855383656282
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					65.33335367838549,
					2.6666259765625
				]
			]
		},
		{
			"type": "arrow",
			"version": 610,
			"versionNonce": 783990528,
			"isDeleted": false,
			"id": "fwXMjSpR4209MZ-LVlITr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -355.8170225911245,
			"y": 2089.1351970580727,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.84615384615387,
			"height": 0,
			"seed": 1325881382,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "2nKi6XqykUgpn6fy24Pdl",
				"focus": -2.008308582289884,
				"gap": 7.768584805169757
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					73.84615384615387,
					0
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1665,
			"versionNonce": 1049932032,
			"isDeleted": false,
			"id": "Zdw2HsOHuWQP46QfyuqMf",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 52.761297159937044,
			"y": 1259.848309037804,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 126.68941261877036,
			"height": 128.32083213463252,
			"seed": 1106600806,
			"groupIds": [
				"8qm6ul2zpNIcgR_sjUG2o"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "vn3qKzWI"
				},
				{
					"id": "78gPQkwR0TmUefBsuEG5X",
					"type": "arrow"
				},
				{
					"id": "XK_9EG3z3p-UNTSd_eKsn",
					"type": "arrow"
				}
			],
			"updated": 1718371996501,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 236,
			"versionNonce": 655023872,
			"isDeleted": false,
			"id": "vn3qKzWI",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 73.91850346932222,
			"y": 1314.4087251051203,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 19.2,
			"seed": 427820710,
			"groupIds": [
				"8qm6ul2zpNIcgR_sjUG2o"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996501,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "zookeeper",
			"rawText": "zookeeper",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "Zdw2HsOHuWQP46QfyuqMf",
			"originalText": "zookeeper",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 716,
			"versionNonce": 986458748,
			"isDeleted": false,
			"id": "78gPQkwR0TmUefBsuEG5X",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -69.89400670320387,
			"y": 1483.135085160286,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 118.66668701171884,
			"height": 128.00003051757812,
			"seed": 1179927014,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474264,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "FoYr8NCYswd2a9pYJZaPB",
				"gap": 16.322510705989316,
				"focus": -0.4779607501657483
			},
			"endBinding": {
				"elementId": "Zdw2HsOHuWQP46QfyuqMf",
				"gap": 3.98861685142208,
				"focus": 0.31325930444454364
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					118.66668701171884,
					-128.00003051757812
				]
			]
		},
		{
			"type": "arrow",
			"version": 924,
			"versionNonce": 1793637244,
			"isDeleted": false,
			"id": "XK_9EG3z3p-UNTSd_eKsn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 56.7726599634627,
			"y": 1389.801751826953,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 102.66662597656261,
			"height": 101.33336385091116,
			"seed": 461313318,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474264,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Zdw2HsOHuWQP46QfyuqMf",
				"gap": 1.6326106545162702,
				"focus": -0.05707343039216553
			},
			"endBinding": {
				"elementId": "8yLS5Tq4sKIeR_eqqEN8e",
				"gap": 21.860922946824758,
				"focus": -0.4779694994238978
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-102.66662597656261,
					101.33336385091116
				]
			]
		},
		{
			"type": "text",
			"version": 221,
			"versionNonce": 870084864,
			"isDeleted": false,
			"id": "qdvFfgGD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 59.43938766528572,
			"y": 1219.135095332812,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 393.75,
			"height": 19.2,
			"seed": 40730726,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "returns a range of available range for use",
			"rawText": "returns a range of available range for use",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "returns a range of available range for use",
			"lineHeight": 1.2
		},
		{
			"type": "line",
			"version": 6345,
			"versionNonce": 1528766208,
			"isDeleted": false,
			"id": "skATiW4fjCuvrGq0k7FoL",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 704.9099272199533,
			"y": 1748.6693429958793,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 105.13790800281912,
			"height": 135.69716172292178,
			"seed": 787252134,
			"groupIds": [
				"Li1s5DXOaBGPuQFzGjIhD",
				"I7jVdHhrr2fKrh4LVTHss",
				"SiPUekGxMxwBt_MoGgG8A"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.34669082758835834,
					102.55917934137484
				],
				[
					0.016224316861414696,
					114.23509655012347
				],
				[
					5.414834790045288,
					119.28011599552745
				],
				[
					24.215226389708466,
					123.54983602450191
				],
				[
					55.993213732261204,
					124.87936305890467
				],
				[
					86.35497921748812,
					122.75657839475303
				],
				[
					102.48640876858191,
					117.67997726385636
				],
				[
					104.76152862158496,
					113.40034925511858
				],
				[
					105.08106096893086,
					104.0001534552872
				],
				[
					104.83026523118853,
					8.604142704364124
				],
				[
					104.2648911359812,
					-0.4090226359881599
				],
				[
					97.51397678010763,
					-5.446540035239639
				],
				[
					83.29799185081623,
					-8.36400355574524
				],
				[
					50.901682954262775,
					-10.817798664017113
				],
				[
					24.928059512961394,
					-9.354595115766912
				],
				[
					4.49998107259457,
					-4.391587213234938
				],
				[
					-0.056847033888255336,
					-0.06162409555958426
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 7067,
			"versionNonce": 1093030144,
			"isDeleted": false,
			"id": "BwzRRQs6ujahvJQLg7cE_",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 705.2826660933149,
			"y": 1736.4009276028812,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 104.46353624249109,
			"height": 21.126964293591094,
			"seed": 1395203814,
			"groupIds": [
				"Li1s5DXOaBGPuQFzGjIhD",
				"I7jVdHhrr2fKrh4LVTHss",
				"SiPUekGxMxwBt_MoGgG8A"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "fXJv_goLrjn5CZjR6kNkE",
					"type": "arrow"
				},
				{
					"id": "bqUG6O1FNMXmFStVyg2on",
					"type": "arrow"
				}
			],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 260,
			"versionNonce": 132333312,
			"isDeleted": false,
			"id": "D1c9x0vZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -63.22734003653727,
			"y": 1409.8017518269526,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 590.625,
			"height": 38.4,
			"seed": 1404064294,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "at start of application this call is made to get range or when \nrange is exhausted.",
			"rawText": "at start of application this call is made to get range or when \nrange is exhausted.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "at start of application this call is made to get range or when \nrange is exhausted.",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 497,
			"versionNonce": 1623345276,
			"isDeleted": false,
			"id": "1lEAjOmF8sIhcIQgmKlzX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -13.893945668047536,
			"y": 1547.9570901813524,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.33331298828125,
			"height": 45.17549463992236,
			"seed": 2070879590,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474263,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "8yLS5Tq4sKIeR_eqqEN8e",
				"gap": 8.281243015201191,
				"focus": -0.5272394438370154
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					121.33331298828125,
					45.17549463992236
				]
			]
		},
		{
			"type": "arrow",
			"version": 1197,
			"versionNonce": 2010451068,
			"isDeleted": false,
			"id": "fXJv_goLrjn5CZjR6kNkE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 487.784109964732,
			"y": 1637.9158045937502,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 226.04181029242739,
			"height": 102.06965871253715,
			"seed": 800227494,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474264,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "GihMFXnR99nX9d4JtI0tw",
				"gap": 2.2273763716505073,
				"focus": 0.1023507245679943
			},
			"endBinding": {
				"elementId": "BwzRRQs6ujahvJQLg7cE_",
				"gap": 1.4477143866408593,
				"focus": -0.4933147486515935
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					226.04181029242739,
					102.06965871253715
				]
			]
		},
		{
			"type": "text",
			"version": 346,
			"versionNonce": 914755840,
			"isDeleted": false,
			"id": "EHuc3ZIJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 559.4391842147647,
			"y": 1711.1351156778644,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 28.125,
			"height": 19.2,
			"seed": 606567398,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "ack",
			"rawText": "ack",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "ack",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 520,
			"versionNonce": 1767866112,
			"isDeleted": false,
			"id": "pxELL8dnOAbWP9bwc5mDP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -155.2272586563289,
			"y": 1563.1351360229164,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 58.66668701171875,
			"height": 0,
			"seed": 249237286,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "FoYr8NCYswd2a9pYJZaPB",
				"focus": -0.2915065882718629,
				"gap": 20.92683503860433
			},
			"endBinding": {
				"elementId": "_H2H_CTj8xDqpVH9NUNxD",
				"focus": -1.1086496739426577,
				"gap": 6.4354268747054215
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-58.66668701171875,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 348,
			"versionNonce": 2107371776,
			"isDeleted": false,
			"id": "bve4IcTYFlEVpyfRCpchl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -263.22734003653716,
			"y": 1567.1350749877602,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 73.33333333333337,
			"height": 0,
			"seed": 1547319910,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "TGKSBn4TlDW2mU2o3mqCQ",
				"focus": -0.24385772628600352,
				"gap": 3.373348282830932
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-73.33333333333337,
					0
				]
			]
		},
		{
			"type": "text",
			"version": 432,
			"versionNonce": 790077184,
			"isDeleted": false,
			"id": "W0jZ8NZU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 868.7726803085147,
			"y": 1732.4683778035148,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 346.875,
			"height": 115.19999999999999,
			"seed": 1662123430,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"rawText": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nid:1234\nshortUrl: https://tinyurl.com/adbkdie\nlongUrl: https://youtube.com\nuserId: (optional)\n}",
			"lineHeight": 1.2
		},
		{
			"type": "line",
			"version": 3395,
			"versionNonce": 653644032,
			"isDeleted": false,
			"id": "zsEdcwKwzptULs0grglXQ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 4.70956944444772,
			"x": 185.64247386774912,
			"y": 1528.091162482719,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 38.18020848385896,
			"height": 166.40795567567025,
			"seed": 1163188134,
			"groupIds": [
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					38.18020848385896,
					-0.14686784256805197
				],
				[
					37.85288802759572,
					149.64497995479326
				],
				[
					18.359942363004773,
					166.2610878331022
				],
				[
					0.5986518871129598,
					148.72816857391405
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1313,
			"versionNonce": 1221312256,
			"isDeleted": false,
			"id": "ZALWaaZL9gs_EZMK-hOrK",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 127.2230106246068,
			"y": 1603.473035171806,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 31.06158617074989,
			"height": 20.645724939839834,
			"seed": 560394982,
			"groupIds": [
				"-qLeLAXlzRpM0xjNNIVQo",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 2637,
			"versionNonce": 1242804480,
			"isDeleted": false,
			"id": "EccbT8iXf-JYBQPGGxJou",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 143.57529975446283,
			"y": 1613.5915903305195,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 30.236706151256726,
			"height": 9.753164264899379,
			"seed": 1125361190,
			"groupIds": [
				"-qLeLAXlzRpM0xjNNIVQo",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					14.733121544374974,
					-9.753164264899379
				],
				[
					-15.50358460688175,
					-9.633742002286136
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "line",
			"version": 1579,
			"versionNonce": 1459347200,
			"isDeleted": false,
			"id": "6BWYqHdq9-PYPBj4_5Dq1",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "dotted",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 193.03103467347603,
			"y": 1615.363736964765,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 39.02944334811038,
			"height": 0.7230377594110944,
			"seed": 1263006054,
			"groupIds": [
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					39.02944334811038,
					-0.7230377594110944
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1389,
			"versionNonce": 242585856,
			"isDeleted": false,
			"id": "b6ZpzVjP3LHXO9jsd2vkX",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 164.35272915068586,
			"y": 1603.651829964065,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 31.06158617074989,
			"height": 20.645724939839834,
			"seed": 894489766,
			"groupIds": [
				"do530pCl0-qgzZmQW8CvI",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 2710,
			"versionNonce": 1781006080,
			"isDeleted": false,
			"id": "Ej6UjY3EMjcHWWM25It95",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 180.72987446069504,
			"y": 1613.047997540405,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 30.236706151256726,
			"height": 9.753164264899379,
			"seed": 182144998,
			"groupIds": [
				"do530pCl0-qgzZmQW8CvI",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					14.733121544374974,
					-9.753164264899379
				],
				[
					-15.50358460688175,
					-9.633742002286136
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1438,
			"versionNonce": 731607296,
			"isDeleted": false,
			"id": "LHbRAiqv7NPmKMcMj-CDZ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 230.98358839972107,
			"y": 1602.9366507950226,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 31.06158617074989,
			"height": 20.645724939839834,
			"seed": 401892134,
			"groupIds": [
				"Gw_X-ELkBN610PrQss2TO",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 2795,
			"versionNonce": 47193856,
			"isDeleted": false,
			"id": "DVPea_WJIuW2wJYY4PwSM",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 247.9878487301425,
			"y": 1611.8879669230498,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 30.236706151256726,
			"height": 9.753164264899379,
			"seed": 520687206,
			"groupIds": [
				"Gw_X-ELkBN610PrQss2TO",
				"Gcy0dxqfw-fjWWxa5Oe9l",
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					14.733121544374974,
					-9.753164264899379
				],
				[
					-15.50358460688175,
					-9.633742002286136
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "text",
			"version": 681,
			"versionNonce": 1761956096,
			"isDeleted": false,
			"id": "GdQUjVRP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 142.24284623408911,
			"y": 1630.193384034954,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 124.03900146484375,
			"height": 31.49152665699798,
			"seed": 216420774,
			"groupIds": [
				"o7lxd9K5CxgwuXbb0NbmW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "fwb-Q1LBHMDxJeSqfD5HC",
					"type": "arrow"
				}
			],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 23.32705678296144,
			"fontFamily": 1,
			"text": "Message Q",
			"rawText": "Message Q",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Message Q",
			"lineHeight": 1.3500000000000016
		},
		{
			"type": "text",
			"version": 26,
			"versionNonce": 292830976,
			"isDeleted": false,
			"id": "0xCpm3Ss",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 141.21206797380046,
			"y": 1559.497988069521,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 46.875,
			"height": 19.2,
			"seed": 1167589754,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "kafka",
			"rawText": "kafka",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "kafka",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1763,
			"versionNonce": 506671360,
			"isDeleted": false,
			"id": "K-oHd8ACsacj8IgTz_rMd",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 377.200756032905,
			"y": 1547.3476846070942,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 100.02274595210362,
			"height": 101.31077039237329,
			"seed": 189796966,
			"groupIds": [
				"4om7RXzcg9XObiLC5bj5W"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "kqzPtnOV"
				},
				{
					"id": "fXJv_goLrjn5CZjR6kNkE",
					"type": "arrow"
				}
			],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 371,
			"versionNonce": 1989435136,
			"isDeleted": false,
			"id": "kqzPtnOV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 386.5099805714568,
			"y": 1590.4237595729173,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 81.404296875,
			"height": 15.158620460727091,
			"seed": 1638716838,
			"groupIds": [
				"4om7RXzcg9XObiLC5bj5W"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 12.632183717272577,
			"fontFamily": 3,
			"text": "task runner",
			"rawText": "task runner",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "K-oHd8ACsacj8IgTz_rMd",
			"originalText": "task runner",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1853,
			"versionNonce": 849678592,
			"isDeleted": false,
			"id": "GihMFXnR99nX9d4JtI0tw",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 385.5339876409779,
			"y": 1556.1759260341412,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 100.02274595210362,
			"height": 101.31077039237329,
			"seed": 1896742074,
			"groupIds": [
				"eP1aWZAKgzESU2BI-px71"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "v5ajxqwo"
				},
				{
					"id": "fXJv_goLrjn5CZjR6kNkE",
					"type": "arrow"
				},
				{
					"id": "ZRo7ELmWfUxRmVL0JcuSA",
					"type": "arrow"
				},
				{
					"id": "fwb-Q1LBHMDxJeSqfD5HC",
					"type": "arrow"
				},
				{
					"id": "bqUG6O1FNMXmFStVyg2on",
					"type": "arrow"
				}
			],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 458,
			"versionNonce": 45121280,
			"isDeleted": false,
			"id": "v5ajxqwo",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 394.8432121795297,
			"y": 1599.2520009999644,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 81.404296875,
			"height": 15.158620460727091,
			"seed": 2120373626,
			"groupIds": [
				"eP1aWZAKgzESU2BI-px71"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 12.632183717272577,
			"fontFamily": 3,
			"text": "task runner",
			"rawText": "task runner",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "GihMFXnR99nX9d4JtI0tw",
			"originalText": "task runner",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 135,
			"versionNonce": 385228028,
			"isDeleted": false,
			"id": "ZRo7ELmWfUxRmVL0JcuSA",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 290.54546234228997,
			"y": 1608.83128071275,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 85.33335367838549,
			"height": 2.66667683919286,
			"seed": 634198950,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "GihMFXnR99nX9d4JtI0tw",
				"gap": 9.65517162030244,
				"focus": -0.12507567727628013
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					85.33335367838549,
					2.66667683919286
				]
			]
		},
		{
			"type": "arrow",
			"version": 892,
			"versionNonce": 2052272124,
			"isDeleted": false,
			"id": "fwb-Q1LBHMDxJeSqfD5HC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 469.2926667095288,
			"y": 1662.9843891541486,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 195.3071825906677,
			"height": 292.6045072993802,
			"seed": 1013055290,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "GihMFXnR99nX9d4JtI0tw",
				"gap": 5.497692727634103,
				"focus": 0.04454231722445511
			},
			"endBinding": {
				"elementId": "HKUFPbc7rCL_RazI4TpnC",
				"gap": 1,
				"focus": 0.19976450651098432
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					195.3071825906677,
					292.6045072993802
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1607,
			"versionNonce": 1733611776,
			"isDeleted": false,
			"id": "HKUFPbc7rCL_RazI4TpnC",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 633.2008679306907,
			"y": 1956.5888964535288,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 608121510,
			"groupIds": [
				"mCBJglJI9B9sA3_Xfho3M"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "fwb-Q1LBHMDxJeSqfD5HC",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "Ac44bt5v"
				},
				{
					"id": "e0sCDEObF-WqLoORJcKXp",
					"type": "arrow"
				}
			],
			"updated": 1718371996502,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 167,
			"versionNonce": 31244032,
			"isDeleted": false,
			"id": "Ac44bt5v",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 653.7538770558311,
			"y": 1996.2937476520399,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 56.25,
			"height": 19.2,
			"seed": 1069378682,
			"groupIds": [
				"mCBJglJI9B9sA3_Xfho3M"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "reddis",
			"rawText": "reddis",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "HKUFPbc7rCL_RazI4TpnC",
			"originalText": "reddis",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 175,
			"versionNonce": 647147776,
			"isDeleted": false,
			"id": "ht06hGxZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 797.2123324594772,
			"y": 1988.8312807127495,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 131.25,
			"height": 38.4,
			"seed": 478900710,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996502,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "along with ttl\n",
			"rawText": "along with ttl\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "along with ttl\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 92,
			"versionNonce": 1173151488,
			"isDeleted": false,
			"id": "WU0kzyDR",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 717.2121290089567,
			"y": 1528.83128071275,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 618.75,
			"height": 38.4,
			"seed": 1208841766,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "first store in db then in reddis to make sure db is ahead of cache\n",
			"rawText": "first store in db then in reddis to make sure db is ahead of cache\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "first store in db then in reddis to make sure db is ahead of cache\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 22,
			"versionNonce": 51679488,
			"isDeleted": false,
			"id": "5r2T2RMC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 562.5453809620817,
			"y": 1643.4979778969948,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 9.375,
			"height": 19.2,
			"seed": 1452470330,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "1",
			"rawText": "1",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "1",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 37,
			"versionNonce": 1392049920,
			"isDeleted": false,
			"id": "CPqdbbT2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 555.8787142954152,
			"y": 1810.1646445636613,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 9.375,
			"height": 19.2,
			"seed": 1086481018,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "2",
			"rawText": "2",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "2",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 292,
			"versionNonce": 1748090620,
			"isDeleted": false,
			"id": "bqUG6O1FNMXmFStVyg2on",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 698.6268509160486,
			"y": 1759.4332104193763,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 210.83672923042337,
			"height": 101.31116645635598,
			"seed": 744061498,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "BwzRRQs6ujahvJQLg7cE_",
				"gap": 15.123431990725429,
				"focus": -1.4970344427798892
			},
			"endBinding": {
				"elementId": "GihMFXnR99nX9d4JtI0tw",
				"gap": 2.3220010473856973,
				"focus": 0.35061209239316693
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-210.83672923042337,
					-101.31116645635598
				]
			]
		},
		{
			"type": "arrow",
			"version": 476,
			"versionNonce": 361521404,
			"isDeleted": false,
			"id": "e0sCDEObF-WqLoORJcKXp",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -38.78793202619954,
			"y": 2124.831290885276,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 665.3333536783855,
			"height": 103.9999389648433,
			"seed": 388177062,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Puu55YxvGYUSIMyWBp3eg",
				"gap": 9.599945439952641,
				"focus": 0.5014437550242801
			},
			"endBinding": {
				"elementId": "HKUFPbc7rCL_RazI4TpnC",
				"gap": 6.655446278504769,
				"focus": -0.11048793412572694
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					665.3333536783855,
					-103.9999389648433
				]
			]
		},
		{
			"type": "text",
			"version": 42,
			"versionNonce": 31740160,
			"isDeleted": false,
			"id": "JMbyUKt2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 155.87881602067546,
			"y": 2074.1646852537656,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 196.875,
			"height": 19.2,
			"seed": 1128837690,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "check in cache firsta",
			"rawText": "check in cache firsta",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "check in cache firsta",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 72,
			"versionNonce": 973422336,
			"isDeleted": false,
			"id": "HGaA4O2OF30zf15etNqiL",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -66.7879116811473,
			"y": 2018.1646242186093,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 758.666788736979,
			"height": 177.33332316080714,
			"seed": 1330816058,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "t_ZL4LFbQDRh0eGfQBaTh",
				"focus": -0.8106966466560874,
				"gap": 13.0093015298595
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					758.666788736979,
					-177.33332316080714
				]
			]
		},
		{
			"type": "text",
			"version": 45,
			"versionNonce": 1127362816,
			"isDeleted": false,
			"id": "OPyT4jum",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 105.2121086639047,
			"y": 1951.4979575519428,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 225,
			"height": 19.2,
			"seed": 1784262822,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "if not found check in db",
			"rawText": "if not found check in db",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "if not found check in db",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 231,
			"versionNonce": 1694850816,
			"isDeleted": false,
			"id": "EsaCQaXL",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -324.1211839793244,
			"y": 2303.497977896994,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 243.75,
			"height": 249.6,
			"seed": 2143494202,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "lsm based db   (cassandra)\n\nCan handle write heavy\noperations pretty easily\n\n\n\nbtree based db  (dynamodb)\n\ncan handle ready heavy \noperation easily\n\n",
			"rawText": "lsm based db   (cassandra)\n\nCan handle write heavy\noperations pretty easily\n\n\n\nbtree based db  (dynamodb)\n\ncan handle ready heavy \noperation easily\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "lsm based db   (cassandra)\n\nCan handle write heavy\noperations pretty easily\n\n\n\nbtree based db  (dynamodb)\n\ncan handle ready heavy \noperation easily\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 178,
			"versionNonce": 1606684928,
			"isDeleted": false,
			"id": "iJk9W4P5",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 257.21212900895694,
			"y": 2281.497957551941,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 581.25,
			"height": 76.8,
			"seed": 1389146598,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "db triggers\n\nlike once stored on db, a lambda script get triggered to store\nin reddis. I think it carries some overhead",
			"rawText": "db triggers\n\nlike once stored on db, a lambda script get triggered to store\nin reddis. I think it carries some overhead",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "db triggers\n\nlike once stored on db, a lambda script get triggered to store\nin reddis. I think it carries some overhead",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 187,
			"versionNonce": 2063695616,
			"isDeleted": false,
			"id": "ZSqjxfmq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 235.8787142954152,
			"y": 2488.164624218608,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 609.375,
			"height": 96,
			"seed": 1730936486,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "idempotent operation\n\nif you do a same operation multiple time, you get the same result\neach time\n",
			"rawText": "idempotent operation\n\nif you do a same operation multiple time, you get the same result\neach time\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "idempotent operation\n\nif you do a same operation multiple time, you get the same result\neach time\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 86,
			"versionNonce": 1327100160,
			"isDeleted": false,
			"id": "l22NcE7y",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 244.54550303239444,
			"y": 2687.4979677244655,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 421.875,
			"height": 19.2,
			"seed": 1670433830,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "multiple instance of redis nodes for hot keys",
			"rawText": "multiple instance of redis nodes for hot keys",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "multiple instance of redis nodes for hot keys",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 254,
			"versionNonce": 1014603520,
			"isDeleted": false,
			"id": "XTIUSoBB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 635.2122103891652,
			"y": 2091.4979575519405,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 365.625,
			"height": 192,
			"seed": 820925222,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "cache for 1 year\n\n10M*365 = 4B links in a year\n\nlet say each record is 2 kb\n4B*2kb = 8B kb\n       = 8 tb\n\nwe can get 16 gb ram on a machine\nso 8tb/16 gb = 8000gb/16 = 500 machines",
			"rawText": "cache for 1 year\n\n10M*365 = 4B links in a year\n\nlet say each record is 2 kb\n4B*2kb = 8B kb\n       = 8 tb\n\nwe can get 16 gb ram on a machine\nso 8tb/16 gb = 8000gb/16 = 500 machines",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "cache for 1 year\n\n10M*365 = 4B links in a year\n\nlet say each record is 2 kb\n4B*2kb = 8B kb\n       = 8 tb\n\nwe can get 16 gb ram on a machine\nso 8tb/16 gb = 8000gb/16 = 500 machines",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 29,
			"versionNonce": 414437632,
			"isDeleted": false,
			"id": "oTI5qIim",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 751.2120679738,
			"y": 1696.8313112303263,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 75,
			"height": 19.2,
			"seed": 906207014,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "dynamodb",
			"rawText": "dynamodb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "dynamodb",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 184,
			"versionNonce": 1508753152,
			"isDeleted": false,
			"id": "2ycHu3dV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1269.8787549855185,
			"y": 1726.1646547361856,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 196.875,
			"height": 230.39999999999998,
			"seed": 659687334,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "10M records in a day\n10M*365 in a year\n10M*365*10 in 10 year\n36.5 B in 10 year\n\n=each record is 2 kb\n\n40B * 2kb\n80 B kb\n80 Tb\n\n",
			"rawText": "10M records in a day\n10M*365 in a year\n10M*365*10 in 10 year\n36.5 B in 10 year\n\n=each record is 2 kb\n\n40B * 2kb\n80 B kb\n80 Tb\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "10M records in a day\n10M*365 in a year\n10M*365*10 in 10 year\n36.5 B in 10 year\n\n=each record is 2 kb\n\n40B * 2kb\n80 B kb\n80 Tb\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 274,
			"versionNonce": 1410445568,
			"isDeleted": false,
			"id": "8CYjhQhWPE2ApwzBzjLxN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -652.8502793030821,
			"y": -409.6197724955964,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2490.666910807291,
			"height": 9013.332824707028,
			"seed": 771164134,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 369,
			"versionNonce": 1943920384,
			"isDeleted": false,
			"id": "aHLYu46X",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2018.815929599912,
			"y": -367.6198284444894,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 646.875,
			"height": 307.2,
			"seed": 1569225466,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Hotel booking\n\nSDFC APPROACH\n\n\nFR\nCustomers can view available rooms\nCustomers can book rooms.\nThe frontdesk can view the reservation info to facilitate the checkin\nNot two people should book same room\n\nNFR\nScalable\nHigh Consistency\n\n",
			"rawText": "Hotel booking\n\nSDFC APPROACH\n\n\nFR\nCustomers can view available rooms\nCustomers can book rooms.\nThe frontdesk can view the reservation info to facilitate the checkin\nNot two people should book same room\n\nNFR\nScalable\nHigh Consistency\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Hotel booking\n\nSDFC APPROACH\n\n\nFR\nCustomers can view available rooms\nCustomers can book rooms.\nThe frontdesk can view the reservation info to facilitate the checkin\nNot two people should book same room\n\nNFR\nScalable\nHigh Consistency\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 283,
			"versionNonce": 682856704,
			"isDeleted": false,
			"id": "nStgYRgm",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2016.8161127053806,
			"y": -35.6198589620675,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 281.25,
			"height": 288,
			"seed": 1006679014,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Numbers\n3B views per month\n30 million booking per month\n\nso 100:1   read to write ratio\nso 1% conversion \n\nread qps = 3*10^9/(30*10^5)\n         = 1000 reads per sec\n\nwrite qps = 30*10^6/(30*10^5)\n          = 10 writes per sec\n\n\n",
			"rawText": "Numbers\n3B views per month\n30 million booking per month\n\nso 100:1   read to write ratio\nso 1% conversion \n\nread qps = 3*10^9/(30*10^5)\n         = 1000 reads per sec\n\nwrite qps = 30*10^6/(30*10^5)\n          = 10 writes per sec\n\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Numbers\n3B views per month\n30 million booking per month\n\nso 100:1   read to write ratio\nso 1% conversion \n\nread qps = 3*10^9/(30*10^5)\n         = 1000 reads per sec\n\nwrite qps = 30*10^6/(30*10^5)\n          = 10 writes per sec\n\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1465,
			"versionNonce": 449445632,
			"isDeleted": false,
			"id": "c9Pf0roai4FExidGVG5Ta",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 1937.6374627110995,
			"y": 335.66891395441144,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 292861990,
			"groupIds": [
				"7_ghw8TfKcmatCLuAxWnG"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "wKK0MImeDprK6uGI3ECvc",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "l5w5Fn1r"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 26,
			"versionNonce": 1310290176,
			"isDeleted": false,
			"id": "l5w5Fn1r",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1967.56547183624,
			"y": 375.3737651529226,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1784640506,
			"groupIds": [
				"7_ghw8TfKcmatCLuAxWnG"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "c9Pf0roai4FExidGVG5Ta",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1602,
			"versionNonce": 1328684800,
			"isDeleted": false,
			"id": "kcY-xnfZsTcFIEbBkAhCL",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2294.6383477208656,
			"y": 605.0752135454759,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 432230054,
			"groupIds": [
				"83GohGsp57OXlex7dN4om"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1479,
			"versionNonce": 197349632,
			"isDeleted": false,
			"id": "c69Mf3GmLo4mqf9S2DoGa",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2288.637828922037,
			"y": 342.57536613336663,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1482647270,
			"groupIds": [
				"k0BalEgD6lttlh__nA_6n"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1474,
			"versionNonce": 26623744,
			"isDeleted": false,
			"id": "dsxq3yRIlFA8bQrIjgmC_",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2298.6379815099276,
			"y": 358.57527458063214,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 632065018,
			"groupIds": [
				"sFUTwdZ8ET1zanQa83Itc"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "Koh8BHlMfbwdFQ9mn0m6c",
					"type": "arrow"
				},
				{
					"id": "yjIqg9kiaUFZhFJtmDy6x",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1529,
			"versionNonce": 959525120,
			"isDeleted": false,
			"id": "KUQUb7Ox6rf8qT9bFNmUG",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2310.6376458165682,
			"y": 615.0751372515306,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 556029734,
			"groupIds": [
				"FibW_yCEX_djZ_LmkP_Pf"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "9qsjbdJRvZxLgIfFd-44-",
					"type": "arrow"
				},
				{
					"id": "mQZTNUwEX2RtCuAxSJNz9",
					"type": "arrow"
				},
				{
					"id": "jIW5Y346uzM5uQW-3lwMl",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1623,
			"versionNonce": 309747456,
			"isDeleted": false,
			"id": "slsoqkgE_v6YKY7vuu7-2",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3409.1380425450843,
			"y": 458.7752715288743,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 130.15594500809328,
			"height": 131.83200415465078,
			"seed": 1689505722,
			"groupIds": [
				"_KJEOb6Xt1IsKPld_DFce"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "EBXn2RMpNnRXXVSaCyu4d",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "myJkkiFW"
				},
				{
					"id": "3GYrr6eiYmgvk0uvOHbDf",
					"type": "arrow"
				},
				{
					"id": "QATQli7JR_GPN2OYzgl-q",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 256,
			"versionNonce": 1038291200,
			"isDeleted": false,
			"id": "myJkkiFW",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3422.653515049131,
			"y": 495.8912736061997,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 103.125,
			"height": 57.599999999999994,
			"seed": 1647573990,
			"groupIds": [
				"_KJEOb6Xt1IsKPld_DFce"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "browser/app\nfrontdesk\nuser",
			"rawText": "browser/app frontdesk user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "slsoqkgE_v6YKY7vuu7-2",
			"originalText": "browser/app frontdesk user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1489,
			"versionNonce": 1381138176,
			"isDeleted": false,
			"id": "nF_I13wqwbABmkdRpi04b",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2315.6381035802406,
			"y": 369.5753356157884,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1200299878,
			"groupIds": [
				"Lwrh1Cbj_lStmb6yGj_-s"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "E3yAYmt3BM6DoFJmwhmxU",
					"type": "arrow"
				},
				{
					"id": "a9NZSmfejhnCEmXjx12jj",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1465,
			"versionNonce": 291041536,
			"isDeleted": false,
			"id": "fqwD8WmKzG0H93qfOFWUS",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3086.837871646647,
			"y": 481.9752684771165,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1543027578,
			"groupIds": [
				"_WYtFzfjkIY6gJiXrWenW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "EOgJ1aTXJLbUFrEAVikc3",
					"type": "arrow"
				},
				{
					"id": "zuMZt_R6lc5f9_mknCHeB",
					"type": "arrow"
				},
				{
					"id": "EBXn2RMpNnRXXVSaCyu4d",
					"type": "arrow"
				},
				{
					"id": "_ciPde9dq86RFQsVO0SXP",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "PJffngZA"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 48,
			"versionNonce": 27959040,
			"isDeleted": false,
			"id": "PJffngZA",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3102.703380771787,
			"y": 502.4801196756277,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 57.599999999999994,
			"seed": 1366945190,
			"groupIds": [
				"_WYtFzfjkIY6gJiXrWenW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "admin\nbackend\nservice",
			"rawText": "admin backend service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "fqwD8WmKzG0H93qfOFWUS",
			"originalText": "admin backend service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1480,
			"versionNonce": 991088896,
			"isDeleted": false,
			"id": "zH_knfdTSHV8D82YrcMDw",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2322.637767886881,
			"y": 637.5753661333665,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1399635878,
			"groupIds": [
				"vfbljOew3gUJEzjnWDqsp"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "psfDohui"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 40,
			"versionNonce": 1358872320,
			"isDeleted": false,
			"id": "psfDohui",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2338.5032770120215,
			"y": 667.6802173318777,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 38.4,
			"seed": 1684651066,
			"groupIds": [
				"vfbljOew3gUJEzjnWDqsp"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "booking\nservice",
			"rawText": "booking\nservice",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "zH_knfdTSHV8D82YrcMDw",
			"originalText": "booking\nservice",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1474,
			"versionNonce": 1385214208,
			"isDeleted": false,
			"id": "tgxq3PLUh04C0bTPLs3Ae",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 1927.6380730626624,
			"y": 613.0753203569993,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1743933242,
			"groupIds": [
				"4XeT_k-5zlQQ6whNISViz"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "SImDd6K6"
				},
				{
					"id": "5KnzdnUtOWdahqh1cKijM",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 26,
			"versionNonce": 1624170240,
			"isDeleted": false,
			"id": "SImDd6K6",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1957.566082187803,
			"y": 652.7801715555105,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 215958502,
			"groupIds": [
				"4XeT_k-5zlQQ6whNISViz"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "tgxq3PLUh04C0bTPLs3Ae",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2127,
			"versionNonce": 2136117504,
			"isDeleted": false,
			"id": "jBB-u9AB_zJuwYikCZRva",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 2147.040381736808,
			"y": 329.98784657200224,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 302897978,
			"groupIds": [
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "gcoHUuHqmgw2EHRlu0hyX",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1946,
			"versionNonce": 1100676864,
			"isDeleted": false,
			"id": "xCj5F3EzprFx8Kbd45xng",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2175.8496633371956,
			"y": 376.66624553416307,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1625449466,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "wxmSKRuqCzVCdMcCaMyPB"
				},
				{
					"type": "arrow",
					"id": "m3qkTZnTGxl-2OMj-w3e5"
				},
				{
					"id": "UsavYyBWDBEK6S0djkIo7",
					"type": "arrow"
				},
				{
					"id": "Koh8BHlMfbwdFQ9mn0m6c",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2254,
			"versionNonce": 2027450624,
			"isDeleted": false,
			"id": "kOpLzIRM4r_iQK8VwFDvr",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2151.7613503826697,
			"y": 374.73461550884724,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 497538234,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "UsavYyBWDBEK6S0djkIo7"
				},
				{
					"type": "arrow",
					"id": "wxmSKRuqCzVCdMcCaMyPB"
				},
				{
					"type": "arrow",
					"id": "m3qkTZnTGxl-2OMj-w3e5"
				},
				{
					"id": "wKK0MImeDprK6uGI3ECvc",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2252,
			"versionNonce": 1944264448,
			"isDeleted": false,
			"id": "AqZH0Ql1DHIbB5krqnI6L",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2176.178124946861,
			"y": 410.4636099489654,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 704720250,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "m3qkTZnTGxl-2OMj-w3e5"
				},
				{
					"id": "yjIqg9kiaUFZhFJtmDy6x",
					"type": "arrow"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1967,
			"versionNonce": 111300864,
			"isDeleted": false,
			"id": "GKrhWESHsWRp5Na007bq1",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2175.722780741647,
			"y": 342.2107636177201,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 993095226,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "wxmSKRuqCzVCdMcCaMyPB"
				}
			],
			"updated": 1718371996503,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6281,
			"versionNonce": 1747402496,
			"isDeleted": false,
			"id": "UsavYyBWDBEK6S0djkIo7",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2160.4907051983178,
			"y": 386.9011436670377,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 1713084154,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996503,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "kOpLzIRM4r_iQK8VwFDvr",
				"focus": 0.24472012017711284,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5073,
			"versionNonce": 3158272,
			"isDeleted": false,
			"id": "m3qkTZnTGxl-2OMj-w3e5",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2164.488502111579,
			"y": 380.89501176533884,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 725788602,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "kOpLzIRM4r_iQK8VwFDvr",
				"focus": -0.05630840266131453,
				"gap": 1
			},
			"endBinding": {
				"elementId": "xCj5F3EzprFx8Kbd45xng",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6038,
			"versionNonce": 2129092352,
			"isDeleted": false,
			"id": "wxmSKRuqCzVCdMcCaMyPB",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2161.507168173225,
			"y": 375.2482027017792,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 46768250,
			"groupIds": [
				"q403DKii0FgMG2F9MStss",
				"tYXp6gDz3CJij3wuD8Ciu",
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "kOpLzIRM4r_iQK8VwFDvr",
				"focus": -0.08869372840681218,
				"gap": 1
			},
			"endBinding": {
				"elementId": "GKrhWESHsWRp5Na007bq1",
				"focus": -0.09679793421698382,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1024,
			"versionNonce": 1291981056,
			"isDeleted": false,
			"id": "zwVDi6yG",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2149.275934584516,
			"y": 434.4480933265771,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 1752400186,
			"groupIds": [
				"3VEurWsb75pCz4lCHObJW"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "rectangle",
			"version": 2160,
			"versionNonce": 144932608,
			"isDeleted": false,
			"id": "FAdWgnyj6dsYwnz2s4rcI",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 2113.0406716538,
			"y": 585.4878770895804,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 2107965050,
			"groupIds": [
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "5KnzdnUtOWdahqh1cKijM",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1979,
			"versionNonce": 1687679232,
			"isDeleted": false,
			"id": "me1iqEzODfK3ROd9QnrOv",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2141.849953254188,
			"y": 632.1662760517412,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1815289658,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "5-BXLxrYP9r5Dv_ETV4s5"
				},
				{
					"type": "arrow",
					"id": "Mt2QMZglft26_SxRasB9w"
				},
				{
					"id": "Fk5eNy56giAZRiOqV_drg",
					"type": "arrow"
				},
				{
					"id": "9qsjbdJRvZxLgIfFd-44-",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2286,
			"versionNonce": 1172020992,
			"isDeleted": false,
			"id": "PRaS3JwNpc9OWHibvVoYe",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2117.761640299662,
			"y": 630.2346460264254,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1304373242,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "Fk5eNy56giAZRiOqV_drg"
				},
				{
					"type": "arrow",
					"id": "5-BXLxrYP9r5Dv_ETV4s5"
				},
				{
					"type": "arrow",
					"id": "Mt2QMZglft26_SxRasB9w"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2285,
			"versionNonce": 1316081920,
			"isDeleted": false,
			"id": "AHUC7lbPzVK6IrYBHmp3u",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2142.1784148638526,
			"y": 665.9636404665436,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1514936506,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "Mt2QMZglft26_SxRasB9w"
				},
				{
					"id": "5KnzdnUtOWdahqh1cKijM",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2000,
			"versionNonce": 1729085184,
			"isDeleted": false,
			"id": "0H64OGlOtivLj9IcRwX8e",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2141.7230706586397,
			"y": 597.7107941352982,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1367142778,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "5-BXLxrYP9r5Dv_ETV4s5"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6345,
			"versionNonce": 571453696,
			"isDeleted": false,
			"id": "Fk5eNy56giAZRiOqV_drg",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2126.4909951153095,
			"y": 642.4011741846158,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 110408250,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "PRaS3JwNpc9OWHibvVoYe",
				"focus": 0.24472012017717362,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5168,
			"versionNonce": 213901056,
			"isDeleted": false,
			"id": "Mt2QMZglft26_SxRasB9w",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2130.488792028571,
			"y": 636.395042282917,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 1819695866,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "PRaS3JwNpc9OWHibvVoYe",
				"focus": -0.05630840266131453,
				"gap": 1
			},
			"endBinding": {
				"elementId": "me1iqEzODfK3ROd9QnrOv",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6133,
			"versionNonce": 116494592,
			"isDeleted": false,
			"id": "5-BXLxrYP9r5Dv_ETV4s5",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2127.5074580902174,
			"y": 630.7482332193573,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 564456378,
			"groupIds": [
				"v47jUyCSmhvv1OBFykya0",
				"6t-4JyNuok8P7DgRq4_3d",
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "PRaS3JwNpc9OWHibvVoYe",
				"focus": -0.08869372840681351,
				"gap": 1
			},
			"endBinding": {
				"elementId": "0H64OGlOtivLj9IcRwX8e",
				"focus": -0.09679793421693206,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1057,
			"versionNonce": 1198259968,
			"isDeleted": false,
			"id": "fOySkTh9",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2115.2762245015083,
			"y": 689.9481238441552,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 2084791418,
			"groupIds": [
				"6WCtcGi_iOiqzzJcHLY4t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "line",
			"version": 6062,
			"versionNonce": 882340096,
			"isDeleted": false,
			"id": "e_eVI0ZGe1TLDTsSUzKnN",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2602.008743646724,
			"y": 342.5472620707046,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 92.11307787956703,
			"height": 118.88655065768039,
			"seed": 910855590,
			"groupIds": [
				"knRJHNJcCtmcOn6YhvILE",
				"ZtXAkA1btBIoZh0k80G-f",
				"Zoms4lNkiyF6kaSKP6h9P"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.3037416266730522,
					89.85381061304011
				],
				[
					0.014214395083438337,
					100.08327676463979
				],
				[
					4.744027232376133,
					104.50330259458084
				],
				[
					21.21536443588695,
					108.24407565183367
				],
				[
					49.056590103625815,
					109.40889650084321
				],
				[
					75.65704013946701,
					107.54908938840468
				],
				[
					89.79005509834187,
					103.10139431612642
				],
				[
					91.7833256149989,
					99.35194071225722
				],
				[
					92.06327324335884,
					91.116272110502
				],
				[
					91.84354690714618,
					7.5382331841028245
				],
				[
					91.34821321588112,
					-0.3583515654722076
				],
				[
					85.43362435223172,
					-4.771804727432435
				],
				[
					72.97876243038847,
					-7.32784326367497
				],
				[
					44.59581491807233,
					-9.477654156837188
				],
				[
					21.839889445416063,
					-8.195717080535312
				],
				[
					3.942508604844666,
					-3.8475429335799025
				],
				[
					-0.04980463620819661,
					-0.05398989975514504
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6782,
			"versionNonce": 395583232,
			"isDeleted": false,
			"id": "rHORMyqghpy9653soaUfJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2602.3353064015178,
			"y": 331.7986983602319,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 91.52224951272136,
			"height": 18.509686413792895,
			"seed": 372631782,
			"groupIds": [
				"knRJHNJcCtmcOn6YhvILE",
				"ZtXAkA1btBIoZh0k80G-f",
				"Zoms4lNkiyF6kaSKP6h9P"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 6144,
			"versionNonce": 1921077504,
			"isDeleted": false,
			"id": "KXiEAHQPoolWEr-iaBt_c",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2580.084177645637,
			"y": 586.7332892889458,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 125.45255473481755,
			"height": 161.91643843577114,
			"seed": 594428218,
			"groupIds": [
				"OOazZsIiq5SoRFA189TiA",
				"GytGV8pfyX6_ZOk6RY_IZ",
				"w5iOj6apnb6yIkETjAjp3"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.41367810003335337,
					122.37556657049717
				],
				[
					0.019359163956706033,
					136.30749341338677
				],
				[
					6.461084025563227,
					142.32730672464072
				],
				[
					28.894069434874467,
					147.42201800254537
				],
				[
					66.81216931134377,
					149.00843498784775
				],
				[
					103.04040628823884,
					146.47548788695457
				],
				[
					122.28873533674135,
					140.41799070693102
				],
				[
					125.00345168699899,
					135.31145703882305
				],
				[
					125.38472377103056,
					124.0949643341677
				],
				[
					125.08546951902913,
					10.266626986115021
				],
				[
					124.41085437809686,
					-0.48805360125396546
				],
				[
					116.35553476190681,
					-6.498915328122704
				],
				[
					99.39275072588195,
					-9.980088379266624
				],
				[
					60.73685779198456,
					-12.908003447923406
				],
				[
					29.744635497205486,
					-11.162081099724166
				],
				[
					5.369463141687927,
					-5.240125523767397
				],
				[
					-0.06783096378698307,
					-0.07353104477754188
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6862,
			"versionNonce": 1840791296,
			"isDeleted": false,
			"id": "sp49rrCswChIOmyWnbatJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2580.5289367701093,
			"y": 572.0943823253575,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 124.647881503428,
			"height": 25.209096269551086,
			"seed": 1967524346,
			"groupIds": [
				"OOazZsIiq5SoRFA189TiA",
				"GytGV8pfyX6_ZOk6RY_IZ",
				"w5iOj6apnb6yIkETjAjp3"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 261,
			"versionNonce": 653087228,
			"isDeleted": false,
			"id": "wKK0MImeDprK6uGI3ECvc",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2035.9934809613803,
			"y": 376.98137305454816,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 114.22262903456453,
			"height": 0.7987472850330732,
			"seed": 1426554618,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "c9Pf0roai4FExidGVG5Ta",
				"gap": 1,
				"focus": -0.16798757426905409
			},
			"endBinding": {
				"elementId": "kOpLzIRM4r_iQK8VwFDvr",
				"gap": 2.1081230433005222,
				"focus": 0.48137536715069407
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					114.22262903456453,
					0.7987472850330732
				]
			]
		},
		{
			"type": "arrow",
			"version": 67,
			"versionNonce": 710434560,
			"isDeleted": false,
			"id": "Koh8BHlMfbwdFQ9mn0m6c",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2193.416027256162,
			"y": 383.3801257791434,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 94.39996337890625,
			"height": 0.79998779296875,
			"seed": 1682863034,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "xCj5F3EzprFx8Kbd45xng",
				"focus": 0.13956018586282404,
				"gap": 5.258759110661415
			},
			"endBinding": {
				"elementId": "dsxq3yRIlFA8bQrIjgmC_",
				"focus": 0.5190181477708177,
				"gap": 10.821990874859466
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					94.39996337890625,
					-0.79998779296875
				]
			]
		},
		{
			"type": "arrow",
			"version": 108,
			"versionNonce": 220270848,
			"isDeleted": false,
			"id": "E3yAYmt3BM6DoFJmwhmxU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2414.216015049131,
			"y": 389.78011967562776,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 185.5999755859375,
			"height": 1.5999755859375,
			"seed": 1833193594,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "nF_I13wqwbABmkdRpi04b",
				"focus": -0.5765751683056601,
				"gap": 1.2218932186094662
			},
			"endBinding": {
				"elementId": "t2gzkvIK",
				"focus": 0.5938975289118368,
				"gap": 6.4000244140625
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					185.5999755859375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "text",
			"version": 38,
			"versionNonce": 502562560,
			"isDeleted": false,
			"id": "6poHL9HA",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2331.016063877256,
			"y": 402.58013798617463,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 38.4,
			"seed": 1468470906,
			"groupIds": [
				"Lwrh1Cbj_lStmb6yGj_-s"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "listing\nservice",
			"rawText": "listing\nservice",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "listing\nservice",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 47,
			"versionNonce": 1222045952,
			"isDeleted": false,
			"id": "t2gzkvIK",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2606.216015049131,
			"y": 380.18011357211213,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 38.4,
			"seed": 416353594,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "E3yAYmt3BM6DoFJmwhmxU",
					"type": "arrow"
				},
				{
					"id": "a9NZSmfejhnCEmXjx12jj",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "inventory\ndb",
			"rawText": "inventory\ndb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "inventory\ndb",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 63,
			"versionNonce": 151822080,
			"isDeleted": false,
			"id": "Ue7DgiYy",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2590.216015049131,
			"y": 632.9801624002371,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 112.5,
			"height": 38.4,
			"seed": 177924262,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "mQZTNUwEX2RtCuAxSJNz9",
					"type": "arrow"
				},
				{
					"id": "EOgJ1aTXJLbUFrEAVikc3",
					"type": "arrow"
				},
				{
					"id": "zuMZt_R6lc5f9_mknCHeB",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "reservations\ndb",
			"rawText": "reservations\ndb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "reservations\ndb",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 367,
			"versionNonce": 237824252,
			"isDeleted": false,
			"id": "5KnzdnUtOWdahqh1cKijM",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2025.9940913129435,
			"y": 655.6009026443506,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 81.53318942534497,
			"height": 2.378670019496667,
			"seed": 1424360762,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474267,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "tgxq3PLUh04C0bTPLs3Ae",
				"gap": 1,
				"focus": -0.1622195854148058
			},
			"endBinding": {
				"elementId": "FAdWgnyj6dsYwnz2s4rcI",
				"gap": 5.513390915511536,
				"focus": -0.08725180091117855
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					81.53318942534497,
					2.378670019496667
				]
			]
		},
		{
			"type": "arrow",
			"version": 164,
			"versionNonce": 471908096,
			"isDeleted": false,
			"id": "9qsjbdJRvZxLgIfFd-44-",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2160.0160333596777,
			"y": 651.7801196756277,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 128.79998779296875,
			"height": 4,
			"seed": 1892096314,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "me1iqEzODfK3ROd9QnrOv",
				"focus": 2.218391244200335,
				"gap": 12.106385732192155
			},
			"endBinding": {
				"elementId": "KUQUb7Ox6rf8qT9bFNmUG",
				"focus": 0.1261485442217421,
				"gap": 21.821624663921966
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					128.79998779296875,
					4
				]
			]
		},
		{
			"type": "arrow",
			"version": 185,
			"versionNonce": 1116647680,
			"isDeleted": false,
			"id": "mQZTNUwEX2RtCuAxSJNz9",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2419.8160516702246,
			"y": 671.9801013650808,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 157.5999755859375,
			"height": 0.00006103515625,
			"seed": 399453626,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "KUQUb7Ox6rf8qT9bFNmUG",
				"focus": 0.15414480307374157,
				"gap": 11.822387603375091
			},
			"endBinding": {
				"elementId": "Ue7DgiYy",
				"focus": -1.0312502227290299,
				"gap": 12.79998779296875
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					157.5999755859375,
					0.00006103515625
				]
			]
		},
		{
			"type": "arrow",
			"version": 283,
			"versionNonce": 2008080128,
			"isDeleted": false,
			"id": "jIW5Y346uzM5uQW-3lwMl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2387.6161004983496,
			"y": 603.5801074685965,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 216,
			"height": 157.59997558593744,
			"seed": 665281146,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "text",
					"id": "dkNrOz7y"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "KUQUb7Ox6rf8qT9bFNmUG",
				"focus": -0.473357767274218,
				"gap": 11.495029782934125
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					216,
					-157.59997558593744
				]
			]
		},
		{
			"type": "text",
			"version": 39,
			"versionNonce": 1066438912,
			"isDeleted": false,
			"id": "dkNrOz7y",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2420.6161004983496,
			"y": 515.1801196756277,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 150,
			"height": 19.2,
			"seed": 1715389626,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "update inventory",
			"rawText": "update inventory",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "jIW5Y346uzM5uQW-3lwMl",
			"originalText": "update inventory",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 69,
			"versionNonce": 742194944,
			"isDeleted": false,
			"id": "a9NZSmfejhnCEmXjx12jj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2599.016063877256,
			"y": 407.3801257791434,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 184,
			"height": 3.20001220703125,
			"seed": 1349500218,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "t2gzkvIK",
				"focus": -0.3582424382410223,
				"gap": 7.199951171875
			},
			"endBinding": {
				"elementId": "nF_I13wqwbABmkdRpi04b",
				"focus": -0.14791816315577488,
				"gap": 2.021942046734466
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-184,
					3.20001220703125
				]
			]
		},
		{
			"type": "arrow",
			"version": 69,
			"versionNonce": 22442240,
			"isDeleted": false,
			"id": "yjIqg9kiaUFZhFJtmDy6x",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2285.415966221006,
			"y": 405.78011967562776,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 89.5999755859375,
			"height": 1.5999755859375,
			"seed": 1272594618,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "dsxq3yRIlFA8bQrIjgmC_",
				"focus": 0.01982427828675947,
				"gap": 13.222015288921966
			},
			"endBinding": {
				"elementId": "AqZH0Ql1DHIbB5krqnI6L",
				"focus": -2.0912783824065064,
				"gap": 12.135233673184683
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-89.5999755859375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "arrow",
			"version": 70,
			"versionNonce": 977608448,
			"isDeleted": false,
			"id": "gcoHUuHqmgw2EHRlu0hyX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2145.416027256162,
			"y": 401.78011967562776,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 113.60003662109375,
			"height": 1.5999755859375,
			"seed": 1055319802,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "jBB-u9AB_zJuwYikCZRva",
				"focus": -0.07015235107943732,
				"gap": 1.6243544806457066
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-113.60003662109375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "text",
			"version": 192,
			"versionNonce": 1331712256,
			"isDeleted": false,
			"id": "E0chhgBe",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2734.816112705381,
			"y": 357.7801501932059,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 356.25,
			"height": 57.599999999999994,
			"seed": 565050874,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"rawText": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 423,
			"versionNonce": 306790144,
			"isDeleted": false,
			"id": "dE8JToFa",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2276.416027256162,
			"y": 833.5801379861746,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 431.25,
			"height": 249.6,
			"seed": 212636154,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "1) receive request from user\n2) update inventory\n\n3) create a record in reservation\n4) return a response to user\n\n\nwhat if 3) steps fails so have inventory \ndecreased but not actually used.\n\nThus you need to do either roll back for \nboth 2) and 3) or roll forward means try again\nfor the failed one.",
			"rawText": "1) receive request from user\n2) update inventory\n\n3) create a record in reservation\n4) return a response to user\n\n\nwhat if 3) steps fails so have inventory \ndecreased but not actually used.\n\nThus you need to do either roll back for \nboth 2) and 3) or roll forward means try again\nfor the failed one.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "1) receive request from user\n2) update inventory\n\n3) create a record in reservation\n4) return a response to user\n\n\nwhat if 3) steps fails so have inventory \ndecreased but not actually used.\n\nThus you need to do either roll back for \nboth 2) and 3) or roll forward means try again\nfor the failed one.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 545,
			"versionNonce": 19804416,
			"isDeleted": false,
			"id": "9YdbCteO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2271.1909906350684,
			"y": 1137.5800647439871,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 384.375,
			"height": 153.6,
			"seed": 887948474,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "1) receive request from user\n2) update inventory PREPARE\n\n3) create a record in reservation PREPARE\n4) update inventory COMMIT\n5) create a record in reservation COMMIT\n6) return a response to user\n",
			"rawText": "1) receive request from user\n2) update inventory PREPARE\n\n3) create a record in reservation PREPARE\n4) update inventory COMMIT\n5) create a record in reservation COMMIT\n6) return a response to user\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "1) receive request from user\n2) update inventory PREPARE\n\n3) create a record in reservation PREPARE\n4) update inventory COMMIT\n5) create a record in reservation COMMIT\n6) return a response to user\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 29,
			"versionNonce": 348741376,
			"isDeleted": false,
			"id": "OzT3EfbP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2274.8159906350684,
			"y": 1110.3801257791433,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 778595430,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996504,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "thus",
			"rawText": "thus",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "thus",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 263,
			"versionNonce": 647931132,
			"isDeleted": false,
			"id": "EOgJ1aTXJLbUFrEAVikc3",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3084.216015049131,
			"y": 531.3801257791433,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 380,
			"height": 112,
			"seed": 1470075386,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474266,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "fqwD8WmKzG0H93qfOFWUS",
				"gap": 2.621856597515716,
				"focus": 0.23596967265858418
			},
			"endBinding": {
				"elementId": "Ue7DgiYy",
				"gap": 1.5,
				"focus": 0.22977243924568683
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-380,
					112
				]
			]
		},
		{
			"type": "arrow",
			"version": 271,
			"versionNonce": 54433276,
			"isDeleted": false,
			"id": "zuMZt_R6lc5f9_mknCHeB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2707.416027256162,
			"y": 664.9801624002372,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 375.99993896484375,
			"height": 116.00003051757824,
			"seed": 469783354,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474266,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ue7DgiYy",
				"gap": 4.70001220703125,
				"focus": 0.8645830258465732
			},
			"endBinding": {
				"elementId": "fqwD8WmKzG0H93qfOFWUS",
				"gap": 3.421905425640716,
				"focus": -0.025288607138779163
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					375.99993896484375,
					-116.00003051757824
				]
			]
		},
		{
			"type": "arrow",
			"version": 664,
			"versionNonce": 995510012,
			"isDeleted": false,
			"id": "EBXn2RMpNnRXXVSaCyu4d",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3265.778632601642,
			"y": 529.9677058285304,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 80.5847427047147,
			"height": 2.6111128564688215,
			"seed": 567089702,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474266,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ad_OIumeVxsAsS4j9bTgk",
				"gap": 11.448851556750522,
				"focus": -1.433019477163381
			},
			"endBinding": {
				"elementId": "fqwD8WmKzG0H93qfOFWUS",
				"gap": 1,
				"focus": 0.057158970421256124
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-80.5847427047147,
					2.6111128564688215
				]
			]
		},
		{
			"type": "arrow",
			"version": 627,
			"versionNonce": 603305980,
			"isDeleted": false,
			"id": "_ciPde9dq86RFQsVO0SXP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3188.2158929788184,
			"y": 542.0949015331469,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 78.400146484375,
			"height": 1.2393511414231853,
			"seed": 95306470,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474266,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "fqwD8WmKzG0H93qfOFWUS",
				"gap": 4.022003081890716,
				"focus": 0.23261138231259618
			},
			"endBinding": {
				"elementId": "1GYphjxxBSsY8bTAENf86",
				"gap": 3.324351428887894,
				"focus": -0.042133160383512065
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					78.400146484375,
					-1.2393511414231853
				]
			]
		},
		{
			"type": "rectangle",
			"version": 2230,
			"versionNonce": 1211093248,
			"isDeleted": false,
			"id": "1GYphjxxBSsY8bTAENf86",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 3269.9403908920813,
			"y": 470.1878587790333,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 990527546,
			"groupIds": [
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "_ciPde9dq86RFQsVO0SXP",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2050,
			"versionNonce": 1882308352,
			"isDeleted": false,
			"id": "VSj1R8XsDVRqYYam3mb4N",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3298.7496724924695,
			"y": 516.8662577411942,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1460283642,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "Byy4dL9ZckjSiEhfZIDDX"
				},
				{
					"type": "arrow",
					"id": "OJS8pG32XN0KYww9LxgiR"
				},
				{
					"id": "pFSuUpwZkjuhnnlx_K2B-",
					"type": "arrow"
				},
				{
					"id": "3GYrr6eiYmgvk0uvOHbDf",
					"type": "arrow"
				},
				{
					"id": "QATQli7JR_GPN2OYzgl-q",
					"type": "arrow"
				}
			],
			"updated": 1718371996504,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2357,
			"versionNonce": 873312512,
			"isDeleted": false,
			"id": "Ad_OIumeVxsAsS4j9bTgk",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3274.661359537943,
			"y": 514.9346277158784,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1687091642,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "pFSuUpwZkjuhnnlx_K2B-"
				},
				{
					"type": "arrow",
					"id": "Byy4dL9ZckjSiEhfZIDDX"
				},
				{
					"type": "arrow",
					"id": "OJS8pG32XN0KYww9LxgiR"
				},
				{
					"id": "EBXn2RMpNnRXXVSaCyu4d",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2354,
			"versionNonce": 564256512,
			"isDeleted": false,
			"id": "tLfEe-hAuaI3VvsVMPaoA",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3299.078134102134,
			"y": 550.6636221559966,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 851161722,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "OJS8pG32XN0KYww9LxgiR"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2069,
			"versionNonce": 690983168,
			"isDeleted": false,
			"id": "XNudY8UY2s1L_46sHG-_s",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3298.622789896921,
			"y": 482.41077582475117,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 877876026,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "Byy4dL9ZckjSiEhfZIDDX"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6487,
			"versionNonce": 1879965440,
			"isDeleted": false,
			"id": "pFSuUpwZkjuhnnlx_K2B-",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3283.3907143535907,
			"y": 527.1011558740688,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 196664314,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ad_OIumeVxsAsS4j9bTgk",
				"focus": 0.24472012017717362,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5379,
			"versionNonce": 1595240704,
			"isDeleted": false,
			"id": "OJS8pG32XN0KYww9LxgiR",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3287.388511266852,
			"y": 521.09502397237,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 384781498,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ad_OIumeVxsAsS4j9bTgk",
				"focus": -0.05630840266131453,
				"gap": 1
			},
			"endBinding": {
				"elementId": "VSj1R8XsDVRqYYam3mb4N",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6348,
			"versionNonce": 1542856448,
			"isDeleted": false,
			"id": "Byy4dL9ZckjSiEhfZIDDX",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3284.4071773284986,
			"y": 515.4482149088103,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 2073666938,
			"groupIds": [
				"o8A5CDV1n9ILcGT1ewuWv",
				"oNf_kZFVtwI6tv3h1Zc52",
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ad_OIumeVxsAsS4j9bTgk",
				"focus": -0.08869372840681218,
				"gap": 1
			},
			"endBinding": {
				"elementId": "XNudY8UY2s1L_46sHG-_s",
				"focus": -0.09679793421693647,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1126,
			"versionNonce": 490688768,
			"isDeleted": false,
			"id": "ennNSDym",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3272.1759437397895,
			"y": 574.6481055336083,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 855303738,
			"groupIds": [
				"Cx46Aik_1ODao_akwlVL4"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 732,
			"versionNonce": 394658556,
			"isDeleted": false,
			"id": "3GYrr6eiYmgvk0uvOHbDf",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3318.5409876808794,
			"y": 539.1297990232063,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 88.07499074715815,
			"height": 4.769132366590725,
			"seed": 582305574,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474265,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "VSj1R8XsDVRqYYam3mb4N",
				"gap": 15.180920223717887,
				"focus": 2.5977467264735736
			},
			"endBinding": {
				"elementId": "slsoqkgE_v6YKY7vuu7-2",
				"gap": 2.5220641170471936,
				"focus": -0.3293223061163617
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					88.07499074715815,
					4.769132366590725
				]
			]
		},
		{
			"type": "arrow",
			"version": 762,
			"versionNonce": 1281782780,
			"isDeleted": false,
			"id": "QATQli7JR_GPN2OYzgl-q",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3407.087932681803,
			"y": 519.6111658582412,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 89.071182550103,
			"height": 2.1883376700462804,
			"seed": 380409210,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474266,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "slsoqkgE_v6YKY7vuu7-2",
				"gap": 2.05010986328125,
				"focus": 0.050816620335350206
			},
			"endBinding": {
				"elementId": "VSj1R8XsDVRqYYam3mb4N",
				"gap": 8.039872163661117,
				"focus": -0.960420199824958
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-89.071182550103,
					-2.1883376700462804
				]
			]
		},
		{
			"type": "text",
			"version": 381,
			"versionNonce": 1044012800,
			"isDeleted": false,
			"id": "zCUKjLmU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2509.815929599912,
			"y": 220.18017460726836,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 111.90234375,
			"height": 101.89938888888888,
			"seed": 588395386,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 10.614519675925925,
			"fontFamily": 3,
			"text": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"rawText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 383,
			"versionNonce": 543101184,
			"isDeleted": false,
			"id": "YleIbjpy",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2737.6409418069434,
			"y": 656.38014408969,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 124.921875,
			"height": 102.39998779296884,
			"seed": 1907824550,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 10.666665395100921,
			"fontFamily": 3,
			"text": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"rawText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 246,
			"versionNonce": 1704361728,
			"isDeleted": false,
			"id": "osr6pdQ2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2624.2159540139746,
			"y": 744.1801746072682,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 160.6171875,
			"height": 89.7303409090909,
			"seed": 99751910,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 12.462547348484847,
			"fontFamily": 3,
			"text": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"rawText": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 191,
			"versionNonce": 1146417408,
			"isDeleted": false,
			"id": "eHUuaaO4",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2669.815929599912,
			"y": 274.5801379861746,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 256.59375,
			"height": 46.399987792968815,
			"seed": 1739239142,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 12.888885498046893,
			"fontFamily": 3,
			"text": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"rawText": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1535,
			"versionNonce": 208576256,
			"isDeleted": false,
			"id": "YTdsLiibhKL0ApIhwwpqS",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 1918.4039371170234,
			"y": 1442.3356355527194,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1009725798,
			"groupIds": [
				"wcmS_e4hEhr55jQCcCSCR"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "VwWpvnAPaXzw7-02vNmYD",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "SeLtXQyE"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 98,
			"versionNonce": 781111552,
			"isDeleted": false,
			"id": "SeLtXQyE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1948.331946242164,
			"y": 1482.0404867512304,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 122688678,
			"groupIds": [
				"wcmS_e4hEhr55jQCcCSCR"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "YTdsLiibhKL0ApIhwwpqS",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1556,
			"versionNonce": 1665318656,
			"isDeleted": false,
			"id": "NNvLWEsD2M4Sza3ViLOQ7",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2421.4043338455394,
			"y": 1944.942054162339,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1112559206,
			"groupIds": [
				"Zx2oDCNmW9hqcPAMZNJma"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "LHpNlrs1"
				},
				{
					"id": "1lG4XuHWzoQLObnefdaeU",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 47,
			"versionNonce": 1988931840,
			"isDeleted": false,
			"id": "LHpNlrs1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2427.8948429706797,
			"y": 1965.4469053608502,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 57.599999999999994,
			"seed": 539361830,
			"groupIds": [
				"Zx2oDCNmW9hqcPAMZNJma"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "external\npayment\nprocessor",
			"rawText": "external payment\nprocessor",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "NNvLWEsD2M4Sza3ViLOQ7",
			"originalText": "external payment\nprocessor",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1671,
			"versionNonce": 177397504,
			"isDeleted": false,
			"id": "DFq-A3N5vyTMusptXZJsk",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2275.40482212679,
			"y": 1711.7419351437838,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1162187174,
			"groupIds": [
				"RhebzZS6O9PRCfDHg53BA"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1548,
			"versionNonce": 1137611008,
			"isDeleted": false,
			"id": "Xj0UrjVp0_C3pZeXSZ6S2",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2269.404303327961,
			"y": 1449.242087731675,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1973280806,
			"groupIds": [
				"yxPtuNtv0IeWIfgIAXERU"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1543,
			"versionNonce": 316604160,
			"isDeleted": false,
			"id": "Sp0pLlSO-eLTG1oTn68ya",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2279.4044559158515,
			"y": 1465.24199617894,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1685777254,
			"groupIds": [
				"XpU8ZmtuP3vVwkhY33evK"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "wWVusJ-cTO5UJEonXUJ2N",
					"type": "arrow"
				},
				{
					"id": "QZTowdrq-GM6RxMiTh_-w",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1599,
			"versionNonce": 1305768192,
			"isDeleted": false,
			"id": "zXXWHdg59fVu5eiVVTkC2",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2291.404120222492,
			"y": 1721.7418588498385,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1645514406,
			"groupIds": [
				"Z59NbgY-JmwBqOZVe2kYq"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "Bg1gRO4byJot44N1FEFpn",
					"type": "arrow"
				},
				{
					"id": "56k_J9FWAYOFENqgaUwJX",
					"type": "arrow"
				},
				{
					"id": "nmgL0kkXhctoI-KoaoXtq",
					"type": "arrow"
				},
				{
					"id": "lwZwOYC4tJbZyTHWF5hwp",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1692,
			"versionNonce": 2091327232,
			"isDeleted": false,
			"id": "cnImRNv-AkYoKq1uBhA0F",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3389.9045169510086,
			"y": 1565.4419931271823,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 130.15594500809328,
			"height": 131.83200415465078,
			"seed": 454543846,
			"groupIds": [
				"2uIsgKkJUarfhaD4fV_2t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "kAmb5NoXidiNjqeHAJpnZ",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "WwnbNqt4"
				},
				{
					"id": "vJUqSuuiU9PitCp-V0CyO",
					"type": "arrow"
				},
				{
					"id": "zKUI4gRLPnjycYCpDULf9",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 325,
			"versionNonce": 1545490688,
			"isDeleted": false,
			"id": "WwnbNqt4",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3403.419989455055,
			"y": 1602.5579952045077,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 103.125,
			"height": 57.599999999999994,
			"seed": 512859430,
			"groupIds": [
				"2uIsgKkJUarfhaD4fV_2t"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "browser/app\nfrontdesk\nuser",
			"rawText": "browser/app frontdesk user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "cnImRNv-AkYoKq1uBhA0F",
			"originalText": "browser/app frontdesk user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1558,
			"versionNonce": 946552576,
			"isDeleted": false,
			"id": "Wz_MVatkovdD10CA-x-zw",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2296.404577986165,
			"y": 1476.2420572140963,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 300877926,
			"groupIds": [
				"LAzt7JHfMTjx-ZG8OHBKx"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "jnfExccceJQmQ7MWUUZHj",
					"type": "arrow"
				},
				{
					"id": "uA7c1TPVYDlm-fvDvGcHl",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1535,
			"versionNonce": 1177301248,
			"isDeleted": false,
			"id": "OshUvji0k_ydtnyyvo6JP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3067.6043460525716,
			"y": 1588.6419900754245,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1694305190,
			"groupIds": [
				"hwe6DeYxjFrl0ROkhYMEe"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "86UBr-msOMUt2zZw0cRdv",
					"type": "arrow"
				},
				{
					"id": "gGC4_46QHRLLaDLfdU2E4",
					"type": "arrow"
				},
				{
					"id": "kAmb5NoXidiNjqeHAJpnZ",
					"type": "arrow"
				},
				{
					"id": "8hW8XXauzMWni7I4Ebw1I",
					"type": "arrow"
				},
				{
					"type": "text",
					"id": "XqvKharD"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 119,
			"versionNonce": 648765184,
			"isDeleted": false,
			"id": "XqvKharD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3083.469855177712,
			"y": 1609.1468412739357,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 57.599999999999994,
			"seed": 99133158,
			"groupIds": [
				"hwe6DeYxjFrl0ROkhYMEe"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "admin\nbackend\nservice",
			"rawText": "admin backend service",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "OshUvji0k_ydtnyyvo6JP",
			"originalText": "admin backend service",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1551,
			"versionNonce": 1937641728,
			"isDeleted": false,
			"id": "sYtF9Otuu9GyDiaOk2S4j",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2303.404242292806,
			"y": 1744.2420877316745,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 356440614,
			"groupIds": [
				"Use7VSANR0oy3BzEaumVx"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "vCXxVPSO"
				},
				{
					"id": "1lG4XuHWzoQLObnefdaeU",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 111,
			"versionNonce": 401047296,
			"isDeleted": false,
			"id": "vCXxVPSO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2319.2697514179463,
			"y": 1774.3469389301856,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 38.4,
			"seed": 434939238,
			"groupIds": [
				"Use7VSANR0oy3BzEaumVx"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "booking\nservice",
			"rawText": "booking\nservice",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "sYtF9Otuu9GyDiaOk2S4j",
			"originalText": "booking\nservice",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1543,
			"versionNonce": 1536422144,
			"isDeleted": false,
			"id": "D2kSK4HoyGq8krXJcVkPE",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 1908.4045474685868,
			"y": 1719.7420419553073,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 893323430,
			"groupIds": [
				"MuaeX6cYFRvUjeiU-UMYY"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "2JIa4WK8"
				},
				{
					"id": "MkmlZo1gsPIYDpePnHsvi",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 97,
			"versionNonce": 1285529344,
			"isDeleted": false,
			"id": "2JIa4WK8",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1938.3325565937273,
			"y": 1759.4468931538183,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1457718246,
			"groupIds": [
				"MuaeX6cYFRvUjeiU-UMYY"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "D2kSK4HoyGq8krXJcVkPE",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 2196,
			"versionNonce": 99471616,
			"isDeleted": false,
			"id": "N3harmkbq3Pyd7vO7g6DP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 2127.806856142732,
			"y": 1436.6545681703105,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 1894094630,
			"groupIds": [
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "zbyatCphF8COYLzXWnE5K",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2015,
			"versionNonce": 1968422656,
			"isDeleted": false,
			"id": "bjCiMusDzL7DS1QQGsdyv",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2156.6161377431195,
			"y": 1483.3329671324714,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 733200998,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "bJ99tZSuhe0LzxAT47Cc-"
				},
				{
					"type": "arrow",
					"id": "rGkjtl1CguYsej91yddZe"
				},
				{
					"id": "_Zhu4DO481q-yS703QB1J",
					"type": "arrow"
				},
				{
					"id": "wWVusJ-cTO5UJEonXUJ2N",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2323,
			"versionNonce": 168538368,
			"isDeleted": false,
			"id": "I0XdqzwKdsIOSUWmHRj2Q",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2132.527824788594,
			"y": 1481.4013371071555,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 437945766,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "_Zhu4DO481q-yS703QB1J"
				},
				{
					"type": "arrow",
					"id": "bJ99tZSuhe0LzxAT47Cc-"
				},
				{
					"type": "arrow",
					"id": "rGkjtl1CguYsej91yddZe"
				},
				{
					"id": "VwWpvnAPaXzw7-02vNmYD",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2321,
			"versionNonce": 847503104,
			"isDeleted": false,
			"id": "DekdSIqCyrNtr94aa6uTc",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2156.9445993527856,
			"y": 1517.1303315472737,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1833361638,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "rGkjtl1CguYsej91yddZe"
				},
				{
					"id": "QZTowdrq-GM6RxMiTh_-w",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2036,
			"versionNonce": 258838784,
			"isDeleted": false,
			"id": "pMc7JGHz9Gw37rwhC86YW",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2156.489255147571,
			"y": 1448.8774852160282,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 684053542,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "bJ99tZSuhe0LzxAT47Cc-"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6418,
			"versionNonce": 347078400,
			"isDeleted": false,
			"id": "_Zhu4DO481q-yS703QB1J",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2141.2571796042425,
			"y": 1493.567865265346,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 1451515750,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "I0XdqzwKdsIOSUWmHRj2Q",
				"focus": 0.24472012017705205,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5277,
			"versionNonce": 1301508352,
			"isDeleted": false,
			"id": "rGkjtl1CguYsej91yddZe",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2145.254976517503,
			"y": 1487.561733363647,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 986677926,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "I0XdqzwKdsIOSUWmHRj2Q",
				"focus": -0.05630840266135244,
				"gap": 1
			},
			"endBinding": {
				"elementId": "bjCiMusDzL7DS1QQGsdyv",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6243,
			"versionNonce": 475537152,
			"isDeleted": false,
			"id": "bJ99tZSuhe0LzxAT47Cc-",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2142.2736425791495,
			"y": 1481.9149243000875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 139738598,
			"groupIds": [
				"Gd3Tzvouqqufn_3do4ymW",
				"eQORB1qPl-Cux1SUmw2hY",
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "I0XdqzwKdsIOSUWmHRj2Q",
				"focus": -0.08869372840681351,
				"gap": 1
			},
			"endBinding": {
				"elementId": "pMc7JGHz9Gw37rwhC86YW",
				"focus": -0.09679793421707263,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1093,
			"versionNonce": 201150720,
			"isDeleted": false,
			"id": "VJrbKPkM",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2130.0424089904404,
			"y": 1541.1148149248852,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 337613094,
			"groupIds": [
				"8sXEjIWG3SRjIUlz0YqUh"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "rectangle",
			"version": 2229,
			"versionNonce": 972832512,
			"isDeleted": false,
			"id": "le-dNgRvk-Z3cWm_ukEiF",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 2093.8071460597243,
			"y": 1692.1545986878887,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 161381478,
			"groupIds": [
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "MkmlZo1gsPIYDpePnHsvi",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2048,
			"versionNonce": 573255936,
			"isDeleted": false,
			"id": "G7zKyr276vb_uVXNcseGJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2122.6164276601125,
			"y": 1738.8329976500495,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 513671078,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "s12M7n6tDyAiQoUpf5ywP"
				},
				{
					"type": "arrow",
					"id": "zANQWJzK739GauyT-OWbE"
				},
				{
					"id": "5d6WYIKxx69vtLxyXzry4",
					"type": "arrow"
				},
				{
					"id": "Bg1gRO4byJot44N1FEFpn",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2355,
			"versionNonce": 1310482176,
			"isDeleted": false,
			"id": "U-emJ9roYf7wa3oNKGcMr",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2098.528114705586,
			"y": 1736.9013676247337,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1196104422,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "5d6WYIKxx69vtLxyXzry4"
				},
				{
					"type": "arrow",
					"id": "s12M7n6tDyAiQoUpf5ywP"
				},
				{
					"type": "arrow",
					"id": "zANQWJzK739GauyT-OWbE"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2354,
			"versionNonce": 2006782208,
			"isDeleted": false,
			"id": "pTijUSuOXgopC8wkTShIH",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2122.944889269777,
			"y": 1772.6303620648519,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1781714470,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "zANQWJzK739GauyT-OWbE"
				},
				{
					"id": "MkmlZo1gsPIYDpePnHsvi",
					"type": "arrow"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2069,
			"versionNonce": 691568384,
			"isDeleted": false,
			"id": "GyNaZHXKzrocBpqai3GfH",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2122.489545064564,
			"y": 1704.3775157336063,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 339876198,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "s12M7n6tDyAiQoUpf5ywP"
				}
			],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6482,
			"versionNonce": 64155904,
			"isDeleted": false,
			"id": "5d6WYIKxx69vtLxyXzry4",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2107.257469521234,
			"y": 1749.067895782924,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 751172774,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "U-emJ9roYf7wa3oNKGcMr",
				"focus": 0.24472012017717362,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5372,
			"versionNonce": 198221568,
			"isDeleted": false,
			"id": "zANQWJzK739GauyT-OWbE",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2111.2552664344953,
			"y": 1743.061763881225,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 694908902,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "U-emJ9roYf7wa3oNKGcMr",
				"focus": -0.05630840266135244,
				"gap": 1
			},
			"endBinding": {
				"elementId": "G7zKyr276vb_uVXNcseGJ",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6338,
			"versionNonce": 1313657088,
			"isDeleted": false,
			"id": "s12M7n6tDyAiQoUpf5ywP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2108.2739324961417,
			"y": 1737.4149548176656,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 1111460646,
			"groupIds": [
				"qUHRrH0DrWnyRWMUfHdLI",
				"XwJ04GgcA2fzmKCPWjaGy",
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "U-emJ9roYf7wa3oNKGcMr",
				"focus": -0.08869372840681351,
				"gap": 1
			},
			"endBinding": {
				"elementId": "GyNaZHXKzrocBpqai3GfH",
				"focus": -0.09679793421695505,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1126,
			"versionNonce": 644136704,
			"isDeleted": false,
			"id": "mXZzR1sM",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2096.0426989074326,
			"y": 1796.6148454424633,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 632239718,
			"groupIds": [
				"ZvNLaF03GC0voeRNr1-63"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "line",
			"version": 6131,
			"versionNonce": 1854583040,
			"isDeleted": false,
			"id": "qUxQWGKtik1mwanqxhfXI",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2582.775218052648,
			"y": 1449.2139836690128,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 92.11307787956703,
			"height": 118.88655065768039,
			"seed": 747076006,
			"groupIds": [
				"WQMDGk6StIrTx2COsY70Z",
				"eLnCsIbYKth1rVNsX8fQr",
				"NkiZewut02Qe541QrbP1o"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.3037416266730522,
					89.85381061304011
				],
				[
					0.014214395083438337,
					100.08327676463979
				],
				[
					4.744027232376133,
					104.50330259458084
				],
				[
					21.21536443588695,
					108.24407565183367
				],
				[
					49.056590103625815,
					109.40889650084321
				],
				[
					75.65704013946701,
					107.54908938840468
				],
				[
					89.79005509834187,
					103.10139431612642
				],
				[
					91.7833256149989,
					99.35194071225722
				],
				[
					92.06327324335884,
					91.116272110502
				],
				[
					91.84354690714618,
					7.5382331841028245
				],
				[
					91.34821321588112,
					-0.3583515654722076
				],
				[
					85.43362435223172,
					-4.771804727432435
				],
				[
					72.97876243038847,
					-7.32784326367497
				],
				[
					44.59581491807233,
					-9.477654156837188
				],
				[
					21.839889445416063,
					-8.195717080535312
				],
				[
					3.942508604844666,
					-3.8475429335799025
				],
				[
					-0.04980463620819661,
					-0.05398989975514504
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6851,
			"versionNonce": 427089664,
			"isDeleted": false,
			"id": "bTNEym3bkWZGaywgI8NhE",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2583.1017808074425,
			"y": 1438.4654199585402,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 91.52224951272136,
			"height": 18.509686413792895,
			"seed": 234181862,
			"groupIds": [
				"WQMDGk6StIrTx2COsY70Z",
				"eLnCsIbYKth1rVNsX8fQr",
				"NkiZewut02Qe541QrbP1o"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "line",
			"version": 6213,
			"versionNonce": 202150144,
			"isDeleted": false,
			"id": "NdBUrKuhf0c45PChKCVHY",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2560.8506520515616,
			"y": 1693.4000108872538,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 125.45255473481755,
			"height": 161.91643843577114,
			"seed": 327534630,
			"groupIds": [
				"128-jDE7Ze4KQhdiGGbJD",
				"q0ry5HbMpToM_aR-qJk_f",
				"-Prlx02CH4o6THxmAznse"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.41367810003335337,
					122.37556657049717
				],
				[
					0.019359163956706033,
					136.30749341338677
				],
				[
					6.461084025563227,
					142.32730672464072
				],
				[
					28.894069434874467,
					147.42201800254537
				],
				[
					66.81216931134377,
					149.00843498784775
				],
				[
					103.04040628823884,
					146.47548788695457
				],
				[
					122.28873533674135,
					140.41799070693102
				],
				[
					125.00345168699899,
					135.31145703882305
				],
				[
					125.38472377103056,
					124.0949643341677
				],
				[
					125.08546951902913,
					10.266626986115021
				],
				[
					124.41085437809686,
					-0.48805360125396546
				],
				[
					116.35553476190681,
					-6.498915328122704
				],
				[
					99.39275072588195,
					-9.980088379266624
				],
				[
					60.73685779198456,
					-12.908003447923406
				],
				[
					29.744635497205486,
					-11.162081099724166
				],
				[
					5.369463141687927,
					-5.240125523767397
				],
				[
					-0.06783096378698307,
					-0.07353104477754188
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6931,
			"versionNonce": 1971388160,
			"isDeleted": false,
			"id": "60bJ4DEfTXtzJkX0UYQtb",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 2561.295411176033,
			"y": 1678.7611039236658,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 124.647881503428,
			"height": 25.209096269551086,
			"seed": 1294324582,
			"groupIds": [
				"128-jDE7Ze4KQhdiGGbJD",
				"q0ry5HbMpToM_aR-qJk_f",
				"-Prlx02CH4o6THxmAznse"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 466,
			"versionNonce": 1191959036,
			"isDeleted": false,
			"id": "VwWpvnAPaXzw7-02vNmYD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2016.7599553673042,
			"y": 1483.6480946528563,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 114.22272398032487,
			"height": 0.7987479489793259,
			"seed": 1159886502,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474267,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "YTdsLiibhKL0ApIhwwpqS",
				"gap": 1,
				"focus": -0.16798757426905006
			},
			"endBinding": {
				"elementId": "I0XdqzwKdsIOSUWmHRj2Q",
				"gap": 2.1080345831072833,
				"focus": 0.48137536715069085
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					114.22272398032487,
					0.7987479489793259
				]
			]
		},
		{
			"type": "arrow",
			"version": 272,
			"versionNonce": 990453504,
			"isDeleted": false,
			"id": "wWVusJ-cTO5UJEonXUJ2N",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2174.1825016620865,
			"y": 1490.0468473774517,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 94.39996337890625,
			"height": 0.79998779296875,
			"seed": 875082214,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "bjCiMusDzL7DS1QQGsdyv",
				"focus": 0.13956018586283422,
				"gap": 5.258759110661872
			},
			"endBinding": {
				"elementId": "Sp0pLlSO-eLTG1oTn68ya",
				"focus": 0.5190181477708096,
				"gap": 10.821990874859011
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					94.39996337890625,
					-0.79998779296875
				]
			]
		},
		{
			"type": "arrow",
			"version": 313,
			"versionNonce": 752636160,
			"isDeleted": false,
			"id": "jnfExccceJQmQ7MWUUZHj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2394.982489455055,
			"y": 1496.4468412739361,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 185.5999755859375,
			"height": 1.5999755859375,
			"seed": 893748518,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996505,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Wz_MVatkovdD10CA-x-zw",
				"focus": -0.5765751683056523,
				"gap": 1.2218932186090115
			},
			"endBinding": {
				"elementId": "giozTE6N",
				"focus": 0.5938975289118397,
				"gap": 6.4000244140625
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					185.5999755859375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "text",
			"version": 107,
			"versionNonce": 1519206144,
			"isDeleted": false,
			"id": "rZZ3Pdlb",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2311.78253828318,
			"y": 1509.246859584483,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 65.625,
			"height": 38.4,
			"seed": 2045112422,
			"groupIds": [
				"LAzt7JHfMTjx-ZG8OHBKx"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "listing\nservice",
			"rawText": "listing\nservice",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "listing\nservice",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 116,
			"versionNonce": 1328165120,
			"isDeleted": false,
			"id": "giozTE6N",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2586.982489455055,
			"y": 1486.8468351704205,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.375,
			"height": 38.4,
			"seed": 2111239078,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "jnfExccceJQmQ7MWUUZHj",
					"type": "arrow"
				},
				{
					"id": "uA7c1TPVYDlm-fvDvGcHl",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "inventory\ndb",
			"rawText": "inventory\ndb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "inventory\ndb",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 132,
			"versionNonce": 881680128,
			"isDeleted": false,
			"id": "0mhF9IGq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2570.982489455055,
			"y": 1739.646883998545,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 112.5,
			"height": 38.4,
			"seed": 994414310,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "56k_J9FWAYOFENqgaUwJX",
					"type": "arrow"
				},
				{
					"id": "86UBr-msOMUt2zZw0cRdv",
					"type": "arrow"
				},
				{
					"id": "gGC4_46QHRLLaDLfdU2E4",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "reservations\ndb",
			"rawText": "reservations\ndb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "reservations\ndb",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 572,
			"versionNonce": 162468604,
			"isDeleted": false,
			"id": "MkmlZo1gsPIYDpePnHsvi",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2006.7605657188678,
			"y": 1762.2676242426587,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 81.53318942534497,
			"height": 2.3786700194964396,
			"seed": 1589559846,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474270,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "D2kSK4HoyGq8krXJcVkPE",
				"gap": 1.000000000000341,
				"focus": -0.16221958541480408
			},
			"endBinding": {
				"elementId": "le-dNgRvk-Z3cWm_ukEiF",
				"gap": 5.513390915511536,
				"focus": -0.08725180091117286
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					81.53318942534497,
					2.3786700194964396
				]
			]
		},
		{
			"type": "arrow",
			"version": 369,
			"versionNonce": 428441344,
			"isDeleted": false,
			"id": "Bg1gRO4byJot44N1FEFpn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2140.782507765602,
			"y": 1758.4468412739357,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 128.79998779296875,
			"height": 4,
			"seed": 2066713958,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "G7zKyr276vb_uVXNcseGJ",
				"focus": 2.2183912442002782,
				"gap": 12.106385732191896
			},
			"endBinding": {
				"elementId": "zXXWHdg59fVu5eiVVTkC2",
				"focus": 0.12614854422174238,
				"gap": 21.82162466392151
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					128.79998779296875,
					4
				]
			]
		},
		{
			"type": "arrow",
			"version": 390,
			"versionNonce": 1024585984,
			"isDeleted": false,
			"id": "56k_J9FWAYOFENqgaUwJX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2400.582526076149,
			"y": 1778.6468229633888,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 157.5999755859375,
			"height": 0.00006103515625,
			"seed": 1038413990,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "zXXWHdg59fVu5eiVVTkC2",
				"focus": 0.15414480307374157,
				"gap": 11.822387603375546
			},
			"endBinding": {
				"elementId": "0mhF9IGq",
				"focus": -1.0312502227290299,
				"gap": 12.79998779296875
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					157.5999755859375,
					0.00006103515625
				]
			]
		},
		{
			"type": "arrow",
			"version": 420,
			"versionNonce": 1241620224,
			"isDeleted": false,
			"id": "nmgL0kkXhctoI-KoaoXtq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2368.382574904274,
			"y": 1710.2468290669044,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 216,
			"height": 157.59997558593744,
			"seed": 579595238,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "text",
					"id": "ftp7zPpr"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "zXXWHdg59fVu5eiVVTkC2",
				"focus": -0.47335776727421386,
				"gap": 11.495029782934125
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					216,
					-157.59997558593744
				]
			]
		},
		{
			"type": "text",
			"version": 42,
			"versionNonce": 128700672,
			"isDeleted": false,
			"id": "ftp7zPpr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3073.382696974587,
			"y": 972.2468046528414,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 150,
			"height": 19.2,
			"seed": 657555238,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "update inventory",
			"rawText": "update inventory",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "nmgL0kkXhctoI-KoaoXtq",
			"originalText": "update inventory",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 274,
			"versionNonce": 1987428096,
			"isDeleted": false,
			"id": "uA7c1TPVYDlm-fvDvGcHl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2579.78253828318,
			"y": 1514.0468473774517,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 184,
			"height": 3.20001220703125,
			"seed": 4368998,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "giozTE6N",
				"focus": -0.3582424382410195,
				"gap": 7.199951171875
			},
			"endBinding": {
				"elementId": "Wz_MVatkovdD10CA-x-zw",
				"focus": -0.1479181631557671,
				"gap": 2.0219420467340115
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-184,
					3.20001220703125
				]
			]
		},
		{
			"type": "arrow",
			"version": 274,
			"versionNonce": 604614912,
			"isDeleted": false,
			"id": "QZTowdrq-GM6RxMiTh_-w",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2266.18244062693,
			"y": 1512.4468412739361,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 89.5999755859375,
			"height": 1.5999755859375,
			"seed": 1284271526,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Sp0pLlSO-eLTG1oTn68ya",
				"focus": 0.019824278286751706,
				"gap": 13.222015288921511
			},
			"endBinding": {
				"elementId": "DekdSIqCyrNtr94aa6uTc",
				"focus": -2.0912783824064953,
				"gap": 12.135233673184299
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-89.5999755859375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "arrow",
			"version": 207,
			"versionNonce": 1063640832,
			"isDeleted": false,
			"id": "zbyatCphF8COYLzXWnE5K",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2126.1825016620865,
			"y": 1508.4468412739361,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 113.60003662109375,
			"height": 1.5999755859375,
			"seed": 1228654822,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "N3harmkbq3Pyd7vO7g6DP",
				"focus": -0.07015235107943814,
				"gap": 1.6243544806457066
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-113.60003662109375,
					-1.5999755859375
				]
			]
		},
		{
			"type": "text",
			"version": 261,
			"versionNonce": 967545088,
			"isDeleted": false,
			"id": "TxNLM1Xe",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2715.582587111305,
			"y": 1464.4468717915142,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 356.25,
			"height": 57.599999999999994,
			"seed": 98417702,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"rawText": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "to handle large number of read we can \nhave read replicas of inventory db\nusing leader follower model.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 1068,
			"versionNonce": 894566144,
			"isDeleted": false,
			"id": "czHVU3l1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1903.1572941425547,
			"y": 2215.4467375141703,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2006.25,
			"height": 211.2,
			"seed": 1359833766,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "1) receive request from user\n2)  get hold of your payment card  (something like prepare lock the fund in your fund for this transaction. Also check if available fund is there or not. Also allow a window like 10 minutes to make payment after it\nexpire that)\n3) update inventory PREPARE\n\n4) create a record in reservation PREPARE\n5) update inventory COMMIT\n6) create a record in reservation COMMIT\n7)  debit money from your card (commit)\n8) return a response to user\n",
			"rawText": "1) receive request from user\n2)  get hold of your payment card  (something like prepare lock the fund in your fund for this transaction. Also check if available fund is there or not. Also allow a window like 10 minutes to make payment after it\nexpire that)\n3) update inventory PREPARE\n\n4) create a record in reservation PREPARE\n5) update inventory COMMIT\n6) create a record in reservation COMMIT\n7)  debit money from your card (commit)\n8) return a response to user\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "1) receive request from user\n2)  get hold of your payment card  (something like prepare lock the fund in your fund for this transaction. Also check if available fund is there or not. Also allow a window like 10 minutes to make payment after it\nexpire that)\n3) update inventory PREPARE\n\n4) create a record in reservation PREPARE\n5) update inventory COMMIT\n6) create a record in reservation COMMIT\n7)  debit money from your card (commit)\n8) return a response to user\n",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 468,
			"versionNonce": 911547900,
			"isDeleted": false,
			"id": "86UBr-msOMUt2zZw0cRdv",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3064.982489455055,
			"y": 1638.0468473774513,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 380,
			"height": 112.00000000000045,
			"seed": 1375959334,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474269,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "OshUvji0k_ydtnyyvo6JP",
				"gap": 2.621856597516171,
				"focus": 0.23596967265858626
			},
			"endBinding": {
				"elementId": "0mhF9IGq",
				"gap": 1.5,
				"focus": 0.22977243924568683
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-380,
					112.00000000000045
				]
			]
		},
		{
			"type": "arrow",
			"version": 476,
			"versionNonce": 1886047996,
			"isDeleted": false,
			"id": "gGC4_46QHRLLaDLfdU2E4",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2688.182501662087,
			"y": 1771.6468839985455,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 375.9999389648433,
			"height": 116.00003051757812,
			"seed": 851797094,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474269,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "0mhF9IGq",
				"gap": 4.700012207031705,
				"focus": 0.86458302584659
			},
			"endBinding": {
				"elementId": "OshUvji0k_ydtnyyvo6JP",
				"gap": 3.421905425641171,
				"focus": -0.0252886071387797
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					375.9999389648433,
					-116.00003051757812
				]
			]
		},
		{
			"type": "arrow",
			"version": 869,
			"versionNonce": 1938309116,
			"isDeleted": false,
			"id": "kAmb5NoXidiNjqeHAJpnZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3246.545453210329,
			"y": 1636.6342610842917,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 80.5850889074768,
			"height": 2.611222134092486,
			"seed": 1386735526,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474269,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "k2-3H7ZsQll5ei3NlqifJ",
				"gap": 11.448469514992002,
				"focus": -1.4329904130023694
			},
			"endBinding": {
				"elementId": "OshUvji0k_ydtnyyvo6JP",
				"gap": 1,
				"focus": 0.05715897042125967
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-80.5850889074768,
					2.611222134092486
				]
			]
		},
		{
			"type": "arrow",
			"version": 832,
			"versionNonce": 1891463420,
			"isDeleted": false,
			"id": "8hW8XXauzMWni7I4Ebw1I",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3168.9823673847427,
			"y": 1648.7596235863139,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 78.40014648437545,
			"height": 1.2378719609534983,
			"seed": 836240102,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474270,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "OshUvji0k_ydtnyyvo6JP",
				"gap": 4.0220030818902615,
				"focus": 0.2325558597253396
			},
			"endBinding": {
				"elementId": "BdN3c9uxddoxpAhRS717v",
				"gap": 3.324351428887894,
				"focus": -0.04213316038351488
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					78.40014648437545,
					-1.2378719609534983
				]
			]
		},
		{
			"type": "rectangle",
			"version": 2299,
			"versionNonce": 1294545152,
			"isDeleted": false,
			"id": "BdN3c9uxddoxpAhRS717v",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": 3250.7068652980056,
			"y": 1576.8545803773413,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 46.551126243786776,
			"height": 134.7844973791262,
			"seed": 1122154022,
			"groupIds": [
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "8hW8XXauzMWni7I4Ebw1I",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2119,
			"versionNonce": 1509842688,
			"isDeleted": false,
			"id": "HoJs0MonOvVyXVhDO2ruB",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3279.516146898394,
			"y": 1623.5329793395022,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 515178854,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "ykb3yeR8tnTtU-UQh4I02"
				},
				{
					"type": "arrow",
					"id": "6gmTuDaXy1l5feU1c53b1"
				},
				{
					"id": "3Cg-YiMxfazNLOhKYLiwb",
					"type": "arrow"
				},
				{
					"id": "vJUqSuuiU9PitCp-V0CyO",
					"type": "arrow"
				},
				{
					"id": "zKUI4gRLPnjycYCpDULf9",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2426,
			"versionNonce": 316346624,
			"isDeleted": false,
			"id": "k2-3H7ZsQll5ei3NlqifJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3255.4278339438674,
			"y": 1621.6013493141863,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 949740710,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "3Cg-YiMxfazNLOhKYLiwb"
				},
				{
					"type": "arrow",
					"id": "ykb3yeR8tnTtU-UQh4I02"
				},
				{
					"type": "arrow",
					"id": "6gmTuDaXy1l5feU1c53b1"
				},
				{
					"id": "kAmb5NoXidiNjqeHAJpnZ",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2424,
			"versionNonce": 1759149824,
			"isDeleted": false,
			"id": "AT0tmgRKkQ4Kuennuhbau",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3279.844608508058,
			"y": 1657.3303437543045,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 306470886,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "6gmTuDaXy1l5feU1c53b1"
				},
				{
					"id": "vJUqSuuiU9PitCp-V0CyO",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2138,
			"versionNonce": 122745088,
			"isDeleted": false,
			"id": "ol3sG0EkLIBV4LYSH0Fcg",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3279.3892643028453,
			"y": 1589.0774974230594,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 12.332238891426526,
			"height": 11.952785387074933,
			"seed": 1874555686,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "ykb3yeR8tnTtU-UQh4I02"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 6624,
			"versionNonce": 120758016,
			"isDeleted": false,
			"id": "3Cg-YiMxfazNLOhKYLiwb",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3264.157188759515,
			"y": 1633.7678774723768,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 17.82261800776967,
			"height": 25.102386583810606,
			"seed": 191766118,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "k2-3H7ZsQll5ei3NlqifJ",
				"focus": 0.24472012017717362,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					17.82261800776967,
					25.102386583810606
				]
			]
		},
		{
			"type": "arrow",
			"version": 5583,
			"versionNonce": 839569664,
			"isDeleted": false,
			"id": "6gmTuDaXy1l5feU1c53b1",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3268.1549856727765,
			"y": 1627.7617455706782,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 11.095301697001764,
			"height": 0.88216610497558,
			"seed": 1244225958,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "k2-3H7ZsQll5ei3NlqifJ",
				"focus": -0.0563084026612766,
				"gap": 1
			},
			"endBinding": {
				"elementId": "HoJs0MonOvVyXVhDO2ruB",
				"gap": 1,
				"focus": 0.059045777174585416
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					11.095301697001764,
					0.88216610497558
				]
			]
		},
		{
			"type": "arrow",
			"version": 6553,
			"versionNonce": 1703329536,
			"isDeleted": false,
			"id": "ykb3yeR8tnTtU-UQh4I02",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3265.173651734423,
			"y": 1622.1149365071183,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.965874145697274,
			"height": 21.727808658837194,
			"seed": 1863990502,
			"groupIds": [
				"raK3xpdk-iCzmuwWJl0W-",
				"SYjpBEQz7XCxdx7i0pUO3",
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "k2-3H7ZsQll5ei3NlqifJ",
				"focus": -0.08869372840681351,
				"gap": 1
			},
			"endBinding": {
				"elementId": "ol3sG0EkLIBV4LYSH0Fcg",
				"focus": -0.09679793421690913,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.965874145697274,
					-21.727808658837194
				]
			]
		},
		{
			"type": "text",
			"version": 1195,
			"versionNonce": 713601280,
			"isDeleted": false,
			"id": "3PfQuaLS",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 3252.942418145714,
			"y": 1681.3148271319164,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 42.0594482421875,
			"height": 26.717473364044668,
			"seed": 1338880038,
			"groupIds": [
				"klCfZt9k4gWtoA6UMdjzJ"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 9.852931060977445,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "arrow",
			"version": 937,
			"versionNonce": 1157692412,
			"isDeleted": false,
			"id": "vJUqSuuiU9PitCp-V0CyO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3299.3063379319183,
			"y": 1645.7966611676488,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 88.07611490204317,
			"height": 4.769061090504692,
			"seed": 137411430,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474268,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "AT0tmgRKkQ4Kuennuhbau",
				"gap": 15.940604270387169,
				"focus": -3.04558495256763
			},
			"endBinding": {
				"elementId": "cnImRNv-AkYoKq1uBhA0F",
				"gap": 2.5220641170471936,
				"focus": -0.3293223061163625
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					88.07611490204317,
					4.769061090504692
				]
			]
		},
		{
			"type": "arrow",
			"version": 967,
			"versionNonce": 272051452,
			"isDeleted": false,
			"id": "zKUI4gRLPnjycYCpDULf9",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 3387.8544070877274,
			"y": 1626.2779804749216,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 89.0714140578907,
			"height": 2.1884245684677808,
			"seed": 781213350,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474268,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "cnImRNv-AkYoKq1uBhA0F",
				"gap": 2.05010986328125,
				"focus": 0.05081429140694477
			},
			"endBinding": {
				"elementId": "HoJs0MonOvVyXVhDO2ruB",
				"gap": 8.039656701882018,
				"focus": -0.9604201998249594
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-89.0714140578907,
					-2.1884245684677808
				]
			]
		},
		{
			"type": "text",
			"version": 450,
			"versionNonce": 1411579648,
			"isDeleted": false,
			"id": "of5srPsu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2490.5824040058365,
			"y": 1326.8468962055765,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 111.90234375,
			"height": 101.89938888888888,
			"seed": 127506918,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 10.614519675925925,
			"fontFamily": 3,
			"text": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"rawText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nisAvailable: True\nprice: '$200'\n}",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 452,
			"versionNonce": 852521216,
			"isDeleted": false,
			"id": "L6JbVlKL",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2718.4074162128677,
			"y": 1763.046865687998,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 124.921875,
			"height": 102.39998779296884,
			"seed": 978939174,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 10.666665395100921,
			"fontFamily": 3,
			"text": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"rawText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\nbuildingId: 12\nroomTypeId: Double\nroomId: 123\ndate: 10-06-2024\nname: 'Mridul Kumar'\n[paymentInfo]\n}",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 315,
			"versionNonce": 1969954560,
			"isDeleted": false,
			"id": "0ikBUPQk",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2604.982428419899,
			"y": 1850.8468962055763,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 160.6171875,
			"height": 89.7303409090909,
			"seed": 71096422,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 12.462547348484847,
			"fontFamily": 3,
			"text": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"rawText": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "PostgreSql\n(because low\nno of writes\nand reads only\nwhen checkin. Also \nwant acid properties.)",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 260,
			"versionNonce": 1100632320,
			"isDeleted": false,
			"id": "RmJwlDLa",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2650.5824040058365,
			"y": 1381.2468595844828,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 256.59375,
			"height": 46.399987792968815,
			"seed": 1829821350,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 12.888885498046893,
			"fontFamily": 3,
			"text": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"rawText": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "bcz read heavy want btree db\npostgreSql or dynamodb with strong\nconsistency",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 45,
			"versionNonce": 2024750848,
			"isDeleted": false,
			"id": "lwZwOYC4tJbZyTHWF5hwp",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2366.1826084736094,
			"y": 1842.3468412739358,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 76.800048828125,
			"height": 105.60003662109375,
			"seed": 1388686522,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "zXXWHdg59fVu5eiVVTkC2",
				"focus": 0.3046530281983817,
				"gap": 21.99528002707484
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					76.800048828125,
					105.60003662109375
				]
			]
		},
		{
			"type": "arrow",
			"version": 436,
			"versionNonce": 354050556,
			"isDeleted": false,
			"id": "1lG4XuHWzoQLObnefdaeU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2455.782584059547,
			"y": 1941.546853480967,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 72,
			"height": 96.00006103515625,
			"seed": 424954682,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474270,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "NNvLWEsD2M4Sza3ViLOQ7",
				"gap": 3.395200681371989,
				"focus": 0.2944927512603308
			},
			"endBinding": {
				"elementId": "sYtF9Otuu9GyDiaOk2S4j",
				"gap": 2.6950023171139037,
				"focus": 0.08521854303419676
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-72,
					-96.00006103515625
				]
			]
		},
		{
			"type": "rectangle",
			"version": 382,
			"versionNonce": 1047486208,
			"isDeleted": false,
			"id": "PP33xBDwpxF8p8ApfhveK",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1865.7824619892363,
			"y": -414.45357376512675,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2686.2700199229025,
			"height": 9986.160756690046,
			"seed": 984316858,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 62,
			"versionNonce": 704254208,
			"isDeleted": false,
			"id": "AzyIUqZJe3WJxhKR6e9Aj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1996.6397443553071,
			"y": -380.75714301387086,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 169.14289202008945,
			"height": 41.142839704241055,
			"seed": 113186470,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 452,
			"versionNonce": 388726528,
			"isDeleted": false,
			"id": "NVVRgQ69",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -487.9319632339784,
			"y": 2990.671428414703,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 712.5,
			"height": 384,
			"seed": 687339834,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "code karle approach\n\nhow many characters to use for this short url?\n\nif we are using alphanumeric characters then 62 characters allowed\n\n\n10M links shortened in a day so in 10 years = 10*10^6*365*10\n                                            = 10^8 * 400\n                                            = 40B links generated in 10 year\n\n\n1 character 62\n2 character 62^2\n\n7 character 62^7  ~ 3.5 trillion \n\n62^7>40B\n\nso we'll use 7 character",
			"rawText": "code karle approach\n\nhow many characters to use for this short url?\n\nif we are using alphanumeric characters then 62 characters allowed\n\n\n10M links shortened in a day so in 10 years = 10*10^6*365*10\n                                            = 10^8 * 400\n                                            = 40B links generated in 10 year\n\n\n1 character 62\n2 character 62^2\n\n7 character 62^7  ~ 3.5 trillion \n\n62^7>40B\n\nso we'll use 7 character",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "code karle approach\n\nhow many characters to use for this short url?\n\nif we are using alphanumeric characters then 62 characters allowed\n\n\n10M links shortened in a day so in 10 years = 10*10^6*365*10\n                                            = 10^8 * 400\n                                            = 40B links generated in 10 year\n\n\n1 character 62\n2 character 62^2\n\n7 character 62^7  ~ 3.5 trillion \n\n62^7>40B\n\nso we'll use 7 character",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1440,
			"versionNonce": 1653600512,
			"isDeleted": false,
			"id": "2ITV1aie3DrE1XnWCxvZN",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -331.56318600541624,
			"y": 3608.268845035555,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 171406394,
			"groupIds": [
				"DtIGNr13XmRu_pNJ8tE3n"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "wQJI6ykG"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 21,
			"versionNonce": 1130602240,
			"isDeleted": false,
			"id": "wQJI6ykG",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -301.6351768802758,
			"y": 3647.973696234066,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1191350906,
			"groupIds": [
				"DtIGNr13XmRu_pNJ8tE3n"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996506,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "2ITV1aie3DrE1XnWCxvZN",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1580,
			"versionNonce": 1298780416,
			"isDeleted": false,
			"id": "l-ZvW6w6BW1uXHU2Hgf5T",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 46.77004560265641,
			"y": 3590.935471012118,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1412479462,
			"groupIds": [
				"fUi5Ep36gHEwZT6OfXxJC"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "wrSGKpQzHbq88hyxwNdV7",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1499,
			"versionNonce": 1939324672,
			"isDeleted": false,
			"id": "Ocddt8r_TXcNs1PgKC4Ml",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 63.103358590938,
			"y": 3611.935532047273,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 2122904570,
			"groupIds": [
				"Yj9Obgj27iv_eEJpsfqFR"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "luGyztMIIFfF0NKZlCMuA",
					"type": "arrow"
				},
				{
					"id": "wrSGKpQzHbq88hyxwNdV7",
					"type": "arrow"
				},
				{
					"id": "HUKMsoYB9UWllsvVriFVZ",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1587,
			"versionNonce": 34058496,
			"isDeleted": false,
			"id": "DAt35WKtw76LZQlMO0UN0",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 77.43665123416679,
			"y": 3629.9355117022214,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 556960230,
			"groupIds": [
				"e5eFYszAWR80-h4Ns6q-u"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "dxPw0I52-__Di-JyJg_Cu",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1872,
			"versionNonce": 1212669696,
			"isDeleted": false,
			"id": "z2tho_4PDUX-1BDBB0J3r",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -146.3988163784773,
			"y": 3564.7400836621437,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 69.69390497296568,
			"height": 201.7922810927382,
			"seed": 366508390,
			"groupIds": [
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "T58aZvhdsxvATRPdgI4oX",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1690,
			"versionNonce": 669618432,
			"isDeleted": false,
			"id": "aqm_Ueb8J82kr1avwo_OH",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -103.26707078585929,
			"y": 3634.6245346746095,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1821400230,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "wTVMoxir8uiFkl0O1YQp3"
				},
				{
					"type": "arrow",
					"id": "OoCRed6YgOuKV_Tfon73k"
				},
				{
					"id": "luGyztMIIFfF0NKZlCMuA",
					"type": "arrow"
				}
			],
			"updated": 1718371996506,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1998,
			"versionNonce": 1374945024,
			"isDeleted": false,
			"id": "4gAJXBeJG6duXBmK5g6n1",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -139.33082969944468,
			"y": 3631.7325994994585,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1089066982,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "jfhzzDEgcgGVjeRm61ytF"
				},
				{
					"type": "arrow",
					"id": "wTVMoxir8uiFkl0O1YQp3"
				},
				{
					"type": "arrow",
					"id": "OoCRed6YgOuKV_Tfon73k"
				}
			],
			"updated": 1718371996507,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1996,
			"versionNonce": 1989112064,
			"isDeleted": false,
			"id": "VVT8lCFXdWkGCPrix2RfJ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -102.77531528908827,
			"y": 3685.2241762713866,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 452061990,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "OoCRed6YgOuKV_Tfon73k"
				}
			],
			"updated": 1718371996507,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1713,
			"versionNonce": 287055616,
			"isDeleted": false,
			"id": "dD4hHIZkZT3fnH3Yh-NqG",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -103.45703275392367,
			"y": 3583.0395940674457,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 2031457894,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "wTVMoxir8uiFkl0O1YQp3"
				}
			],
			"updated": 1718371996507,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 5705,
			"versionNonce": 897143040,
			"isDeleted": false,
			"id": "jfhzzDEgcgGVjeRm61ytF",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -126.26169745523185,
			"y": 3649.947687419507,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 26.68308902555831,
			"height": 37.58197677119037,
			"seed": 69327270,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "4gAJXBeJG6duXBmK5g6n1",
				"focus": 0.24472012017710268,
				"gap": 1.0429565441461008
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					26.68308902555831,
					37.58197677119037
				]
			]
		},
		{
			"type": "arrow",
			"version": 4315,
			"versionNonce": 1983921920,
			"isDeleted": false,
			"id": "OoCRed6YgOuKV_Tfon73k",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -120.27640556959847,
			"y": 3640.9556217105064,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.61130383973117,
			"height": 1.3207328297184937,
			"seed": 1128510694,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "4gAJXBeJG6duXBmK5g6n1",
				"focus": -0.056308402661310396,
				"gap": 1
			},
			"endBinding": {
				"elementId": "aqm_Ueb8J82kr1avwo_OH",
				"focus": 0.059045777174585416,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.61130383973117,
					1.3207328297184937
				]
			]
		},
		{
			"type": "arrow",
			"version": 5272,
			"versionNonce": 1009201408,
			"isDeleted": false,
			"id": "wTVMoxir8uiFkl0O1YQp3",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -124.73990239466235,
			"y": 3632.501515311121,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 25.400417044718434,
			"height": 32.52973567190321,
			"seed": 1342711846,
			"groupIds": [
				"N0nhgNU5ZSSEZYk9kzg8G",
				"D1-CAi9khMQe3frUI7XBi",
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "4gAJXBeJG6duXBmK5g6n1",
				"focus": -0.08869372840674807,
				"gap": 1
			},
			"endBinding": {
				"elementId": "dD4hHIZkZT3fnH3Yh-NqG",
				"focus": -0.09679793421697684,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					25.400417044718434,
					-32.52973567190321
				]
			]
		},
		{
			"type": "text",
			"version": 768,
			"versionNonce": 1642094336,
			"isDeleted": false,
			"id": "sYbplmvn",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -143.0518638919944,
			"y": 3721.132486987457,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 62.98243713378906,
			"height": 40,
			"seed": 173814630,
			"groupIds": [
				"iWc9WpDuUvNPEwzJQ-Cy9"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"fontSize": 14.751291676011752,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "text",
			"version": 101,
			"versionNonce": 1914245376,
			"isDeleted": false,
			"id": "tte7HfYn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 89.11484346477641,
			"y": 3668.573757269222,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 140.69496154785156,
			"height": 25.066666666667004,
			"seed": 1019191866,
			"groupIds": [
				"e5eFYszAWR80-h4Ns6q-u"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"fontSize": 10.444444444444585,
			"fontFamily": 3,
			"text": "link shortening service\n",
			"rawText": "link shortening service\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "link shortening service\n",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 70,
			"versionNonce": 612138752,
			"isDeleted": false,
			"id": "T58aZvhdsxvATRPdgI4oX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -238.8851870528017,
			"y": 3641.9070397399255,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 82.66667683919263,
			"height": 0,
			"seed": 633146746,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "z2tho_4PDUX-1BDBB0J3r",
				"focus": 0.23518426314514634,
				"gap": 9.81969383513178
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					82.66667683919263,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 60,
			"versionNonce": 1322184960,
			"isDeleted": false,
			"id": "luGyztMIIFfF0NKZlCMuA",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -77.55182320189033,
			"y": 3632.573747096696,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.33331298828125,
			"height": 1.3333638509111552,
			"seed": 816758458,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "aqm_Ueb8J82kr1avwo_OH",
				"focus": -1.208878499478316,
				"gap": 10.672712768012616
			},
			"endBinding": {
				"elementId": "Ocddt8r_TXcNs1PgKC4Ml",
				"focus": 0.6169221552648161,
				"gap": 19.32186880454708
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					121.33331298828125,
					-1.3333638509111552
				]
			]
		},
		{
			"type": "rectangle",
			"version": 120,
			"versionNonce": 2123669248,
			"isDeleted": false,
			"id": "85Z8PS9v6zrtHTmKNnBLj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 209.1148434647764,
			"y": 3336.5737623554846,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 212.000020345052,
			"height": 149.33331807454442,
			"seed": 853188454,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [
				{
					"id": "wrSGKpQzHbq88hyxwNdV7",
					"type": "arrow"
				},
				{
					"id": "HUKMsoYB9UWllsvVriFVZ",
					"type": "arrow"
				}
			],
			"updated": 1718371996507,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 105,
			"versionNonce": 1506332928,
			"isDeleted": false,
			"id": "zCge4HKZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 254.4482988684224,
			"y": 3408.573731837907,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.875,
			"height": 38.4,
			"seed": 762950438,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "centralized \ncounter cache",
			"rawText": "centralized \ncounter cache",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "centralized \ncounter cache",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 72,
			"versionNonce": 547929856,
			"isDeleted": false,
			"id": "wrSGKpQzHbq88hyxwNdV7",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 93.11488415488066,
			"y": 3591.2403832457844,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 105.33345540364576,
			"height": 145.3333028157549,
			"seed": 2090537958,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "Ocddt8r_TXcNs1PgKC4Ml",
				"focus": -0.8221564186334868,
				"gap": 20.695148801488813
			},
			"endBinding": {
				"elementId": "85Z8PS9v6zrtHTmKNnBLj",
				"focus": 0.5717163747304319,
				"gap": 10.66650390625
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					105.33345540364576,
					-145.3333028157549
				]
			]
		},
		{
			"type": "freedraw",
			"version": 29,
			"versionNonce": 713470208,
			"isDeleted": false,
			"id": "-fYGf67IXrU2BrmIO8Iy4",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 594.4481971431619,
			"y": 3252.573721665381,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 5.3333536783854925,
			"height": 42.66667683919286,
			"seed": 80428006,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					-1.3333384195966573
				],
				[
					0,
					3.999989827473655
				],
				[
					0,
					9.333343505859375
				],
				[
					0,
					16.00001017252589
				],
				[
					-2.6667277018229925,
					21.333338419596203
				],
				[
					-4.0000406901042425,
					29.333343505859375
				],
				[
					-4.0000406901042425,
					30.666656494140625
				],
				[
					-4.0000406901042425,
					33.33333333333303
				],
				[
					-4.0000406901042425,
					34.66667175292969
				],
				[
					-5.3333536783854925,
					37.33332316080714
				],
				[
					-5.3333536783854925,
					41.3333384195962
				],
				[
					-5.3333536783854925,
					41.3333384195962
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 27,
			"versionNonce": 725147392,
			"isDeleted": false,
			"id": "ndlXL751UgrigtvIWn1oL",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 602.4481767981097,
			"y": 3249.907044826188,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 30.666707356770985,
			"height": 0,
			"seed": 149442918,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.0000406901042425,
					0
				],
				[
					9.333292643229242,
					0
				],
				[
					13.333333333333485,
					0
				],
				[
					17.3333740234375,
					0
				],
				[
					22.6666259765625,
					0
				],
				[
					25.333353678385492,
					0
				],
				[
					26.666666666666742,
					0
				],
				[
					29.333292643229242,
					0
				],
				[
					30.666707356770985,
					0
				],
				[
					30.666707356770985,
					0
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 20,
			"versionNonce": 1753780480,
			"isDeleted": false,
			"id": "PTKQSyV8hIUcB45UiXjJn",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 613.1148841548807,
			"y": 3263.2403781595217,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2.6667277018229925,
			"height": 2.666676839192405,
			"seed": 368584806,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-2.6667277018229925,
					1.3333384195962026
				],
				[
					-2.6667277018229925,
					2.666676839192405
				],
				[
					-2.6667277018229925,
					2.666676839192405
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 31,
			"versionNonce": 784662272,
			"isDeleted": false,
			"id": "9yvVFqKuSGkGCT_kRM0jx",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 606.4482174882139,
			"y": 3267.2403934183108,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 6.6666666666667425,
			"height": 28.000005086262718,
			"seed": 1871980710,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.3333384195962026
				],
				[
					0,
					5.3333282470703125
				],
				[
					1.33331298828125,
					9.333318074543968
				],
				[
					1.33331298828125,
					11.999994913736828
				],
				[
					3.99993896484375,
					15.999984741210938
				],
				[
					3.99993896484375,
					18.666661580403343
				],
				[
					3.99993896484375,
					20
				],
				[
					3.99993896484375,
					22.666651407877453
				],
				[
					3.99993896484375,
					23.999989827473655
				],
				[
					5.333251953125,
					25.333328247070312
				],
				[
					5.333251953125,
					26.666666666666515
				],
				[
					6.6666666666667425,
					26.666666666666515
				],
				[
					6.6666666666667425,
					28.000005086262718
				],
				[
					6.6666666666667425,
					28.000005086262718
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 47,
			"versionNonce": 1263431936,
			"isDeleted": false,
			"id": "ymJezF64OqZLij3rv_F3_",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 630.4481564530577,
			"y": 3273.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 20,
			"height": 17.33332316080714,
			"seed": 148577446,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-2.6666259765625,
					3.99998982747411
				],
				[
					-5.3333536783854925,
					8.000005086263172
				],
				[
					-6.6666666666667425,
					9.333318074544422
				],
				[
					-6.6666666666667425,
					10.666656494140625
				],
				[
					-6.6666666666667425,
					13.333333333333485
				],
				[
					-3.99993896484375,
					14.666671752929688
				],
				[
					-1.33331298828125,
					15.999984741210938
				],
				[
					0,
					17.33332316080714
				],
				[
					1.33331298828125,
					17.33332316080714
				],
				[
					2.6667277018229925,
					17.33332316080714
				],
				[
					5.3333536783854925,
					17.33332316080714
				],
				[
					9.333394368489508,
					17.33332316080714
				],
				[
					10.666707356770758,
					17.33332316080714
				],
				[
					12.000020345052008,
					17.33332316080714
				],
				[
					13.333333333333258,
					17.33332316080714
				],
				[
					13.333333333333258,
					15.999984741210938
				],
				[
					12.000020345052008,
					13.333333333333485
				],
				[
					10.666707356770758,
					13.333333333333485
				],
				[
					9.333394368489508,
					11.999994913736828
				],
				[
					7.9999796549479925,
					9.333318074544422
				],
				[
					6.6666666666667425,
					9.333318074544422
				],
				[
					5.3333536783854925,
					8.000005086263172
				],
				[
					5.3333536783854925,
					6.666666666666515
				],
				[
					4.0000406901042425,
					6.666666666666515
				],
				[
					2.6667277018229925,
					6.666666666666515
				],
				[
					2.6667277018229925,
					5.3333282470703125
				],
				[
					1.33331298828125,
					5.3333282470703125
				],
				[
					1.33331298828125,
					3.99998982747411
				],
				[
					1.33331298828125,
					2.6666514078774526
				],
				[
					1.33331298828125,
					2.6666514078774526
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 53,
			"versionNonce": 734863104,
			"isDeleted": false,
			"id": "KQdDHHbWaBzGiyGP9mgEz",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 647.7815304764952,
			"y": 3268.573731837907,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 15.999959309895758,
			"height": 20,
			"seed": 1479607462,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.33331298828125,
					0
				],
				[
					2.6666259765625,
					0
				],
				[
					3.99993896484375,
					0
				],
				[
					5.3333536783854925,
					0
				],
				[
					7.9999796549479925,
					0
				],
				[
					9.333292643229242,
					0
				],
				[
					10.666605631510492,
					0
				],
				[
					6.6666666666667425,
					0
				],
				[
					3.99993896484375,
					1.33331298828125
				],
				[
					1.33331298828125,
					2.6666514078774526
				],
				[
					0,
					2.6666514078774526
				],
				[
					-1.33331298828125,
					3.99998982747411
				],
				[
					-1.33331298828125,
					5.3333282470703125
				],
				[
					-1.33331298828125,
					7.999979654947765
				],
				[
					-1.33331298828125,
					9.333318074544422
				],
				[
					-1.33331298828125,
					11.999994913736828
				],
				[
					-1.33331298828125,
					14.666646321614735
				],
				[
					-1.33331298828125,
					15.999984741210938
				],
				[
					0,
					15.999984741210938
				],
				[
					0,
					14.666646321614735
				],
				[
					1.33331298828125,
					13.333333333333485
				],
				[
					1.33331298828125,
					11.999994913736828
				],
				[
					3.99993896484375,
					11.999994913736828
				],
				[
					5.3333536783854925,
					10.666656494140625
				],
				[
					7.9999796549479925,
					9.333318074544422
				],
				[
					10.666605631510492,
					7.999979654947765
				],
				[
					14.666646321614508,
					7.999979654947765
				],
				[
					14.666646321614508,
					9.333318074544422
				],
				[
					14.666646321614508,
					10.666656494140625
				],
				[
					14.666646321614508,
					11.999994913736828
				],
				[
					14.666646321614508,
					14.666646321614735
				],
				[
					12.000020345052008,
					17.33332316080714
				],
				[
					10.666605631510492,
					20
				],
				[
					9.333292643229242,
					20
				],
				[
					7.9999796549479925,
					20
				],
				[
					7.9999796549479925,
					20
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 56,
			"versionNonce": 441995520,
			"isDeleted": false,
			"id": "VCSEfuma2nMsaXVlRDu_x",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 683.7814897863909,
			"y": 3267.2403934183108,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 25.333353678385492,
			"height": 22.666651407877453,
			"seed": 1127397414,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-3.99993896484375,
					0
				],
				[
					-6.666666666666515,
					0
				],
				[
					-9.333292643229015,
					0
				],
				[
					-10.666605631510265,
					0
				],
				[
					-13.333333333333258,
					1.3333384195962026
				],
				[
					-14.666646321614508,
					2.6666514078774526
				],
				[
					-14.666646321614508,
					5.3333282470703125
				],
				[
					-15.999959309895758,
					5.3333282470703125
				],
				[
					-17.333272298177008,
					5.3333282470703125
				],
				[
					-17.333272298177008,
					6.666666666666515
				],
				[
					-17.333272298177008,
					8.000005086262718
				],
				[
					-15.999959309895758,
					9.333318074543968
				],
				[
					-13.333333333333258,
					9.333318074543968
				],
				[
					-10.666605631510265,
					9.333318074543968
				],
				[
					-3.99993896484375,
					9.333318074543968
				],
				[
					-2.6666259765625,
					9.333318074543968
				],
				[
					-1.33331298828125,
					9.333318074543968
				],
				[
					-1.33331298828125,
					8.000005086262718
				],
				[
					0,
					8.000005086262718
				],
				[
					0,
					6.666666666666515
				],
				[
					0,
					5.3333282470703125
				],
				[
					1.33331298828125,
					5.3333282470703125
				],
				[
					2.6667277018229925,
					5.3333282470703125
				],
				[
					4.0000406901042425,
					5.3333282470703125
				],
				[
					4.0000406901042425,
					6.666666666666515
				],
				[
					4.0000406901042425,
					8.000005086262718
				],
				[
					5.3333536783854925,
					8.000005086262718
				],
				[
					5.3333536783854925,
					9.333318074543968
				],
				[
					6.6666666666667425,
					10.666656494140625
				],
				[
					6.6666666666667425,
					11.999994913736828
				],
				[
					6.6666666666667425,
					13.33333333333303
				],
				[
					6.6666666666667425,
					14.666671752929688
				],
				[
					6.6666666666667425,
					15.999984741210938
				],
				[
					6.6666666666667425,
					17.33332316080714
				],
				[
					6.6666666666667425,
					18.666661580403343
				],
				[
					6.6666666666667425,
					20
				],
				[
					6.6666666666667425,
					21.333338419596203
				],
				[
					8.000081380208485,
					22.666651407877453
				],
				[
					8.000081380208485,
					22.666651407877453
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 51,
			"versionNonce": 315703040,
			"isDeleted": false,
			"id": "lWEcQjhDInydh36tPO-h0",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 702.4482785233702,
			"y": 3267.2403934183108,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 33.33333333333326,
			"height": 20,
			"seed": 1102144870,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					2.6666259765625,
					-2.66667683919286
				],
				[
					3.9998372395832575,
					-2.66667683919286
				],
				[
					5.333251953125,
					-2.66667683919286
				],
				[
					7.9998779296875,
					-2.66667683919286
				],
				[
					10.66650390625,
					-2.66667683919286
				],
				[
					13.333333333333258,
					-2.66667683919286
				],
				[
					14.666544596354242,
					-2.66667683919286
				],
				[
					14.666544596354242,
					-1.3333384195966573
				],
				[
					11.999918619791742,
					3.999989827473655
				],
				[
					7.9998779296875,
					8.000005086262718
				],
				[
					5.333251953125,
					10.666656494140625
				],
				[
					2.6666259765625,
					11.999994913736828
				],
				[
					2.6666259765625,
					13.33333333333303
				],
				[
					3.9998372395832575,
					11.999994913736828
				],
				[
					6.6666666666667425,
					9.333318074543968
				],
				[
					13.333333333333258,
					5.3333282470703125
				],
				[
					20,
					3.999989827473655
				],
				[
					22.6666259765625,
					2.6666514078774526
				],
				[
					25.333251953125,
					2.6666514078774526
				],
				[
					27.9998779296875,
					2.6666514078774526
				],
				[
					30.66650390625,
					2.6666514078774526
				],
				[
					31.999918619791742,
					2.6666514078774526
				],
				[
					33.33333333333326,
					2.6666514078774526
				],
				[
					33.33333333333326,
					3.999989827473655
				],
				[
					33.33333333333326,
					5.3333282470703125
				],
				[
					29.333292643229242,
					9.333318074543968
				],
				[
					25.333251953125,
					13.33333333333303
				],
				[
					23.999837239583258,
					14.666671752929688
				],
				[
					21.333211263020758,
					14.666671752929688
				],
				[
					18.666585286458258,
					15.999984741210938
				],
				[
					17.333170572916742,
					17.33332316080714
				],
				[
					15.999959309895758,
					17.33332316080714
				],
				[
					14.666544596354242,
					17.33332316080714
				],
				[
					14.666544596354242,
					17.33332316080714
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 43,
			"versionNonce": 757477632,
			"isDeleted": false,
			"id": "PtK2ZzEljkBf8Bb4F9Q_R",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 545.1148027746722,
			"y": 3261.9070651712404,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 10.666605631510265,
			"height": 31.999994913736828,
			"seed": 1017604710,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-2.6666259765625,
					1.33331298828125
				],
				[
					-5.333251953125,
					2.6666514078774526
				],
				[
					-5.333251953125,
					5.3333282470703125
				],
				[
					-6.666666666666515,
					7.999979654947765
				],
				[
					-7.999979654947765,
					10.666656494140625
				],
				[
					-10.666605631510265,
					15.999984741210938
				],
				[
					-10.666605631510265,
					20
				],
				[
					-10.666605631510265,
					22.666651407877453
				],
				[
					-10.666605631510265,
					23.999989827473655
				],
				[
					-9.333292643229015,
					25.333328247070312
				],
				[
					-7.999979654947765,
					27.999979654947765
				],
				[
					-5.333251953125,
					29.333318074543968
				],
				[
					-3.99993896484375,
					30.666656494140625
				],
				[
					-1.33331298828125,
					31.999994913736828
				],
				[
					0,
					30.666656494140625
				],
				[
					0,
					29.333318074543968
				],
				[
					0,
					26.666666666666515
				],
				[
					0,
					23.999989827473655
				],
				[
					0,
					20
				],
				[
					0,
					18.666661580403343
				],
				[
					-1.33331298828125,
					17.33332316080714
				],
				[
					-2.6666259765625,
					17.33332316080714
				],
				[
					-3.99993896484375,
					17.33332316080714
				],
				[
					-3.99993896484375,
					15.999984741210938
				],
				[
					-5.333251953125,
					15.999984741210938
				],
				[
					-5.333251953125,
					15.999984741210938
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 1146183424,
			"isDeleted": false,
			"id": "6x3uRxohJ54vF4ks80C8S",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 559.7815508215472,
			"y": 3264.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 18.666585286458485,
			"height": 29.333343505859375,
			"seed": 1888957798,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996507,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.33331298828125,
					-2.6666514078774526
				],
				[
					3.99993896484375,
					-5.3333282470703125
				],
				[
					5.333251953125,
					-6.666666666666515
				],
				[
					6.6666666666667425,
					-6.666666666666515
				],
				[
					7.9999796549479925,
					-6.666666666666515
				],
				[
					9.333292643229242,
					-6.666666666666515
				],
				[
					10.666605631510492,
					-3.99998982747411
				],
				[
					11.999918619791742,
					-1.3333384195962026
				],
				[
					11.999918619791742,
					0
				],
				[
					13.333333333333485,
					4.0000152587890625
				],
				[
					13.333333333333485,
					5.3333282470703125
				],
				[
					11.999918619791742,
					8.000005086263172
				],
				[
					7.9999796549479925,
					14.666671752929688
				],
				[
					5.333251953125,
					20
				],
				[
					2.6666259765625,
					21.333338419596203
				],
				[
					1.33331298828125,
					21.333338419596203
				],
				[
					0,
					22.66667683919286
				],
				[
					1.33331298828125,
					22.66667683919286
				],
				[
					3.99993896484375,
					20
				],
				[
					7.9999796549479925,
					20
				],
				[
					10.666605631510492,
					18.666661580403797
				],
				[
					14.666646321614735,
					18.666661580403797
				],
				[
					17.333272298177235,
					20
				],
				[
					18.666585286458485,
					21.333338419596203
				],
				[
					18.666585286458485,
					21.333338419596203
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 1798836480,
			"isDeleted": false,
			"id": "19PVWqBNMj52O07tE5cfh",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 857.1148231197244,
			"y": 3200.573726751644,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 17.3333740234375,
			"height": 34.66665903727244,
			"seed": 445256998,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.000040690104015,
					0
				],
				[
					8.000081380208258,
					0
				],
				[
					12.0001220703125,
					0
				],
				[
					13.333333333333258,
					2.6666514078779073
				],
				[
					15.999959309895758,
					3.99998982747411
				],
				[
					15.999959309895758,
					8.000005086263172
				],
				[
					17.3333740234375,
					10.666656494140625
				],
				[
					17.3333740234375,
					14.666671752929688
				],
				[
					17.3333740234375,
					20
				],
				[
					14.666748046875,
					21.333338419596657
				],
				[
					13.333333333333258,
					22.666651407877907
				],
				[
					10.666707356770758,
					22.666651407877907
				],
				[
					9.333292643229015,
					21.333338419596657
				],
				[
					6.666666666666515,
					15.999984741210938
				],
				[
					5.3334554036457575,
					5.3333282470703125
				],
				[
					5.3334554036457575,
					0
				],
				[
					5.3334554036457575,
					-4.000002543131359
				],
				[
					5.3334554036457575,
					-6.666679382324219
				],
				[
					5.3334554036457575,
					-8.000005086262718
				],
				[
					5.3334554036457575,
					-9.333343505859375
				],
				[
					8.000081380208258,
					-10.666669209797874
				],
				[
					10.666707356770758,
					-10.666669209797874
				],
				[
					13.333333333333258,
					-12.000007629394531
				],
				[
					15.999959309895758,
					-12.000007629394531
				],
				[
					15.999959309895758,
					-12.000007629394531
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 92,
			"versionNonce": 281902848,
			"isDeleted": false,
			"id": "9spNA72YPy11iseelOGWG",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 893.1147824296202,
			"y": 3195.2403857889162,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 75.99995930989576,
			"height": 26.66666666666697,
			"seed": 54054118,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.3334147135417425,
					-1.3333384195966573
				],
				[
					2.6668294270832575,
					-2.6666641235351562
				],
				[
					2.6668294270832575,
					-4.000002543131814
				],
				[
					2.6668294270832575,
					-5.3333282470703125
				],
				[
					1.3334147135417425,
					-8.000005086263172
				],
				[
					1.3334147135417425,
					-9.333330790202126
				],
				[
					0,
					-9.333330790202126
				],
				[
					-2.6666259765625,
					-9.333330790202126
				],
				[
					-3.9998372395832575,
					-9.333330790202126
				],
				[
					-5.333251953125,
					-9.333330790202126
				],
				[
					-6.6666666666667425,
					-9.333330790202126
				],
				[
					-7.9998779296875,
					-6.66666666666697
				],
				[
					-10.66650390625,
					-4.000002543131814
				],
				[
					-10.66650390625,
					-1.3333384195966573
				],
				[
					-10.66650390625,
					1.3333384195962026
				],
				[
					-9.333292643229242,
					7.999992370605469
				],
				[
					-6.6666666666667425,
					10.666669209797874
				],
				[
					-5.333251953125,
					12.000007629394531
				],
				[
					-3.9998372395832575,
					14.666659037271984
				],
				[
					-2.6666259765625,
					15.999997456868186
				],
				[
					0,
					17.333335876464844
				],
				[
					1.3334147135417425,
					17.333335876464844
				],
				[
					4.0000406901042425,
					17.333335876464844
				],
				[
					8.000081380208258,
					15.999997456868186
				],
				[
					13.333333333333258,
					12.000007629394531
				],
				[
					16.000162760416742,
					9.333330790201671
				],
				[
					17.3333740234375,
					6.666679382324219
				],
				[
					18.666788736979242,
					4.000002543131359
				],
				[
					18.666788736979242,
					2.6666641235351562
				],
				[
					18.666788736979242,
					0
				],
				[
					18.666788736979242,
					-1.3333384195966573
				],
				[
					18.666788736979242,
					-2.6666641235351562
				],
				[
					18.666788736979242,
					-1.3333384195966573
				],
				[
					21.333414713541742,
					1.3333384195962026
				],
				[
					22.666829427083258,
					4.000002543131359
				],
				[
					25.333455403645758,
					6.666679382324219
				],
				[
					28.000081380208258,
					9.333330790201671
				],
				[
					28.000081380208258,
					10.666669209797874
				],
				[
					26.666666666666742,
					9.333330790201671
				],
				[
					24.000040690104242,
					4.000002543131359
				],
				[
					24.000040690104242,
					2.6666641235351562
				],
				[
					24.000040690104242,
					1.3333384195962026
				],
				[
					24.000040690104242,
					-2.6666641235351562
				],
				[
					26.666666666666742,
					-4.000002543131814
				],
				[
					28.000081380208258,
					-5.3333282470703125
				],
				[
					32.0001220703125,
					-6.66666666666697
				],
				[
					36.00016276041674,
					-5.3333282470703125
				],
				[
					38.66678873697924,
					-4.000002543131814
				],
				[
					41.33341471354174,
					-1.3333384195966573
				],
				[
					44.00004069010424,
					1.3333384195962026
				],
				[
					45.33345540364576,
					4.000002543131359
				],
				[
					45.33345540364576,
					5.333340962727561
				],
				[
					42.66682942708326,
					5.333340962727561
				],
				[
					41.33341471354174,
					2.6666641235351562
				],
				[
					40,
					1.3333384195962026
				],
				[
					40,
					0
				],
				[
					40,
					-2.6666641235351562
				],
				[
					41.33341471354174,
					-5.3333282470703125
				],
				[
					44.00004069010424,
					-6.66666666666697
				],
				[
					45.33345540364576,
					-8.000005086263172
				],
				[
					48.00008138020826,
					-9.333330790202126
				],
				[
					50.66670735677076,
					-9.333330790202126
				],
				[
					52.0001220703125,
					-9.333330790202126
				],
				[
					54.666748046875,
					-9.333330790202126
				],
				[
					56.00016276041674,
					-9.333330790202126
				],
				[
					57.3333740234375,
					-8.000005086263172
				],
				[
					58.66678873697924,
					-8.000005086263172
				],
				[
					60,
					-5.3333282470703125
				],
				[
					61.33341471354174,
					-4.000002543131814
				],
				[
					61.33341471354174,
					0
				],
				[
					61.33341471354174,
					2.6666641235351562
				],
				[
					62.66682942708326,
					2.6666641235351562
				],
				[
					64.00004069010424,
					5.333340962727561
				],
				[
					65.33345540364576,
					5.333340962727561
				],
				[
					65.33345540364576,
					5.333340962727561
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 48,
			"versionNonce": 1275982080,
			"isDeleted": false,
			"id": "W-GL3zM9EmWpOPKuESDNi",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 905.1149044999327,
			"y": 3255.2403985045735,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 18.666788736979015,
			"height": 22.666651407877907,
			"seed": 961136422,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.3334147135417425,
					0
				],
				[
					-4.0000406901042425,
					0
				],
				[
					-5.3334554036457575,
					0
				],
				[
					-5.3334554036457575,
					1.33331298828125
				],
				[
					-6.6666666666667425,
					2.6666514078779073
				],
				[
					-8.000081380208258,
					2.6666514078779073
				],
				[
					-8.000081380208258,
					3.99998982747411
				],
				[
					-8.000081380208258,
					5.3333282470703125
				],
				[
					-8.000081380208258,
					6.66666666666697
				],
				[
					-8.000081380208258,
					7.99997965494822
				],
				[
					-8.000081380208258,
					9.333318074544422
				],
				[
					-8.000081380208258,
					10.666656494140625
				],
				[
					-6.6666666666667425,
					11.999994913737282
				],
				[
					-4.0000406901042425,
					11.999994913737282
				],
				[
					-1.3334147135417425,
					10.666656494140625
				],
				[
					0,
					9.333318074544422
				],
				[
					4.0000406901042425,
					9.333318074544422
				],
				[
					6.6666666666667425,
					9.333318074544422
				],
				[
					7.9998779296875,
					9.333318074544422
				],
				[
					9.333292643229242,
					10.666656494140625
				],
				[
					10.666707356770758,
					11.999994913737282
				],
				[
					10.666707356770758,
					13.333333333333485
				],
				[
					10.666707356770758,
					14.666646321614735
				],
				[
					10.666707356770758,
					17.333323160807595
				],
				[
					10.666707356770758,
					18.666661580403797
				],
				[
					7.9998779296875,
					21.33331298828125
				],
				[
					5.333251953125,
					22.666651407877907
				],
				[
					4.0000406901042425,
					22.666651407877907
				],
				[
					1.3332112630207575,
					22.666651407877907
				],
				[
					0,
					22.666651407877907
				],
				[
					0,
					22.666651407877907
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 55,
			"versionNonce": 952475392,
			"isDeleted": false,
			"id": "BGmDXbli8Wq15PlOHyAw9",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 930.4481564530577,
			"y": 3248.573731837907,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 26.666666666666515,
			"height": 26.666666666666515,
			"seed": 400611942,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.3334147135417425,
					0
				],
				[
					2.6666259765625,
					0
				],
				[
					4.0000406901042425,
					0
				],
				[
					5.3334554036457575,
					0
				],
				[
					5.3334554036457575,
					1.33331298828125
				],
				[
					5.3334554036457575,
					2.6666514078774526
				],
				[
					6.6666666666667425,
					5.3333282470703125
				],
				[
					6.6666666666667425,
					6.666666666666515
				],
				[
					8.000081380208258,
					7.999979654947765
				],
				[
					8.000081380208258,
					9.333318074544422
				],
				[
					8.000081380208258,
					10.666656494140625
				],
				[
					6.6666666666667425,
					11.999994913736828
				],
				[
					6.6666666666667425,
					14.666646321614735
				],
				[
					5.3334554036457575,
					14.666646321614735
				],
				[
					4.0000406901042425,
					14.666646321614735
				],
				[
					5.3334554036457575,
					13.333333333333485
				],
				[
					9.333292643229242,
					11.999994913736828
				],
				[
					10.666707356770758,
					10.666656494140625
				],
				[
					15.999959309895758,
					10.666656494140625
				],
				[
					18.666788736979242,
					10.666656494140625
				],
				[
					21.333414713541742,
					10.666656494140625
				],
				[
					22.6666259765625,
					11.999994913736828
				],
				[
					22.6666259765625,
					13.333333333333485
				],
				[
					24.000040690104242,
					13.333333333333485
				],
				[
					24.000040690104242,
					14.666646321614735
				],
				[
					25.333455403645758,
					14.666646321614735
				],
				[
					25.333455403645758,
					15.999984741210938
				],
				[
					25.333455403645758,
					17.33332316080714
				],
				[
					22.6666259765625,
					21.33331298828125
				],
				[
					20,
					22.666651407877453
				],
				[
					15.999959309895758,
					23.99998982747411
				],
				[
					10.666707356770758,
					26.666666666666515
				],
				[
					5.3334554036457575,
					26.666666666666515
				],
				[
					2.6666259765625,
					26.666666666666515
				],
				[
					1.3334147135417425,
					26.666666666666515
				],
				[
					-1.3332112630207575,
					26.666666666666515
				],
				[
					-1.3332112630207575,
					25.333328247070312
				],
				[
					-1.3332112630207575,
					25.333328247070312
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 33,
			"versionNonce": 1462227200,
			"isDeleted": false,
			"id": "NAGWFn2bB-terV-XKlBet",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 611.7814694413389,
			"y": 3344.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 0,
			"height": 51.99999491373683,
			"seed": 2080013414,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					4.0000152587890625
				],
				[
					0,
					9.333343505859375
				],
				[
					0,
					16.00001017252589
				],
				[
					0,
					24.000015258789062
				],
				[
					0,
					26.666666666666515
				],
				[
					0,
					28.000005086263172
				],
				[
					0,
					29.333343505859375
				],
				[
					0,
					30.666681925455578
				],
				[
					0,
					31.999994913736828
				],
				[
					0,
					36.00001017252589
				],
				[
					0,
					41.3333384195962
				],
				[
					0,
					45.33332824707031
				],
				[
					0,
					48.00000508626317
				],
				[
					0,
					50.66668192545558
				],
				[
					0,
					51.99999491373683
				],
				[
					0,
					51.99999491373683
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 29,
			"versionNonce": 1824112384,
			"isDeleted": false,
			"id": "0LyDa_LkH4X3Av37BKLtq",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 611.7814694413389,
			"y": 3343.2403781595217,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 82.66672770182299,
			"height": 7.99997965494822,
			"seed": 245468902,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					9.333394368489508,
					-2.6666514078779073
				],
				[
					21.333414713541742,
					-5.3333282470703125
				],
				[
					36.00006103515625,
					-7.99997965494822
				],
				[
					49.33339436848951,
					-6.66666666666697
				],
				[
					60,
					-5.3333282470703125
				],
				[
					66.66666666666674,
					-3.99998982747411
				],
				[
					72.00002034505201,
					-3.99998982747411
				],
				[
					76.00006103515625,
					-3.99998982747411
				],
				[
					78.66668701171875,
					-3.99998982747411
				],
				[
					80.00010172526049,
					-3.99998982747411
				],
				[
					82.66672770182299,
					-6.66666666666697
				],
				[
					82.66672770182299,
					-6.66666666666697
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 26,
			"versionNonce": 604352768,
			"isDeleted": false,
			"id": "GDKjPq5QBsxfNzRI2yvQl",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 627.7815304764952,
			"y": 3359.2403883320476,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 5.3333536783854925,
			"height": 28.000005086263172,
			"seed": 891380838,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					2.66667683919286
				],
				[
					1.33331298828125,
					11.999994913736828
				],
				[
					3.99993896484375,
					17.33332316080714
				],
				[
					3.99993896484375,
					21.333338419596203
				],
				[
					3.99993896484375,
					25.333328247070312
				],
				[
					5.3333536783854925,
					25.333328247070312
				],
				[
					5.3333536783854925,
					26.666666666666515
				],
				[
					5.3333536783854925,
					28.000005086263172
				],
				[
					5.3333536783854925,
					28.000005086263172
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 32,
			"versionNonce": 1294589696,
			"isDeleted": false,
			"id": "pAIXoo7NYYzfvW2Y30d3k",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 646.4482174882139,
			"y": 3365.907054998714,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 9.333292643229242,
			"height": 30.666681925455578,
			"seed": 61452326,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					-1.3333384195962026
				],
				[
					3.99993896484375,
					-2.666676839192405
				],
				[
					5.333251953125,
					-2.666676839192405
				],
				[
					5.333251953125,
					-1.3333384195962026
				],
				[
					5.333251953125,
					1.3333384195966573
				],
				[
					5.333251953125,
					3.99998982747411
				],
				[
					5.333251953125,
					8.000005086263172
				],
				[
					6.6666666666667425,
					11.999994913737282
				],
				[
					7.9999796549479925,
					14.666671752929688
				],
				[
					7.9999796549479925,
					18.666661580403797
				],
				[
					7.9999796549479925,
					22.66667683919286
				],
				[
					7.9999796549479925,
					25.333328247070312
				],
				[
					9.333292643229242,
					26.66666666666697
				],
				[
					9.333292643229242,
					28.000005086263172
				],
				[
					9.333292643229242,
					28.000005086263172
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 27,
			"versionNonce": 1512542464,
			"isDeleted": false,
			"id": "2_tjQdqg9xT5FBStqunEd",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 642.4481767981097,
			"y": 3385.907054998714,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 21.33331298828125,
			"height": 6.666666666666515,
			"seed": 217460582,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.0000406901042425,
					0
				],
				[
					7.9999796549479925,
					-2.666676839192405
				],
				[
					10.666707356770985,
					-3.999989827473655
				],
				[
					12.000020345052235,
					-3.999989827473655
				],
				[
					14.666646321614735,
					-3.999989827473655
				],
				[
					14.666646321614735,
					-5.3333282470703125
				],
				[
					18.66668701171875,
					-5.3333282470703125
				],
				[
					20,
					-6.666666666666515
				],
				[
					21.33331298828125,
					-6.666666666666515
				],
				[
					21.33331298828125,
					-6.666666666666515
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 47,
			"versionNonce": 1788215040,
			"isDeleted": false,
			"id": "rVSkJ7hXEpeDhVs1YVqDh",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 694.4481971431619,
			"y": 3365.907054998714,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 14.666748046875,
			"height": 17.333323160807595,
			"seed": 1776879206,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.3334147135417425,
					1.3333384195966573
				],
				[
					-2.6666259765625,
					2.66667683919286
				],
				[
					-2.6666259765625,
					3.99998982747411
				],
				[
					-2.6666259765625,
					5.3333282470703125
				],
				[
					-4.0000406901042425,
					6.66666666666697
				],
				[
					-4.0000406901042425,
					8.000005086263172
				],
				[
					-4.0000406901042425,
					9.333343505859375
				],
				[
					-4.0000406901042425,
					11.999994913737282
				],
				[
					-4.0000406901042425,
					14.666671752929688
				],
				[
					-4.0000406901042425,
					17.333323160807595
				],
				[
					-1.3334147135417425,
					17.333323160807595
				],
				[
					0,
					17.333323160807595
				],
				[
					2.6666259765625,
					17.333323160807595
				],
				[
					6.666666666666515,
					16.000010172526345
				],
				[
					9.333292643229015,
					14.666671752929688
				],
				[
					10.666707356770758,
					14.666671752929688
				],
				[
					10.666707356770758,
					13.333333333333485
				],
				[
					10.666707356770758,
					10.666656494140625
				],
				[
					10.666707356770758,
					8.000005086263172
				],
				[
					10.666707356770758,
					6.66666666666697
				],
				[
					10.666707356770758,
					5.3333282470703125
				],
				[
					10.666707356770758,
					3.99998982747411
				],
				[
					10.666707356770758,
					2.66667683919286
				],
				[
					8.000081380208258,
					1.3333384195966573
				],
				[
					8.000081380208258,
					0
				],
				[
					6.666666666666515,
					0
				],
				[
					5.333251953125,
					0
				],
				[
					2.6666259765625,
					0
				],
				[
					1.333414713541515,
					0
				],
				[
					1.333414713541515,
					0
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 822964480,
			"isDeleted": false,
			"id": "VyBpqh93lEBY5-ZEURd24",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 537.1148231197244,
			"y": 3355.2403985045735,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 22.666727701822992,
			"height": 31.999994913737282,
			"seed": 1684532838,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33331298828125
				],
				[
					-2.6666259765625,
					6.66666666666697
				],
				[
					-5.3333536783854925,
					14.666646321614735
				],
				[
					-6.6666666666667425,
					20
				],
				[
					-6.6666666666667425,
					22.666651407877907
				],
				[
					-6.6666666666667425,
					25.333328247070312
				],
				[
					-6.6666666666667425,
					27.99997965494822
				],
				[
					-3.99993896484375,
					27.99997965494822
				],
				[
					-1.33331298828125,
					30.666656494140625
				],
				[
					1.33331298828125,
					31.999994913737282
				],
				[
					4.000040690104015,
					31.999994913737282
				],
				[
					6.666666666666515,
					31.999994913737282
				],
				[
					12.000020345052008,
					31.999994913737282
				],
				[
					14.666646321614508,
					31.999994913737282
				],
				[
					16.00006103515625,
					31.999994913737282
				],
				[
					16.00006103515625,
					30.666656494140625
				],
				[
					16.00006103515625,
					29.333318074544422
				],
				[
					12.000020345052008,
					29.333318074544422
				],
				[
					10.666707356770758,
					27.99997965494822
				],
				[
					5.333353678385265,
					26.66666666666697
				],
				[
					4.000040690104015,
					26.66666666666697
				],
				[
					2.666727701822765,
					25.333328247070312
				],
				[
					1.33331298828125,
					25.333328247070312
				],
				[
					0,
					27.99997965494822
				],
				[
					0,
					27.99997965494822
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 45,
			"versionNonce": 1165893376,
			"isDeleted": false,
			"id": "lc9cuXVvMRAxWamkT4dB7",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 554.4481971431619,
			"y": 3364.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 21.33331298828125,
			"height": 22.66667683919286,
			"seed": 1125019174,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.33331298828125,
					-1.3333384195962026
				],
				[
					6.666666666666515,
					-3.99998982747411
				],
				[
					7.999979654947765,
					-5.3333282470703125
				],
				[
					9.333292643229015,
					-5.3333282470703125
				],
				[
					10.666605631510265,
					-5.3333282470703125
				],
				[
					12.000020345052008,
					-5.3333282470703125
				],
				[
					13.333333333333258,
					-5.3333282470703125
				],
				[
					13.333333333333258,
					-3.99998982747411
				],
				[
					13.333333333333258,
					-2.6666514078774526
				],
				[
					12.000020345052008,
					1.3333384195962026
				],
				[
					9.333292643229015,
					9.333343505859375
				],
				[
					6.666666666666515,
					13.333333333333485
				],
				[
					5.333353678385265,
					14.666671752929688
				],
				[
					3.99993896484375,
					16.00001017252589
				],
				[
					3.99993896484375,
					17.333348592122547
				],
				[
					2.6666259765625,
					17.333348592122547
				],
				[
					3.99993896484375,
					17.333348592122547
				],
				[
					5.333353678385265,
					17.333348592122547
				],
				[
					7.999979654947765,
					17.333348592122547
				],
				[
					10.666605631510265,
					16.00001017252589
				],
				[
					12.000020345052008,
					14.666671752929688
				],
				[
					14.666646321614508,
					14.666671752929688
				],
				[
					15.999959309895758,
					14.666671752929688
				],
				[
					17.333272298177008,
					14.666671752929688
				],
				[
					18.66668701171875,
					14.666671752929688
				],
				[
					20,
					14.666671752929688
				],
				[
					21.33331298828125,
					14.666671752929688
				],
				[
					21.33331298828125,
					14.666671752929688
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 40,
			"versionNonce": 1882673408,
			"isDeleted": false,
			"id": "oRmT7KtwYR4x-rtvVXhsm",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 909.1149451900369,
			"y": 3335.2403985045735,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 20,
			"height": 15.999984741210938,
			"seed": 426477478,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					3.99998982747411
				],
				[
					2.6666259765625,
					5.3333282470703125
				],
				[
					2.6666259765625,
					6.66666666666697
				],
				[
					3.9998372395832575,
					7.99997965494822
				],
				[
					5.333251953125,
					9.333318074544422
				],
				[
					9.333292643229015,
					9.333318074544422
				],
				[
					10.66650390625,
					7.99997965494822
				],
				[
					13.333333333333258,
					6.66666666666697
				],
				[
					14.666544596354015,
					5.3333282470703125
				],
				[
					15.999959309895758,
					2.6666514078779073
				],
				[
					17.333170572916515,
					1.33331298828125
				],
				[
					17.333170572916515,
					0
				],
				[
					17.333170572916515,
					-1.3333384195962026
				],
				[
					15.999959309895758,
					-1.3333384195962026
				],
				[
					15.999959309895758,
					0
				],
				[
					15.999959309895758,
					3.99998982747411
				],
				[
					15.999959309895758,
					6.66666666666697
				],
				[
					17.333170572916515,
					10.666656494140625
				],
				[
					17.333170572916515,
					11.999994913737282
				],
				[
					18.666585286458258,
					11.999994913737282
				],
				[
					18.666585286458258,
					13.333333333333485
				],
				[
					20,
					14.666646321614735
				],
				[
					20,
					14.666646321614735
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 44,
			"versionNonce": 1315061504,
			"isDeleted": false,
			"id": "qVp5B5PLrfhjUglkxEO9W",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 954.4481971431619,
			"y": 3324.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 16.000162760416742,
			"height": 25.333328247070312,
			"seed": 402673894,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-2.6666259765625,
					1.3333384195962026
				],
				[
					-5.333251953125,
					4.0000152587890625
				],
				[
					-6.6666666666667425,
					6.666666666666515
				],
				[
					-6.6666666666667425,
					8.000005086263172
				],
				[
					-8.000081380208485,
					9.333343505859375
				],
				[
					-8.000081380208485,
					11.999994913736828
				],
				[
					-8.000081380208485,
					14.666671752929688
				],
				[
					-8.000081380208485,
					16.00001017252589
				],
				[
					-6.6666666666667425,
					18.666661580403797
				],
				[
					-5.333251953125,
					21.333338419596203
				],
				[
					-4.0000406901042425,
					22.66667683919286
				],
				[
					-4.0000406901042425,
					24.000015258789062
				],
				[
					-1.3334147135417425,
					25.333328247070312
				],
				[
					1.333414713541515,
					25.333328247070312
				],
				[
					2.6666259765625,
					25.333328247070312
				],
				[
					5.333251953125,
					25.333328247070312
				],
				[
					6.666666666666515,
					24.000015258789062
				],
				[
					6.666666666666515,
					22.66667683919286
				],
				[
					8.000081380208258,
					21.333338419596203
				],
				[
					8.000081380208258,
					20
				],
				[
					8.000081380208258,
					17.333348592122547
				],
				[
					6.666666666666515,
					17.333348592122547
				],
				[
					4.000040690104015,
					13.333333333333485
				],
				[
					2.6666259765625,
					11.999994913736828
				],
				[
					1.333414713541515,
					10.666681925455578
				],
				[
					0,
					10.666681925455578
				],
				[
					0,
					10.666681925455578
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 35,
			"versionNonce": 1864708352,
			"isDeleted": false,
			"id": "5sDk_A36v6wE-OJjIwPXc",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 618.4481361080057,
			"y": 3448.573706406592,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2.666727701822765,
			"height": 42.666676839192405,
			"seed": 884272934,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					2.666676839192405
				],
				[
					0,
					6.666666666666515
				],
				[
					1.333414713541515,
					12.00002034505178
				],
				[
					2.666727701822765,
					16.00001017252589
				],
				[
					2.666727701822765,
					18.66668701171875
				],
				[
					2.666727701822765,
					21.333363850911155
				],
				[
					2.666727701822765,
					25.333353678385265
				],
				[
					2.666727701822765,
					26.666666666666515
				],
				[
					2.666727701822765,
					28.000030517578125
				],
				[
					2.666727701822765,
					29.333343505859375
				],
				[
					2.666727701822765,
					32.00002034505178
				],
				[
					2.666727701822765,
					33.33333333333303
				],
				[
					2.666727701822765,
					37.3333740234375
				],
				[
					2.666727701822765,
					38.66668701171875
				],
				[
					2.666727701822765,
					40
				],
				[
					2.666727701822765,
					41.333363850911155
				],
				[
					2.666727701822765,
					42.666676839192405
				],
				[
					2.666727701822765,
					42.666676839192405
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 31,
			"versionNonce": 1707237120,
			"isDeleted": false,
			"id": "u_gqxQNNR8C_r6biSu8rA",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 621.1148638098284,
			"y": 3451.2403832457844,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 61.33331298828125,
			"height": 7.999979654947765,
			"seed": 1262034982,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					9.333292643229242,
					-1.33331298828125
				],
				[
					18.66668701171875,
					-2.666676839192405
				],
				[
					33.333333333333485,
					-3.999989827473655
				],
				[
					38.66668701171875,
					-5.333302815754905
				],
				[
					42.6666259765625,
					-5.333302815754905
				],
				[
					47.99997965494799,
					-6.666666666666515
				],
				[
					52.000020345052235,
					-6.666666666666515
				],
				[
					53.333333333333485,
					-6.666666666666515
				],
				[
					55.999959309895985,
					-6.666666666666515
				],
				[
					57.333272298177235,
					-6.666666666666515
				],
				[
					58.66668701171875,
					-6.666666666666515
				],
				[
					61.33331298828125,
					-6.666666666666515
				],
				[
					61.33331298828125,
					-7.999979654947765
				],
				[
					61.33331298828125,
					-7.999979654947765
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 36,
			"versionNonce": 358027520,
			"isDeleted": false,
			"id": "k2Q6sITaikuh0T_j8RQcQ",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 646.4482174882139,
			"y": 3469.907070257503,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 26.666666666666742,
			"height": 32.00002034505178,
			"seed": 1071715366,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.33331298828125,
					0
				],
				[
					3.99993896484375,
					-1.3333638509111552
				],
				[
					6.6666666666667425,
					-2.666676839192405
				],
				[
					9.333292643229242,
					-2.666676839192405
				],
				[
					11.999918619791742,
					0
				],
				[
					13.333333333333258,
					2.66667683919286
				],
				[
					13.333333333333258,
					7.99997965494822
				],
				[
					10.666605631510492,
					14.666646321614735
				],
				[
					7.9999796549479925,
					23.99998982747411
				],
				[
					6.6666666666667425,
					25.33330281575536
				],
				[
					3.99993896484375,
					29.333343505859375
				],
				[
					6.6666666666667425,
					29.333343505859375
				],
				[
					14.666646321614508,
					25.33330281575536
				],
				[
					17.333272298177008,
					23.99998982747411
				],
				[
					21.33331298828125,
					22.66667683919286
				],
				[
					22.6666259765625,
					22.66667683919286
				],
				[
					25.333251953125,
					22.66667683919286
				],
				[
					26.666666666666742,
					22.66667683919286
				],
				[
					26.666666666666742,
					22.66667683919286
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 32,
			"versionNonce": 1545502464,
			"isDeleted": false,
			"id": "JMlcU6hiaPcBArwmBCT3Z",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 571.7814694413389,
			"y": 3463.2404035908366,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 9.333292643229242,
			"height": 21.33331298828125,
			"seed": 1232679014,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33331298828125
				],
				[
					-1.33331298828125,
					3.99998982747411
				],
				[
					-3.99993896484375,
					9.333343505859375
				],
				[
					-3.99993896484375,
					11.999969482421875
				],
				[
					-3.99993896484375,
					16.00001017252589
				],
				[
					-3.99993896484375,
					18.66663614908839
				],
				[
					-1.33331298828125,
					20
				],
				[
					1.3334147135417425,
					21.33331298828125
				],
				[
					2.6667277018229925,
					21.33331298828125
				],
				[
					5.3333536783854925,
					21.33331298828125
				],
				[
					4.0000406901042425,
					21.33331298828125
				],
				[
					4.0000406901042425,
					20
				],
				[
					1.3334147135417425,
					18.66663614908839
				],
				[
					0,
					18.66663614908839
				],
				[
					0,
					18.66663614908839
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 36,
			"versionNonce": 1514991872,
			"isDeleted": false,
			"id": "qkg_oO_WvbIvPxLfoVwY9",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 581.1148638098284,
			"y": 3464.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 26.666666666666742,
			"height": 20,
			"seed": 1867720614,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					3.99993896484375,
					0
				],
				[
					6.6666666666667425,
					-1.33331298828125
				],
				[
					10.666605631510492,
					-1.33331298828125
				],
				[
					12.000020345052235,
					-1.33331298828125
				],
				[
					12.000020345052235,
					1.33336385091161
				],
				[
					12.000020345052235,
					2.66667683919286
				],
				[
					12.000020345052235,
					8.000030517578125
				],
				[
					10.666605631510492,
					12.000020345052235
				],
				[
					10.666605631510492,
					16.00001017252589
				],
				[
					7.9999796549479925,
					16.00001017252589
				],
				[
					7.9999796549479925,
					17.33332316080714
				],
				[
					7.9999796549479925,
					18.66668701171875
				],
				[
					12.000020345052235,
					17.33332316080714
				],
				[
					15.999959309895985,
					17.33332316080714
				],
				[
					20,
					16.00001017252589
				],
				[
					22.6666259765625,
					14.66669718424464
				],
				[
					25.333353678385492,
					14.66669718424464
				],
				[
					26.666666666666742,
					14.66669718424464
				],
				[
					26.666666666666742,
					14.66669718424464
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 33,
			"versionNonce": 1911987968,
			"isDeleted": false,
			"id": "fb_jumQPh7_L-kQXtrMfO",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 939.7814490962869,
			"y": 3437.9070499124514,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 33.33333333333326,
			"height": 26.666666666666515,
			"seed": 62395366,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.333414713541515,
					0
				],
				[
					8.000081380208258,
					0
				],
				[
					12.0001220703125,
					2.666676839192405
				],
				[
					12.0001220703125,
					10.666656494140625
				],
				[
					13.333333333333258,
					20
				],
				[
					13.333333333333258,
					23.999989827473655
				],
				[
					13.333333333333258,
					25.333353678385265
				],
				[
					12.0001220703125,
					25.333353678385265
				],
				[
					12.0001220703125,
					26.666666666666515
				],
				[
					13.333333333333258,
					26.666666666666515
				],
				[
					17.3333740234375,
					26.666666666666515
				],
				[
					24.000040690104015,
					25.333353678385265
				],
				[
					26.666666666666515,
					23.999989827473655
				],
				[
					29.33349609375,
					22.666676839192405
				],
				[
					33.33333333333326,
					20
				],
				[
					33.33333333333326,
					20
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 40,
			"versionNonce": 1166463232,
			"isDeleted": false,
			"id": "FoI1b0e80WCoCRtTwTodl",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 662.4481767981097,
			"y": 3536.57373692417,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 20,
			"height": 21.33331298828125,
			"seed": 6309478,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					2.666676839192405
				],
				[
					0,
					6.666666666666515
				],
				[
					0,
					10.666656494140625
				],
				[
					0,
					14.66664632161428
				],
				[
					1.33331298828125,
					16.00001017252589
				],
				[
					5.3333536783854925,
					17.33332316080714
				],
				[
					9.333292643229242,
					17.33332316080714
				],
				[
					13.333333333333485,
					17.33332316080714
				],
				[
					14.666646321614735,
					17.33332316080714
				],
				[
					17.3333740234375,
					16.00001017252589
				],
				[
					18.66668701171875,
					14.66664632161428
				],
				[
					20,
					11.999969482421875
				],
				[
					20,
					10.666656494140625
				],
				[
					20,
					6.666666666666515
				],
				[
					17.3333740234375,
					3.999989827473655
				],
				[
					15.999959309895985,
					1.33331298828125
				],
				[
					14.666646321614735,
					-1.33336385091161
				],
				[
					13.333333333333485,
					-3.99998982747411
				],
				[
					10.666707356770985,
					-3.99998982747411
				],
				[
					9.333292643229242,
					-3.99998982747411
				],
				[
					7.9999796549479925,
					-3.99998982747411
				],
				[
					6.6666666666667425,
					-3.99998982747411
				],
				[
					6.6666666666667425,
					-3.99998982747411
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 24,
			"versionNonce": 1472904960,
			"isDeleted": false,
			"id": "RFfBX4ODAb9Y3JmJ6HsVF",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 595.7815101314432,
			"y": 3531.2403832457844,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 10.666707356770758,
			"height": 10.666656494140625,
			"seed": 545716134,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.000040690104015,
					2.66667683919286
				],
				[
					5.333353678385265,
					5.33335367838572
				],
				[
					9.333292643229015,
					8.000030517578125
				],
				[
					9.333292643229015,
					9.333343505859375
				],
				[
					10.666707356770758,
					9.333343505859375
				],
				[
					10.666707356770758,
					10.666656494140625
				],
				[
					10.666707356770758,
					10.666656494140625
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 35,
			"versionNonce": 1854189824,
			"isDeleted": false,
			"id": "2G45Ge-dhSxlj_BhMcPMp",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 607.7815304764952,
			"y": 3524.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 9.333394368489508,
			"height": 18.66668701171875,
			"seed": 881282278,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33336385091161
				],
				[
					0,
					2.66667683919286
				],
				[
					0,
					3.99998982747411
				],
				[
					-1.33331298828125,
					3.99998982747411
				],
				[
					-1.33331298828125,
					5.333353678385265
				],
				[
					-2.6667277018229925,
					5.333353678385265
				],
				[
					-5.3333536783854925,
					8.000030517578125
				],
				[
					-5.3333536783854925,
					9.333343505859375
				],
				[
					-5.3333536783854925,
					10.666656494140625
				],
				[
					-6.6666666666667425,
					12.000020345052235
				],
				[
					-7.9999796549479925,
					12.000020345052235
				],
				[
					-7.9999796549479925,
					13.333333333333485
				],
				[
					-7.9999796549479925,
					14.66669718424464
				],
				[
					-9.333394368489508,
					14.66669718424464
				],
				[
					-9.333394368489508,
					16.00001017252589
				],
				[
					-9.333394368489508,
					17.33332316080714
				],
				[
					-9.333394368489508,
					18.66668701171875
				],
				[
					-9.333394368489508,
					18.66668701171875
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 41,
			"versionNonce": 773512960,
			"isDeleted": false,
			"id": "LoEdoBx_tc3CwPW7LVq2m",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 583.7814897863909,
			"y": 3612.573747096696,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 34.66664632161451,
			"height": 35.999959309895985,
			"seed": 964369894,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.0000406901042425,
					0
				],
				[
					7.9999796549479925,
					0
				],
				[
					9.333394368489735,
					2.6666259765625
				],
				[
					12.000020345052235,
					5.33330281575536
				],
				[
					12.000020345052235,
					7.999979654947765
				],
				[
					12.000020345052235,
					11.999969482421875
				],
				[
					10.666707356770985,
					14.666646321614735
				],
				[
					6.6666666666667425,
					21.33331298828125
				],
				[
					2.6667277018229925,
					26.66666666666697
				],
				[
					0,
					27.99997965494822
				],
				[
					-3.99993896484375,
					31.999969482421875
				],
				[
					-5.333353678385265,
					31.999969482421875
				],
				[
					-6.666666666666515,
					31.999969482421875
				],
				[
					-6.666666666666515,
					29.33329264322947
				],
				[
					-5.333353678385265,
					29.33329264322947
				],
				[
					-2.6666259765625,
					29.33329264322947
				],
				[
					-1.33331298828125,
					29.33329264322947
				],
				[
					2.6667277018229925,
					29.33329264322947
				],
				[
					7.9999796549479925,
					29.33329264322947
				],
				[
					12.000020345052235,
					29.33329264322947
				],
				[
					20,
					33.333333333333485
				],
				[
					24.000040690104242,
					35.999959309895985
				],
				[
					27.999979654947992,
					35.999959309895985
				],
				[
					27.999979654947992,
					35.999959309895985
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 28,
			"versionNonce": 2093388032,
			"isDeleted": false,
			"id": "BdvaaLP3kDZ6HlACsp7W2",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 619.7815508215472,
			"y": 3616.57373692417,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 23.99993896484375,
			"height": 17.33332316080714,
			"seed": 244419174,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996508,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					5.333251953125,
					1.33331298828125
				],
				[
					9.333292643229242,
					5.333302815754905
				],
				[
					14.666646321614735,
					9.333343505859375
				],
				[
					17.333272298177235,
					11.999969482421875
				],
				[
					18.666585286458485,
					14.666646321614735
				],
				[
					20,
					14.666646321614735
				],
				[
					20,
					16.00001017252589
				],
				[
					21.33331298828125,
					16.00001017252589
				],
				[
					22.6666259765625,
					16.00001017252589
				],
				[
					23.99993896484375,
					17.33332316080714
				],
				[
					23.99993896484375,
					17.33332316080714
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 32,
			"versionNonce": 90636032,
			"isDeleted": false,
			"id": "3FEUAz2nfrTzwkywm743L",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 638.4481361080057,
			"y": 3604.573716579118,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 14.666646321614735,
			"height": 23.99998982747411,
			"seed": 1086244006,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.33331298828125,
					2.66667683919286
				],
				[
					-3.99993896484375,
					5.333353678385265
				],
				[
					-5.333251953125,
					6.666666666666515
				],
				[
					-5.333251953125,
					8.000030517578125
				],
				[
					-5.333251953125,
					9.333343505859375
				],
				[
					-7.9999796549479925,
					10.666656494140625
				],
				[
					-9.333292643229242,
					12.000020345052235
				],
				[
					-10.666605631510492,
					13.333333333333485
				],
				[
					-10.666605631510492,
					14.66669718424464
				],
				[
					-11.999918619791742,
					16.00001017252589
				],
				[
					-11.999918619791742,
					17.33332316080714
				],
				[
					-13.333333333333485,
					18.66668701171875
				],
				[
					-14.666646321614735,
					18.66668701171875
				],
				[
					-14.666646321614735,
					23.99998982747411
				],
				[
					-14.666646321614735,
					23.99998982747411
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 49,
			"versionNonce": 667709696,
			"isDeleted": false,
			"id": "zPiZTErVE8S6OjX8N3AAF",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 683.7814897863909,
			"y": 3608.573706406592,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 16.00006103515625,
			"height": 29.333343505859375,
			"seed": 798733286,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.33331298828125,
					2.666676839192405
				],
				[
					-3.99993896484375,
					4.000040690104015
				],
				[
					-5.333353678385265,
					6.666666666666515
				],
				[
					-5.333353678385265,
					10.66670735677053
				],
				[
					-5.333353678385265,
					12.00002034505178
				],
				[
					-5.333353678385265,
					13.33333333333303
				],
				[
					-5.333353678385265,
					16.00001017252589
				],
				[
					-5.333353678385265,
					18.66668701171875
				],
				[
					-3.99993896484375,
					22.66667683919286
				],
				[
					-2.6666259765625,
					25.333353678385265
				],
				[
					-1.33331298828125,
					26.666666666666515
				],
				[
					0,
					28.000030517578125
				],
				[
					4.0000406901042425,
					29.333343505859375
				],
				[
					5.3333536783854925,
					29.333343505859375
				],
				[
					6.6666666666667425,
					29.333343505859375
				],
				[
					9.333292643229242,
					28.000030517578125
				],
				[
					10.666707356770985,
					26.666666666666515
				],
				[
					10.666707356770985,
					25.333353678385265
				],
				[
					10.666707356770985,
					22.66667683919286
				],
				[
					10.666707356770985,
					21.33336385091161
				],
				[
					10.666707356770985,
					20
				],
				[
					10.666707356770985,
					18.66668701171875
				],
				[
					9.333292643229242,
					18.66668701171875
				],
				[
					9.333292643229242,
					17.3333740234375
				],
				[
					6.6666666666667425,
					17.3333740234375
				],
				[
					5.3333536783854925,
					17.3333740234375
				],
				[
					1.33331298828125,
					17.3333740234375
				],
				[
					0,
					18.66668701171875
				],
				[
					-1.33331298828125,
					20
				],
				[
					-3.99993896484375,
					21.33336385091161
				],
				[
					-5.333353678385265,
					22.66667683919286
				],
				[
					-5.333353678385265,
					22.66667683919286
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 44,
			"versionNonce": 1580146432,
			"isDeleted": false,
			"id": "1gy1q8APEhFkxeAND8uru",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 699.7814490962869,
			"y": 3615.2403730732585,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 28.000081380208258,
			"height": 24.000040690104015,
			"seed": 1473206886,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					-1.33331298828125
				],
				[
					4.000040690104015,
					-5.33330281575536
				],
				[
					4.000040690104015,
					-6.666666666666515
				],
				[
					5.3334554036457575,
					-6.666666666666515
				],
				[
					6.666666666666515,
					-6.666666666666515
				],
				[
					8.000081380208258,
					-6.666666666666515
				],
				[
					9.33349609375,
					-6.666666666666515
				],
				[
					10.666707356770758,
					-6.666666666666515
				],
				[
					13.333333333333258,
					-6.666666666666515
				],
				[
					14.666748046875,
					-3.99998982747411
				],
				[
					14.666748046875,
					-2.6666259765625
				],
				[
					14.666748046875,
					-1.33331298828125
				],
				[
					14.666748046875,
					1.33336385091161
				],
				[
					13.333333333333258,
					2.66667683919286
				],
				[
					12.0001220703125,
					4.000040690104015
				],
				[
					12.0001220703125,
					5.333353678385265
				],
				[
					12.0001220703125,
					8.000030517578125
				],
				[
					14.666748046875,
					10.666707356770985
				],
				[
					18.666788736979015,
					13.333333333333485
				],
				[
					20,
					14.666697184245095
				],
				[
					22.666829427083258,
					16.000010172526345
				],
				[
					22.666829427083258,
					17.3333740234375
				],
				[
					24.000040690104015,
					17.3333740234375
				],
				[
					25.333455403645758,
					17.3333740234375
				],
				[
					26.666666666666515,
					17.3333740234375
				],
				[
					28.000081380208258,
					17.3333740234375
				],
				[
					28.000081380208258,
					17.3333740234375
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 35,
			"versionNonce": 924209408,
			"isDeleted": false,
			"id": "F77UtDq7tDRfMjXipYhiz",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 715.7816118567034,
			"y": 3577.9070499124514,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 14.666544596354242,
			"height": 18.66668701171875,
			"seed": 1836681382,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.333211263020985,
					0
				],
				[
					2.6666259765625,
					1.3333638509111552
				],
				[
					2.6666259765625,
					3.999989827473655
				],
				[
					2.6666259765625,
					5.333353678385265
				],
				[
					2.6666259765625,
					8.000030517578125
				],
				[
					2.6666259765625,
					10.666656494140625
				],
				[
					2.6666259765625,
					12.00002034505178
				],
				[
					1.333211263020985,
					12.00002034505178
				],
				[
					1.333211263020985,
					13.33333333333303
				],
				[
					1.333211263020985,
					14.66669718424464
				],
				[
					3.999837239583485,
					16.00001017252589
				],
				[
					5.333251953125,
					16.00001017252589
				],
				[
					9.333292643229242,
					18.66668701171875
				],
				[
					10.66650390625,
					18.66668701171875
				],
				[
					11.999918619791742,
					18.66668701171875
				],
				[
					13.333333333333485,
					18.66668701171875
				],
				[
					14.666544596354242,
					18.66668701171875
				],
				[
					14.666544596354242,
					18.66668701171875
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 25,
			"versionNonce": 687030016,
			"isDeleted": false,
			"id": "r7yhP1zsS2vbVSTkgMaXZ",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 749.1149451900369,
			"y": 3617.9070499124514,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 20,
			"height": 0,
			"seed": 780269990,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					3.9998372395832575,
					0
				],
				[
					7.9998779296875,
					0
				],
				[
					13.333333333333258,
					0
				],
				[
					15.999959309895758,
					0
				],
				[
					17.333170572916515,
					0
				],
				[
					18.666585286458258,
					0
				],
				[
					20,
					0
				],
				[
					20,
					0
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 30,
			"versionNonce": 35926272,
			"isDeleted": false,
			"id": "J5Gnyha8StekGDf6lWYYy",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 762.4482785233702,
			"y": 3611.2403832457844,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2.6666259765625,
			"height": 18.666687011719205,
			"seed": 563692070,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33336385091161
				],
				[
					0,
					3.99998982747411
				],
				[
					0,
					5.33335367838572
				],
				[
					0,
					6.66666666666697
				],
				[
					0,
					8.000030517578125
				],
				[
					0,
					9.333343505859375
				],
				[
					0,
					10.666656494140625
				],
				[
					0,
					12.000020345052235
				],
				[
					0,
					14.666697184245095
				],
				[
					0,
					16.000010172526345
				],
				[
					1.3332112630207575,
					17.333323160807595
				],
				[
					2.6666259765625,
					18.666687011719205
				],
				[
					2.6666259765625,
					18.666687011719205
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 44,
			"versionNonce": 1177771776,
			"isDeleted": false,
			"id": "QUYN3uWVmGEtPt9o0DaPY",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 826.4481157629534,
			"y": 3596.57373692417,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 22.666829427083485,
			"height": 23.99998982747411,
			"seed": 2030207718,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33331298828125
				],
				[
					1.3334147135417425,
					6.666666666666515
				],
				[
					2.666829427083485,
					10.666656494140625
				],
				[
					4.0000406901042425,
					13.33333333333303
				],
				[
					6.6666666666667425,
					17.33332316080714
				],
				[
					8.000081380208485,
					17.33332316080714
				],
				[
					9.33349609375,
					18.66663614908839
				],
				[
					9.33349609375,
					20
				],
				[
					10.666707356770985,
					20
				],
				[
					13.333333333333485,
					20
				],
				[
					14.666748046875,
					18.66663614908839
				],
				[
					17.3333740234375,
					16.00001017252589
				],
				[
					20,
					14.66664632161428
				],
				[
					21.333414713541742,
					7.999979654947765
				],
				[
					21.333414713541742,
					3.999989827473655
				],
				[
					21.333414713541742,
					0
				],
				[
					21.333414713541742,
					-2.66667683919286
				],
				[
					20,
					-3.99998982747411
				],
				[
					20,
					0
				],
				[
					20,
					2.666676839192405
				],
				[
					21.333414713541742,
					5.333302815754905
				],
				[
					21.333414713541742,
					7.999979654947765
				],
				[
					21.333414713541742,
					10.666656494140625
				],
				[
					22.666829427083485,
					14.66664632161428
				],
				[
					22.666829427083485,
					16.00001017252589
				],
				[
					22.666829427083485,
					17.33332316080714
				],
				[
					22.666829427083485,
					17.33332316080714
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 37,
			"versionNonce": 1886785792,
			"isDeleted": false,
			"id": "_-XiNsmZDfOD506Yxf0_G",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 873.1147824296202,
			"y": 3593.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 17.333170572916515,
			"height": 21.33331298828125,
			"seed": 1398923558,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.3332112630207575,
					3.99998982747411
				],
				[
					-3.9998372395832575,
					7.999979654947765
				],
				[
					-3.9998372395832575,
					10.666656494140625
				],
				[
					-3.9998372395832575,
					13.333333333333485
				],
				[
					-3.9998372395832575,
					14.666646321614735
				],
				[
					-1.3332112630207575,
					17.33332316080714
				],
				[
					-1.3332112630207575,
					18.66668701171875
				],
				[
					0,
					20
				],
				[
					1.3334147135417425,
					21.33331298828125
				],
				[
					2.6668294270832575,
					21.33331298828125
				],
				[
					6.6666666666667425,
					21.33331298828125
				],
				[
					9.33349609375,
					21.33331298828125
				],
				[
					10.666707356770758,
					21.33331298828125
				],
				[
					13.333333333333258,
					21.33331298828125
				],
				[
					12.0001220703125,
					20
				],
				[
					9.33349609375,
					18.66668701171875
				],
				[
					6.6666666666667425,
					18.66668701171875
				],
				[
					2.6668294270832575,
					18.66668701171875
				],
				[
					0,
					18.66668701171875
				],
				[
					0,
					18.66668701171875
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 29,
			"versionNonce": 107970304,
			"isDeleted": false,
			"id": "gp0zI_aE-GWRIQpC7FgfA",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 897.1148231197244,
			"y": 3591.2403832457844,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 18.666788736979015,
			"height": 20,
			"seed": 1552629926,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.333414713541515,
					0
				],
				[
					6.666666666666515,
					6.66666666666697
				],
				[
					8.000081380208258,
					9.333343505859375
				],
				[
					10.666707356770758,
					12.000020345052235
				],
				[
					12.0001220703125,
					16.000010172526345
				],
				[
					13.333333333333258,
					17.333323160807595
				],
				[
					14.666748046875,
					17.333323160807595
				],
				[
					15.999959309895758,
					17.333323160807595
				],
				[
					15.999959309895758,
					18.66668701171875
				],
				[
					15.999959309895758,
					20
				],
				[
					18.666788736979015,
					20
				],
				[
					18.666788736979015,
					20
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 27,
			"versionNonce": 2039214336,
			"isDeleted": false,
			"id": "-raNChHzxSWfk-1QU4gyi",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 915.7816118567034,
			"y": 3593.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 16.000162760416515,
			"height": 22.66667683919286,
			"seed": 1497171494,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.333414713541515,
					3.99998982747411
				],
				[
					-4.000040690104015,
					10.666656494140625
				],
				[
					-8.000081380208258,
					13.333333333333485
				],
				[
					-9.33349609375,
					16.00001017252589
				],
				[
					-10.666707356770758,
					16.00001017252589
				],
				[
					-12.0001220703125,
					17.33332316080714
				],
				[
					-13.333333333333258,
					18.66668701171875
				],
				[
					-14.666748046875,
					21.33331298828125
				],
				[
					-16.000162760416515,
					22.66667683919286
				],
				[
					-16.000162760416515,
					22.66667683919286
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 707239680,
			"isDeleted": false,
			"id": "3y7TQZ9eOwN-BEcrznJBH",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 942.4482785233702,
			"y": 3597.9070499124514,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 20,
			"height": 14.66669718424464,
			"seed": 1438367014,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					3.999989827473655
				],
				[
					0,
					6.666666666666515
				],
				[
					0,
					8.000030517578125
				],
				[
					0,
					9.333343505859375
				],
				[
					0,
					10.666656494140625
				],
				[
					1.3332112630207575,
					10.666656494140625
				],
				[
					1.3332112630207575,
					12.00002034505178
				],
				[
					5.333251953125,
					14.66669718424464
				],
				[
					9.333292643229242,
					14.66669718424464
				],
				[
					11.999918619791742,
					14.66669718424464
				],
				[
					14.666544596354242,
					14.66669718424464
				],
				[
					15.999959309895758,
					13.33333333333303
				],
				[
					18.666585286458258,
					12.00002034505178
				],
				[
					20,
					12.00002034505178
				],
				[
					20,
					10.666656494140625
				],
				[
					18.666585286458258,
					9.333343505859375
				],
				[
					17.333170572916742,
					9.333343505859375
				],
				[
					14.666544596354242,
					9.333343505859375
				],
				[
					11.999918619791742,
					9.333343505859375
				],
				[
					9.333292643229242,
					9.333343505859375
				],
				[
					7.9998779296875,
					9.333343505859375
				],
				[
					6.6666666666667425,
					9.333343505859375
				],
				[
					3.9998372395832575,
					9.333343505859375
				],
				[
					3.9998372395832575,
					10.666656494140625
				],
				[
					3.9998372395832575,
					10.666656494140625
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 40,
			"versionNonce": 619041024,
			"isDeleted": false,
			"id": "RScPQzpe2pkWbn8Lvf1qZ",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 962.4482785233702,
			"y": 3593.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 35.99995930989576,
			"height": 21.33331298828125,
			"seed": 1198748902,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.3332112630207575,
					0
				],
				[
					6.6666666666667425,
					0
				],
				[
					10.66650390625,
					0
				],
				[
					11.999918619791742,
					0
				],
				[
					15.999959309895758,
					0
				],
				[
					17.333170572916742,
					2.66667683919286
				],
				[
					18.666585286458258,
					3.99998982747411
				],
				[
					18.666585286458258,
					5.333353678385265
				],
				[
					18.666585286458258,
					6.666666666666515
				],
				[
					18.666585286458258,
					7.999979654947765
				],
				[
					18.666585286458258,
					10.666656494140625
				],
				[
					17.333170572916742,
					12.000020345052235
				],
				[
					13.333333333333258,
					13.333333333333485
				],
				[
					11.999918619791742,
					13.333333333333485
				],
				[
					10.66650390625,
					13.333333333333485
				],
				[
					11.999918619791742,
					14.666646321614735
				],
				[
					17.333170572916742,
					16.00001017252589
				],
				[
					22.6666259765625,
					17.33332316080714
				],
				[
					26.666666666666742,
					18.66668701171875
				],
				[
					31.999918619791742,
					20
				],
				[
					34.66654459635424,
					21.33331298828125
				],
				[
					35.99995930989576,
					21.33331298828125
				],
				[
					35.99995930989576,
					21.33331298828125
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 25,
			"versionNonce": 1641791232,
			"isDeleted": false,
			"id": "x-J9CpmNqDCVflvk-W3Oa",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 982.4482785233702,
			"y": 3568.573706406592,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2.6666259765625,
			"height": 12.00002034505178,
			"seed": 1799149094,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.3332112630207575,
					2.666676839192405
				],
				[
					1.3332112630207575,
					5.333353678385265
				],
				[
					2.6666259765625,
					6.666666666666515
				],
				[
					2.6666259765625,
					8.000030517578125
				],
				[
					2.6666259765625,
					9.333343505859375
				],
				[
					2.6666259765625,
					10.66670735677053
				],
				[
					2.6666259765625,
					12.00002034505178
				],
				[
					2.6666259765625,
					12.00002034505178
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 23,
			"versionNonce": 168014080,
			"isDeleted": false,
			"id": "FLGbCauLnuateLXWIrBRu",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1013.1147824296202,
			"y": 3601.907039739925,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 17.3333740234375,
			"height": 5.333302815754905,
			"seed": 1388478118,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					4.0000406901042425,
					0
				],
				[
					10.666707356770758,
					-3.999989827473655
				],
				[
					14.666748046875,
					-3.999989827473655
				],
				[
					16.000162760416742,
					-3.999989827473655
				],
				[
					17.3333740234375,
					-5.333302815754905
				],
				[
					17.3333740234375,
					-5.333302815754905
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 27,
			"versionNonce": 1309400832,
			"isDeleted": false,
			"id": "ZH0QddaMAkUOaMo9gP_3a",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1023.7814897863909,
			"y": 3581.907039739925,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 4.0000406901042425,
			"height": 21.33336385091161,
			"seed": 620558502,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					2.66667683919286
				],
				[
					0,
					6.66666666666697
				],
				[
					0,
					9.333343505859375
				],
				[
					1.3334147135417425,
					13.333333333333485
				],
				[
					2.6666259765625,
					16.000010172526345
				],
				[
					2.6666259765625,
					17.3333740234375
				],
				[
					4.0000406901042425,
					18.66668701171875
				],
				[
					4.0000406901042425,
					20
				],
				[
					4.0000406901042425,
					21.33336385091161
				],
				[
					4.0000406901042425,
					21.33336385091161
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 51,
			"versionNonce": 1348833536,
			"isDeleted": false,
			"id": "II-qNVfIgKcVu5s6B1YYA",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1070.4481564530577,
			"y": 3576.57373692417,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 30.666707356770985,
			"height": 40,
			"seed": 1861480358,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.3332112630207575,
					1.33331298828125
				],
				[
					-2.6666259765625,
					1.33331298828125
				],
				[
					-5.333251953125,
					3.999989827473655
				],
				[
					-5.333251953125,
					5.333302815754905
				],
				[
					-7.9998779296875,
					7.999979654947765
				],
				[
					-9.333292643229242,
					9.333343505859375
				],
				[
					-9.333292643229242,
					10.666656494140625
				],
				[
					-9.333292643229242,
					13.33333333333303
				],
				[
					-7.9998779296875,
					14.66664632161428
				],
				[
					-7.9998779296875,
					20
				],
				[
					-7.9998779296875,
					21.33331298828125
				],
				[
					-6.6666666666667425,
					22.666676839192405
				],
				[
					-5.333251953125,
					22.666676839192405
				],
				[
					-1.3332112630207575,
					18.66663614908839
				],
				[
					1.3334147135417425,
					13.33333333333303
				],
				[
					5.3334554036457575,
					9.333343505859375
				],
				[
					6.6666666666667425,
					7.999979654947765
				],
				[
					8.000081380208258,
					6.666666666666515
				],
				[
					9.333292643229242,
					6.666666666666515
				],
				[
					10.666707356770758,
					6.666666666666515
				],
				[
					12.0001220703125,
					7.999979654947765
				],
				[
					15.999959309895758,
					9.333343505859375
				],
				[
					17.3333740234375,
					10.666656494140625
				],
				[
					18.666788736979242,
					13.33333333333303
				],
				[
					20,
					16.00001017252589
				],
				[
					21.333414713541742,
					18.66663614908839
				],
				[
					21.333414713541742,
					22.666676839192405
				],
				[
					20,
					25.333302815754905
				],
				[
					14.666748046875,
					31.999969482421875
				],
				[
					10.666707356770758,
					34.66664632161428
				],
				[
					8.000081380208258,
					37.33332316080714
				],
				[
					5.3334554036457575,
					38.66663614908839
				],
				[
					4.0000406901042425,
					40
				],
				[
					4.0000406901042425,
					40
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 48,
			"versionNonce": 2134376192,
			"isDeleted": false,
			"id": "4w_MShpMdW9zLtrcsuF8O",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1107.7815304764954,
			"y": 3580.573726751644,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 35.99995930989553,
			"height": 25.333353678385265,
			"seed": 1387910310,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					6.666666666666515,
					-3.999989827473655
				],
				[
					11.999918619791515,
					-5.333353678385265
				],
				[
					15.99995930989553,
					-5.333353678385265
				],
				[
					17.3333740234375,
					-5.333353678385265
				],
				[
					20,
					-5.333353678385265
				],
				[
					21.333414713541515,
					-5.333353678385265
				],
				[
					22.6666259765625,
					-5.333353678385265
				],
				[
					24.000040690104015,
					-2.666676839192405
				],
				[
					24.000040690104015,
					-1.33331298828125
				],
				[
					24.000040690104015,
					1.33331298828125
				],
				[
					24.000040690104015,
					3.99998982747411
				],
				[
					24.000040690104015,
					6.66666666666697
				],
				[
					22.6666259765625,
					7.99997965494822
				],
				[
					21.333414713541515,
					7.99997965494822
				],
				[
					20,
					7.99997965494822
				],
				[
					22.6666259765625,
					7.99997965494822
				],
				[
					25.333251953125,
					6.66666666666697
				],
				[
					28.00008138020803,
					5.33335367838572
				],
				[
					31.999918619791515,
					5.33335367838572
				],
				[
					34.666748046875,
					6.66666666666697
				],
				[
					35.99995930989553,
					7.99997965494822
				],
				[
					35.99995930989553,
					10.666656494140625
				],
				[
					31.999918619791515,
					16.000010172526345
				],
				[
					28.00008138020803,
					18.66668701171875
				],
				[
					25.333251953125,
					20
				],
				[
					20,
					20
				],
				[
					15.99995930989553,
					20
				],
				[
					13.33333333333303,
					20
				],
				[
					11.999918619791515,
					20
				],
				[
					10.66670735677053,
					20
				],
				[
					10.66670735677053,
					20
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 28,
			"versionNonce": 797667584,
			"isDeleted": false,
			"id": "5YMVWbnI6Rq64Wum6uJBC",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1157.1148231197244,
			"y": 3573.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 15.999959309895985,
			"height": 17.33332316080714,
			"seed": 1788688358,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.333414713541515,
					0
				],
				[
					2.6666259765625,
					2.66667683919286
				],
				[
					5.333455403645985,
					3.99998982747411
				],
				[
					6.666666666666515,
					6.666666666666515
				],
				[
					10.666707356770985,
					9.333343505859375
				],
				[
					12.0001220703125,
					12.000020345052235
				],
				[
					13.333333333333485,
					13.333333333333485
				],
				[
					14.666748046875,
					14.666646321614735
				],
				[
					15.999959309895985,
					16.00001017252589
				],
				[
					15.999959309895985,
					17.33332316080714
				],
				[
					15.999959309895985,
					17.33332316080714
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 30,
			"versionNonce": 1977622272,
			"isDeleted": false,
			"id": "glyOHMuv25hOyUKiw4Vn0",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1173.1147824296204,
			"y": 3575.2403730732585,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 10.66650390625,
			"height": 17.3333740234375,
			"seed": 1662550566,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.333211263020985,
					2.66667683919286
				],
				[
					-1.333211263020985,
					4.000040690104015
				],
				[
					-2.6666259765625,
					4.000040690104015
				],
				[
					-3.999837239583485,
					8.000030517578125
				],
				[
					-6.66666666666697,
					9.333343505859375
				],
				[
					-7.9998779296875,
					10.666707356770985
				],
				[
					-7.9998779296875,
					12.000020345052235
				],
				[
					-7.9998779296875,
					13.333333333333485
				],
				[
					-9.33329264322947,
					14.66669718424464
				],
				[
					-10.66650390625,
					14.66669718424464
				],
				[
					-10.66650390625,
					16.00001017252589
				],
				[
					-10.66650390625,
					17.3333740234375
				],
				[
					-10.66650390625,
					17.3333740234375
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 1861570816,
			"isDeleted": false,
			"id": "o7cFzZlMsma96NiOfaY8I",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1214.448197143162,
			"y": 3569.907070257503,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 17.3333740234375,
			"height": 34.666646321614735,
			"seed": 1927922406,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.333414713541515,
					1.33331298828125
				],
				[
					-6.666666666666515,
					7.99997965494822
				],
				[
					-11.999918619791515,
					14.666646321614735
				],
				[
					-15.999959309895985,
					21.33331298828125
				],
				[
					-17.3333740234375,
					23.99998982747411
				],
				[
					-17.3333740234375,
					26.66666666666697
				],
				[
					-17.3333740234375,
					27.99997965494822
				],
				[
					-17.3333740234375,
					29.333343505859375
				],
				[
					-17.3333740234375,
					30.666656494140625
				],
				[
					-15.999959309895985,
					31.999969482421875
				],
				[
					-13.333333333333485,
					33.333333333333485
				],
				[
					-10.666707356770985,
					33.333333333333485
				],
				[
					-8.000081380208485,
					34.666646321614735
				],
				[
					-6.666666666666515,
					34.666646321614735
				],
				[
					-5.333251953125,
					34.666646321614735
				],
				[
					-4.000040690104015,
					33.333333333333485
				],
				[
					-4.000040690104015,
					31.999969482421875
				],
				[
					-4.000040690104015,
					26.66666666666697
				],
				[
					-4.000040690104015,
					25.33330281575536
				],
				[
					-4.000040690104015,
					22.66667683919286
				],
				[
					-4.000040690104015,
					20
				],
				[
					-4.000040690104015,
					18.666636149088845
				],
				[
					-5.333251953125,
					18.666636149088845
				],
				[
					-6.666666666666515,
					18.666636149088845
				],
				[
					-6.666666666666515,
					18.666636149088845
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 35,
			"versionNonce": 579092224,
			"isDeleted": false,
			"id": "EwngJ-_Wj-A9kmXjDYYQ5",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1225.114904499933,
			"y": 3573.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 29.333292643229015,
			"height": 18.66668701171875,
			"seed": 164958886,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					2.6666259765625,
					0
				],
				[
					4.000040690104015,
					0
				],
				[
					4.000040690104015,
					1.33331298828125
				],
				[
					4.000040690104015,
					2.66667683919286
				],
				[
					4.000040690104015,
					5.333353678385265
				],
				[
					4.000040690104015,
					7.999979654947765
				],
				[
					4.000040690104015,
					10.666656494140625
				],
				[
					1.3332112630205302,
					14.666646321614735
				],
				[
					1.3332112630205302,
					16.00001017252589
				],
				[
					1.3332112630205302,
					17.33332316080714
				],
				[
					4.000040690104015,
					17.33332316080714
				],
				[
					11.999918619791515,
					17.33332316080714
				],
				[
					18.66658528645803,
					17.33332316080714
				],
				[
					24.000040690104015,
					17.33332316080714
				],
				[
					26.666666666666515,
					17.33332316080714
				],
				[
					29.333292643229015,
					17.33332316080714
				],
				[
					29.333292643229015,
					18.66668701171875
				],
				[
					29.333292643229015,
					18.66668701171875
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 42,
			"versionNonce": 1713582336,
			"isDeleted": false,
			"id": "-vzd6lQ29Wxi19xxac625",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1243.781489786391,
			"y": 3553.9070600849773,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 14.666748046875,
			"height": 13.333333333333485,
			"seed": 544506790,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					1.33331298828125
				],
				[
					1.3334147135419698,
					2.66667683919286
				],
				[
					2.6666259765625,
					2.66667683919286
				],
				[
					4.00004069010447,
					2.66667683919286
				],
				[
					6.66666666666697,
					2.66667683919286
				],
				[
					9.33329264322947,
					2.66667683919286
				],
				[
					10.666707356770985,
					0
				],
				[
					12.0001220703125,
					0
				],
				[
					13.333333333333485,
					0
				],
				[
					14.666748046875,
					-3.99998982747411
				],
				[
					14.666748046875,
					-7.999979654947765
				],
				[
					14.666748046875,
					-10.666656494140625
				],
				[
					13.333333333333485,
					-10.666656494140625
				],
				[
					12.0001220703125,
					-10.666656494140625
				],
				[
					10.666707356770985,
					-10.666656494140625
				],
				[
					8.000081380208485,
					-9.333343505859375
				],
				[
					5.333455403645985,
					-7.999979654947765
				],
				[
					5.333455403645985,
					-6.666666666666515
				],
				[
					4.00004069010447,
					-6.666666666666515
				],
				[
					2.6666259765625,
					-6.666666666666515
				],
				[
					1.3334147135419698,
					-5.333353678385265
				],
				[
					1.3334147135419698,
					-3.99998982747411
				],
				[
					0,
					-1.33331298828125
				],
				[
					0,
					0
				],
				[
					0.0001,
					0.0001
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "text",
			"version": 218,
			"versionNonce": 1705271040,
			"isDeleted": false,
			"id": "HdlJw3uO",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 111.78146944133891,
			"y": 3275.2403730732585,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 290.625,
			"height": 76.8,
			"seed": 221817786,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "will experience race condition,\nto overcome it we can use locks\nbut it will inc the latency of\nthe system",
			"rawText": "will experience race condition,\nto overcome it we can use locks\nbut it will inc the latency of\nthe system",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "will experience race condition,\nto overcome it we can use locks\nbut it will inc the latency of\nthe system",
			"lineHeight": 1.2
		},
		{
			"type": "line",
			"version": 6021,
			"versionNonce": 2090144000,
			"isDeleted": false,
			"id": "G6xBiTrIxLsSeyvBjv3AM",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 348.58940150746866,
			"y": 3622.702702771778,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 75.01121630306868,
			"height": 96.81388324216654,
			"seed": 1895530618,
			"groupIds": [
				"tcLfR2HI6ea7ax4Q6VXDn",
				"S3NcdebolrmrL5vkZfg0X",
				"8vqpawkzXtZLlVfaUzdWX"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.24734846976242794,
					73.1714082159101
				],
				[
					0.011575327725072006,
					81.50165529728328
				],
				[
					3.8632435379119165,
					85.10105205208878
				],
				[
					17.276485894102954,
					88.14730719194147
				],
				[
					39.948665011120255,
					89.0958655364321
				],
				[
					61.61043288740646,
					87.58135319133916
				],
				[
					73.11948965218787,
					83.95942431004657
				],
				[
					74.74268637210398,
					80.90610026776591
				],
				[
					74.9706584753909,
					74.19947908967055
				],
				[
					74.79172688269483,
					6.138672737165569
				],
				[
					74.38835763792527,
					-0.2918194398554754
				],
				[
					69.57188081608908,
					-3.885863818744892
				],
				[
					59.42940850758881,
					-5.967344146345569
				],
				[
					36.31608449133351,
					-7.7180177057344235
				],
				[
					17.785060590062127,
					-6.674087120295436
				],
				[
					3.210536142559118,
					-3.1332019499277424
				],
				[
					-0.04055782767777212,
					-0.04396604849106378
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6741,
			"versionNonce": 264273664,
			"isDeleted": false,
			"id": "bWP7L5S-i7BbEUAez0AtV",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 348.85533409815264,
			"y": 3613.9497346157505,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 74.53008207714048,
			"height": 15.073148387271289,
			"seed": 1969840442,
			"groupIds": [
				"tcLfR2HI6ea7ax4Q6VXDn",
				"S3NcdebolrmrL5vkZfg0X",
				"8vqpawkzXtZLlVfaUzdWX"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 83,
			"versionNonce": 701165824,
			"isDeleted": false,
			"id": "dxPw0I52-__Di-JyJg_Cu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 175.78151013144316,
			"y": 3716.57373692417,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 166.66666666666652,
			"height": 35.999959309895985,
			"seed": 1946889062,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996509,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "DAt35WKtw76LZQlMO0UN0",
				"focus": 0.8034432040697004,
				"gap": 1
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					166.66666666666652,
					-35.999959309895985
				]
			]
		},
		{
			"type": "arrow",
			"version": 57,
			"versionNonce": 1633197824,
			"isDeleted": false,
			"id": "HUKMsoYB9UWllsvVriFVZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 206.4482174882139,
			"y": 3477.9070499124514,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 77.3333740234375,
			"height": 116.00001017252589,
			"seed": 468998586,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996510,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "85Z8PS9v6zrtHTmKNnBLj",
				"focus": 0.41226795932909993,
				"gap": 2.6666259765625
			},
			"endBinding": {
				"elementId": "Ocddt8r_TXcNs1PgKC4Ml",
				"focus": -0.33790468936060886,
				"gap": 18.028471962295953
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-77.3333740234375,
					116.00001017252589
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1521,
			"versionNonce": 1967444224,
			"isDeleted": false,
			"id": "H-cjssD4kNAck2vbMkLJ2",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -339.87502444157553,
			"y": 4130.622866996662,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1163926586,
			"groupIds": [
				"5Qmrb-DwnoUtAaGVcxal3"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "rM0cW7HF"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 104,
			"versionNonce": 183287552,
			"isDeleted": false,
			"id": "rM0cW7HF",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -309.9470153164351,
			"y": 4170.3277181951735,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 1380222202,
			"groupIds": [
				"5Qmrb-DwnoUtAaGVcxal3"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996510,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "H-cjssD4kNAck2vbMkLJ2",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1662,
			"versionNonce": 1988276480,
			"isDeleted": false,
			"id": "NM-0WkEhFqe_7-5DTXmy1",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 38.45820716649712,
			"y": 4113.2894929732265,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1075697082,
			"groupIds": [
				"sBf1tZlifp_D7tSpCScfM"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "uLkTNctnv9866xU2lH20J",
					"type": "arrow"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1582,
			"versionNonce": 754769664,
			"isDeleted": false,
			"id": "-cgkvepB8tPcjQEAWOCmU",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 54.79152015477871,
			"y": 4134.289554008381,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1880034938,
			"groupIds": [
				"kiIXGe3pXh7MwhQsMyXPu"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "J-lzBjZd-ayZVwRvnYIBJ",
					"type": "arrow"
				},
				{
					"id": "uLkTNctnv9866xU2lH20J",
					"type": "arrow"
				},
				{
					"id": "y2_tOBgoTVgOP2OeBvs-C",
					"type": "arrow"
				},
				{
					"id": "DVdzjuBPQeX5X61IJSy8B",
					"type": "arrow"
				},
				{
					"id": "CF8832qlDUXCWioIWQ1Wc",
					"type": "arrow"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1668,
			"versionNonce": 1426362624,
			"isDeleted": false,
			"id": "rRsdrlb4b5GAjcKDtZ6N0",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 69.1248127980075,
			"y": 4152.28953366333,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 651898682,
			"groupIds": [
				"j2EhErYajqH2XtJs_joLw"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "6qIElDWQh7kJh08A_4CxE",
					"type": "arrow"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1954,
			"versionNonce": 1476984576,
			"isDeleted": false,
			"id": "DOes6IjETF7-ozc_eIPws",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -154.7106548146366,
			"y": 4087.094105623252,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 69.69390497296568,
			"height": 201.7922810927382,
			"seed": 417675258,
			"groupIds": [
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "NQfTcjiyAhnMIW2i_mUNN",
					"type": "arrow"
				},
				{
					"id": "FkIUREJqGH9PcJ3WCyrR7",
					"type": "arrow"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1772,
			"versionNonce": 1212838144,
			"isDeleted": false,
			"id": "GUjJvIUlwMxZ61ZjiXqLl",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -111.57890922201858,
			"y": 4156.978556635717,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1982867642,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "_6iyRqR0uXoWqEuv_u2pf"
				},
				{
					"type": "arrow",
					"id": "IvC28-xIh_XAT5fNBSzT8"
				},
				{
					"id": "J-lzBjZd-ayZVwRvnYIBJ",
					"type": "arrow"
				},
				{
					"id": "CF8832qlDUXCWioIWQ1Wc",
					"type": "arrow"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2079,
			"versionNonce": 210837248,
			"isDeleted": false,
			"id": "7onZOXrG9bBl23eU2SHtQ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -147.64266813560397,
			"y": 4154.086621460567,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1985937786,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "k6RX6YApV5Uhhmq9jW5Fb"
				},
				{
					"type": "arrow",
					"id": "_6iyRqR0uXoWqEuv_u2pf"
				},
				{
					"type": "arrow",
					"id": "IvC28-xIh_XAT5fNBSzT8"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2077,
			"versionNonce": 399790336,
			"isDeleted": false,
			"id": "d-Sq2qqYqkepHlEB5r51J",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -111.08715372524756,
			"y": 4207.578198232495,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1689567802,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "IvC28-xIh_XAT5fNBSzT8"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1794,
			"versionNonce": 991248128,
			"isDeleted": false,
			"id": "hSvUnK2UDPItocu_YW8MZ",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -111.76887119008296,
			"y": 4105.393616028554,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 739535610,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "_6iyRqR0uXoWqEuv_u2pf"
				}
			],
			"updated": 1718371996510,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 5866,
			"versionNonce": 455225600,
			"isDeleted": false,
			"id": "k6RX6YApV5Uhhmq9jW5Fb",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -134.57353589139115,
			"y": 4172.301709380616,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 26.68308902555831,
			"height": 37.58197677119037,
			"seed": 1661008826,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996510,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "7onZOXrG9bBl23eU2SHtQ",
				"focus": 0.2447201201771665,
				"gap": 1.04295654414695
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					26.68308902555831,
					37.58197677119037
				]
			]
		},
		{
			"type": "arrow",
			"version": 4556,
			"versionNonce": 1142251264,
			"isDeleted": false,
			"id": "IvC28-xIh_XAT5fNBSzT8",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -128.58824400575776,
			"y": 4163.309643671615,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.61130383973117,
			"height": 1.3207328297184937,
			"seed": 1469936762,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996510,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "7onZOXrG9bBl23eU2SHtQ",
				"focus": -0.05630840266120908,
				"gap": 1
			},
			"endBinding": {
				"elementId": "GUjJvIUlwMxZ61ZjiXqLl",
				"focus": 0.059045777174382766,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.61130383973117,
					1.3207328297184937
				]
			]
		},
		{
			"type": "arrow",
			"version": 5513,
			"versionNonce": 968102144,
			"isDeleted": false,
			"id": "_6iyRqR0uXoWqEuv_u2pf",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -133.05174083082164,
			"y": 4154.855537272229,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 25.400417044718434,
			"height": 32.52973567190321,
			"seed": 464311610,
			"groupIds": [
				"3sgbSGZwCCvHjwLGeU94W",
				"Zf6UTXG_YaO3IQgTT6oFT",
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996510,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "7onZOXrG9bBl23eU2SHtQ",
				"focus": -0.08869372840669407,
				"gap": 1
			},
			"endBinding": {
				"elementId": "hSvUnK2UDPItocu_YW8MZ",
				"focus": -0.09679793421707583,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					25.400417044718434,
					-32.52973567190321
				]
			]
		},
		{
			"type": "text",
			"version": 849,
			"versionNonce": 2014412544,
			"isDeleted": false,
			"id": "h600J1b0",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -151.3637023281537,
			"y": 4243.486508948565,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 62.98243713378906,
			"height": 40,
			"seed": 278011386,
			"groupIds": [
				"coMaFag59bcL3DbG3Ph1L"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"fontSize": 14.751291676011752,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "text",
			"version": 183,
			"versionNonce": 1795813632,
			"isDeleted": false,
			"id": "ZZcyHs1L",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 80.80300502861712,
			"y": 4190.927779230329,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 140.69496154785156,
			"height": 25.066666666667004,
			"seed": 1934642874,
			"groupIds": [
				"j2EhErYajqH2XtJs_joLw"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "6qIElDWQh7kJh08A_4CxE",
					"type": "arrow"
				}
			],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"fontSize": 10.444444444444585,
			"fontFamily": 3,
			"text": "link shortening service\n",
			"rawText": "link shortening service\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "link shortening service\n",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 231,
			"versionNonce": 394895104,
			"isDeleted": false,
			"id": "NQfTcjiyAhnMIW2i_mUNN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -247.197025488961,
			"y": 4164.261061701034,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 82.66667683919263,
			"height": 0,
			"seed": 1753900922,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "DOes6IjETF7-ozc_eIPws",
				"focus": 0.23518426314514634,
				"gap": 9.81969383513178
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					82.66667683919263,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 301,
			"versionNonce": 916705536,
			"isDeleted": false,
			"id": "J-lzBjZd-ayZVwRvnYIBJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -85.86366163804962,
			"y": 4154.927769057804,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.33331298828125,
			"height": 1.3333638509111552,
			"seed": 142829626,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "GUjJvIUlwMxZ61ZjiXqLl",
				"focus": -1.2088784994782145,
				"gap": 10.6727127680121
			},
			"endBinding": {
				"elementId": "-cgkvepB8tPcjQEAWOCmU",
				"focus": 0.6169221552648071,
				"gap": 19.32186880454708
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					121.33331298828125,
					-1.3333638509111552
				]
			]
		},
		{
			"type": "arrow",
			"version": 500,
			"versionNonce": 1938523132,
			"isDeleted": false,
			"id": "uLkTNctnv9866xU2lH20J",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 86.76408544789582,
			"y": 4113.594405206892,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 118.03906199608603,
			"height": 149.16550994627232,
			"seed": 870195642,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474271,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "-cgkvepB8tPcjQEAWOCmU",
				"gap": 20.695148801488813,
				"focus": -0.8221564186334868
			},
			"endBinding": {
				"elementId": "yVoOof1FW4FJhPn2tggHE",
				"gap": 1.6336970681803678,
				"focus": 0.5790544481090878
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					118.03906199608603,
					-149.16550994627232
				]
			]
		},
		{
			"type": "line",
			"version": 6150,
			"versionNonce": 872526080,
			"isDeleted": false,
			"id": "Qk5lbBp42oOUKpdr7jXPW",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 337.6108353694866,
			"y": 4193.056704387834,
			"strokeColor": "#000000",
			"backgroundColor": "#ced4da",
			"width": 75.01121630306868,
			"height": 96.81388324216654,
			"seed": 501602938,
			"groupIds": [
				"QUb67M1nsFz-Jq7baMBJt",
				"TFEj7XMZ-EtyG2Sr1c9qE",
				"v4R2VOs2E6wsMTpidz-7D"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": null,
			"points": [
				[
					0,
					0
				],
				[
					0.24734846976242794,
					73.1714082159101
				],
				[
					0.011575327725072006,
					81.50165529728328
				],
				[
					3.8632435379119165,
					85.10105205208878
				],
				[
					17.276485894102954,
					88.14730719194147
				],
				[
					39.948665011120255,
					89.0958655364321
				],
				[
					61.61043288740646,
					87.58135319133916
				],
				[
					73.11948965218787,
					83.95942431004657
				],
				[
					74.74268637210398,
					80.90610026776591
				],
				[
					74.9706584753909,
					74.19947908967055
				],
				[
					74.79172688269483,
					6.138672737165569
				],
				[
					74.38835763792527,
					-0.2918194398554754
				],
				[
					69.57188081608908,
					-3.885863818744892
				],
				[
					59.42940850758881,
					-5.967344146345569
				],
				[
					36.31608449133351,
					-7.7180177057344235
				],
				[
					17.785060590062127,
					-6.674087120295436
				],
				[
					3.210536142559118,
					-3.1332019499277424
				],
				[
					-0.04055782767777212,
					-0.04396604849106378
				],
				[
					0,
					0
				]
			]
		},
		{
			"type": "ellipse",
			"version": 6870,
			"versionNonce": 1257103104,
			"isDeleted": false,
			"id": "F2LX-46bMR7d-8p_BdEdT",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 337.8767679601706,
			"y": 4184.303736231807,
			"strokeColor": "#000000",
			"backgroundColor": "#fff",
			"width": 74.53008207714048,
			"height": 15.073148387271289,
			"seed": 133724986,
			"groupIds": [
				"QUb67M1nsFz-Jq7baMBJt",
				"TFEj7XMZ-EtyG2Sr1c9qE",
				"v4R2VOs2E6wsMTpidz-7D"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 273,
			"versionNonce": 178491648,
			"isDeleted": false,
			"id": "6qIElDWQh7kJh08A_4CxE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 170.13639939710686,
			"y": 4220.261071873559,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 166.66666666666652,
			"height": 2.6666259765615905,
			"seed": 7930874,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "ZZcyHs1L",
				"focus": 1.2522062195094137,
				"gap": 4.2666259765633185
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					166.66666666666652,
					-2.6666259765615905
				]
			]
		},
		{
			"type": "arrow",
			"version": 403,
			"versionNonce": 1941943548,
			"isDeleted": false,
			"id": "y2_tOBgoTVgOP2OeBvs-C",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 198.13637905205462,
			"y": 4000.2610718735605,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 77.3333740234373,
			"height": 116.00001017252544,
			"seed": 1365931194,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718693474271,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "yVoOof1FW4FJhPn2tggHE",
				"gap": 8.300465460107603,
				"focus": 0.4643029023241481
			},
			"endBinding": {
				"elementId": "-cgkvepB8tPcjQEAWOCmU",
				"gap": 18.02847196229459,
				"focus": -0.3379046893605977
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-77.3333740234373,
					116.00001017252544
				]
			]
		},
		{
			"type": "rectangle",
			"version": 1612,
			"versionNonce": 1913221376,
			"isDeleted": false,
			"id": "yVoOof1FW4FJhPn2tggHE",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 206.43684451216222,
			"y": 3900.6022190589897,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 136.02270526199962,
			"height": 121.55360881102825,
			"seed": 588996474,
			"groupIds": [
				"X9TdB5mlEcUqOut5TdKLM"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "w8rqwdzR"
				},
				{
					"id": "uLkTNctnv9866xU2lH20J",
					"type": "arrow"
				},
				{
					"id": "y2_tOBgoTVgOP2OeBvs-C",
					"type": "arrow"
				}
			],
			"updated": 1718371996511,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 292,
			"versionNonce": 574758656,
			"isDeleted": false,
			"id": "w8rqwdzR",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 215.51753308066202,
			"y": 3907.7277754375673,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 117.861328125,
			"height": 107.30249605387321,
			"seed": 909467706,
			"groupIds": [
				"X9TdB5mlEcUqOut5TdKLM"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"fontSize": 22.354686677890253,
			"fontFamily": 3,
			"text": "zookeeper\n0-10000\n10k-20k\n",
			"rawText": "zookeeper\n0-10000\n10k-20k\n",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "yVoOof1FW4FJhPn2tggHE",
			"originalText": "zookeeper\n0-10000\n10k-20k\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 73,
			"versionNonce": 833835264,
			"isDeleted": false,
			"id": "dfqUj1iZ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 47.78153047649516,
			"y": 4057.907049912449,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 515.625,
			"height": 19.2,
			"seed": 224193318,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996511,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "asks for range at start of app or range gets exhausted.",
			"rawText": "asks for range at start of app or range gets exhausted.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "asks for range at start of app or range gets exhausted.",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1554,
			"versionNonce": 1923497728,
			"isDeleted": false,
			"id": "OUPdJZDyIi002xpKXYe2M",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -359.6801415644245,
			"y": 4410.206317061105,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 565020282,
			"groupIds": [
				"IqFlXSfBSOyPj-CwkOHCb"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"type": "text",
					"id": "ocvCDveI"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 138,
			"versionNonce": 555823360,
			"isDeleted": false,
			"id": "ocvCDveI",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -329.7521324392841,
			"y": 4449.911168259617,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 233482042,
			"groupIds": [
				"IqFlXSfBSOyPj-CwkOHCb"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "user",
			"rawText": "user",
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "OUPdJZDyIi002xpKXYe2M",
			"originalText": "user",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 1694,
			"versionNonce": 1636196096,
			"isDeleted": false,
			"id": "xA4Ew58nyAJhwNsRAgRGP",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 18.65309004364815,
			"y": 4392.87294303767,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 1598402554,
			"groupIds": [
				"Rj6q5Kgkv8qR0Jbulsknd"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1613,
			"versionNonce": 668143872,
			"isDeleted": false,
			"id": "hDhdzKb2YtnpYlDN3ODMv",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 34.98640303192974,
			"y": 4413.873004072824,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 163684538,
			"groupIds": [
				"JvBXSJU2lrZme641JL7P0"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "J7yomujDHk02J606GUsqY",
					"type": "arrow"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1701,
			"versionNonce": 1063419648,
			"isDeleted": false,
			"id": "0uMiirFxCCPAMhzkujuZy",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 49.31969567515853,
			"y": 4431.872983727773,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 97.35601825028085,
			"height": 98.60970239702232,
			"seed": 151091578,
			"groupIds": [
				"-SgU0LJ9oM7nu1GEon91D"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "pvTRlC9L6dntInB-CHObf",
					"type": "arrow"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "rectangle",
			"version": 1986,
			"versionNonce": 1028190464,
			"isDeleted": false,
			"id": "ZTmOfzhZjWnm0ZxqlNPtt",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 90,
			"angle": 0,
			"x": -174.51577193748557,
			"y": 4366.677555687695,
			"strokeColor": "#000000",
			"backgroundColor": "#eeeeee",
			"width": 69.69390497296568,
			"height": 201.7922810927382,
			"seed": 1816672826,
			"groupIds": [
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "JVUxAzC9D_IRq60ry5vQz",
					"type": "arrow"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1804,
			"versionNonce": 1287298816,
			"isDeleted": false,
			"id": "2mct52ay-C2NaPn_hBLUy",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -131.38402634486755,
			"y": 4436.56200670016,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1652089594,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "mug55xdCwsRbf4f2xObzH"
				},
				{
					"type": "arrow",
					"id": "VKRDSLhGiOrVbJ4n7fOh3"
				},
				{
					"id": "J7yomujDHk02J606GUsqY",
					"type": "arrow"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2112,
			"versionNonce": 1761792256,
			"isDeleted": false,
			"id": "pWEB0-Hh2Lohf2mN9CVtW",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -167.44778525845294,
			"y": 4433.67007152501,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1175876538,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "TfrRr8LN6Bv0kOnY9K6A9"
				},
				{
					"type": "arrow",
					"id": "mug55xdCwsRbf4f2xObzH"
				},
				{
					"type": "arrow",
					"id": "VKRDSLhGiOrVbJ4n7fOh3"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 2110,
			"versionNonce": 974044928,
			"isDeleted": false,
			"id": "xE2QeQdPc_7IY8yQN9wKl",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -130.89227084809653,
			"y": 4487.161648296938,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 692317306,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "VKRDSLhGiOrVbJ4n7fOh3"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "ellipse",
			"version": 1827,
			"versionNonce": 1115730176,
			"isDeleted": false,
			"id": "33N1yAmwKOqHhcoUYGpEl",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -131.57398831293193,
			"y": 4384.977066092997,
			"strokeColor": "#000000",
			"backgroundColor": "#868e96",
			"width": 18.463181339628875,
			"height": 17.895083452255665,
			"seed": 1640254778,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [
				{
					"type": "arrow",
					"id": "mug55xdCwsRbf4f2xObzH"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "arrow",
			"version": 5931,
			"versionNonce": 668917504,
			"isDeleted": false,
			"id": "TfrRr8LN6Bv0kOnY9K6A9",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -154.37865301424011,
			"y": 4451.885159445059,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 26.68308902555831,
			"height": 37.58197677119037,
			"seed": 351966714,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "pWEB0-Hh2Lohf2mN9CVtW",
				"focus": 0.2447201201771665,
				"gap": 1.04295654414695
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					26.68308902555831,
					37.58197677119037
				]
			]
		},
		{
			"type": "arrow",
			"version": 4653,
			"versionNonce": 1900187904,
			"isDeleted": false,
			"id": "VKRDSLhGiOrVbJ4n7fOh3",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -148.39336112860673,
			"y": 4442.893093736058,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 16.61130383973117,
			"height": 1.3207328297184937,
			"seed": 1139394234,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "pWEB0-Hh2Lohf2mN9CVtW",
				"focus": -0.05630840266120908,
				"gap": 1
			},
			"endBinding": {
				"elementId": "2mct52ay-C2NaPn_hBLUy",
				"focus": 0.059045777174382766,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					16.61130383973117,
					1.3207328297184937
				]
			]
		},
		{
			"type": "arrow",
			"version": 5610,
			"versionNonce": 648740608,
			"isDeleted": false,
			"id": "mug55xdCwsRbf4f2xObzH",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -152.8568579536706,
			"y": 4434.438987336673,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 25.400417044718434,
			"height": 32.52973567190321,
			"seed": 1463082874,
			"groupIds": [
				"WAo-PAHe4YQxFyEjJXMwY",
				"eJJi1j19HUP5OqoIKAPTO",
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "pWEB0-Hh2Lohf2mN9CVtW",
				"focus": -0.08869372840669407,
				"gap": 1
			},
			"endBinding": {
				"elementId": "33N1yAmwKOqHhcoUYGpEl",
				"focus": -0.09679793421707583,
				"gap": 1
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					25.400417044718434,
					-32.52973567190321
				]
			]
		},
		{
			"type": "text",
			"version": 882,
			"versionNonce": 751333632,
			"isDeleted": false,
			"id": "CxoFgtAt",
			"fillStyle": "solid",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -171.16881945100266,
			"y": 4523.069959013008,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 62.98243713378906,
			"height": 40,
			"seed": 723443770,
			"groupIds": [
				"IHaahfAt8g87PwsLtb-sy"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 14.751291676011752,
			"fontFamily": 1,
			"text": "Load\nBalancer",
			"rawText": "Load\nBalancer",
			"textAlign": "center",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Load\nBalancer",
			"lineHeight": 1.355813473102399
		},
		{
			"type": "text",
			"version": 254,
			"versionNonce": 921902848,
			"isDeleted": false,
			"id": "2K5selIr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 68.99786756071614,
			"y": 4471.844542283054,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 55.05455017089844,
			"height": 25.066666666667004,
			"seed": 462080250,
			"groupIds": [
				"-SgU0LJ9oM7nu1GEon91D"
			],
			"frameId": null,
			"roundness": null,
			"boundElements": [
				{
					"id": "pvTRlC9L6dntInB-CHObf",
					"type": "arrow"
				}
			],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 10.444444444444585,
			"fontFamily": 3,
			"text": "redirect \nservice",
			"rawText": "redirect \nservice",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "redirect \nservice",
			"lineHeight": 1.2
		},
		{
			"type": "arrow",
			"version": 296,
			"versionNonce": 1016221952,
			"isDeleted": false,
			"id": "JVUxAzC9D_IRq60ry5vQz",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -267.00214261181,
			"y": 4443.844511765477,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 82.66667683919263,
			"height": 0,
			"seed": 268147130,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "ZTmOfzhZjWnm0ZxqlNPtt",
				"focus": 0.2351842631451373,
				"gap": 9.81969383513178
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					82.66667683919263,
					0
				]
			]
		},
		{
			"type": "arrow",
			"version": 398,
			"versionNonce": 1228357376,
			"isDeleted": false,
			"id": "J7yomujDHk02J606GUsqY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -105.66877876089859,
			"y": 4434.511219122247,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.33331298828125,
			"height": 1.3333638509111552,
			"seed": 127160954,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "2mct52ay-C2NaPn_hBLUy",
				"focus": -1.2088784994782145,
				"gap": 10.6727127680121
			},
			"endBinding": {
				"elementId": "hDhdzKb2YtnpYlDN3ODMv",
				"focus": 0.6169221552648071,
				"gap": 19.32186880454708
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					121.33331298828125,
					-1.3333638509111552
				]
			]
		},
		{
			"type": "arrow",
			"version": 431,
			"versionNonce": 2015375616,
			"isDeleted": false,
			"id": "pvTRlC9L6dntInB-CHObf",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 153.54795243876646,
			"y": 4488.105273506126,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 188.78335018054344,
			"height": 222.92739788973813,
			"seed": 1460399290,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "0uMiirFxCCPAMhzkujuZy",
				"focus": 0.679153322887997,
				"gap": 6.8722385133270905
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					188.78335018054344,
					-222.92739788973813
				]
			]
		},
		{
			"type": "arrow",
			"version": 66,
			"versionNonce": 1039621888,
			"isDeleted": false,
			"id": "DVdzjuBPQeX5X61IJSy8B",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 329.1148434647764,
			"y": 4235.240423935886,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 166.66666666666674,
			"height": 5.33335367838572,
			"seed": 1655142394,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": null,
			"endBinding": {
				"elementId": "-cgkvepB8tPcjQEAWOCmU",
				"focus": 1.1573680901696413,
				"gap": 10.300638393050122
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-166.66666666666674,
					5.33335367838572
				]
			]
		},
		{
			"type": "arrow",
			"version": 61,
			"versionNonce": 1190269184,
			"isDeleted": false,
			"id": "CF8832qlDUXCWioIWQ1Wc",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 34.44819714316179,
			"y": 4175.240423935886,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 125.33335367838538,
			"height": 6.66666666666697,
			"seed": 1527282810,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "-cgkvepB8tPcjQEAWOCmU",
				"focus": 0.23172820424139684,
				"gap": 20.343323011616917
			},
			"endBinding": {
				"elementId": "GUjJvIUlwMxZ61ZjiXqLl",
				"focus": 1.8514307387635596,
				"gap": 10.62336444499101
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-125.33335367838538,
					6.66666666666697
				]
			]
		},
		{
			"type": "arrow",
			"version": 44,
			"versionNonce": 1706262272,
			"isDeleted": false,
			"id": "FkIUREJqGH9PcJ3WCyrR7",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -160.21844917845283,
			"y": 4195.240423935886,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 84.00004069010413,
			"height": 0,
			"seed": 1852891258,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 2
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"startBinding": {
				"elementId": "DOes6IjETF7-ozc_eIPws",
				"focus": -0.07185783050772553,
				"gap": 5.507794363816238
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-84.00004069010413,
					0
				]
			]
		},
		{
			"type": "text",
			"version": 267,
			"versionNonce": 545779968,
			"isDeleted": false,
			"id": "GGIkou7W",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 439.78155082154717,
			"y": 4221.907090602553,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 553.125,
			"height": 76.8,
			"seed": 1035962982,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "using no sql db here because need to store 4 trillion\nso rdbms may start giving problems, of course we can shard \nthe database but going here with nosql.\nusing dynamodb here as it supports large reads",
			"rawText": "using no sql db here because need to store 4 trillion\nso rdbms may start giving problems, of course we can shard \nthe database but going here with nosql.\nusing dynamodb here as it supports large reads",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "using no sql db here because need to store 4 trillion\nso rdbms may start giving problems, of course we can shard \nthe database but going here with nosql.\nusing dynamodb here as it supports large reads",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 40,
			"versionNonce": 15441664,
			"isDeleted": false,
			"id": "eHV0lOwR",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 343.7814897863909,
			"y": 4297.907049912449,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 75,
			"height": 19.2,
			"seed": 1674841786,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "dynamodb",
			"rawText": "dynamodb",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "dynamodb",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 289,
			"versionNonce": 207737088,
			"isDeleted": false,
			"id": "9cPV3xLs",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 381.1148638098284,
			"y": 3920.5737267516415,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 590.625,
			"height": 76.8,
			"seed": 1691784550,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "instead of zookeeper we can also use mysql db as \nwe are giving range and that call happens very often.\nAlso in case two service request for a range at same time\nwe should give different range so we will need acid compliance.",
			"rawText": "instead of zookeeper we can also use mysql db as \nwe are giving range and that call happens very often.\nAlso in case two service request for a range at same time\nwe should give different range so we will need acid compliance.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "instead of zookeeper we can also use mysql db as \nwe are giving range and that call happens very often.\nAlso in case two service request for a range at same time\nwe should give different range so we will need acid compliance.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 915,
			"versionNonce": 1075822336,
			"isDeleted": false,
			"id": "xGHJRn8j",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -408.2184796960306,
			"y": 4669.907019394871,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1134.375,
			"height": 230.39999999999998,
			"seed": 1945156966,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "here when redirect service directly sends the long url and done. But if we want analytics also.\nWe can put info in kafka. like platform where they have accessed the link from, ip address, broswer/mobile, etc.\nThen kafka can process these messages and maybe put in hadoop where we can run analytics job.\n\n\nHowever kafka will be under huge load bcz of the number of reads we are getting. so we can use mutliple kafka queues\nand job runner service which take out message from one of the queue and push in hadoop.\n\nOr a redirect service can aggregate the analytics for some time in a data structure and flush out the info periodically. \nThis will reduce the load on one single queue.\n\nHowever, it may happen one of the queue dies and we lose some analytics data in it. So that's okay.",
			"rawText": "here when redirect service directly sends the long url and done. But if we want analytics also.\nWe can put info in kafka. like platform where they have accessed the link from, ip address, broswer/mobile, etc.\nThen kafka can process these messages and maybe put in hadoop where we can run analytics job.\n\n\nHowever kafka will be under huge load bcz of the number of reads we are getting. so we can use mutliple kafka queues\nand job runner service which take out message from one of the queue and push in hadoop.\n\nOr a redirect service can aggregate the analytics for some time in a data structure and flush out the info periodically. \nThis will reduce the load on one single queue.\n\nHowever, it may happen one of the queue dies and we lose some analytics data in it. So that's okay.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "here when redirect service directly sends the long url and done. But if we want analytics also.\nWe can put info in kafka. like platform where they have accessed the link from, ip address, broswer/mobile, etc.\nThen kafka can process these messages and maybe put in hadoop where we can run analytics job.\n\n\nHowever kafka will be under huge load bcz of the number of reads we are getting. so we can use mutliple kafka queues\nand job runner service which take out message from one of the queue and push in hadoop.\n\nOr a redirect service can aggregate the analytics for some time in a data structure and flush out the info periodically. \nThis will reduce the load on one single queue.\n\nHowever, it may happen one of the queue dies and we lose some analytics data in it. So that's okay.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 278,
			"versionNonce": 570405120,
			"isDeleted": false,
			"id": "QbqSSLhc",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 905.4483599035786,
			"y": 4075.2403730732567,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 628.125,
			"height": 57.599999999999994,
			"seed": 1859098554,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "if one of the link shortening service dies after without completing\na range, we'll lose the range, but that is totally okay. losing few\nmillions won't create huge impact.",
			"rawText": "if one of the link shortening service dies after without completing\na range, we'll lose the range, but that is totally okay. losing few\nmillions won't create huge impact.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "if one of the link shortening service dies after without completing\na range, we'll lose the range, but that is totally okay. losing few\nmillions won't create huge impact.",
			"lineHeight": 1.2
		},
		{
			"type": "freedraw",
			"version": 90,
			"versionNonce": 1137696512,
			"isDeleted": false,
			"id": "C5iG0DSxXqv-mwSdvsrRg",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 666.7815711665996,
			"y": 4663.240403590836,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 89.33329264322924,
			"height": 270.6666564941406,
			"seed": 1359533882,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					3.99993896484375,
					3.999989827473655
				],
				[
					7.999979654947765,
					6.66666666666606
				],
				[
					10.666605631510265,
					11.999969482421875
				],
				[
					13.333333333333258,
					17.333323160806685
				],
				[
					17.333272298177008,
					23.999989827473655
				],
				[
					18.66668701171875,
					27.99997965494731
				],
				[
					20,
					30.666656494140625
				],
				[
					21.33331298828125,
					34.66664632161428
				],
				[
					21.33331298828125,
					38.666636149087935
				],
				[
					21.33331298828125,
					41.33331298828125
				],
				[
					18.66668701171875,
					47.99997965494731
				],
				[
					18.66668701171875,
					51.999969482421875
				],
				[
					18.66668701171875,
					53.33333333333303
				],
				[
					17.333272298177008,
					54.66664632161428
				],
				[
					17.333272298177008,
					55.99995930989553
				],
				[
					17.333272298177008,
					57.333323160806685
				],
				[
					17.333272298177008,
					58.666636149087935
				],
				[
					17.333272298177008,
					60
				],
				[
					17.333272298177008,
					62.6666259765625
				],
				[
					20,
					66.66666666666606
				],
				[
					22.6666259765625,
					69.33329264322856
				],
				[
					23.99993896484375,
					70.66665649414062
				],
				[
					30.666605631510265,
					74.66664632161428
				],
				[
					35.99995930989576,
					77.33332316080669
				],
				[
					41.33331298828125,
					78.66663614908794
				],
				[
					47.999979654947765,
					78.66663614908794
				],
				[
					52.00002034505201,
					78.66663614908794
				],
				[
					54.66664632161451,
					78.66663614908794
				],
				[
					55.99995930989576,
					78.66663614908794
				],
				[
					57.33327229817701,
					78.66663614908794
				],
				[
					58.66668701171875,
					78.66663614908794
				],
				[
					58.66668701171875,
					82.6666259765625
				],
				[
					58.66668701171875,
					87.99997965494731
				],
				[
					58.66668701171875,
					93.33333333333303
				],
				[
					60,
					101.33331298828125
				],
				[
					61.33331298828125,
					107.99997965494731
				],
				[
					63.99993896484375,
					121.33331298828125
				],
				[
					65.33335367838527,
					125.3333028157549
				],
				[
					67.99997965494777,
					131.99996948242188
				],
				[
					69.33329264322902,
					135.99995930989553
				],
				[
					69.33329264322902,
					141.33331298828125
				],
				[
					69.33329264322902,
					145.3333028157549
				],
				[
					69.33329264322902,
					151.99996948242188
				],
				[
					69.33329264322902,
					157.33332316080669
				],
				[
					67.99997965494777,
					157.33332316080669
				],
				[
					66.66666666666652,
					161.33331298828125
				],
				[
					65.33335367838527,
					163.99998982747366
				],
				[
					63.99993896484375,
					163.99998982747366
				],
				[
					62.6666259765625,
					163.99998982747366
				],
				[
					62.6666259765625,
					165.3333028157549
				],
				[
					62.6666259765625,
					167.9999796549473
				],
				[
					63.99993896484375,
					174.66664632161428
				],
				[
					66.66666666666652,
					186.66666666666606
				],
				[
					69.33329264322902,
					195.99995930989553
				],
				[
					72.00002034505201,
					202.6666259765625
				],
				[
					74.66664632161451,
					207.9999796549473
				],
				[
					74.66664632161451,
					210.66665649414062
				],
				[
					74.66664632161451,
					214.66664632161428
				],
				[
					70.66660563151027,
					222.6666259765625
				],
				[
					66.66666666666652,
					229.33329264322856
				],
				[
					58.66668701171875,
					239.99994913736919
				],
				[
					46.666666666666515,
					251.99996948242188
				],
				[
					32.00002034505201,
					262.6666768391924
				],
				[
					23.99993896484375,
					268.0000305175781
				],
				[
					13.333333333333258,
					270.6666564941406
				],
				[
					7.999979654947765,
					270.6666564941406
				],
				[
					0,
					270.6666564941406
				],
				[
					-5.3333536783854925,
					266.66661580403616
				],
				[
					-10.666707356770985,
					261.33336385091116
				],
				[
					-13.333333333333485,
					259.9999491373692
				],
				[
					-14.666646321614735,
					258.66663614908794
				],
				[
					-14.666646321614735,
					257.3333231608067
				],
				[
					-14.666646321614735,
					257.3333231608067
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "text",
			"version": 170,
			"versionNonce": 149000448,
			"isDeleted": false,
			"id": "lUvKQtBh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 772.1149248449849,
			"y": 4717.90704991245,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 459.375,
			"height": 57.599999999999994,
			"seed": 750007526,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "here we are pushing in kafka as separate thread. \none thread return result back to user while other\nthread push analytics to hadoop",
			"rawText": "here we are pushing in kafka as separate thread. \none thread return result back to user while other\nthread push analytics to hadoop",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "here we are pushing in kafka as separate thread. \none thread return result back to user while other\nthread push analytics to hadoop",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 41,
			"versionNonce": 477888256,
			"isDeleted": false,
			"id": "VdpImqyT",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2056.114812947198,
			"y": 2563.2404544534693,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 178.125,
			"height": 76.8,
			"seed": 406713126,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Code Karle approach\n\n\n",
			"rawText": "Code Karle approach\n\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Code Karle approach\n\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 202,
			"versionNonce": 2022142208,
			"isDeleted": false,
			"id": "zVufrloc",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2061.4481157629534,
			"y": 2688.573808131855,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 318.75,
			"height": 249.6,
			"seed": 1303715366,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "FR\n\nHotel manager\n- onboarding\n- update rooms/images/info/pricing\n- see bookings info, revenue, etc.\n\nUser\n- search\n- book\n- check bookings details\n\nAnalytics",
			"rawText": "FR\n\nHotel manager\n- onboarding\n- update rooms/images/info/pricing\n- see bookings info, revenue, etc.\n\nUser\n- search\n- book\n- check bookings details\n\nAnalytics",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "FR\n\nHotel manager\n- onboarding\n- update rooms/images/info/pricing\n- see bookings info, revenue, etc.\n\nUser\n- search\n- book\n- check bookings details\n\nAnalytics",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 79,
			"versionNonce": 1252269824,
			"isDeleted": false,
			"id": "XarYbwUn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2532.114823119724,
			"y": 2688.5738081318545,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 159.375,
			"height": 115.19999999999999,
			"seed": 1384979386,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"rawText": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 68,
			"versionNonce": 946950400,
			"isDeleted": false,
			"id": "rYOB56Hk5LS3gOV2k0Ub6",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1998.7606830175814,
			"y": 2971.907141465187,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1144.041450777202,
			"height": 613.3333333333333,
			"seed": 1768301882,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "5f1056ba6b9a2c7f49e9d87d78593a1c35fde570",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 70,
			"versionNonce": 1053310720,
			"isDeleted": false,
			"id": "GnFty9UuhR8nj_IURdtFn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1997.4481361080052,
			"y": 3647.7404341084134,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 472,
			"height": 267,
			"seed": 544368230,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "e09329139f145a7f88a95908eafe2a793954be20",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 58,
			"versionNonce": 538915072,
			"isDeleted": false,
			"id": "BbGUc-azzkTjMOnwl9zNr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2564.9605128837943,
			"y": 3618.907060084976,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 631.6417910447763,
			"height": 613.3333333333334,
			"seed": 1183463610,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "8bd607c2ffe6097d130a0ecf9357bb2ffe3f3b95",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 115,
			"versionNonce": 1500012288,
			"isDeleted": false,
			"id": "NMg7xkOLDeOGiZtFjsbkz",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2586.277396735869,
			"y": 4287.573848821954,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 665.674690007294,
			"height": 613.3333333333334,
			"seed": 764798522,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "01038622d7310d09334aacf6b0b440a7d19de487",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 123,
			"versionNonce": 386994432,
			"isDeleted": false,
			"id": "ogx28HW6CKTMH1FuU3yW1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1893.3829196816325,
			"y": 4344.240464625991,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 678.7971198644642,
			"height": 613.3333333333334,
			"seed": 941299878,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "7260455284a033b99861ee1622f2e9497de365c0",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 1795456768,
			"isDeleted": false,
			"id": "n1t7UStX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1931.4481157629532,
			"y": 5033.240454453468,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2512.5,
			"height": 19.2,
			"seed": 338755366,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "a UI that we give out to the hotel managers through this you it could be either a website or a mobile app but through this UI they would come on onboard onto our platform and the same UI would be used by them to modify the property. So let's say they want to add a new",
			"rawText": "a UI that we give out to the hotel managers through this you it could be either a website or a mobile app but through this UI they would come on onboard onto our platform and the same UI would be used by them to modify the property. So let's say they want to add a new",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "a UI that we give out to the hotel managers through this you it could be either a website or a mobile app but through this UI they would come on onboard onto our platform and the same UI would be used by them to modify the property. So let's say they want to add a new",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 16,
			"versionNonce": 348582144,
			"isDeleted": false,
			"id": "KpJfq5Gz",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1931.4481157629532,
			"y": 5062.440454453468,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2521.875,
			"height": 38.4,
			"seed": 1119776314,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "image or they want to add a new room or if they want to make any modifications this is the UI that they talk to. Now this UI talks to a Load Balancer through which it talks to a hotel service. This is basically a service which manages the hotel part which is basically \nthe onboarding and the management. All right, now let's just say there's a spike in traffic",
			"rawText": "image or they want to add a new room or if they want to make any modifications this is the UI that they talk to. Now this UI talks to a Load Balancer through which it talks to a hotel service. This is basically a service which manages the hotel part which is basically \nthe onboarding and the management. All right, now let's just say there's a spike in traffic",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "image or they want to add a new room or if they want to make any modifications this is the UI that they talk to. Now this UI talks to a Load Balancer through which it talks to a hotel service. This is basically a service which manages the hotel part which is basically \nthe onboarding and the management. All right, now let's just say there's a spike in traffic",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 20,
			"versionNonce": 874290944,
			"isDeleted": false,
			"id": "EBKLOkae",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1934.9192978314338,
			"y": 5099.739805716735,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1640.625,
			"height": 19.2,
			"seed": 559032934,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "so there could be multiple nodes of this hotel services that could be added here and so this becomes a horizontally scalable component. Now hotel data in itself is a very much",
			"rawText": "so there could be multiple nodes of this hotel services that could be added here and so this becomes a horizontally scalable component. Now hotel data in itself is a very much",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "so there could be multiple nodes of this hotel services that could be added here and so this becomes a horizontally scalable component. Now hotel data in itself is a very much",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 16,
			"versionNonce": 549507328,
			"isDeleted": false,
			"id": "NwSvDZyR",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1931.4481157629532,
			"y": 5120.840454453468,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2531.25,
			"height": 38.4,
			"seed": 1946719994,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "relational data plus earlier we talked about the number of photos that's not too many so it doesn't even have a scale problem so we'll be using a clustered MySQL here with one master and multiple slaves slaves can be added as and when required. let's say there's a huge \nspike in Read traffic, we can add more slaves but this data resides within MySQL database",
			"rawText": "relational data plus earlier we talked about the number of photos that's not too many so it doesn't even have a scale problem so we'll be using a clustered MySQL here with one master and multiple slaves slaves can be added as and when required. let's say there's a huge \nspike in Read traffic, we can add more slaves but this data resides within MySQL database",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "relational data plus earlier we talked about the number of photos that's not too many so it doesn't even have a scale problem so we'll be using a clustered MySQL here with one master and multiple slaves slaves can be added as and when required. let's say there's a huge \nspike in Read traffic, we can add more slaves but this data resides within MySQL database",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 69,
			"versionNonce": 1697693440,
			"isDeleted": false,
			"id": "gsZWtTUN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1953.6018453462054,
			"y": 5179.2404544534675,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2568.75,
			"height": 76.8,
			"seed": 531361190,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Now let's just say any image is added, so hotels can add images about the rooms about their whole building and all of that all those images would be stored into a CDN and the reference to the CDN which is basically a URL of the image would be stored in the database and \nthat URL would be sent out to customers and whenever they want to render an image that would be looked up directly from the CDN. let's just say each time a modification is happening to a hotel let's just say a new hotel comes in we want to bubble up this hotel to the users \nwho are going to search for this right, now there are multiple ways in which we can send out this information to the search piece, \nright. I'll be using a Kafka here so each modification that is happening",
			"rawText": "Now let's just say any image is added, so hotels can add images about the rooms about their whole building and all of that all those images would be stored into a CDN and the reference to the CDN which is basically a URL of the image would be stored in the database and \nthat URL would be sent out to customers and whenever they want to render an image that would be looked up directly from the CDN. let's just say each time a modification is happening to a hotel let's just say a new hotel comes in we want to bubble up this hotel to the users \nwho are going to search for this right, now there are multiple ways in which we can send out this information to the search piece, \nright. I'll be using a Kafka here so each modification that is happening",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Now let's just say any image is added, so hotels can add images about the rooms about their whole building and all of that all those images would be stored into a CDN and the reference to the CDN which is basically a URL of the image would be stored in the database and \nthat URL would be sent out to customers and whenever they want to render an image that would be looked up directly from the CDN. let's just say each time a modification is happening to a hotel let's just say a new hotel comes in we want to bubble up this hotel to the users \nwho are going to search for this right, now there are multiple ways in which we can send out this information to the search piece, \nright. I'll be using a Kafka here so each modification that is happening",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 66,
			"versionNonce": 1384034560,
			"isDeleted": false,
			"id": "aytsAwpH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1963.675738356217,
			"y": 5280.3148225742,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1631.25,
			"height": 19.2,
			"seed": 1938794426,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "within hotel service will flow through a Kafka cluster and there'll be multiple consumers that will be sitting on top of this cluster which will populate their data store for",
			"rawText": "within hotel service will flow through a Kafka cluster and there'll be multiple consumers that will be sitting on top of this cluster which will populate their data store for",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "within hotel service will flow through a Kafka cluster and there'll be multiple consumers that will be sitting on top of this cluster which will populate their data store for",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 137,
			"versionNonce": 515956480,
			"isDeleted": false,
			"id": "GZgqNhal",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1956.0523702836456,
			"y": 5317.239632858269,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2493.75,
			"height": 38.4,
			"seed": 208357606,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "serving the search traffic and for other traffic as well, right. So one of the consumers will be the search consumer what happens is let's say a hotel gets a new room, for example. There will be a payload that is put into Kafka which has all the information that is \nrequired Now the search consumer pulls up the payload from Kafka and it stores into its own database",
			"rawText": "serving the search traffic and for other traffic as well, right. So one of the consumers will be the search consumer what happens is let's say a hotel gets a new room, for example. There will be a payload that is put into Kafka which has all the information that is \nrequired Now the search consumer pulls up the payload from Kafka and it stores into its own database",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "serving the search traffic and for other traffic as well, right. So one of the consumers will be the search consumer what happens is let's say a hotel gets a new room, for example. There will be a payload that is put into Kafka which has all the information that is \nrequired Now the search consumer pulls up the payload from Kafka and it stores into its own database",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 59,
			"versionNonce": 1367380224,
			"isDeleted": false,
			"id": "wAlCzMZq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1960.98689339104,
			"y": 5376.148390265787,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1265.625,
			"height": 19.2,
			"seed": 964075642,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "and this database would be used to power the search on the website. Okay, now for search, I am using an elastic search. So all the data",
			"rawText": "and this database would be used to power the search on the website. Okay, now for search, I am using an elastic search. So all the data",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "and this database would be used to power the search on the website. Okay, now for search, I am using an elastic search. So all the data",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 29,
			"versionNonce": 1900871424,
			"isDeleted": false,
			"id": "FcVqTEBH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1931.4481157629532,
			"y": 5478.980599872275,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2550,
			"height": 38.4,
			"seed": 924662822,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "of each individual hotel, flows through the Kafka via the search consumer into this Elasticsearch cluster. Now on top of this Elasticsearch sits the Search Service. Now again let's just say there's a spike in traffic I can increase the number of nodes in Kafka cluster, I \ncan increase the number of search consumers here and I can increase the number of nodes in Elasticsearch cluster. So till now whatever we have talked about is again horizontally scalable, right. And again coming to Search Service this is the service which powers the",
			"rawText": "of each individual hotel, flows through the Kafka via the search consumer into this Elasticsearch cluster. Now on top of this Elasticsearch sits the Search Service. Now again let's just say there's a spike in traffic I can increase the number of nodes in Kafka cluster, I \ncan increase the number of search consumers here and I can increase the number of nodes in Elasticsearch cluster. So till now whatever we have talked about is again horizontally scalable, right. And again coming to Search Service this is the service which powers the",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "of each individual hotel, flows through the Kafka via the search consumer into this Elasticsearch cluster. Now on top of this Elasticsearch sits the Search Service. Now again let's just say there's a spike in traffic I can increase the number of nodes in Kafka cluster, I \ncan increase the number of search consumers here and I can increase the number of nodes in Elasticsearch cluster. So till now whatever we have talked about is again horizontally scalable, right. And again coming to Search Service this is the service which powers the",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 86,
			"versionNonce": 1430679808,
			"isDeleted": false,
			"id": "hUhCMRI6",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1956.271837910356,
			"y": 5675.742122825447,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2559.375,
			"height": 441.59999999999997,
			"seed": 1098940730,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "search on the website So the user talks to through again a load balancer to the search service whenever they want  to search for a particular hotel again they will give a date range and a location for example as a search criteria and along with that they could also \nprovide some tags. Now those tags would be the properties of the hotels. So again going back to my previous example a five star property is a tag. A beachfront property is a tag. Now the search on elasticity would be happening on either of these tags and the ranges \nthat are provided basically the date range, price range and all of that. okay, so this takes care of the search flow. Now once the user has seen some of the results on the website they would want to book a hotel. The booking again happens through this UI. So I've made \nthis UI saying that it's a search and book UI. Normally, it will be the same app or the same website through which they are searching  and then booking right. Now a booking request again comes to this load balancer and talks to Booking Service. Booking Service essentially \nagain sits on top of a MySQL database now these are two different MySQL clusters. I am purposefully not using a same cluster here although we could use the same cluster and have two different databases in that but because we are talking about a fairly large system that \nhas like a good enough amount of scale I would want to keep different clusters so as to you know take care of the scaling separately of each other Now, whenever a booking happens, that booking gets stored into this MySQL we go over the exact flow of booking when we go \nover the details of implementation within the Booking Service, but essentially this stores the data into this MySQL and it talks to a Payment Service Normally what will happen...  a booking request will come, it stores something, it will send the request for payment, \nonce there's a success, it will mark the booking confirm. Now again, whenever a booking is happening, the data is flowing into the same Kafka, right. Why? so let's just say there was just one room available in a hotel right and that room is now booked i want to make sure \nthat this hotel is not available for search now in that same date range, because it's not available. So all of those information is again sent to the same Kafka which is read by Search Consumer and then it takes care of even removing the hotels which are now completely \nbooked. Now if you can see, there's something called an Archival Service here. What I have done is, I am just storing the live data into MySQL. By live data, I mean the bookings that are done but have not been completed thereby making sure that this is having a scale \nwhich is low enough that MySQL can easily handle, and once the booking moves to a terminal state so let's say booking is cancelled or booking is completed it will move through the archival service to a Cassandra cluster. The reason I'm using a Cassandra here is so \ncassandra is a very good database which can handle a huge amount of reads and writes. It has a constraint that it needs a partition key on which all the queries should happen. So let's say if I want to search by a \"booking_id\" my partition key has to be a \"booking_id\" \nin that case I cannot do any kinds of queries on a Cassandra therefore I did not use a Cassandra as a source of truth database. Because on this database I need to do a large variety of queries. We'll come to all of those when we go into the detail of Booking Service, but \nonce it is archived we just need to do GETs on those. So therefore Cassandra makes a good enough sense over here. Now, once the booking is done, all of that is fine, but now we need to notify all the people right? So then comes the Notification Service. So let's say \nwhenever a booking is made, or any changes are happening into a booking or it moves into a terminal state, there'll be a Notification Service that consumes events from this Kafka and notifies the people, so for example on each booking, we need to notify the hotel right. \nWhenever a booking is cancelled by the hotel we need to notify the consumer or in fact on each booking we need to notify the consumer with an invoice right. So all of those is taken care by this Notification Service. Now coming back to the UI for hotels and users. So each \ntime a booking is done or even without that a user might want to see their old bookings or a hotel might want to see all the bookings that they have. This is more of a read-only view for them, right? That will be powered by this Booking Management Service, which talks to \nnow two data sources. It talks to the MySQL cluster for all the active bookings, which are to happen sometime in future and to the Cassandra cluster, for the bookings that have already happened right. Now i am adding a Redis on top of this MySQL to reduce the load on \nthis MySQL, so Redis will act as my Cache and whenever I have a query so for example something like get bookings of a user so I can cache this result into this Redis. And it'll be a write-through cache, so whenever a new booking is coming in this will get updated all \nright. Now this is the functional flow the bigger component here is how do we do the analytics on this so let's just say a business person wants to know how much revenue I'm making or how many bookings I'm having or what are my best performing hotels and stuff like that. \nSo they need to do a lot of analytics Now mostly while designing the system we'll never always know what kind of analytics is required right so what I've done for that is I've used a Hadoop Cluster on which I'm pushing in all the events that are going into my Kafka. Which \nis basically information about all my hotels, about all my bookings, about all the transactions that happen in my system. So there will be a Spark Streaming Consumer that runs somewhere that reads from this Kafka and puts all the data into a Hadoop Cluster on which \nI can do Hive queries or any",
			"rawText": "search on the website So the user talks to through again a load balancer to the search service whenever they want  to search for a particular hotel again they will give a date range and a location for example as a search criteria and along with that they could also \nprovide some tags. Now those tags would be the properties of the hotels. So again going back to my previous example a five star property is a tag. A beachfront property is a tag. Now the search on elasticity would be happening on either of these tags and the ranges \nthat are provided basically the date range, price range and all of that. okay, so this takes care of the search flow. Now once the user has seen some of the results on the website they would want to book a hotel. The booking again happens through this UI. So I've made \nthis UI saying that it's a search and book UI. Normally, it will be the same app or the same website through which they are searching  and then booking right. Now a booking request again comes to this load balancer and talks to Booking Service. Booking Service essentially \nagain sits on top of a MySQL database now these are two different MySQL clusters. I am purposefully not using a same cluster here although we could use the same cluster and have two different databases in that but because we are talking about a fairly large system that \nhas like a good enough amount of scale I would want to keep different clusters so as to you know take care of the scaling separately of each other Now, whenever a booking happens, that booking gets stored into this MySQL we go over the exact flow of booking when we go \nover the details of implementation within the Booking Service, but essentially this stores the data into this MySQL and it talks to a Payment Service Normally what will happen...  a booking request will come, it stores something, it will send the request for payment, \nonce there's a success, it will mark the booking confirm. Now again, whenever a booking is happening, the data is flowing into the same Kafka, right. Why? so let's just say there was just one room available in a hotel right and that room is now booked i want to make sure \nthat this hotel is not available for search now in that same date range, because it's not available. So all of those information is again sent to the same Kafka which is read by Search Consumer and then it takes care of even removing the hotels which are now completely \nbooked. Now if you can see, there's something called an Archival Service here. What I have done is, I am just storing the live data into MySQL. By live data, I mean the bookings that are done but have not been completed thereby making sure that this is having a scale \nwhich is low enough that MySQL can easily handle, and once the booking moves to a terminal state so let's say booking is cancelled or booking is completed it will move through the archival service to a Cassandra cluster. The reason I'm using a Cassandra here is so \ncassandra is a very good database which can handle a huge amount of reads and writes. It has a constraint that it needs a partition key on which all the queries should happen. So let's say if I want to search by a \"booking_id\" my partition key has to be a \"booking_id\" \nin that case I cannot do any kinds of queries on a Cassandra therefore I did not use a Cassandra as a source of truth database. Because on this database I need to do a large variety of queries. We'll come to all of those when we go into the detail of Booking Service, but \nonce it is archived we just need to do GETs on those. So therefore Cassandra makes a good enough sense over here. Now, once the booking is done, all of that is fine, but now we need to notify all the people right? So then comes the Notification Service. So let's say \nwhenever a booking is made, or any changes are happening into a booking or it moves into a terminal state, there'll be a Notification Service that consumes events from this Kafka and notifies the people, so for example on each booking, we need to notify the hotel right. \nWhenever a booking is cancelled by the hotel we need to notify the consumer or in fact on each booking we need to notify the consumer with an invoice right. So all of those is taken care by this Notification Service. Now coming back to the UI for hotels and users. So each \ntime a booking is done or even without that a user might want to see their old bookings or a hotel might want to see all the bookings that they have. This is more of a read-only view for them, right? That will be powered by this Booking Management Service, which talks to \nnow two data sources. It talks to the MySQL cluster for all the active bookings, which are to happen sometime in future and to the Cassandra cluster, for the bookings that have already happened right. Now i am adding a Redis on top of this MySQL to reduce the load on \nthis MySQL, so Redis will act as my Cache and whenever I have a query so for example something like get bookings of a user so I can cache this result into this Redis. And it'll be a write-through cache, so whenever a new booking is coming in this will get updated all \nright. Now this is the functional flow the bigger component here is how do we do the analytics on this so let's just say a business person wants to know how much revenue I'm making or how many bookings I'm having or what are my best performing hotels and stuff like that. \nSo they need to do a lot of analytics Now mostly while designing the system we'll never always know what kind of analytics is required right so what I've done for that is I've used a Hadoop Cluster on which I'm pushing in all the events that are going into my Kafka. Which \nis basically information about all my hotels, about all my bookings, about all the transactions that happen in my system. So there will be a Spark Streaming Consumer that runs somewhere that reads from this Kafka and puts all the data into a Hadoop Cluster on which \nI can do Hive queries or any",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "search on the website So the user talks to through again a load balancer to the search service whenever they want  to search for a particular hotel again they will give a date range and a location for example as a search criteria and along with that they could also \nprovide some tags. Now those tags would be the properties of the hotels. So again going back to my previous example a five star property is a tag. A beachfront property is a tag. Now the search on elasticity would be happening on either of these tags and the ranges \nthat are provided basically the date range, price range and all of that. okay, so this takes care of the search flow. Now once the user has seen some of the results on the website they would want to book a hotel. The booking again happens through this UI. So I've made \nthis UI saying that it's a search and book UI. Normally, it will be the same app or the same website through which they are searching  and then booking right. Now a booking request again comes to this load balancer and talks to Booking Service. Booking Service essentially \nagain sits on top of a MySQL database now these are two different MySQL clusters. I am purposefully not using a same cluster here although we could use the same cluster and have two different databases in that but because we are talking about a fairly large system that \nhas like a good enough amount of scale I would want to keep different clusters so as to you know take care of the scaling separately of each other Now, whenever a booking happens, that booking gets stored into this MySQL we go over the exact flow of booking when we go \nover the details of implementation within the Booking Service, but essentially this stores the data into this MySQL and it talks to a Payment Service Normally what will happen...  a booking request will come, it stores something, it will send the request for payment, \nonce there's a success, it will mark the booking confirm. Now again, whenever a booking is happening, the data is flowing into the same Kafka, right. Why? so let's just say there was just one room available in a hotel right and that room is now booked i want to make sure \nthat this hotel is not available for search now in that same date range, because it's not available. So all of those information is again sent to the same Kafka which is read by Search Consumer and then it takes care of even removing the hotels which are now completely \nbooked. Now if you can see, there's something called an Archival Service here. What I have done is, I am just storing the live data into MySQL. By live data, I mean the bookings that are done but have not been completed thereby making sure that this is having a scale \nwhich is low enough that MySQL can easily handle, and once the booking moves to a terminal state so let's say booking is cancelled or booking is completed it will move through the archival service to a Cassandra cluster. The reason I'm using a Cassandra here is so \ncassandra is a very good database which can handle a huge amount of reads and writes. It has a constraint that it needs a partition key on which all the queries should happen. So let's say if I want to search by a \"booking_id\" my partition key has to be a \"booking_id\" \nin that case I cannot do any kinds of queries on a Cassandra therefore I did not use a Cassandra as a source of truth database. Because on this database I need to do a large variety of queries. We'll come to all of those when we go into the detail of Booking Service, but \nonce it is archived we just need to do GETs on those. So therefore Cassandra makes a good enough sense over here. Now, once the booking is done, all of that is fine, but now we need to notify all the people right? So then comes the Notification Service. So let's say \nwhenever a booking is made, or any changes are happening into a booking or it moves into a terminal state, there'll be a Notification Service that consumes events from this Kafka and notifies the people, so for example on each booking, we need to notify the hotel right. \nWhenever a booking is cancelled by the hotel we need to notify the consumer or in fact on each booking we need to notify the consumer with an invoice right. So all of those is taken care by this Notification Service. Now coming back to the UI for hotels and users. So each \ntime a booking is done or even without that a user might want to see their old bookings or a hotel might want to see all the bookings that they have. This is more of a read-only view for them, right? That will be powered by this Booking Management Service, which talks to \nnow two data sources. It talks to the MySQL cluster for all the active bookings, which are to happen sometime in future and to the Cassandra cluster, for the bookings that have already happened right. Now i am adding a Redis on top of this MySQL to reduce the load on \nthis MySQL, so Redis will act as my Cache and whenever I have a query so for example something like get bookings of a user so I can cache this result into this Redis. And it'll be a write-through cache, so whenever a new booking is coming in this will get updated all \nright. Now this is the functional flow the bigger component here is how do we do the analytics on this so let's just say a business person wants to know how much revenue I'm making or how many bookings I'm having or what are my best performing hotels and stuff like that. \nSo they need to do a lot of analytics Now mostly while designing the system we'll never always know what kind of analytics is required right so what I've done for that is I've used a Hadoop Cluster on which I'm pushing in all the events that are going into my Kafka. Which \nis basically information about all my hotels, about all my bookings, about all the transactions that happen in my system. So there will be a Spark Streaming Consumer that runs somewhere that reads from this Kafka and puts all the data into a Hadoop Cluster on which \nI can do Hive queries or any",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 146,
			"versionNonce": 1565859584,
			"isDeleted": false,
			"id": "ejsSkm8Z",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1924.1900922416405,
			"y": 6279.742903584396,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2606.25,
			"height": 441.59999999999997,
			"seed": 1974388582,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "different kind of queries and build up a lot of reporting. So this is overall how the system looks like and how the data flows. Now let's go into the details of some of the components. Now let's look at what Hotel Service internally is.  So it's not a very complicated \nservice it is basically a CRUD Service which provides Create, Update, Read, Delete operations on the hotel data store. And it is the source of truth for hotel data. Now, this is not an exhaustive list of neither the APIs nor the DB Schema that you see here there will be a \nlot more things, but this will give you a feel of how it should be. So let's look at some of the APIs. to create a hotel which will be part of their onboarding process. GET /hotel/{hotel_id} which will give back the information of the hotel which can be rendered on the\n screen and the hotel guy can see it. PUT /hotel/id which will be used to update any information of a hotel. PUT /hotel/{hotel_id}/room/{room_id} which would be used to update the room information or create new rooms and all of that. Now this is not an exhaustive list \nthere'll be a lot more APIs that you can add it as in when you know there's a requirement to add. Now let's look at how the DB schema might look like. So there are a couple of important tables now this is again not an exhaustive list of databases of the tables so there's \none hotel table into this hotel DB but before that everything in red here is either a primary key or a foreign key. everything in blue is just a column now this hotel table contains your very standard things id, name, locality_id which is a foreign key to locality table \ndescription, original_images,  display_images and is_active. Now I have two columns for original and display images? so original_images is basically the artifact that the people have uploaded display_images could be a compressed version of that, that we've compressed, \nit could be a version that we have uploaded on the CDN, it could be something different than the original image but we still need to keep both of them so we have stored it here. is_active is basically like a soft delete flag Then coming to rooms table. It has a room id \nobviously, a hotel_id which references into this[hotel] table a display_name which could just be a identifier to tell the customer on what kind of a room it is, is_active again a soft delete flag, quantity basically tells how many such rooms are there in the hotel and a \nprice_min and a price_max. Now why do I have do we have two prizes? Remember the hadoop cluster that we had in the original design that we made. it has a lot of data about various kinds of things we might as well run a machine learning model onto it and do some supply \ndemand analytics and then come up with the optimal price! right? let's say supply is low there's a lot of demand there are just a few rooms left... might as well increase the price! or let's say if there are too many rooms and very few customers might as well reduce the \nprice. So this price_min and price_max could be the ranges which the hotel provides, wherein the price could be fluctuated by the system. A good starting point could be an average of both these prices right.  Then there's a facilities table, which is basically a list of all\n the facilities that a hotel and a room can possibly have and these hotels_facilities and room_facilities are basically  mapping tables which is a many-to-many relationship between a hotel_id and a facility_id. again is_active flag everywhere is basically a soft delete \nflag. now again this is not a full list of tables there are a lot of information missing. I've skipped the auditing information, I've skipped the bookkeeping information like created_on, updated_time and all of that. A lot of information missing but this will give you a \nfair enough idea and it will be a good starting point for you to come up with a DB schema for this. One more thing to note here that if you remember the original design that we had I did not keep a Redis cache on top of this MySQL database but I did keep a Redis cache on the \nother MySQL database which was for Booking DB Now why is that? We could have kept the Cache on top of this and all these GET APIs could have been a bit more faster right, but this is not coming in the critical path of any high throughput business interaction right so all the \ncustomers are not querying this database, neither  this service, they are always querying the Search Service so if this service is a little bit slow that's okay but adding a Redis Cluster is a cost. So you need to do a trade-off analysis between what cost are you adding of an \ninfrastructure and what benefit it adds to you if it is worth it you might as well go and add a Redis cluster here, but I don't think it is worth it and that's the reason I did not add it. Now let's look at the internal functioning of the Booking Service. We'll first start off \njust walking through the DB Schema again it's not a full-fledged schema there are a lot of details missing like bookkeeping information like created_time, updated_time and all of that but let's focus on the meaty part here. So it has a table called available_rooms which has \na room_id it has a date, it has an initial_quantity that comes from the hotel service and it has a available_quantity available_quantity is basically the number of rooms that are remaining for that particular room_id for that particular date. Now, it has a constraint saying \nit cannot go negative. Here is where the true power of MySQL we are utilizing and that's the reason why I chose to use MySQL here the other table here is a booking table it has a booking_id which is the primary key here, which will be referenced across the whole system it has \na room_id, again comes from the room table it has a user_id, a start_date and an end_date for a particular booking, number_of_rooms which is how many rooms the person has booked, status and an invoice_id. looking at this design we can clearly understand that one booking \ncannot contain different room types you can have multiple rooms of the same room type but you cannot have like one deluxe room",
			"rawText": "different kind of queries and build up a lot of reporting. So this is overall how the system looks like and how the data flows. Now let's go into the details of some of the components. Now let's look at what Hotel Service internally is.  So it's not a very complicated \nservice it is basically a CRUD Service which provides Create, Update, Read, Delete operations on the hotel data store. And it is the source of truth for hotel data. Now, this is not an exhaustive list of neither the APIs nor the DB Schema that you see here there will be a \nlot more things, but this will give you a feel of how it should be. So let's look at some of the APIs. to create a hotel which will be part of their onboarding process. GET /hotel/{hotel_id} which will give back the information of the hotel which can be rendered on the\n screen and the hotel guy can see it. PUT /hotel/id which will be used to update any information of a hotel. PUT /hotel/{hotel_id}/room/{room_id} which would be used to update the room information or create new rooms and all of that. Now this is not an exhaustive list \nthere'll be a lot more APIs that you can add it as in when you know there's a requirement to add. Now let's look at how the DB schema might look like. So there are a couple of important tables now this is again not an exhaustive list of databases of the tables so there's \none hotel table into this hotel DB but before that everything in red here is either a primary key or a foreign key. everything in blue is just a column now this hotel table contains your very standard things id, name, locality_id which is a foreign key to locality table \ndescription, original_images,  display_images and is_active. Now I have two columns for original and display images? so original_images is basically the artifact that the people have uploaded display_images could be a compressed version of that, that we've compressed, \nit could be a version that we have uploaded on the CDN, it could be something different than the original image but we still need to keep both of them so we have stored it here. is_active is basically like a soft delete flag Then coming to rooms table. It has a room id \nobviously, a hotel_id which references into this[hotel] table a display_name which could just be a identifier to tell the customer on what kind of a room it is, is_active again a soft delete flag, quantity basically tells how many such rooms are there in the hotel and a \nprice_min and a price_max. Now why do I have do we have two prizes? Remember the hadoop cluster that we had in the original design that we made. it has a lot of data about various kinds of things we might as well run a machine learning model onto it and do some supply \ndemand analytics and then come up with the optimal price! right? let's say supply is low there's a lot of demand there are just a few rooms left... might as well increase the price! or let's say if there are too many rooms and very few customers might as well reduce the \nprice. So this price_min and price_max could be the ranges which the hotel provides, wherein the price could be fluctuated by the system. A good starting point could be an average of both these prices right.  Then there's a facilities table, which is basically a list of all\n the facilities that a hotel and a room can possibly have and these hotels_facilities and room_facilities are basically  mapping tables which is a many-to-many relationship between a hotel_id and a facility_id. again is_active flag everywhere is basically a soft delete \nflag. now again this is not a full list of tables there are a lot of information missing. I've skipped the auditing information, I've skipped the bookkeeping information like created_on, updated_time and all of that. A lot of information missing but this will give you a \nfair enough idea and it will be a good starting point for you to come up with a DB schema for this. One more thing to note here that if you remember the original design that we had I did not keep a Redis cache on top of this MySQL database but I did keep a Redis cache on the \nother MySQL database which was for Booking DB Now why is that? We could have kept the Cache on top of this and all these GET APIs could have been a bit more faster right, but this is not coming in the critical path of any high throughput business interaction right so all the \ncustomers are not querying this database, neither  this service, they are always querying the Search Service so if this service is a little bit slow that's okay but adding a Redis Cluster is a cost. So you need to do a trade-off analysis between what cost are you adding of an \ninfrastructure and what benefit it adds to you if it is worth it you might as well go and add a Redis cluster here, but I don't think it is worth it and that's the reason I did not add it. Now let's look at the internal functioning of the Booking Service. We'll first start off \njust walking through the DB Schema again it's not a full-fledged schema there are a lot of details missing like bookkeeping information like created_time, updated_time and all of that but let's focus on the meaty part here. So it has a table called available_rooms which has \na room_id it has a date, it has an initial_quantity that comes from the hotel service and it has a available_quantity available_quantity is basically the number of rooms that are remaining for that particular room_id for that particular date. Now, it has a constraint saying \nit cannot go negative. Here is where the true power of MySQL we are utilizing and that's the reason why I chose to use MySQL here the other table here is a booking table it has a booking_id which is the primary key here, which will be referenced across the whole system it has \na room_id, again comes from the room table it has a user_id, a start_date and an end_date for a particular booking, number_of_rooms which is how many rooms the person has booked, status and an invoice_id. looking at this design we can clearly understand that one booking \ncannot contain different room types you can have multiple rooms of the same room type but you cannot have like one deluxe room",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "different kind of queries and build up a lot of reporting. So this is overall how the system looks like and how the data flows. Now let's go into the details of some of the components. Now let's look at what Hotel Service internally is.  So it's not a very complicated \nservice it is basically a CRUD Service which provides Create, Update, Read, Delete operations on the hotel data store. And it is the source of truth for hotel data. Now, this is not an exhaustive list of neither the APIs nor the DB Schema that you see here there will be a \nlot more things, but this will give you a feel of how it should be. So let's look at some of the APIs. to create a hotel which will be part of their onboarding process. GET /hotel/{hotel_id} which will give back the information of the hotel which can be rendered on the\n screen and the hotel guy can see it. PUT /hotel/id which will be used to update any information of a hotel. PUT /hotel/{hotel_id}/room/{room_id} which would be used to update the room information or create new rooms and all of that. Now this is not an exhaustive list \nthere'll be a lot more APIs that you can add it as in when you know there's a requirement to add. Now let's look at how the DB schema might look like. So there are a couple of important tables now this is again not an exhaustive list of databases of the tables so there's \none hotel table into this hotel DB but before that everything in red here is either a primary key or a foreign key. everything in blue is just a column now this hotel table contains your very standard things id, name, locality_id which is a foreign key to locality table \ndescription, original_images,  display_images and is_active. Now I have two columns for original and display images? so original_images is basically the artifact that the people have uploaded display_images could be a compressed version of that, that we've compressed, \nit could be a version that we have uploaded on the CDN, it could be something different than the original image but we still need to keep both of them so we have stored it here. is_active is basically like a soft delete flag Then coming to rooms table. It has a room id \nobviously, a hotel_id which references into this[hotel] table a display_name which could just be a identifier to tell the customer on what kind of a room it is, is_active again a soft delete flag, quantity basically tells how many such rooms are there in the hotel and a \nprice_min and a price_max. Now why do I have do we have two prizes? Remember the hadoop cluster that we had in the original design that we made. it has a lot of data about various kinds of things we might as well run a machine learning model onto it and do some supply \ndemand analytics and then come up with the optimal price! right? let's say supply is low there's a lot of demand there are just a few rooms left... might as well increase the price! or let's say if there are too many rooms and very few customers might as well reduce the \nprice. So this price_min and price_max could be the ranges which the hotel provides, wherein the price could be fluctuated by the system. A good starting point could be an average of both these prices right.  Then there's a facilities table, which is basically a list of all\n the facilities that a hotel and a room can possibly have and these hotels_facilities and room_facilities are basically  mapping tables which is a many-to-many relationship between a hotel_id and a facility_id. again is_active flag everywhere is basically a soft delete \nflag. now again this is not a full list of tables there are a lot of information missing. I've skipped the auditing information, I've skipped the bookkeeping information like created_on, updated_time and all of that. A lot of information missing but this will give you a \nfair enough idea and it will be a good starting point for you to come up with a DB schema for this. One more thing to note here that if you remember the original design that we had I did not keep a Redis cache on top of this MySQL database but I did keep a Redis cache on the \nother MySQL database which was for Booking DB Now why is that? We could have kept the Cache on top of this and all these GET APIs could have been a bit more faster right, but this is not coming in the critical path of any high throughput business interaction right so all the \ncustomers are not querying this database, neither  this service, they are always querying the Search Service so if this service is a little bit slow that's okay but adding a Redis Cluster is a cost. So you need to do a trade-off analysis between what cost are you adding of an \ninfrastructure and what benefit it adds to you if it is worth it you might as well go and add a Redis cluster here, but I don't think it is worth it and that's the reason I did not add it. Now let's look at the internal functioning of the Booking Service. We'll first start off \njust walking through the DB Schema again it's not a full-fledged schema there are a lot of details missing like bookkeeping information like created_time, updated_time and all of that but let's focus on the meaty part here. So it has a table called available_rooms which has \na room_id it has a date, it has an initial_quantity that comes from the hotel service and it has a available_quantity available_quantity is basically the number of rooms that are remaining for that particular room_id for that particular date. Now, it has a constraint saying \nit cannot go negative. Here is where the true power of MySQL we are utilizing and that's the reason why I chose to use MySQL here the other table here is a booking table it has a booking_id which is the primary key here, which will be referenced across the whole system it has \na room_id, again comes from the room table it has a user_id, a start_date and an end_date for a particular booking, number_of_rooms which is how many rooms the person has booked, status and an invoice_id. looking at this design we can clearly understand that one booking \ncannot contain different room types you can have multiple rooms of the same room type but you cannot have like one deluxe room",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 307,
			"versionNonce": 626020608,
			"isDeleted": false,
			"id": "7SbUmrYw",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1935.6807831836188,
			"y": 6952.126832020772,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2568.75,
			"height": 710.4,
			"seed": 386943482,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "and one regular room in one booking. If you want that there'll be a small change required but i think that's a minor detail it can be taken care of easily. The important part here is the status column. it has these four values  - reserved, booked cancelled and completed. \nNow canceled and completed are the terminal statuses here so the booking gets first created into reserved status. Then based on the payment success it can either move to book or cancel. And once the user stays in that, it moves to complete. Now you can add more statuses \ndepending upon your conversation with your interviewer but these four statuses are the main ones that will help us achieve what we initially thought of. Now, let's look at the API Signature so this will have one important API called a book API it will be a POST API which \nwill take these five attributes. It will contain a user_id it will contain a room_id, it will contain the quantity. Now again if you want to make multiple rooms multiple quantity we'll have to change it a bit to have an array but let's stick to this for now it'll have a \nstart_date and it'll have a end_date. The price will come from somewhere else let's assume for now. It'll actually come from the data store which contains the price for the room at this point in time we don't want to generally take the price from the user because then the \nrequest can be tampered with and that's not really a good design okay now let's do a quick revision of the design because i skipped some important details in the earlier larger diagram and we'll go over that now. So the way Booking Service actually works is when it gets a \nrequest to do a booking it first of all queries this table and the available_rooms table and check whether or not I have that many number of rooms remaining or not. So if there are no rooms left for that particular room_id for that particular date, there's no point of \nproceeding so we can error out from there. But in case that's a success and we have rooms then we actually go ahead with the blocking of the room saying that now I'll block it temporarily and if the payment is success I'll actually book the room. I'll do a quick dry run of \nwhat actually happens. Assuming this is the request that came in user_id: 1 | room_id: 5 | quantity: 1  for some date \"dt\" to \"dt +1\".   The room_id: 5 on that particular date \"dt\" has 7 available rooms. So our first check is a success that we have enough rooms. So what\n essentially will happen is there'll be a row created in this table with a booking_id: (some_uuid) | room_id: 5 user_id: 1 | start_date: dt whatever that is, end_date would be \"dt + 1\" whatever that is, number_of_rooms in the request is quantity:1, and status would be at\n this point in time, RESERVED. invoice_id at this point in time would be NULL because there is no invoice created till now Now, we have a record, along with that we also decrement the quantity here now here again we are utilizing a very important feature of MySQL which is \npart of the ACID property  and transactions. So we are creating a record here[booking table] and we are reducing the quantity here[available_rooms] to 6. what essentially we are trying to do is basically bounding this as part of one transaction so let's say there was just \none room left and two three requests came in only one transaction would be successful to do both these things. Basically to insert this record and reduce the quantity because we have this constraint sitting over here which says that quantity cannot be negative. okay so \nonly one of the transaction will be success, and only one of the rooms will be booked and no two users will be redirected to payment. That being taken care of what is the next step so i have written down the steps here if you want to actually look at so what we have gone \nthrough till now is step number one and step number two okay we've inserted in booking and reduces reduce the quantity in available_rooms our step number three is something that I did not cover as part of the larger design review because it was getting too much cluttered. \nNow we cannot keep this room reserved for an infinite amount of time. What we can say is if the payment is success in next five minutes, well and good, if not then we'll assume that the payment will not go through and will unblock the room so that somebody else could book \nit, okay. So there are multiple ways to implement that what I choose to implement here is something using the TTL(Time To Live) of Redis. So because we anyway are using a Redis we can utilize the same cluster of Redis for this use case as well. So what we'll do is we'll \nput the key in Redis saying some booking_id expires at some timestamp Now the time stamp could be a configurable number, it could be a fixed timestamp across the board, it could be a country specific timestamp, for India have an expiry time of five minutes, for US have \nexpiry time of four minutes, something of that sort but whatever that time is, we'll insert that into redis. Now what redis does is, it has something called callbacks so one of the later versions of Redis has introduced this concept called callbacks so whenever a key is \ngetting expired you'll get a notification, okay.  And you can do whatever you need to do at that point in time, right.  So, if you get a Success notification from payment, well and good. Success notification means the payment has gone through, then you will mark the \nbooking as BOOKED but before that if you get a callback from Redis saying that the key has expired and you've not got the success from payment you will say that the booking is CANCELLED. Alternatively you could also get a failure from payment saying for whatever reason\n the payment didn't go through and you got a failure response from the Payment Service, in that again you can say CANCELLED. Now if you want a bifurcation of the varieties of CANCELLED, you can maybe make multiple statuses like cancel because of invoicing / cancel because \nof payment/ cancel because of expiry, whatever right or you could maybe add a status_reason column or something of that sort but that's a very minor detail we'll skip that for now, okay.  So let's go over what all possibilities are there in this and how each of them \nbehaves, okay. So, first very simple thing is -  what happens when payment is a Sucess? so in case payment is a success everything remains the same just the status becomes BOOKED. okay, in that case, we do get some invoice_id as well. So basically we'll get an invoice_id \nfrom Payment Service whenever you know a booking is getting success and we'll just update the invoice_id there and then the regular Kafka events would also be sent saying the booking is now complete and here's the Kafka event for that in case somebody wants to do something \non that. What happens when payment fails? Now in this we just have these four statuses so the booking status will become CANCELLED. okay there would be no invoice_id in this case Why? because if the payment did not go through there obviously is not an invoice that is \ngenerated. And everything else remains the same but, if the payment did not go through, we need to revert the available_quantity again. so available_quantity in that case would become seven. Now let's say your key expired so basically let's say the user was redirected to \npayment screen and there was no response from payment service for whatever reason what happens then if we get a call back from Redis and based on that call back we can say that okay now the payment has not gone through we will follow the same process as payment failure we \nwill mark this CANCELLED okay we will mark this CANCELLED and we'll increment the quantity in available_quantity so that the room is now available for somebody else to use.  Again in that scenario there is no invoice generated. But this you do only if the status is \nRESERVED. Why? -  coming to the next case, what happens if both (3) and (1) happen. What happens if you get a key expiry event and a payment is also success. so there are two conditions if the payment has already been successful and the booking has already been moved to \nBOOKED status, after that if you get this key expired event then you don't do anything because that is any way bound to happen right? but what if it happens the other way around what if key expired first you move the booking to CANCELLED state but then you get a \nnotification saying payment is success Now there are multiple directions in which you could take it based on your conversation with your interviewer and the non-functional requirements and in fact even the functional requirements for that matter you could do two three \nthings. You could now either revert the payment saying for whatever reason we were not able to book the room so here's your payment back. Alternatively you could do something even more smarter. You could say that now I have anyway got the payment from the user, I can \ncheck if there are rooms available and I'll book them, right? Now this could be done based on what the requirement is and you could talk to your interviewer and implement it either ways. All good so far but there are a couple of caveats here. The TTL that you have talked \nabout it is not a very precise measure so let's just say that a key was supposed to expire at 10:00 okay,  you will probably never ever get a call back at this point in time it will always have some delay. Now in this case it doesn't matter too much instead of at 10:00 if \nyou get it at 10:01 it's possibly okay also. So it's not too big of a problem and the reason for that is because of the way expires are implemented in Redis I'll not go too much into detail of that but there's a background process that runs in Redis for keys that are not \naccessed and whenever that process gets to access a particular key is when it will expire it. So it is not necessary that it will acquire it at exactly the same time.",
			"rawText": "and one regular room in one booking. If you want that there'll be a small change required but i think that's a minor detail it can be taken care of easily. The important part here is the status column. it has these four values  - reserved, booked cancelled and completed. \nNow canceled and completed are the terminal statuses here so the booking gets first created into reserved status. Then based on the payment success it can either move to book or cancel. And once the user stays in that, it moves to complete. Now you can add more statuses \ndepending upon your conversation with your interviewer but these four statuses are the main ones that will help us achieve what we initially thought of. Now, let's look at the API Signature so this will have one important API called a book API it will be a POST API which \nwill take these five attributes. It will contain a user_id it will contain a room_id, it will contain the quantity. Now again if you want to make multiple rooms multiple quantity we'll have to change it a bit to have an array but let's stick to this for now it'll have a \nstart_date and it'll have a end_date. The price will come from somewhere else let's assume for now. It'll actually come from the data store which contains the price for the room at this point in time we don't want to generally take the price from the user because then the \nrequest can be tampered with and that's not really a good design okay now let's do a quick revision of the design because i skipped some important details in the earlier larger diagram and we'll go over that now. So the way Booking Service actually works is when it gets a \nrequest to do a booking it first of all queries this table and the available_rooms table and check whether or not I have that many number of rooms remaining or not. So if there are no rooms left for that particular room_id for that particular date, there's no point of \nproceeding so we can error out from there. But in case that's a success and we have rooms then we actually go ahead with the blocking of the room saying that now I'll block it temporarily and if the payment is success I'll actually book the room. I'll do a quick dry run of \nwhat actually happens. Assuming this is the request that came in user_id: 1 | room_id: 5 | quantity: 1  for some date \"dt\" to \"dt +1\".   The room_id: 5 on that particular date \"dt\" has 7 available rooms. So our first check is a success that we have enough rooms. So what\n essentially will happen is there'll be a row created in this table with a booking_id: (some_uuid) | room_id: 5 user_id: 1 | start_date: dt whatever that is, end_date would be \"dt + 1\" whatever that is, number_of_rooms in the request is quantity:1, and status would be at\n this point in time, RESERVED. invoice_id at this point in time would be NULL because there is no invoice created till now Now, we have a record, along with that we also decrement the quantity here now here again we are utilizing a very important feature of MySQL which is \npart of the ACID property  and transactions. So we are creating a record here[booking table] and we are reducing the quantity here[available_rooms] to 6. what essentially we are trying to do is basically bounding this as part of one transaction so let's say there was just \none room left and two three requests came in only one transaction would be successful to do both these things. Basically to insert this record and reduce the quantity because we have this constraint sitting over here which says that quantity cannot be negative. okay so \nonly one of the transaction will be success, and only one of the rooms will be booked and no two users will be redirected to payment. That being taken care of what is the next step so i have written down the steps here if you want to actually look at so what we have gone \nthrough till now is step number one and step number two okay we've inserted in booking and reduces reduce the quantity in available_rooms our step number three is something that I did not cover as part of the larger design review because it was getting too much cluttered. \nNow we cannot keep this room reserved for an infinite amount of time. What we can say is if the payment is success in next five minutes, well and good, if not then we'll assume that the payment will not go through and will unblock the room so that somebody else could book \nit, okay. So there are multiple ways to implement that what I choose to implement here is something using the TTL(Time To Live) of Redis. So because we anyway are using a Redis we can utilize the same cluster of Redis for this use case as well. So what we'll do is we'll \nput the key in Redis saying some booking_id expires at some timestamp Now the time stamp could be a configurable number, it could be a fixed timestamp across the board, it could be a country specific timestamp, for India have an expiry time of five minutes, for US have \nexpiry time of four minutes, something of that sort but whatever that time is, we'll insert that into redis. Now what redis does is, it has something called callbacks so one of the later versions of Redis has introduced this concept called callbacks so whenever a key is \ngetting expired you'll get a notification, okay.  And you can do whatever you need to do at that point in time, right.  So, if you get a Success notification from payment, well and good. Success notification means the payment has gone through, then you will mark the \nbooking as BOOKED but before that if you get a callback from Redis saying that the key has expired and you've not got the success from payment you will say that the booking is CANCELLED. Alternatively you could also get a failure from payment saying for whatever reason\n the payment didn't go through and you got a failure response from the Payment Service, in that again you can say CANCELLED. Now if you want a bifurcation of the varieties of CANCELLED, you can maybe make multiple statuses like cancel because of invoicing / cancel because \nof payment/ cancel because of expiry, whatever right or you could maybe add a status_reason column or something of that sort but that's a very minor detail we'll skip that for now, okay.  So let's go over what all possibilities are there in this and how each of them \nbehaves, okay. So, first very simple thing is -  what happens when payment is a Sucess? so in case payment is a success everything remains the same just the status becomes BOOKED. okay, in that case, we do get some invoice_id as well. So basically we'll get an invoice_id \nfrom Payment Service whenever you know a booking is getting success and we'll just update the invoice_id there and then the regular Kafka events would also be sent saying the booking is now complete and here's the Kafka event for that in case somebody wants to do something \non that. What happens when payment fails? Now in this we just have these four statuses so the booking status will become CANCELLED. okay there would be no invoice_id in this case Why? because if the payment did not go through there obviously is not an invoice that is \ngenerated. And everything else remains the same but, if the payment did not go through, we need to revert the available_quantity again. so available_quantity in that case would become seven. Now let's say your key expired so basically let's say the user was redirected to \npayment screen and there was no response from payment service for whatever reason what happens then if we get a call back from Redis and based on that call back we can say that okay now the payment has not gone through we will follow the same process as payment failure we \nwill mark this CANCELLED okay we will mark this CANCELLED and we'll increment the quantity in available_quantity so that the room is now available for somebody else to use.  Again in that scenario there is no invoice generated. But this you do only if the status is \nRESERVED. Why? -  coming to the next case, what happens if both (3) and (1) happen. What happens if you get a key expiry event and a payment is also success. so there are two conditions if the payment has already been successful and the booking has already been moved to \nBOOKED status, after that if you get this key expired event then you don't do anything because that is any way bound to happen right? but what if it happens the other way around what if key expired first you move the booking to CANCELLED state but then you get a \nnotification saying payment is success Now there are multiple directions in which you could take it based on your conversation with your interviewer and the non-functional requirements and in fact even the functional requirements for that matter you could do two three \nthings. You could now either revert the payment saying for whatever reason we were not able to book the room so here's your payment back. Alternatively you could do something even more smarter. You could say that now I have anyway got the payment from the user, I can \ncheck if there are rooms available and I'll book them, right? Now this could be done based on what the requirement is and you could talk to your interviewer and implement it either ways. All good so far but there are a couple of caveats here. The TTL that you have talked \nabout it is not a very precise measure so let's just say that a key was supposed to expire at 10:00 okay,  you will probably never ever get a call back at this point in time it will always have some delay. Now in this case it doesn't matter too much instead of at 10:00 if \nyou get it at 10:01 it's possibly okay also. So it's not too big of a problem and the reason for that is because of the way expires are implemented in Redis I'll not go too much into detail of that but there's a background process that runs in Redis for keys that are not \naccessed and whenever that process gets to access a particular key is when it will expire it. So it is not necessary that it will acquire it at exactly the same time.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "and one regular room in one booking. If you want that there'll be a small change required but i think that's a minor detail it can be taken care of easily. The important part here is the status column. it has these four values  - reserved, booked cancelled and completed. \nNow canceled and completed are the terminal statuses here so the booking gets first created into reserved status. Then based on the payment success it can either move to book or cancel. And once the user stays in that, it moves to complete. Now you can add more statuses \ndepending upon your conversation with your interviewer but these four statuses are the main ones that will help us achieve what we initially thought of. Now, let's look at the API Signature so this will have one important API called a book API it will be a POST API which \nwill take these five attributes. It will contain a user_id it will contain a room_id, it will contain the quantity. Now again if you want to make multiple rooms multiple quantity we'll have to change it a bit to have an array but let's stick to this for now it'll have a \nstart_date and it'll have a end_date. The price will come from somewhere else let's assume for now. It'll actually come from the data store which contains the price for the room at this point in time we don't want to generally take the price from the user because then the \nrequest can be tampered with and that's not really a good design okay now let's do a quick revision of the design because i skipped some important details in the earlier larger diagram and we'll go over that now. So the way Booking Service actually works is when it gets a \nrequest to do a booking it first of all queries this table and the available_rooms table and check whether or not I have that many number of rooms remaining or not. So if there are no rooms left for that particular room_id for that particular date, there's no point of \nproceeding so we can error out from there. But in case that's a success and we have rooms then we actually go ahead with the blocking of the room saying that now I'll block it temporarily and if the payment is success I'll actually book the room. I'll do a quick dry run of \nwhat actually happens. Assuming this is the request that came in user_id: 1 | room_id: 5 | quantity: 1  for some date \"dt\" to \"dt +1\".   The room_id: 5 on that particular date \"dt\" has 7 available rooms. So our first check is a success that we have enough rooms. So what\n essentially will happen is there'll be a row created in this table with a booking_id: (some_uuid) | room_id: 5 user_id: 1 | start_date: dt whatever that is, end_date would be \"dt + 1\" whatever that is, number_of_rooms in the request is quantity:1, and status would be at\n this point in time, RESERVED. invoice_id at this point in time would be NULL because there is no invoice created till now Now, we have a record, along with that we also decrement the quantity here now here again we are utilizing a very important feature of MySQL which is \npart of the ACID property  and transactions. So we are creating a record here[booking table] and we are reducing the quantity here[available_rooms] to 6. what essentially we are trying to do is basically bounding this as part of one transaction so let's say there was just \none room left and two three requests came in only one transaction would be successful to do both these things. Basically to insert this record and reduce the quantity because we have this constraint sitting over here which says that quantity cannot be negative. okay so \nonly one of the transaction will be success, and only one of the rooms will be booked and no two users will be redirected to payment. That being taken care of what is the next step so i have written down the steps here if you want to actually look at so what we have gone \nthrough till now is step number one and step number two okay we've inserted in booking and reduces reduce the quantity in available_rooms our step number three is something that I did not cover as part of the larger design review because it was getting too much cluttered. \nNow we cannot keep this room reserved for an infinite amount of time. What we can say is if the payment is success in next five minutes, well and good, if not then we'll assume that the payment will not go through and will unblock the room so that somebody else could book \nit, okay. So there are multiple ways to implement that what I choose to implement here is something using the TTL(Time To Live) of Redis. So because we anyway are using a Redis we can utilize the same cluster of Redis for this use case as well. So what we'll do is we'll \nput the key in Redis saying some booking_id expires at some timestamp Now the time stamp could be a configurable number, it could be a fixed timestamp across the board, it could be a country specific timestamp, for India have an expiry time of five minutes, for US have \nexpiry time of four minutes, something of that sort but whatever that time is, we'll insert that into redis. Now what redis does is, it has something called callbacks so one of the later versions of Redis has introduced this concept called callbacks so whenever a key is \ngetting expired you'll get a notification, okay.  And you can do whatever you need to do at that point in time, right.  So, if you get a Success notification from payment, well and good. Success notification means the payment has gone through, then you will mark the \nbooking as BOOKED but before that if you get a callback from Redis saying that the key has expired and you've not got the success from payment you will say that the booking is CANCELLED. Alternatively you could also get a failure from payment saying for whatever reason\n the payment didn't go through and you got a failure response from the Payment Service, in that again you can say CANCELLED. Now if you want a bifurcation of the varieties of CANCELLED, you can maybe make multiple statuses like cancel because of invoicing / cancel because \nof payment/ cancel because of expiry, whatever right or you could maybe add a status_reason column or something of that sort but that's a very minor detail we'll skip that for now, okay.  So let's go over what all possibilities are there in this and how each of them \nbehaves, okay. So, first very simple thing is -  what happens when payment is a Sucess? so in case payment is a success everything remains the same just the status becomes BOOKED. okay, in that case, we do get some invoice_id as well. So basically we'll get an invoice_id \nfrom Payment Service whenever you know a booking is getting success and we'll just update the invoice_id there and then the regular Kafka events would also be sent saying the booking is now complete and here's the Kafka event for that in case somebody wants to do something \non that. What happens when payment fails? Now in this we just have these four statuses so the booking status will become CANCELLED. okay there would be no invoice_id in this case Why? because if the payment did not go through there obviously is not an invoice that is \ngenerated. And everything else remains the same but, if the payment did not go through, we need to revert the available_quantity again. so available_quantity in that case would become seven. Now let's say your key expired so basically let's say the user was redirected to \npayment screen and there was no response from payment service for whatever reason what happens then if we get a call back from Redis and based on that call back we can say that okay now the payment has not gone through we will follow the same process as payment failure we \nwill mark this CANCELLED okay we will mark this CANCELLED and we'll increment the quantity in available_quantity so that the room is now available for somebody else to use.  Again in that scenario there is no invoice generated. But this you do only if the status is \nRESERVED. Why? -  coming to the next case, what happens if both (3) and (1) happen. What happens if you get a key expiry event and a payment is also success. so there are two conditions if the payment has already been successful and the booking has already been moved to \nBOOKED status, after that if you get this key expired event then you don't do anything because that is any way bound to happen right? but what if it happens the other way around what if key expired first you move the booking to CANCELLED state but then you get a \nnotification saying payment is success Now there are multiple directions in which you could take it based on your conversation with your interviewer and the non-functional requirements and in fact even the functional requirements for that matter you could do two three \nthings. You could now either revert the payment saying for whatever reason we were not able to book the room so here's your payment back. Alternatively you could do something even more smarter. You could say that now I have anyway got the payment from the user, I can \ncheck if there are rooms available and I'll book them, right? Now this could be done based on what the requirement is and you could talk to your interviewer and implement it either ways. All good so far but there are a couple of caveats here. The TTL that you have talked \nabout it is not a very precise measure so let's just say that a key was supposed to expire at 10:00 okay,  you will probably never ever get a call back at this point in time it will always have some delay. Now in this case it doesn't matter too much instead of at 10:00 if \nyou get it at 10:01 it's possibly okay also. So it's not too big of a problem and the reason for that is because of the way expires are implemented in Redis I'll not go too much into detail of that but there's a background process that runs in Redis for keys that are not \naccessed and whenever that process gets to access a particular key is when it will expire it. So it is not necessary that it will acquire it at exactly the same time.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 358,
			"versionNonce": 1398357760,
			"isDeleted": false,
			"id": "cqjTvMm9",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 1940.9151011179467,
			"y": 7811.29772728054,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2578.125,
			"height": 518.4,
			"seed": 1483532966,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Now a couple of optimizations you could do. So, let's just say payment is success. You know that key will expire after some time, for sure, right? because it's there in Redis. You don't need to keep that key there you know the payment is success you can evict the key right, \neven if the for the payment failure case you know that payment has failed it will expire after five minutes might as well delete the key then and there, right. So these are certain optimizations that you could do over this implementation to make it even more better. But \non and off this is how the booking flow works. Now again reiterating we have used a couple of important features of MySQL and that's what is helping us to make the code on application side much more smoother had we used some other database which doesn't provide for example \nif you were using Cassandra here we would not have had access to the transactions and the constraints and all of that you would have to implement it on application side. That's additional effort on our side to make sure things are consistent. in this case I would rather \nleave it to MySQL to implement all of those things.  Now coming back to the same architecture again i just want to call out that all of the components that you see here are individually horizontally scalable so let's just say there's a traffic spike happening on one of the \ncomponents we could increase the number of nodes in that particular service maybe that particular database and then that should work just fine. As far as Kafka and hadoop cluster are concerned we could add more nodes into that as well and they should also scale to a much \nlarger scale than what we need. Cool, so now let's look at what kind of alternates that we could have used instead of this particular design choice. So first of all why MySQL, we could use any other relational database here. We could use a Postgres we could use a SQL \nServer, anything which provides ACID guarantees should be fairly fine here. As far as Redis is concerned we could use a memcache or any other cache instead of Redis and that should also be good. Cassandra, I would still stick to Cassandra because that is exactly what we \nneed here now technically in place of Cassandra we could also use a HBase here that would also work fine but it has a lot of operational overhead in terms of deployment and maintaining it over time so that's the reason I would prefer Cassandra over HBase or any other \nsimilar system The way cassandra works is every data in Cassandra is you know sharded across a partition key so each query has to happen on a partition key now the queries that we are doing are just of two varieties. There is no the third variety so we basically have two \nkinds of data which is distributed by two different partition keys on which the queries are happening. So this would be kind of a very good choice here. In place of Kafka,  we could have used an Active MQ or a Rabbit MQ or any other queueing mechanism there's an amazon \nqueue(SQS) also we could have used that but i think Kafka scales much better than most of them so i think it's a fairly good choice here. Other than that in general we definitely need to monitor how are our CPUs and Memory is behaving.  So if I have a CPU spike at certain \npoints in time that is something we need to kind of look at so across the whole infrastructure we need to keep an eye on how my CPU usage  percentage is, how my memory usage percentage is, how my disk usage for Redis is, how my disk usage for elastic search is all of these\n things are what we need to monitor now monitoring could be done through a Grafana kind of a tool on which i can set up alert. So if the let's say a particular metric has some threshold the moment I cross that threshold or with certain conditions I could send out an \nalert and the team could get notified that something is potentially wrong and they need to look at that. this will help us to make sure that we in the end achieve our NFRs that we talked about of latency and high availability. Because let's just say something goes wrong \nlet's just say memory is you know utilize more than what we expected eventually it will lead to some machines going down and eventually it will lead to us having a lower availability that than what we expected so yeah these are the things that we need to monitor and\n alert on. Now in the next section let's look at how this whole thing would be spread across geographies, so for example let's say there's an earthquake in one of the data centers and everything just goes away out of the blue what do we do? So let's look at that next So\n let's say we have these four data centers data center 1, data center 2 data center 3, and data center 4 which are located in different geographical regions across the globe, okay. Now we want to create a topology in a way that we do get low latency and high availability\n okay so one very simple approach that we could do is say that DC 1 is our primary and all the three DC's are our secondary data centers and data is replicated to all the three data centers in near real time okay, so that's okay it's good enough. but it's not very good to \nbe honest because we are just using 25 percent of our capacity as primary which is active and rest three data centers are sitting idle and not really doing anything. So let's try to improvise what we could instead do is divide the data centers and thus the globe into two \nparts.  What we could say is this is region one and this is region two okay now the countries or people accessing our services who are closer to this region(R1) will connect to this region(R1) and the people who are closer to that region(R2) will connect to that \nregion(R2). Now how are we able to do that so the data in a hotel management system is fairly specific to a geography so all the hotels in let's say India can be you know separated from all the hotels in US. Similarly all the rooms all the bookings are now specific to \nhotels and thus specific to geography so we could kind of bifurcate the data as per geography right which gives us the leverage to divide the system into two halves right now what will happen here now let's just say DC1 is the primary in this region(R1) and DC3 is the \nprimary in R2 okay now if DC1 goes down all the data in DC1 is getting replicated to DC2 in near real time so if that goes down DC2 can become active and all the clients who are connecting to DC1 and how will they connect so there will be bunch of clients who are \nconnecting via some DNS to DC1 right if this goes down DNS can flip and connect to DC2 if this link is broken right similar thing can happen on this side so this way what we have is basically dividing our infrastructure into two halves thereby clients who are closer \nto this region are connecting to the servers that are closer to them thus giving them lower latency right. Now we could go even one step further we could say that we'll divide the region into four parts and we could do we could go as much as deep we want into this to \nincrease the latency basically to reduce the latency and increase the availability but i think for all practical purposes at least for a Hotel Booking System this R1 R2 thing is more than sufficient to give us a good enough latency and a very high availability. ",
			"rawText": "Now a couple of optimizations you could do. So, let's just say payment is success. You know that key will expire after some time, for sure, right? because it's there in Redis. You don't need to keep that key there you know the payment is success you can evict the key right, \neven if the for the payment failure case you know that payment has failed it will expire after five minutes might as well delete the key then and there, right. So these are certain optimizations that you could do over this implementation to make it even more better. But \non and off this is how the booking flow works. Now again reiterating we have used a couple of important features of MySQL and that's what is helping us to make the code on application side much more smoother had we used some other database which doesn't provide for example \nif you were using Cassandra here we would not have had access to the transactions and the constraints and all of that you would have to implement it on application side. That's additional effort on our side to make sure things are consistent. in this case I would rather \nleave it to MySQL to implement all of those things.  Now coming back to the same architecture again i just want to call out that all of the components that you see here are individually horizontally scalable so let's just say there's a traffic spike happening on one of the \ncomponents we could increase the number of nodes in that particular service maybe that particular database and then that should work just fine. As far as Kafka and hadoop cluster are concerned we could add more nodes into that as well and they should also scale to a much \nlarger scale than what we need. Cool, so now let's look at what kind of alternates that we could have used instead of this particular design choice. So first of all why MySQL, we could use any other relational database here. We could use a Postgres we could use a SQL \nServer, anything which provides ACID guarantees should be fairly fine here. As far as Redis is concerned we could use a memcache or any other cache instead of Redis and that should also be good. Cassandra, I would still stick to Cassandra because that is exactly what we \nneed here now technically in place of Cassandra we could also use a HBase here that would also work fine but it has a lot of operational overhead in terms of deployment and maintaining it over time so that's the reason I would prefer Cassandra over HBase or any other \nsimilar system The way cassandra works is every data in Cassandra is you know sharded across a partition key so each query has to happen on a partition key now the queries that we are doing are just of two varieties. There is no the third variety so we basically have two \nkinds of data which is distributed by two different partition keys on which the queries are happening. So this would be kind of a very good choice here. In place of Kafka,  we could have used an Active MQ or a Rabbit MQ or any other queueing mechanism there's an amazon \nqueue(SQS) also we could have used that but i think Kafka scales much better than most of them so i think it's a fairly good choice here. Other than that in general we definitely need to monitor how are our CPUs and Memory is behaving.  So if I have a CPU spike at certain \npoints in time that is something we need to kind of look at so across the whole infrastructure we need to keep an eye on how my CPU usage  percentage is, how my memory usage percentage is, how my disk usage for Redis is, how my disk usage for elastic search is all of these\n things are what we need to monitor now monitoring could be done through a Grafana kind of a tool on which i can set up alert. So if the let's say a particular metric has some threshold the moment I cross that threshold or with certain conditions I could send out an \nalert and the team could get notified that something is potentially wrong and they need to look at that. this will help us to make sure that we in the end achieve our NFRs that we talked about of latency and high availability. Because let's just say something goes wrong \nlet's just say memory is you know utilize more than what we expected eventually it will lead to some machines going down and eventually it will lead to us having a lower availability that than what we expected so yeah these are the things that we need to monitor and\n alert on. Now in the next section let's look at how this whole thing would be spread across geographies, so for example let's say there's an earthquake in one of the data centers and everything just goes away out of the blue what do we do? So let's look at that next So\n let's say we have these four data centers data center 1, data center 2 data center 3, and data center 4 which are located in different geographical regions across the globe, okay. Now we want to create a topology in a way that we do get low latency and high availability\n okay so one very simple approach that we could do is say that DC 1 is our primary and all the three DC's are our secondary data centers and data is replicated to all the three data centers in near real time okay, so that's okay it's good enough. but it's not very good to \nbe honest because we are just using 25 percent of our capacity as primary which is active and rest three data centers are sitting idle and not really doing anything. So let's try to improvise what we could instead do is divide the data centers and thus the globe into two \nparts.  What we could say is this is region one and this is region two okay now the countries or people accessing our services who are closer to this region(R1) will connect to this region(R1) and the people who are closer to that region(R2) will connect to that \nregion(R2). Now how are we able to do that so the data in a hotel management system is fairly specific to a geography so all the hotels in let's say India can be you know separated from all the hotels in US. Similarly all the rooms all the bookings are now specific to \nhotels and thus specific to geography so we could kind of bifurcate the data as per geography right which gives us the leverage to divide the system into two halves right now what will happen here now let's just say DC1 is the primary in this region(R1) and DC3 is the \nprimary in R2 okay now if DC1 goes down all the data in DC1 is getting replicated to DC2 in near real time so if that goes down DC2 can become active and all the clients who are connecting to DC1 and how will they connect so there will be bunch of clients who are \nconnecting via some DNS to DC1 right if this goes down DNS can flip and connect to DC2 if this link is broken right similar thing can happen on this side so this way what we have is basically dividing our infrastructure into two halves thereby clients who are closer \nto this region are connecting to the servers that are closer to them thus giving them lower latency right. Now we could go even one step further we could say that we'll divide the region into four parts and we could do we could go as much as deep we want into this to \nincrease the latency basically to reduce the latency and increase the availability but i think for all practical purposes at least for a Hotel Booking System this R1 R2 thing is more than sufficient to give us a good enough latency and a very high availability. ",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Now a couple of optimizations you could do. So, let's just say payment is success. You know that key will expire after some time, for sure, right? because it's there in Redis. You don't need to keep that key there you know the payment is success you can evict the key right, \neven if the for the payment failure case you know that payment has failed it will expire after five minutes might as well delete the key then and there, right. So these are certain optimizations that you could do over this implementation to make it even more better. But \non and off this is how the booking flow works. Now again reiterating we have used a couple of important features of MySQL and that's what is helping us to make the code on application side much more smoother had we used some other database which doesn't provide for example \nif you were using Cassandra here we would not have had access to the transactions and the constraints and all of that you would have to implement it on application side. That's additional effort on our side to make sure things are consistent. in this case I would rather \nleave it to MySQL to implement all of those things.  Now coming back to the same architecture again i just want to call out that all of the components that you see here are individually horizontally scalable so let's just say there's a traffic spike happening on one of the \ncomponents we could increase the number of nodes in that particular service maybe that particular database and then that should work just fine. As far as Kafka and hadoop cluster are concerned we could add more nodes into that as well and they should also scale to a much \nlarger scale than what we need. Cool, so now let's look at what kind of alternates that we could have used instead of this particular design choice. So first of all why MySQL, we could use any other relational database here. We could use a Postgres we could use a SQL \nServer, anything which provides ACID guarantees should be fairly fine here. As far as Redis is concerned we could use a memcache or any other cache instead of Redis and that should also be good. Cassandra, I would still stick to Cassandra because that is exactly what we \nneed here now technically in place of Cassandra we could also use a HBase here that would also work fine but it has a lot of operational overhead in terms of deployment and maintaining it over time so that's the reason I would prefer Cassandra over HBase or any other \nsimilar system The way cassandra works is every data in Cassandra is you know sharded across a partition key so each query has to happen on a partition key now the queries that we are doing are just of two varieties. There is no the third variety so we basically have two \nkinds of data which is distributed by two different partition keys on which the queries are happening. So this would be kind of a very good choice here. In place of Kafka,  we could have used an Active MQ or a Rabbit MQ or any other queueing mechanism there's an amazon \nqueue(SQS) also we could have used that but i think Kafka scales much better than most of them so i think it's a fairly good choice here. Other than that in general we definitely need to monitor how are our CPUs and Memory is behaving.  So if I have a CPU spike at certain \npoints in time that is something we need to kind of look at so across the whole infrastructure we need to keep an eye on how my CPU usage  percentage is, how my memory usage percentage is, how my disk usage for Redis is, how my disk usage for elastic search is all of these\n things are what we need to monitor now monitoring could be done through a Grafana kind of a tool on which i can set up alert. So if the let's say a particular metric has some threshold the moment I cross that threshold or with certain conditions I could send out an \nalert and the team could get notified that something is potentially wrong and they need to look at that. this will help us to make sure that we in the end achieve our NFRs that we talked about of latency and high availability. Because let's just say something goes wrong \nlet's just say memory is you know utilize more than what we expected eventually it will lead to some machines going down and eventually it will lead to us having a lower availability that than what we expected so yeah these are the things that we need to monitor and\n alert on. Now in the next section let's look at how this whole thing would be spread across geographies, so for example let's say there's an earthquake in one of the data centers and everything just goes away out of the blue what do we do? So let's look at that next So\n let's say we have these four data centers data center 1, data center 2 data center 3, and data center 4 which are located in different geographical regions across the globe, okay. Now we want to create a topology in a way that we do get low latency and high availability\n okay so one very simple approach that we could do is say that DC 1 is our primary and all the three DC's are our secondary data centers and data is replicated to all the three data centers in near real time okay, so that's okay it's good enough. but it's not very good to \nbe honest because we are just using 25 percent of our capacity as primary which is active and rest three data centers are sitting idle and not really doing anything. So let's try to improvise what we could instead do is divide the data centers and thus the globe into two \nparts.  What we could say is this is region one and this is region two okay now the countries or people accessing our services who are closer to this region(R1) will connect to this region(R1) and the people who are closer to that region(R2) will connect to that \nregion(R2). Now how are we able to do that so the data in a hotel management system is fairly specific to a geography so all the hotels in let's say India can be you know separated from all the hotels in US. Similarly all the rooms all the bookings are now specific to \nhotels and thus specific to geography so we could kind of bifurcate the data as per geography right which gives us the leverage to divide the system into two halves right now what will happen here now let's just say DC1 is the primary in this region(R1) and DC3 is the \nprimary in R2 okay now if DC1 goes down all the data in DC1 is getting replicated to DC2 in near real time so if that goes down DC2 can become active and all the clients who are connecting to DC1 and how will they connect so there will be bunch of clients who are \nconnecting via some DNS to DC1 right if this goes down DNS can flip and connect to DC2 if this link is broken right similar thing can happen on this side so this way what we have is basically dividing our infrastructure into two halves thereby clients who are closer \nto this region are connecting to the servers that are closer to them thus giving them lower latency right. Now we could go even one step further we could say that we'll divide the region into four parts and we could do we could go as much as deep we want into this to \nincrease the latency basically to reduce the latency and increase the availability but i think for all practical purposes at least for a Hotel Booking System this R1 R2 thing is more than sufficient to give us a good enough latency and a very high availability. ",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 512,
			"versionNonce": 421409024,
			"isDeleted": false,
			"id": "Dmk9M_Oi3Xh--fbAyX8Hf",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 4595.747965216696,
			"y": -399.2034622523897,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2802.2394494704527,
			"height": 12362.132718937253,
			"seed": 1475886586,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 524,
			"versionNonce": 869883648,
			"isDeleted": false,
			"id": "9RfWs4di",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 4685.792042020975,
			"y": -364.42792750909393,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1136.71875,
			"height": 312,
			"seed": 755526310,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Amazon\n\ncode karle approach\n\nFR                                       NFR\n- search\n- (tell them if it is delivarable        low latency\nto a certain pincode or not)             high availability (search + view orders + view products)\n- add/remove to cart                     high consistency (payment + inventory counting)\n- checkout                               scalable\n- view past orders                       \n\n",
			"rawText": "Amazon\n\ncode karle approach\n\nFR                                       NFR\n- search\n- (tell them if it is delivarable        low latency\nto a certain pincode or not)             high availability (search + view orders + view products)\n- add/remove to cart                     high consistency (payment + inventory counting)\n- checkout                               scalable\n- view past orders                       \n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Amazon\n\ncode karle approach\n\nFR                                       NFR\n- search\n- (tell them if it is delivarable        low latency\nto a certain pincode or not)             high availability (search + view orders + view products)\n- add/remove to cart                     high consistency (payment + inventory counting)\n- checkout                               scalable\n- view past orders                       \n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 111,
			"versionNonce": 405803264,
			"isDeleted": false,
			"id": "DBFndP1ww49IcpdCDUaVB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 4671.973189954351,
			"y": -30.58975826119513,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1129,
			"height": 599,
			"seed": 1656938918,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "3372d8a497d5fbd694405bb4cfcb847d686f7da4",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 109,
			"versionNonce": 1331003136,
			"isDeleted": false,
			"id": "dWvRSAedlCgSCleP_OlEE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 2440.3064484953256,
			"y": 8451.439775993205,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1169.2667311719777,
			"height": 617.9249877929688,
			"seed": 1196850214,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996512,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "342aac54a4f3b8786bb876ee31445c3eb57a2068",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 110,
			"versionNonce": 436596992,
			"isDeleted": false,
			"id": "R8-5OqkC2zYzL0H9DTidq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 4671.18594437055,
			"y": 652.2300256981705,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1289.5825832201087,
			"height": 617.9249877929688,
			"seed": 1757452794,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "ab7fbd7e160c7216f5704f6bd1f6f7b43eaebd10",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 1716363008,
			"isDeleted": false,
			"id": "FM420z12",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 4727.9022111331,
			"y": 1409.576703136905,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2132.8125,
			"height": 9672,
			"seed": 1737913914,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Things in green are basically the user interfaces. It could be browsers, mobile applications, anything.These two are basically not just load balancers but also reverse proxies and an\n\nauthorization and authentication layer in between that will authenticate all therequests that are coming from outside world into our system. All the things in\n\nblue that you see here are basically the services that we have built. It could beKafka consumers, could be Spark jobs could be anything. And the things in red are\n\nbasically the databases or any clusters could be Kafka Cluster/Hadoop clusteror any public facing thing that we've used. Now let's look at the user\n\ninterface what all we'll have. So we mainly have two user interfaces.One is the home screen which would be the first screen that a user comes to it would by\n\ndefault have some recommendations based on some past record of that user, or in caseof new user some general recommendations. In case of search page it would just be\n\na text box where in user head put in a text and will give them the search results.With that let's look at how the data flow begins. So a company like Amazon\n\nwould have various suppliers that they would have integrated with nowthese suppliers would be managed by various services on the supplier front\n\nokay. I am abstracting out all of them assomething called as an Inbound Service. What that does is basically it talks to\n\nvarious supplier system and get all of the dataNow let's say new item has come in. Or a supplier is basically onboarding\n\na new item. That information comes through a lot of services and through InboundService into a Kafka. That is basically a supplier word coming into the whole\n\nsearch and user side of things. Now there are multiple consumers on thatKafka, which will process that particular piece of information to flow\n\ninto the user world. Let's look at what that is. So the veryfirst thing that will happen is basically something called as an Item Service.\n\nSo Item Service has a lot of peopletalking to it and if I start drawing all the lines, it become too cluttered so\n\nI've not on any connection to item service but item service will be one ofthe important things that listen to this kafka topic and what it does is\n\nit basically on board a new item.  Now it also is basically the source of truthfor all items in the ecosystem.  So it will provide various APIs to get an\n\nitem by item ID, add a new item, remove an item,update details of a particular item and it will also have an important API to bulk\n\nGET a lot of items. So get a GET API with a lot of item IDs and it is in response itgives details about all of those items. Now Item Service sits on top of a\n\nMongoDB. Why do we need a Mongo here?  - So item information is fundamentallyvery non structured. Different item types will have different attributes and all\n\nof that needs to be stored in a queriable format. Now if we try to model that in astructured form into MySQL kind of database that will not be an optimimal choice.\n\nSo that's why we've used a Mongo. To take an example, let's say if you look ifyou look at attributes of some products like a shirt, it would have a size\n\nattribute and it would probably have a color attribute right. Like a large sizet-shirt of red color. If you look at something like a television, it will have\n\na screen size, saying a 55 inch TV with the led display kind of a thing. There could beother things like a bread, which could have a type and weight. Like 400 grams of\n\nbread of which is of wheat bread or a sweet bread or something of that sort.So, it's a fairly non-structured data and that's the reason I use a Mongo database here.\n\nNow, coming to other consumers that will be sitting on that Kafka.So on this Kafka, there is something called as a Search Consumer. What this\n\ndoes is basically whenever a new item comes in, this search consumer isresponsible for making sure that item is now available for the users to query on.\n\nSo what it does is all the items that are coming in it basically reads throughall of those items. It puts that in a format\n\nthat the search system understands and it stores it into its database.Now, search uses a database called Elastic search, which is again a NoSQL\n\ndatabase, which is very efficient at doing text-based queries. Now this wholesearch will happen either on the product name or product description and maybe it\n\nwill have some filters on the product attributes. Those kind of things issomething that elastic search is very good at. Plus in some cases you might\n\nalso want to do a fuzzy search, which is also supported very well by Elastic Search.Now on top of this Elastic Search, there is something called as a Search Service.\n\nThis Search Service is basically an interface that talks to the front endor any other component that wants to search anything within the ecosystem.\n\nIt provides various kinds of APIs to filter products, to search by a particularstring or anything of that sort. And the contract between Search Service and\n\nSearch Consumer is fixed so both of them understand what is the type of data thatis stored within Elastic Search. That is the reason consumer is able to write it\n\nand the Search Service is able to search for it. Now, once .. a user wants to searchsomething, there are two main things around it.  One is basically trying to\n\nfigure out the right set of items that needs to be displayed but there is alsoan important aspect that we should not show items that we cannot deliver to the\n\ncustomers. So for example, if a customer is staying in a very remote locationand if we are not able to deliver big sized items like refrigerator to that\n\npin code, we should not really show that search result to the user as wellbecause otherwise it's a bad experience that he will see the result but you will\n\nnot be able to order it, right.  So search service talks  to something called as aServiceability and TAT(Turn Around Time) Service. This basically does a lot of things\n\nfirst of all it tries to figure out that, where exactly the product is. In what allwarehouses. Now given one of those Warehouse or some of those warehouses, it\n\ntries to see - do I have a way to deliver products from  this warehouse to the customer's pincode?and if I have, then what kind of products can I carry on\n\nthat route. Now certain routes can carry all kinds of products but certain routesmight not be able to carry things like big products or\n\nother kind of product, right. So all of those filtering stays within theServiceability and TAT Service. Now it also does one more thing that it tells\n\nyou in how much time I will be able to deliver, okay. So it would be like innumber of hours or days or anything of that sort it can say that probably I\n\nwill be able to deliver it in 12 hours,  or 24 hours or something of that sort.Now if serviceability tells that I\n\ncannot deliver, search will simply filter out those results and ignore that andreturn the rest of the remaining things. Now Search might talk to User Service.\n\nThere's something called as a User Service here. We'll get into thatlater but the User Service is basically a service that is the source of true so\n\nfor the user data and it(Search) can query that(User  Service) to fetch some attributes of userprobably a default address or something of that sort, which can be used basically\n\nwhich can be passed as an argument to Serviceability Service to check whetherI can deliver it or not, okay.  Now Search Service returns the response to the\n\nuser which can be rendered and the people can see whatever you knowthey want to see. Now each time a Search happens, an event is basically put into Kafka.\n\nThe reason behind this is whenever somebody is searching for something theyare basically telling you an intent to buy a kind of product, right? That is\n\na very good source for building a Recommendation. We'll look at howRecommendation can be build later on, but this is an input into the recommendation\n\nengine and we will be using a Kafka to pass it along.So each search query goes into Kafka, saying this user ID searched for\n\nthis particular product. Now from the Search Screen user could be able towishlist a particular product or add it to cart and buy it, right? All of those\n\ncould be done using the Wishlist Service and Cart Service.Wishlist Service is the repository of all the wish lists in the ecosystem and\n\nthe cart services by repository of all the carts in the ecosystem. Carts are basicallya shopping bag, which when people put product into it and then\n\ncheckout.  Now both these services are built in exactly the same way(almost). Theyprovide APIs to add a product into user's cart or wishlist. Get a user's\n\nCart or Wishlist. Or delete a particular item from that.And they would have a very similar data model and they are both sitting on\n\ntheir own MySQL databases. Now from a hardware standpoint I'd like to keepthese two  as separate Hardwares. Just in case, for example Wishlist size becomes too\n\nbig and it needs to scale out so we can scale this particular clusteraccordingly. But otherwise functionally both of them are totally same.\n\nNow each time, a person is putting a product into Wishlist, they areagain giving you signal. Each time they are adding something into their cart\n\nthey are again giving a signal, about their preferences, things that likethat they want to buy and all of that, right? All of those could again be put\n\ninto Kafka for a very similar kind of analytics.  Now let's look at what thoseanalytics would be? - So from this Kafka there would be something like a\n\nSpark Streaming Consumer. One of the very first things that itdoes is - kind of come up with some kind of reports on what products people are\n\nbuying right now. Those would be things like coming up with the report sayingwhat was the most bought item in the last 30 minutes, or what was the most\n\nWishlisted listed item in last 30 minutes, or in Electronics category what whichproduct is the most sought-after product. So all of those would be inferred by\n\nthis Spark Streaming. Other than that it also puts all the data to Hadoopsaying this user has liked this product, this user has searched for this product\n\nanything that happens, right. On top of it, we could run various ML Algorithms. I'vetalked about those in detail in another video(Netflix Video), but the idea is - given a user and a\n\ncertain kinds of products that they like, we could be able to figure of two kindsof information. One is what other products this user might like okay and\n\nthe other thing is how similar is this user to other users and based onproducts that other users have already purchased we would recommend a\n\nparticular product to the user. So all of those is calculated by this Spark Clusteron top of which we can run various ML jobs to come up with this data.\n\nOnce we calculate those recommendations,  this Spark Cluster basically talks tosomething called as a Recommendation Service.\n\nWhich is basically the repository of all the recommendations, and it has various kinds ofrecommendations. One is given a user ID, if you store general recommendations saying\n\nwhat are the most recommended products for this user. And it will also store thesame information for each category. Saying for electronics for this user\n\nthese are the recommendations. For the food kind of a thing, for this user, theseare the recommendations. So when a person is actually on home page they will first\n\nsee all in just general recommendations and if they navigate into a particularcategory they'll see the specific recommendations we are specific to the category.\n\nNow we have skipped a couple of components. User Service is a verystraightforward service which basically you can look at any other of my videos\n\nthat have talked about it in detail(Airbnb Video), but it's a repository of all the users.It provides various API is to Get details of a user, Update details of user and all\n\nof that. It'll sit on top of a MySQL database and a Redis Cache on top of it.Now let's say Search Service wants to get details of a user the way it will\n\nwork is, it will first query Redis to get the details of the user. If theuser is present, it will return from there. But if the user is not present in\n\nRedis it will then query the MySQL Database (one of the slaves of that MYSQLcluster), get the user information, store it in Redis, and return it back.\n\nSo that's how User Services will work. Now there are some other components that are here.One is Logistic Service and one is Warehouse service.\n\nNormally these two components come in once the order is placed. But inthis scenario this Serviceability Service might query either of these two\n\nservices not a runtime, but before catching the information to fetchvarious attributes. So for example it might query this Warehouse Service to get a\n\nrepository of all the items that are in the warehouse or it might query LogisticService to get details of all the pin codes that are existing or maybe details\n\nabout or the Courier Partners that work in a particular locality and all of withthat all of the information this Serviceability Service will basically\n\ncreate a graph kind of a thing saying what is the shortest path to go frompoint A to point B and in how much time can I get there.\n\nNow we have not covered this service in detail. I have also made another video onimplementation of Google Maps. This is very similar to that. So if you\n\nwant to get into details you can look at that(Google Maps Video) but just to just to call it outthis doesn't really do any calculation at runtime. You store all the\n\ninformation in a cache and whenever anybody queries, it willquery the cache and return the results from the cache itself, and no runtime\n\ncalculation because those kind of calculations are fairly slow. And it willpre-calculate all possible requests that can come to it. Basically if there are\n\nN Pincodes and M Warehouses, it will do a M x N and calculate all possiblecombinations of requests that can come to the service, and store it in a cache.\n\nNow let's look at what happens when a User tries to place an order. So the userinteraction, to place an order is represented as this User Burchase Flow.\n\nThis could be access to apps, mobile apps or web browsers or anything. Now wheneverUser says that I am ready to place an order take me to the payment screen\n\nwhich is the last piece in the app flow then basically the request goes tosomething called as the Order Taking Service. Think of Order Taking Service as\n\na part of Order Management System which takes the order.Now Order Management System sits on top of a MySQL database. Why MYSQL? - because if you\n\nlook at order and table form for order, it will have a lot of tables, some withorder information, some with customer information, some with item\n\ninformation and there are a lot of updates that happen on to the OrderDatabase, right, for each order.  Now we need to make sure that those updates are\n\natomic and they can form a transaction so as to make sure that there are nopartial updates happening. And because MYSQL provides that out of the box we\n\nwould leverage that here. So that's why MySQL.  Now whenever this gets calledthe very first thing that happens is a record gets created for an order,\n\nan order ID gets generated. Now the next thing that we do is we put an entryinto this Redis saying, this order ID was created at some point in time and this\n\nrecord expires at some point. Why is it being used, we'll come to. But think of it asan entry that goes in something like - Order id: \"O1\", gets placed\n\nand 10:00 let's say. it expires at 10:05. Something of that sort.Now the record that goes into this MySQL Database has an initial status.\n\nThink of it as a Status of: \"CREATED\". So basically the record thatgoes into this table is something like - order O1, was created at 10:00 with\n\nstatus: \"CREATED\". You can have different set of names also that's fine.The third thing that happens is we basically call Inventory Service. The idea of\n\ncalling Invented Service is we want to block the inventory. So let's say ifthere were five units of a television that a user wanted to purchase, we will\n\nreduce the inventory count at this point in time, and then send the user to payment.Why do we do that? - Let's just say there was just one TV and three users want to\n\ncome in at the same time. Now we want to make sure only one of them buys the TVand for two of them it should show that it is out of stock, right? We can easily\n\nenforce that, through this Inventory Service, by having a constraint on to thetable which has the 'count' column saying that 'count' cannot go negative. Now each\n\ntime you basically want to place that order for a TV, only one of the.. if thecount is one, only one of the users will be able to do that transaction where the\n\ncount reduces. For the other two, it'll be a Constraint Violation Exception becausethe count cannot be negative. So only one of them will go through with the\n\ninventory, right! Now once the inventory is updated then the user is taken tosomething called as a Payment Service. Think of it as an abstraction over the\n\nwhole payment flow where in this service talks to your Payment Gateways and takescare of all of the interaction with the payment. We will not go into details\n\nof how that works, but the interaction with the Payment Service can lead to two-threeoutcomes. One of them is that payment service could come back saying the payment was\n\nsuccessful. Or it could say that the payment failed due to some reason, couldbe a lot of reasons. Or the person could just close the browser window after\n\ngoing to the payment gateway and not come backin which case payment service would not give a response. So these are there are\n\nthese three possibilities. Now let's see what can happen, okay. So one of the veryfirst thing that can happen is let's just say\n\nat 10:01, we got a confirmation from Payment saying payment was successful.In that case it'll.. the order would get confirmed, right. So let's say we call it\n\nand that status is now \"PLACED\", or any other name for that matter. So nowonce the payment has been successful, we update the status of the order over here\n\nin the database saying that order is PLACED. Now the work is done. At thatpoint in time an event would be send in to Kafka, staying an order has been\n\nplaced, with so-and-so details, okay! Another option - it could(Payment Service) couldcome back saying that.. the payment failed. Let's say there was no money in\n\nthe account or whatever happened.  Now once the payment has failed, we need todo a lot of things. First of all, we need to cancel the order, because the payment\n\nhas not happened. So let's say the other possible scenario is the order could beCANCELLED, right? Now.. if the payment has failed\n\nwe need to increment the inventory count again. so we'll basically again callInventory Service and saying that - you decremented the quantity for this\n\nparticular order ID, now let's increment it back. So that's a rollback transactionkind of a thing, that is happening here, okay. So that is one more thing we'll do.\n\nAnd also we'll have a Reconciliation Service that sits on top of this wholesystem which reconciles basically checks every once in a while that if there were\n\nten orders overall I do have the correct inventory count at the end, just to handlecases with due to some reason we missed update of inventory count or the write\n\nfail. So all of those scenarios can be handled by the Reconciliation flow.Now there is one more scenario that can happen. Payment Service could not at all\n\ncome back, right? The user close the browser window, the flow ends there,payment service doesn't respond back to us. Now what do we do? We can't keep the\n\ninventive blocked. So let's say there was just one television available this userhas gone to the payment screen, closed the window and gone away. Now we still have\n\nthat one television physically available in our warehouse but the database saysit's not available. We need to bring it back, right. So for\n\nthat the Redis comes in. So at 10:05 what will happen is Redisthis record will get expired, right.  Redis will have a will have a expiry. We'll have a expiry\n\ncall back on top of Redis which will basically be invoked saying that thisparticular report whatever you insert inserted, it has got expired. Now do\n\nwhatever you want. At that point in time Order Taking Service will catch thatevent and say that now this particular record has expired,\n\nI'll basically follow the same flow that was followed for payment cancellationbasically I'll time out the payment and mark it CANCELLED, okay. So at that point\n\nin time again at 10:05, this order would be moved to CANCELLED State in the Databaseand the inventory would get updated back again, right. So everything is good but\n\nthere are a couple of scenarios here.  So there could be potential risk conditions.What happens if your payment success event and your expiry happens at the\n\nsame time. What do you do then? So there are two three scenarios in which itwould happen. The first scenario is that payment success comes first and then\n\nexpiry happens. So in that... that is a scenario that will always happen.So whenever a payment is success let's say at 10:01 payment got success\n\nanywhere at 10:05 this expiry would have happened, right? So this is something thatis bound to happen for all the  the orders. So one optimization we could do\n\nhere is each time we get a payment success or payment failure event, we candelete the entry form Redis, so as to make sure it's expiry event does not come in.\n\nThe other scenario is that expiry comes first and then paymentsuccess. Now whenever we would have got.. let's say expiry came at 10:05 and\n\npayment success happens at 10:07. Now whenever we get the expiry event wewould have canceled the order, we would have decremented the inventory count.\n\nBut now the payment has happened, that we got to know. There we could do 2-3 things.We could either refund the money back to the customers saying that for\n\nwhatever reason we are not able to process, here's your money back. Alternatively,we could also say that now we have anyway got the money from the customer. We know\n\nwhat the person was able to... was trying to order. Due to a issue one our sidepossibly the order didn't go through. So we could\n\ncreate a new order mark this payment for that order, and then put that directlyinto PLACED status. So that is another thing that we could do.\n\nAssuming for all the orders as soon as we get a payment success and paymentfailure, we will delete these entries from Redis so to make sure there are no..\n\nthese conditions do not happen too frequently. That will help us to save thememory footprint as well, because the lesser amount of data we have in\n\nRedis, the lesser RAM it would consume, and it will be much more efficient okay.Now one thing I want to call out about this Redis expiry is - this is not very\n\naccurate. So let's say if it was the supposed to expire at 10:05, we might not getthe call back exactly a 10:05. We might get a callback at 10:06, 10:07 or sometime\n\nafter 10:05 and that is because of the way it is expiry works. So Redis doesn'texpire all the records at that point in time. It basically it checks all the\n\nrecords every once in a while for expiry and whenever it finds some of the docs/some of the keys that are expired then it expires that. So it might happen\n\nthat it'll expire after a few minutes. Now in this scenario it doesn't really matterso I think we should be okay with this kind of an approach but if you are\n\ntrying to do something which is much more mission-critical, then possibly youmight have to do a different approach. But even you should talk\n\nabout this to your interviewer, and if they say then you might also change theimplementation a bit. You might implement a queue and keep polling that queue every\n\nsecond or something of that sort. Okay. Now once the payment has happenedor not happened or whatever happened, you would put all of those events into Kafka\n\nanyway. There is one more reason why you want to put two events. So let's saythere was this one item one television left okay and somebody has purchased\n\nthat. Now you want to make sure that nobody else is able to see thetelevision because anyway the count has become.. inventory count has become zero\n\nyou cannot take an order, right. So you need to... basically make sure that itshould be removed from search.  Now remember there was a Search Consumer\n\nthat we looked at in the previous section. That Search Consumer wouldalso take care of inventory kind of things. So as soon as an item goes out of stock\n\nit would basically remove that element from in the listing. Basically it willremove the documents pertaining to that particular set of items. Now there is one\n\nproblem in this whole thing that we have decided/built. This MySQL can veryquickly become a bottleneck. Way? - Because there are a lot of Orders. So for\n\na company like Amazon they will probably have like millions of Orders in a day acouple of millions at-least. And that number could bloat up significantly\n\nover an year. And normally you would have to keep Order Data for a couple of yearsfor auditing purposes, right. So this Database is going massively big. we need to\n\ndo something about it. So remember the whole use case of having this MySQLis to take care of atomicity, transaction, basically the acid properties for orders that are\n\nbeing updated. But for the orders that are not being updated, we don't reallyneed any of these functionalities, right. So what we can do is once you order\n\nreaches a terminal state, let's just say an order is DELIVERED or CANCELLED, wecan basically move it to Cassandra. So there is something called as Archival\n\nService, which is a cron kind of a thing, which runs every one day/12 hours atsome frequency and it pulls all the orders which have reached the\n\nterminal status from this MYSQL and puts it into Cassandra. Now how does itdo that? - so you can see these two services. There's the Order Processing\n\nService and there's a Historical Order Service. These two are againcomponent of the whole larger Order Management System which are do certain\n\nthings of their own. So Order Processing Service is the service which takes care ofthe whole lifecycle of the order. So once the order has been placed any changes to\n\nthat order happen through this. This will also provide APId to Get the orders ifsomebody wants to get Order details. Again, similarly, Historical Order Service\n\nwill provide all kinds of the APIs to fetch information about HistoricalOrders. Now Archival Service will basically query Order Processing Service\n\nto fetch all the orders who have reached terminal status, get all of those details,call Historical Order Service to insert all of those entries\n\ninto its Cassandra, and once it has got a success saying I've inserted intoCassandra, replicated in all the right places, then it will basically call Order\n\nProcessing Service to delete that. Let's say there is some error, somethingbreaks in between, it will retry the whole thing and because it is idempotent\n\nit doesn't really matter we can replay it as many number of times as we want.Cool. Now coming to the...once the user has placed the order all of the things will\n\nhappen, logistics and all can happen behind the scenes. Now the user can go and seetheir past orders, right. That will be powered by this Orders View. So Orders\n\nView will basically...there will be a service here which kind of is the back end ofOrders View, but that'll clutter the diagram too much. Assume there's a\n\nservice here which talks to the Order View, and that talks to these two services.So basically what it will do is, it will basically query Order Processing Service\n\nto fetch information about all the live orders who are in transit it. It'll callHistorical Order Service for all the orders that have been completed. It will\n\nmerge the data and it will return back to display on the App or website orwherever, cool. Now why did we use a Cassandra here? - So Historical Order\n\nService will be used in a very limited set of query patterns.So some of the queries that will run is:  1) Get information of a\n\nparticular order ID  2) Get all the orders of a particular user ID3) possibly get all the orders of a particular seller. But there will be a\n\nsmall number of type of queries that will run on this Cassandra and Cassandra verygood when you have that finite number of queries(by type) but a large set of data.\n\nthat's the reason we have used Cassandra. Now coming to whenever anorder is placed we want to notify the customer that your order has been successfully\n\nplaced. It will be delivered to in 3 days or something of that sort.You'll have to possibly notify a seller, you might have to notify somebody else\n\nor when something happens. Let's say an order is cancelled by the seller youwant to notify the customers. So all of those notifications would be taken care\n\nby this Notification Service. Think of it as an abstraction which can abstract outall various kinds of notification like SMSs, Emails and all of that. I made\n\nanother video(on Notification Service Design)  which talks about in detail of how doyou implement Notification Service.  So you can go have a look at that as well.\n\nWhile ... a user is placing all the orders, all of those things are happening,all the events are going into this Kafka on which we are running a Spark Streaming\n\nConsumer. It does a lot of things.  One of the... very first thingsthat it does is it can publish a report saying in the last one hour what are our\n\nitems which have been ordered the most. Or which category has generated the mostamount of revenue like electronics or food or something of that sort, right. So\n\nit can publish out some of the reporting metrics that we want to quickly look at.Other than that,  it will also put the whole of the data into Hadoop cluster. Now we have\n\nreal order information of a user which is a very good thing for recommendationsSo on top of it, will have some spark jobs which will run some very\n\nstandard ALS kind of algorithms, which would be predicting that this particularuser, given that he's ordered certain things in the past, what are the next set\n\nof things that this person might order. Or because this customer lookslike that customer and that customer ordered so-and-so product, so this\n\ncustomer might also order so-and-so product. So there could be, a lot of kind ofmodels that you can run to predict what are the right set of recommendations for\n\nthis user, which would be then send to this Recommendation Service which we lookedat in the last section, it will store it into its Cassandra and the next time when\n\nthe user comes in, we'll show them those kind of recommendations. It would notjust have like recommendations based on your orders but also similarity, so again\n\ntaking the same example if you have ordered a white board you willdefinitely want to order marker. So all of those things would also be taken care by this.",
			"rawText": "Things in green are basically the user interfaces. It could be browsers, mobile applications, anything.These two are basically not just load balancers but also reverse proxies and an\n\nauthorization and authentication layer in between that will authenticate all therequests that are coming from outside world into our system. All the things in\n\nblue that you see here are basically the services that we have built. It could beKafka consumers, could be Spark jobs could be anything. And the things in red are\n\nbasically the databases or any clusters could be Kafka Cluster/Hadoop clusteror any public facing thing that we've used. Now let's look at the user\n\ninterface what all we'll have. So we mainly have two user interfaces.One is the home screen which would be the first screen that a user comes to it would by\n\ndefault have some recommendations based on some past record of that user, or in caseof new user some general recommendations. In case of search page it would just be\n\na text box where in user head put in a text and will give them the search results.With that let's look at how the data flow begins. So a company like Amazon\n\nwould have various suppliers that they would have integrated with nowthese suppliers would be managed by various services on the supplier front\n\nokay. I am abstracting out all of them assomething called as an Inbound Service. What that does is basically it talks to\n\nvarious supplier system and get all of the dataNow let's say new item has come in. Or a supplier is basically onboarding\n\na new item. That information comes through a lot of services and through InboundService into a Kafka. That is basically a supplier word coming into the whole\n\nsearch and user side of things. Now there are multiple consumers on thatKafka, which will process that particular piece of information to flow\n\ninto the user world. Let's look at what that is. So the veryfirst thing that will happen is basically something called as an Item Service.\n\nSo Item Service has a lot of peopletalking to it and if I start drawing all the lines, it become too cluttered so\n\nI've not on any connection to item service but item service will be one ofthe important things that listen to this kafka topic and what it does is\n\nit basically on board a new item.  Now it also is basically the source of truthfor all items in the ecosystem.  So it will provide various APIs to get an\n\nitem by item ID, add a new item, remove an item,update details of a particular item and it will also have an important API to bulk\n\nGET a lot of items. So get a GET API with a lot of item IDs and it is in response itgives details about all of those items. Now Item Service sits on top of a\n\nMongoDB. Why do we need a Mongo here?  - So item information is fundamentallyvery non structured. Different item types will have different attributes and all\n\nof that needs to be stored in a queriable format. Now if we try to model that in astructured form into MySQL kind of database that will not be an optimimal choice.\n\nSo that's why we've used a Mongo. To take an example, let's say if you look ifyou look at attributes of some products like a shirt, it would have a size\n\nattribute and it would probably have a color attribute right. Like a large sizet-shirt of red color. If you look at something like a television, it will have\n\na screen size, saying a 55 inch TV with the led display kind of a thing. There could beother things like a bread, which could have a type and weight. Like 400 grams of\n\nbread of which is of wheat bread or a sweet bread or something of that sort.So, it's a fairly non-structured data and that's the reason I use a Mongo database here.\n\nNow, coming to other consumers that will be sitting on that Kafka.So on this Kafka, there is something called as a Search Consumer. What this\n\ndoes is basically whenever a new item comes in, this search consumer isresponsible for making sure that item is now available for the users to query on.\n\nSo what it does is all the items that are coming in it basically reads throughall of those items. It puts that in a format\n\nthat the search system understands and it stores it into its database.Now, search uses a database called Elastic search, which is again a NoSQL\n\ndatabase, which is very efficient at doing text-based queries. Now this wholesearch will happen either on the product name or product description and maybe it\n\nwill have some filters on the product attributes. Those kind of things issomething that elastic search is very good at. Plus in some cases you might\n\nalso want to do a fuzzy search, which is also supported very well by Elastic Search.Now on top of this Elastic Search, there is something called as a Search Service.\n\nThis Search Service is basically an interface that talks to the front endor any other component that wants to search anything within the ecosystem.\n\nIt provides various kinds of APIs to filter products, to search by a particularstring or anything of that sort. And the contract between Search Service and\n\nSearch Consumer is fixed so both of them understand what is the type of data thatis stored within Elastic Search. That is the reason consumer is able to write it\n\nand the Search Service is able to search for it. Now, once .. a user wants to searchsomething, there are two main things around it.  One is basically trying to\n\nfigure out the right set of items that needs to be displayed but there is alsoan important aspect that we should not show items that we cannot deliver to the\n\ncustomers. So for example, if a customer is staying in a very remote locationand if we are not able to deliver big sized items like refrigerator to that\n\npin code, we should not really show that search result to the user as wellbecause otherwise it's a bad experience that he will see the result but you will\n\nnot be able to order it, right.  So search service talks  to something called as aServiceability and TAT(Turn Around Time) Service. This basically does a lot of things\n\nfirst of all it tries to figure out that, where exactly the product is. In what allwarehouses. Now given one of those Warehouse or some of those warehouses, it\n\ntries to see - do I have a way to deliver products from  this warehouse to the customer's pincode?and if I have, then what kind of products can I carry on\n\nthat route. Now certain routes can carry all kinds of products but certain routesmight not be able to carry things like big products or\n\nother kind of product, right. So all of those filtering stays within theServiceability and TAT Service. Now it also does one more thing that it tells\n\nyou in how much time I will be able to deliver, okay. So it would be like innumber of hours or days or anything of that sort it can say that probably I\n\nwill be able to deliver it in 12 hours,  or 24 hours or something of that sort.Now if serviceability tells that I\n\ncannot deliver, search will simply filter out those results and ignore that andreturn the rest of the remaining things. Now Search might talk to User Service.\n\nThere's something called as a User Service here. We'll get into thatlater but the User Service is basically a service that is the source of true so\n\nfor the user data and it(Search) can query that(User  Service) to fetch some attributes of userprobably a default address or something of that sort, which can be used basically\n\nwhich can be passed as an argument to Serviceability Service to check whetherI can deliver it or not, okay.  Now Search Service returns the response to the\n\nuser which can be rendered and the people can see whatever you knowthey want to see. Now each time a Search happens, an event is basically put into Kafka.\n\nThe reason behind this is whenever somebody is searching for something theyare basically telling you an intent to buy a kind of product, right? That is\n\na very good source for building a Recommendation. We'll look at howRecommendation can be build later on, but this is an input into the recommendation\n\nengine and we will be using a Kafka to pass it along.So each search query goes into Kafka, saying this user ID searched for\n\nthis particular product. Now from the Search Screen user could be able towishlist a particular product or add it to cart and buy it, right? All of those\n\ncould be done using the Wishlist Service and Cart Service.Wishlist Service is the repository of all the wish lists in the ecosystem and\n\nthe cart services by repository of all the carts in the ecosystem. Carts are basicallya shopping bag, which when people put product into it and then\n\ncheckout.  Now both these services are built in exactly the same way(almost). Theyprovide APIs to add a product into user's cart or wishlist. Get a user's\n\nCart or Wishlist. Or delete a particular item from that.And they would have a very similar data model and they are both sitting on\n\ntheir own MySQL databases. Now from a hardware standpoint I'd like to keepthese two  as separate Hardwares. Just in case, for example Wishlist size becomes too\n\nbig and it needs to scale out so we can scale this particular clusteraccordingly. But otherwise functionally both of them are totally same.\n\nNow each time, a person is putting a product into Wishlist, they areagain giving you signal. Each time they are adding something into their cart\n\nthey are again giving a signal, about their preferences, things that likethat they want to buy and all of that, right? All of those could again be put\n\ninto Kafka for a very similar kind of analytics.  Now let's look at what thoseanalytics would be? - So from this Kafka there would be something like a\n\nSpark Streaming Consumer. One of the very first things that itdoes is - kind of come up with some kind of reports on what products people are\n\nbuying right now. Those would be things like coming up with the report sayingwhat was the most bought item in the last 30 minutes, or what was the most\n\nWishlisted listed item in last 30 minutes, or in Electronics category what whichproduct is the most sought-after product. So all of those would be inferred by\n\nthis Spark Streaming. Other than that it also puts all the data to Hadoopsaying this user has liked this product, this user has searched for this product\n\nanything that happens, right. On top of it, we could run various ML Algorithms. I'vetalked about those in detail in another video(Netflix Video), but the idea is - given a user and a\n\ncertain kinds of products that they like, we could be able to figure of two kindsof information. One is what other products this user might like okay and\n\nthe other thing is how similar is this user to other users and based onproducts that other users have already purchased we would recommend a\n\nparticular product to the user. So all of those is calculated by this Spark Clusteron top of which we can run various ML jobs to come up with this data.\n\nOnce we calculate those recommendations,  this Spark Cluster basically talks tosomething called as a Recommendation Service.\n\nWhich is basically the repository of all the recommendations, and it has various kinds ofrecommendations. One is given a user ID, if you store general recommendations saying\n\nwhat are the most recommended products for this user. And it will also store thesame information for each category. Saying for electronics for this user\n\nthese are the recommendations. For the food kind of a thing, for this user, theseare the recommendations. So when a person is actually on home page they will first\n\nsee all in just general recommendations and if they navigate into a particularcategory they'll see the specific recommendations we are specific to the category.\n\nNow we have skipped a couple of components. User Service is a verystraightforward service which basically you can look at any other of my videos\n\nthat have talked about it in detail(Airbnb Video), but it's a repository of all the users.It provides various API is to Get details of a user, Update details of user and all\n\nof that. It'll sit on top of a MySQL database and a Redis Cache on top of it.Now let's say Search Service wants to get details of a user the way it will\n\nwork is, it will first query Redis to get the details of the user. If theuser is present, it will return from there. But if the user is not present in\n\nRedis it will then query the MySQL Database (one of the slaves of that MYSQLcluster), get the user information, store it in Redis, and return it back.\n\nSo that's how User Services will work. Now there are some other components that are here.One is Logistic Service and one is Warehouse service.\n\nNormally these two components come in once the order is placed. But inthis scenario this Serviceability Service might query either of these two\n\nservices not a runtime, but before catching the information to fetchvarious attributes. So for example it might query this Warehouse Service to get a\n\nrepository of all the items that are in the warehouse or it might query LogisticService to get details of all the pin codes that are existing or maybe details\n\nabout or the Courier Partners that work in a particular locality and all of withthat all of the information this Serviceability Service will basically\n\ncreate a graph kind of a thing saying what is the shortest path to go frompoint A to point B and in how much time can I get there.\n\nNow we have not covered this service in detail. I have also made another video onimplementation of Google Maps. This is very similar to that. So if you\n\nwant to get into details you can look at that(Google Maps Video) but just to just to call it outthis doesn't really do any calculation at runtime. You store all the\n\ninformation in a cache and whenever anybody queries, it willquery the cache and return the results from the cache itself, and no runtime\n\ncalculation because those kind of calculations are fairly slow. And it willpre-calculate all possible requests that can come to it. Basically if there are\n\nN Pincodes and M Warehouses, it will do a M x N and calculate all possiblecombinations of requests that can come to the service, and store it in a cache.\n\nNow let's look at what happens when a User tries to place an order. So the userinteraction, to place an order is represented as this User Burchase Flow.\n\nThis could be access to apps, mobile apps or web browsers or anything. Now wheneverUser says that I am ready to place an order take me to the payment screen\n\nwhich is the last piece in the app flow then basically the request goes tosomething called as the Order Taking Service. Think of Order Taking Service as\n\na part of Order Management System which takes the order.Now Order Management System sits on top of a MySQL database. Why MYSQL? - because if you\n\nlook at order and table form for order, it will have a lot of tables, some withorder information, some with customer information, some with item\n\ninformation and there are a lot of updates that happen on to the OrderDatabase, right, for each order.  Now we need to make sure that those updates are\n\natomic and they can form a transaction so as to make sure that there are nopartial updates happening. And because MYSQL provides that out of the box we\n\nwould leverage that here. So that's why MySQL.  Now whenever this gets calledthe very first thing that happens is a record gets created for an order,\n\nan order ID gets generated. Now the next thing that we do is we put an entryinto this Redis saying, this order ID was created at some point in time and this\n\nrecord expires at some point. Why is it being used, we'll come to. But think of it asan entry that goes in something like - Order id: \"O1\", gets placed\n\nand 10:00 let's say. it expires at 10:05. Something of that sort.Now the record that goes into this MySQL Database has an initial status.\n\nThink of it as a Status of: \"CREATED\". So basically the record thatgoes into this table is something like - order O1, was created at 10:00 with\n\nstatus: \"CREATED\". You can have different set of names also that's fine.The third thing that happens is we basically call Inventory Service. The idea of\n\ncalling Invented Service is we want to block the inventory. So let's say ifthere were five units of a television that a user wanted to purchase, we will\n\nreduce the inventory count at this point in time, and then send the user to payment.Why do we do that? - Let's just say there was just one TV and three users want to\n\ncome in at the same time. Now we want to make sure only one of them buys the TVand for two of them it should show that it is out of stock, right? We can easily\n\nenforce that, through this Inventory Service, by having a constraint on to thetable which has the 'count' column saying that 'count' cannot go negative. Now each\n\ntime you basically want to place that order for a TV, only one of the.. if thecount is one, only one of the users will be able to do that transaction where the\n\ncount reduces. For the other two, it'll be a Constraint Violation Exception becausethe count cannot be negative. So only one of them will go through with the\n\ninventory, right! Now once the inventory is updated then the user is taken tosomething called as a Payment Service. Think of it as an abstraction over the\n\nwhole payment flow where in this service talks to your Payment Gateways and takescare of all of the interaction with the payment. We will not go into details\n\nof how that works, but the interaction with the Payment Service can lead to two-threeoutcomes. One of them is that payment service could come back saying the payment was\n\nsuccessful. Or it could say that the payment failed due to some reason, couldbe a lot of reasons. Or the person could just close the browser window after\n\ngoing to the payment gateway and not come backin which case payment service would not give a response. So these are there are\n\nthese three possibilities. Now let's see what can happen, okay. So one of the veryfirst thing that can happen is let's just say\n\nat 10:01, we got a confirmation from Payment saying payment was successful.In that case it'll.. the order would get confirmed, right. So let's say we call it\n\nand that status is now \"PLACED\", or any other name for that matter. So nowonce the payment has been successful, we update the status of the order over here\n\nin the database saying that order is PLACED. Now the work is done. At thatpoint in time an event would be send in to Kafka, staying an order has been\n\nplaced, with so-and-so details, okay! Another option - it could(Payment Service) couldcome back saying that.. the payment failed. Let's say there was no money in\n\nthe account or whatever happened.  Now once the payment has failed, we need todo a lot of things. First of all, we need to cancel the order, because the payment\n\nhas not happened. So let's say the other possible scenario is the order could beCANCELLED, right? Now.. if the payment has failed\n\nwe need to increment the inventory count again. so we'll basically again callInventory Service and saying that - you decremented the quantity for this\n\nparticular order ID, now let's increment it back. So that's a rollback transactionkind of a thing, that is happening here, okay. So that is one more thing we'll do.\n\nAnd also we'll have a Reconciliation Service that sits on top of this wholesystem which reconciles basically checks every once in a while that if there were\n\nten orders overall I do have the correct inventory count at the end, just to handlecases with due to some reason we missed update of inventory count or the write\n\nfail. So all of those scenarios can be handled by the Reconciliation flow.Now there is one more scenario that can happen. Payment Service could not at all\n\ncome back, right? The user close the browser window, the flow ends there,payment service doesn't respond back to us. Now what do we do? We can't keep the\n\ninventive blocked. So let's say there was just one television available this userhas gone to the payment screen, closed the window and gone away. Now we still have\n\nthat one television physically available in our warehouse but the database saysit's not available. We need to bring it back, right. So for\n\nthat the Redis comes in. So at 10:05 what will happen is Redisthis record will get expired, right.  Redis will have a will have a expiry. We'll have a expiry\n\ncall back on top of Redis which will basically be invoked saying that thisparticular report whatever you insert inserted, it has got expired. Now do\n\nwhatever you want. At that point in time Order Taking Service will catch thatevent and say that now this particular record has expired,\n\nI'll basically follow the same flow that was followed for payment cancellationbasically I'll time out the payment and mark it CANCELLED, okay. So at that point\n\nin time again at 10:05, this order would be moved to CANCELLED State in the Databaseand the inventory would get updated back again, right. So everything is good but\n\nthere are a couple of scenarios here.  So there could be potential risk conditions.What happens if your payment success event and your expiry happens at the\n\nsame time. What do you do then? So there are two three scenarios in which itwould happen. The first scenario is that payment success comes first and then\n\nexpiry happens. So in that... that is a scenario that will always happen.So whenever a payment is success let's say at 10:01 payment got success\n\nanywhere at 10:05 this expiry would have happened, right? So this is something thatis bound to happen for all the  the orders. So one optimization we could do\n\nhere is each time we get a payment success or payment failure event, we candelete the entry form Redis, so as to make sure it's expiry event does not come in.\n\nThe other scenario is that expiry comes first and then paymentsuccess. Now whenever we would have got.. let's say expiry came at 10:05 and\n\npayment success happens at 10:07. Now whenever we get the expiry event wewould have canceled the order, we would have decremented the inventory count.\n\nBut now the payment has happened, that we got to know. There we could do 2-3 things.We could either refund the money back to the customers saying that for\n\nwhatever reason we are not able to process, here's your money back. Alternatively,we could also say that now we have anyway got the money from the customer. We know\n\nwhat the person was able to... was trying to order. Due to a issue one our sidepossibly the order didn't go through. So we could\n\ncreate a new order mark this payment for that order, and then put that directlyinto PLACED status. So that is another thing that we could do.\n\nAssuming for all the orders as soon as we get a payment success and paymentfailure, we will delete these entries from Redis so to make sure there are no..\n\nthese conditions do not happen too frequently. That will help us to save thememory footprint as well, because the lesser amount of data we have in\n\nRedis, the lesser RAM it would consume, and it will be much more efficient okay.Now one thing I want to call out about this Redis expiry is - this is not very\n\naccurate. So let's say if it was the supposed to expire at 10:05, we might not getthe call back exactly a 10:05. We might get a callback at 10:06, 10:07 or sometime\n\nafter 10:05 and that is because of the way it is expiry works. So Redis doesn'texpire all the records at that point in time. It basically it checks all the\n\nrecords every once in a while for expiry and whenever it finds some of the docs/some of the keys that are expired then it expires that. So it might happen\n\nthat it'll expire after a few minutes. Now in this scenario it doesn't really matterso I think we should be okay with this kind of an approach but if you are\n\ntrying to do something which is much more mission-critical, then possibly youmight have to do a different approach. But even you should talk\n\nabout this to your interviewer, and if they say then you might also change theimplementation a bit. You might implement a queue and keep polling that queue every\n\nsecond or something of that sort. Okay. Now once the payment has happenedor not happened or whatever happened, you would put all of those events into Kafka\n\nanyway. There is one more reason why you want to put two events. So let's saythere was this one item one television left okay and somebody has purchased\n\nthat. Now you want to make sure that nobody else is able to see thetelevision because anyway the count has become.. inventory count has become zero\n\nyou cannot take an order, right. So you need to... basically make sure that itshould be removed from search.  Now remember there was a Search Consumer\n\nthat we looked at in the previous section. That Search Consumer wouldalso take care of inventory kind of things. So as soon as an item goes out of stock\n\nit would basically remove that element from in the listing. Basically it willremove the documents pertaining to that particular set of items. Now there is one\n\nproblem in this whole thing that we have decided/built. This MySQL can veryquickly become a bottleneck. Way? - Because there are a lot of Orders. So for\n\na company like Amazon they will probably have like millions of Orders in a day acouple of millions at-least. And that number could bloat up significantly\n\nover an year. And normally you would have to keep Order Data for a couple of yearsfor auditing purposes, right. So this Database is going massively big. we need to\n\ndo something about it. So remember the whole use case of having this MySQLis to take care of atomicity, transaction, basically the acid properties for orders that are\n\nbeing updated. But for the orders that are not being updated, we don't reallyneed any of these functionalities, right. So what we can do is once you order\n\nreaches a terminal state, let's just say an order is DELIVERED or CANCELLED, wecan basically move it to Cassandra. So there is something called as Archival\n\nService, which is a cron kind of a thing, which runs every one day/12 hours atsome frequency and it pulls all the orders which have reached the\n\nterminal status from this MYSQL and puts it into Cassandra. Now how does itdo that? - so you can see these two services. There's the Order Processing\n\nService and there's a Historical Order Service. These two are againcomponent of the whole larger Order Management System which are do certain\n\nthings of their own. So Order Processing Service is the service which takes care ofthe whole lifecycle of the order. So once the order has been placed any changes to\n\nthat order happen through this. This will also provide APId to Get the orders ifsomebody wants to get Order details. Again, similarly, Historical Order Service\n\nwill provide all kinds of the APIs to fetch information about HistoricalOrders. Now Archival Service will basically query Order Processing Service\n\nto fetch all the orders who have reached terminal status, get all of those details,call Historical Order Service to insert all of those entries\n\ninto its Cassandra, and once it has got a success saying I've inserted intoCassandra, replicated in all the right places, then it will basically call Order\n\nProcessing Service to delete that. Let's say there is some error, somethingbreaks in between, it will retry the whole thing and because it is idempotent\n\nit doesn't really matter we can replay it as many number of times as we want.Cool. Now coming to the...once the user has placed the order all of the things will\n\nhappen, logistics and all can happen behind the scenes. Now the user can go and seetheir past orders, right. That will be powered by this Orders View. So Orders\n\nView will basically...there will be a service here which kind of is the back end ofOrders View, but that'll clutter the diagram too much. Assume there's a\n\nservice here which talks to the Order View, and that talks to these two services.So basically what it will do is, it will basically query Order Processing Service\n\nto fetch information about all the live orders who are in transit it. It'll callHistorical Order Service for all the orders that have been completed. It will\n\nmerge the data and it will return back to display on the App or website orwherever, cool. Now why did we use a Cassandra here? - So Historical Order\n\nService will be used in a very limited set of query patterns.So some of the queries that will run is:  1) Get information of a\n\nparticular order ID  2) Get all the orders of a particular user ID3) possibly get all the orders of a particular seller. But there will be a\n\nsmall number of type of queries that will run on this Cassandra and Cassandra verygood when you have that finite number of queries(by type) but a large set of data.\n\nthat's the reason we have used Cassandra. Now coming to whenever anorder is placed we want to notify the customer that your order has been successfully\n\nplaced. It will be delivered to in 3 days or something of that sort.You'll have to possibly notify a seller, you might have to notify somebody else\n\nor when something happens. Let's say an order is cancelled by the seller youwant to notify the customers. So all of those notifications would be taken care\n\nby this Notification Service. Think of it as an abstraction which can abstract outall various kinds of notification like SMSs, Emails and all of that. I made\n\nanother video(on Notification Service Design)  which talks about in detail of how doyou implement Notification Service.  So you can go have a look at that as well.\n\nWhile ... a user is placing all the orders, all of those things are happening,all the events are going into this Kafka on which we are running a Spark Streaming\n\nConsumer. It does a lot of things.  One of the... very first thingsthat it does is it can publish a report saying in the last one hour what are our\n\nitems which have been ordered the most. Or which category has generated the mostamount of revenue like electronics or food or something of that sort, right. So\n\nit can publish out some of the reporting metrics that we want to quickly look at.Other than that,  it will also put the whole of the data into Hadoop cluster. Now we have\n\nreal order information of a user which is a very good thing for recommendationsSo on top of it, will have some spark jobs which will run some very\n\nstandard ALS kind of algorithms, which would be predicting that this particularuser, given that he's ordered certain things in the past, what are the next set\n\nof things that this person might order. Or because this customer lookslike that customer and that customer ordered so-and-so product, so this\n\ncustomer might also order so-and-so product. So there could be, a lot of kind ofmodels that you can run to predict what are the right set of recommendations for\n\nthis user, which would be then send to this Recommendation Service which we lookedat in the last section, it will store it into its Cassandra and the next time when\n\nthe user comes in, we'll show them those kind of recommendations. It would notjust have like recommendations based on your orders but also similarity, so again\n\ntaking the same example if you have ordered a white board you willdefinitely want to order marker. So all of those things would also be taken care by this.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Things in green are basically the user interfaces. It could be browsers, mobile applications, anything.These two are basically not just load balancers but also reverse proxies and an\n\nauthorization and authentication layer in between that will authenticate all therequests that are coming from outside world into our system. All the things in\n\nblue that you see here are basically the services that we have built. It could beKafka consumers, could be Spark jobs could be anything. And the things in red are\n\nbasically the databases or any clusters could be Kafka Cluster/Hadoop clusteror any public facing thing that we've used. Now let's look at the user\n\ninterface what all we'll have. So we mainly have two user interfaces.One is the home screen which would be the first screen that a user comes to it would by\n\ndefault have some recommendations based on some past record of that user, or in caseof new user some general recommendations. In case of search page it would just be\n\na text box where in user head put in a text and will give them the search results.With that let's look at how the data flow begins. So a company like Amazon\n\nwould have various suppliers that they would have integrated with nowthese suppliers would be managed by various services on the supplier front\n\nokay. I am abstracting out all of them assomething called as an Inbound Service. What that does is basically it talks to\n\nvarious supplier system and get all of the dataNow let's say new item has come in. Or a supplier is basically onboarding\n\na new item. That information comes through a lot of services and through InboundService into a Kafka. That is basically a supplier word coming into the whole\n\nsearch and user side of things. Now there are multiple consumers on thatKafka, which will process that particular piece of information to flow\n\ninto the user world. Let's look at what that is. So the veryfirst thing that will happen is basically something called as an Item Service.\n\nSo Item Service has a lot of peopletalking to it and if I start drawing all the lines, it become too cluttered so\n\nI've not on any connection to item service but item service will be one ofthe important things that listen to this kafka topic and what it does is\n\nit basically on board a new item.  Now it also is basically the source of truthfor all items in the ecosystem.  So it will provide various APIs to get an\n\nitem by item ID, add a new item, remove an item,update details of a particular item and it will also have an important API to bulk\n\nGET a lot of items. So get a GET API with a lot of item IDs and it is in response itgives details about all of those items. Now Item Service sits on top of a\n\nMongoDB. Why do we need a Mongo here?  - So item information is fundamentallyvery non structured. Different item types will have different attributes and all\n\nof that needs to be stored in a queriable format. Now if we try to model that in astructured form into MySQL kind of database that will not be an optimimal choice.\n\nSo that's why we've used a Mongo. To take an example, let's say if you look ifyou look at attributes of some products like a shirt, it would have a size\n\nattribute and it would probably have a color attribute right. Like a large sizet-shirt of red color. If you look at something like a television, it will have\n\na screen size, saying a 55 inch TV with the led display kind of a thing. There could beother things like a bread, which could have a type and weight. Like 400 grams of\n\nbread of which is of wheat bread or a sweet bread or something of that sort.So, it's a fairly non-structured data and that's the reason I use a Mongo database here.\n\nNow, coming to other consumers that will be sitting on that Kafka.So on this Kafka, there is something called as a Search Consumer. What this\n\ndoes is basically whenever a new item comes in, this search consumer isresponsible for making sure that item is now available for the users to query on.\n\nSo what it does is all the items that are coming in it basically reads throughall of those items. It puts that in a format\n\nthat the search system understands and it stores it into its database.Now, search uses a database called Elastic search, which is again a NoSQL\n\ndatabase, which is very efficient at doing text-based queries. Now this wholesearch will happen either on the product name or product description and maybe it\n\nwill have some filters on the product attributes. Those kind of things issomething that elastic search is very good at. Plus in some cases you might\n\nalso want to do a fuzzy search, which is also supported very well by Elastic Search.Now on top of this Elastic Search, there is something called as a Search Service.\n\nThis Search Service is basically an interface that talks to the front endor any other component that wants to search anything within the ecosystem.\n\nIt provides various kinds of APIs to filter products, to search by a particularstring or anything of that sort. And the contract between Search Service and\n\nSearch Consumer is fixed so both of them understand what is the type of data thatis stored within Elastic Search. That is the reason consumer is able to write it\n\nand the Search Service is able to search for it. Now, once .. a user wants to searchsomething, there are two main things around it.  One is basically trying to\n\nfigure out the right set of items that needs to be displayed but there is alsoan important aspect that we should not show items that we cannot deliver to the\n\ncustomers. So for example, if a customer is staying in a very remote locationand if we are not able to deliver big sized items like refrigerator to that\n\npin code, we should not really show that search result to the user as wellbecause otherwise it's a bad experience that he will see the result but you will\n\nnot be able to order it, right.  So search service talks  to something called as aServiceability and TAT(Turn Around Time) Service. This basically does a lot of things\n\nfirst of all it tries to figure out that, where exactly the product is. In what allwarehouses. Now given one of those Warehouse or some of those warehouses, it\n\ntries to see - do I have a way to deliver products from  this warehouse to the customer's pincode?and if I have, then what kind of products can I carry on\n\nthat route. Now certain routes can carry all kinds of products but certain routesmight not be able to carry things like big products or\n\nother kind of product, right. So all of those filtering stays within theServiceability and TAT Service. Now it also does one more thing that it tells\n\nyou in how much time I will be able to deliver, okay. So it would be like innumber of hours or days or anything of that sort it can say that probably I\n\nwill be able to deliver it in 12 hours,  or 24 hours or something of that sort.Now if serviceability tells that I\n\ncannot deliver, search will simply filter out those results and ignore that andreturn the rest of the remaining things. Now Search might talk to User Service.\n\nThere's something called as a User Service here. We'll get into thatlater but the User Service is basically a service that is the source of true so\n\nfor the user data and it(Search) can query that(User  Service) to fetch some attributes of userprobably a default address or something of that sort, which can be used basically\n\nwhich can be passed as an argument to Serviceability Service to check whetherI can deliver it or not, okay.  Now Search Service returns the response to the\n\nuser which can be rendered and the people can see whatever you knowthey want to see. Now each time a Search happens, an event is basically put into Kafka.\n\nThe reason behind this is whenever somebody is searching for something theyare basically telling you an intent to buy a kind of product, right? That is\n\na very good source for building a Recommendation. We'll look at howRecommendation can be build later on, but this is an input into the recommendation\n\nengine and we will be using a Kafka to pass it along.So each search query goes into Kafka, saying this user ID searched for\n\nthis particular product. Now from the Search Screen user could be able towishlist a particular product or add it to cart and buy it, right? All of those\n\ncould be done using the Wishlist Service and Cart Service.Wishlist Service is the repository of all the wish lists in the ecosystem and\n\nthe cart services by repository of all the carts in the ecosystem. Carts are basicallya shopping bag, which when people put product into it and then\n\ncheckout.  Now both these services are built in exactly the same way(almost). Theyprovide APIs to add a product into user's cart or wishlist. Get a user's\n\nCart or Wishlist. Or delete a particular item from that.And they would have a very similar data model and they are both sitting on\n\ntheir own MySQL databases. Now from a hardware standpoint I'd like to keepthese two  as separate Hardwares. Just in case, for example Wishlist size becomes too\n\nbig and it needs to scale out so we can scale this particular clusteraccordingly. But otherwise functionally both of them are totally same.\n\nNow each time, a person is putting a product into Wishlist, they areagain giving you signal. Each time they are adding something into their cart\n\nthey are again giving a signal, about their preferences, things that likethat they want to buy and all of that, right? All of those could again be put\n\ninto Kafka for a very similar kind of analytics.  Now let's look at what thoseanalytics would be? - So from this Kafka there would be something like a\n\nSpark Streaming Consumer. One of the very first things that itdoes is - kind of come up with some kind of reports on what products people are\n\nbuying right now. Those would be things like coming up with the report sayingwhat was the most bought item in the last 30 minutes, or what was the most\n\nWishlisted listed item in last 30 minutes, or in Electronics category what whichproduct is the most sought-after product. So all of those would be inferred by\n\nthis Spark Streaming. Other than that it also puts all the data to Hadoopsaying this user has liked this product, this user has searched for this product\n\nanything that happens, right. On top of it, we could run various ML Algorithms. I'vetalked about those in detail in another video(Netflix Video), but the idea is - given a user and a\n\ncertain kinds of products that they like, we could be able to figure of two kindsof information. One is what other products this user might like okay and\n\nthe other thing is how similar is this user to other users and based onproducts that other users have already purchased we would recommend a\n\nparticular product to the user. So all of those is calculated by this Spark Clusteron top of which we can run various ML jobs to come up with this data.\n\nOnce we calculate those recommendations,  this Spark Cluster basically talks tosomething called as a Recommendation Service.\n\nWhich is basically the repository of all the recommendations, and it has various kinds ofrecommendations. One is given a user ID, if you store general recommendations saying\n\nwhat are the most recommended products for this user. And it will also store thesame information for each category. Saying for electronics for this user\n\nthese are the recommendations. For the food kind of a thing, for this user, theseare the recommendations. So when a person is actually on home page they will first\n\nsee all in just general recommendations and if they navigate into a particularcategory they'll see the specific recommendations we are specific to the category.\n\nNow we have skipped a couple of components. User Service is a verystraightforward service which basically you can look at any other of my videos\n\nthat have talked about it in detail(Airbnb Video), but it's a repository of all the users.It provides various API is to Get details of a user, Update details of user and all\n\nof that. It'll sit on top of a MySQL database and a Redis Cache on top of it.Now let's say Search Service wants to get details of a user the way it will\n\nwork is, it will first query Redis to get the details of the user. If theuser is present, it will return from there. But if the user is not present in\n\nRedis it will then query the MySQL Database (one of the slaves of that MYSQLcluster), get the user information, store it in Redis, and return it back.\n\nSo that's how User Services will work. Now there are some other components that are here.One is Logistic Service and one is Warehouse service.\n\nNormally these two components come in once the order is placed. But inthis scenario this Serviceability Service might query either of these two\n\nservices not a runtime, but before catching the information to fetchvarious attributes. So for example it might query this Warehouse Service to get a\n\nrepository of all the items that are in the warehouse or it might query LogisticService to get details of all the pin codes that are existing or maybe details\n\nabout or the Courier Partners that work in a particular locality and all of withthat all of the information this Serviceability Service will basically\n\ncreate a graph kind of a thing saying what is the shortest path to go frompoint A to point B and in how much time can I get there.\n\nNow we have not covered this service in detail. I have also made another video onimplementation of Google Maps. This is very similar to that. So if you\n\nwant to get into details you can look at that(Google Maps Video) but just to just to call it outthis doesn't really do any calculation at runtime. You store all the\n\ninformation in a cache and whenever anybody queries, it willquery the cache and return the results from the cache itself, and no runtime\n\ncalculation because those kind of calculations are fairly slow. And it willpre-calculate all possible requests that can come to it. Basically if there are\n\nN Pincodes and M Warehouses, it will do a M x N and calculate all possiblecombinations of requests that can come to the service, and store it in a cache.\n\nNow let's look at what happens when a User tries to place an order. So the userinteraction, to place an order is represented as this User Burchase Flow.\n\nThis could be access to apps, mobile apps or web browsers or anything. Now wheneverUser says that I am ready to place an order take me to the payment screen\n\nwhich is the last piece in the app flow then basically the request goes tosomething called as the Order Taking Service. Think of Order Taking Service as\n\na part of Order Management System which takes the order.Now Order Management System sits on top of a MySQL database. Why MYSQL? - because if you\n\nlook at order and table form for order, it will have a lot of tables, some withorder information, some with customer information, some with item\n\ninformation and there are a lot of updates that happen on to the OrderDatabase, right, for each order.  Now we need to make sure that those updates are\n\natomic and they can form a transaction so as to make sure that there are nopartial updates happening. And because MYSQL provides that out of the box we\n\nwould leverage that here. So that's why MySQL.  Now whenever this gets calledthe very first thing that happens is a record gets created for an order,\n\nan order ID gets generated. Now the next thing that we do is we put an entryinto this Redis saying, this order ID was created at some point in time and this\n\nrecord expires at some point. Why is it being used, we'll come to. But think of it asan entry that goes in something like - Order id: \"O1\", gets placed\n\nand 10:00 let's say. it expires at 10:05. Something of that sort.Now the record that goes into this MySQL Database has an initial status.\n\nThink of it as a Status of: \"CREATED\". So basically the record thatgoes into this table is something like - order O1, was created at 10:00 with\n\nstatus: \"CREATED\". You can have different set of names also that's fine.The third thing that happens is we basically call Inventory Service. The idea of\n\ncalling Invented Service is we want to block the inventory. So let's say ifthere were five units of a television that a user wanted to purchase, we will\n\nreduce the inventory count at this point in time, and then send the user to payment.Why do we do that? - Let's just say there was just one TV and three users want to\n\ncome in at the same time. Now we want to make sure only one of them buys the TVand for two of them it should show that it is out of stock, right? We can easily\n\nenforce that, through this Inventory Service, by having a constraint on to thetable which has the 'count' column saying that 'count' cannot go negative. Now each\n\ntime you basically want to place that order for a TV, only one of the.. if thecount is one, only one of the users will be able to do that transaction where the\n\ncount reduces. For the other two, it'll be a Constraint Violation Exception becausethe count cannot be negative. So only one of them will go through with the\n\ninventory, right! Now once the inventory is updated then the user is taken tosomething called as a Payment Service. Think of it as an abstraction over the\n\nwhole payment flow where in this service talks to your Payment Gateways and takescare of all of the interaction with the payment. We will not go into details\n\nof how that works, but the interaction with the Payment Service can lead to two-threeoutcomes. One of them is that payment service could come back saying the payment was\n\nsuccessful. Or it could say that the payment failed due to some reason, couldbe a lot of reasons. Or the person could just close the browser window after\n\ngoing to the payment gateway and not come backin which case payment service would not give a response. So these are there are\n\nthese three possibilities. Now let's see what can happen, okay. So one of the veryfirst thing that can happen is let's just say\n\nat 10:01, we got a confirmation from Payment saying payment was successful.In that case it'll.. the order would get confirmed, right. So let's say we call it\n\nand that status is now \"PLACED\", or any other name for that matter. So nowonce the payment has been successful, we update the status of the order over here\n\nin the database saying that order is PLACED. Now the work is done. At thatpoint in time an event would be send in to Kafka, staying an order has been\n\nplaced, with so-and-so details, okay! Another option - it could(Payment Service) couldcome back saying that.. the payment failed. Let's say there was no money in\n\nthe account or whatever happened.  Now once the payment has failed, we need todo a lot of things. First of all, we need to cancel the order, because the payment\n\nhas not happened. So let's say the other possible scenario is the order could beCANCELLED, right? Now.. if the payment has failed\n\nwe need to increment the inventory count again. so we'll basically again callInventory Service and saying that - you decremented the quantity for this\n\nparticular order ID, now let's increment it back. So that's a rollback transactionkind of a thing, that is happening here, okay. So that is one more thing we'll do.\n\nAnd also we'll have a Reconciliation Service that sits on top of this wholesystem which reconciles basically checks every once in a while that if there were\n\nten orders overall I do have the correct inventory count at the end, just to handlecases with due to some reason we missed update of inventory count or the write\n\nfail. So all of those scenarios can be handled by the Reconciliation flow.Now there is one more scenario that can happen. Payment Service could not at all\n\ncome back, right? The user close the browser window, the flow ends there,payment service doesn't respond back to us. Now what do we do? We can't keep the\n\ninventive blocked. So let's say there was just one television available this userhas gone to the payment screen, closed the window and gone away. Now we still have\n\nthat one television physically available in our warehouse but the database saysit's not available. We need to bring it back, right. So for\n\nthat the Redis comes in. So at 10:05 what will happen is Redisthis record will get expired, right.  Redis will have a will have a expiry. We'll have a expiry\n\ncall back on top of Redis which will basically be invoked saying that thisparticular report whatever you insert inserted, it has got expired. Now do\n\nwhatever you want. At that point in time Order Taking Service will catch thatevent and say that now this particular record has expired,\n\nI'll basically follow the same flow that was followed for payment cancellationbasically I'll time out the payment and mark it CANCELLED, okay. So at that point\n\nin time again at 10:05, this order would be moved to CANCELLED State in the Databaseand the inventory would get updated back again, right. So everything is good but\n\nthere are a couple of scenarios here.  So there could be potential risk conditions.What happens if your payment success event and your expiry happens at the\n\nsame time. What do you do then? So there are two three scenarios in which itwould happen. The first scenario is that payment success comes first and then\n\nexpiry happens. So in that... that is a scenario that will always happen.So whenever a payment is success let's say at 10:01 payment got success\n\nanywhere at 10:05 this expiry would have happened, right? So this is something thatis bound to happen for all the  the orders. So one optimization we could do\n\nhere is each time we get a payment success or payment failure event, we candelete the entry form Redis, so as to make sure it's expiry event does not come in.\n\nThe other scenario is that expiry comes first and then paymentsuccess. Now whenever we would have got.. let's say expiry came at 10:05 and\n\npayment success happens at 10:07. Now whenever we get the expiry event wewould have canceled the order, we would have decremented the inventory count.\n\nBut now the payment has happened, that we got to know. There we could do 2-3 things.We could either refund the money back to the customers saying that for\n\nwhatever reason we are not able to process, here's your money back. Alternatively,we could also say that now we have anyway got the money from the customer. We know\n\nwhat the person was able to... was trying to order. Due to a issue one our sidepossibly the order didn't go through. So we could\n\ncreate a new order mark this payment for that order, and then put that directlyinto PLACED status. So that is another thing that we could do.\n\nAssuming for all the orders as soon as we get a payment success and paymentfailure, we will delete these entries from Redis so to make sure there are no..\n\nthese conditions do not happen too frequently. That will help us to save thememory footprint as well, because the lesser amount of data we have in\n\nRedis, the lesser RAM it would consume, and it will be much more efficient okay.Now one thing I want to call out about this Redis expiry is - this is not very\n\naccurate. So let's say if it was the supposed to expire at 10:05, we might not getthe call back exactly a 10:05. We might get a callback at 10:06, 10:07 or sometime\n\nafter 10:05 and that is because of the way it is expiry works. So Redis doesn'texpire all the records at that point in time. It basically it checks all the\n\nrecords every once in a while for expiry and whenever it finds some of the docs/some of the keys that are expired then it expires that. So it might happen\n\nthat it'll expire after a few minutes. Now in this scenario it doesn't really matterso I think we should be okay with this kind of an approach but if you are\n\ntrying to do something which is much more mission-critical, then possibly youmight have to do a different approach. But even you should talk\n\nabout this to your interviewer, and if they say then you might also change theimplementation a bit. You might implement a queue and keep polling that queue every\n\nsecond or something of that sort. Okay. Now once the payment has happenedor not happened or whatever happened, you would put all of those events into Kafka\n\nanyway. There is one more reason why you want to put two events. So let's saythere was this one item one television left okay and somebody has purchased\n\nthat. Now you want to make sure that nobody else is able to see thetelevision because anyway the count has become.. inventory count has become zero\n\nyou cannot take an order, right. So you need to... basically make sure that itshould be removed from search.  Now remember there was a Search Consumer\n\nthat we looked at in the previous section. That Search Consumer wouldalso take care of inventory kind of things. So as soon as an item goes out of stock\n\nit would basically remove that element from in the listing. Basically it willremove the documents pertaining to that particular set of items. Now there is one\n\nproblem in this whole thing that we have decided/built. This MySQL can veryquickly become a bottleneck. Way? - Because there are a lot of Orders. So for\n\na company like Amazon they will probably have like millions of Orders in a day acouple of millions at-least. And that number could bloat up significantly\n\nover an year. And normally you would have to keep Order Data for a couple of yearsfor auditing purposes, right. So this Database is going massively big. we need to\n\ndo something about it. So remember the whole use case of having this MySQLis to take care of atomicity, transaction, basically the acid properties for orders that are\n\nbeing updated. But for the orders that are not being updated, we don't reallyneed any of these functionalities, right. So what we can do is once you order\n\nreaches a terminal state, let's just say an order is DELIVERED or CANCELLED, wecan basically move it to Cassandra. So there is something called as Archival\n\nService, which is a cron kind of a thing, which runs every one day/12 hours atsome frequency and it pulls all the orders which have reached the\n\nterminal status from this MYSQL and puts it into Cassandra. Now how does itdo that? - so you can see these two services. There's the Order Processing\n\nService and there's a Historical Order Service. These two are againcomponent of the whole larger Order Management System which are do certain\n\nthings of their own. So Order Processing Service is the service which takes care ofthe whole lifecycle of the order. So once the order has been placed any changes to\n\nthat order happen through this. This will also provide APId to Get the orders ifsomebody wants to get Order details. Again, similarly, Historical Order Service\n\nwill provide all kinds of the APIs to fetch information about HistoricalOrders. Now Archival Service will basically query Order Processing Service\n\nto fetch all the orders who have reached terminal status, get all of those details,call Historical Order Service to insert all of those entries\n\ninto its Cassandra, and once it has got a success saying I've inserted intoCassandra, replicated in all the right places, then it will basically call Order\n\nProcessing Service to delete that. Let's say there is some error, somethingbreaks in between, it will retry the whole thing and because it is idempotent\n\nit doesn't really matter we can replay it as many number of times as we want.Cool. Now coming to the...once the user has placed the order all of the things will\n\nhappen, logistics and all can happen behind the scenes. Now the user can go and seetheir past orders, right. That will be powered by this Orders View. So Orders\n\nView will basically...there will be a service here which kind of is the back end ofOrders View, but that'll clutter the diagram too much. Assume there's a\n\nservice here which talks to the Order View, and that talks to these two services.So basically what it will do is, it will basically query Order Processing Service\n\nto fetch information about all the live orders who are in transit it. It'll callHistorical Order Service for all the orders that have been completed. It will\n\nmerge the data and it will return back to display on the App or website orwherever, cool. Now why did we use a Cassandra here? - So Historical Order\n\nService will be used in a very limited set of query patterns.So some of the queries that will run is:  1) Get information of a\n\nparticular order ID  2) Get all the orders of a particular user ID3) possibly get all the orders of a particular seller. But there will be a\n\nsmall number of type of queries that will run on this Cassandra and Cassandra verygood when you have that finite number of queries(by type) but a large set of data.\n\nthat's the reason we have used Cassandra. Now coming to whenever anorder is placed we want to notify the customer that your order has been successfully\n\nplaced. It will be delivered to in 3 days or something of that sort.You'll have to possibly notify a seller, you might have to notify somebody else\n\nor when something happens. Let's say an order is cancelled by the seller youwant to notify the customers. So all of those notifications would be taken care\n\nby this Notification Service. Think of it as an abstraction which can abstract outall various kinds of notification like SMSs, Emails and all of that. I made\n\nanother video(on Notification Service Design)  which talks about in detail of how doyou implement Notification Service.  So you can go have a look at that as well.\n\nWhile ... a user is placing all the orders, all of those things are happening,all the events are going into this Kafka on which we are running a Spark Streaming\n\nConsumer. It does a lot of things.  One of the... very first thingsthat it does is it can publish a report saying in the last one hour what are our\n\nitems which have been ordered the most. Or which category has generated the mostamount of revenue like electronics or food or something of that sort, right. So\n\nit can publish out some of the reporting metrics that we want to quickly look at.Other than that,  it will also put the whole of the data into Hadoop cluster. Now we have\n\nreal order information of a user which is a very good thing for recommendationsSo on top of it, will have some spark jobs which will run some very\n\nstandard ALS kind of algorithms, which would be predicting that this particularuser, given that he's ordered certain things in the past, what are the next set\n\nof things that this person might order. Or because this customer lookslike that customer and that customer ordered so-and-so product, so this\n\ncustomer might also order so-and-so product. So there could be, a lot of kind ofmodels that you can run to predict what are the right set of recommendations for\n\nthis user, which would be then send to this Recommendation Service which we lookedat in the last section, it will store it into its Cassandra and the next time when\n\nthe user comes in, we'll show them those kind of recommendations. It would notjust have like recommendations based on your orders but also similarity, so again\n\ntaking the same example if you have ordered a white board you willdefinitely want to order marker. So all of those things would also be taken care by this.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 141,
			"versionNonce": 639619328,
			"isDeleted": false,
			"id": "fPyBj1ls9u3Z3p5BFyWAs",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 5007.294164408301,
			"y": 11136.857825549529,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1523.3203822742241,
			"height": 816.6689827192369,
			"seed": 221307386,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "91ab27c387504acea080612c47918f652eae3403",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "rectangle",
			"version": 489,
			"versionNonce": 692174592,
			"isDeleted": false,
			"id": "qFKKGbcuHIgEvG9YfcIGk",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7421.893188998503,
			"y": -417.3878032811099,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2601.347136334507,
			"height": 15177.476612566394,
			"seed": 73515002,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 67,
			"versionNonce": 1409134848,
			"isDeleted": false,
			"id": "czQPSYsT",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7492.714457649388,
			"y": -369.04222665287034,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 574.21875,
			"height": 24,
			"seed": 1979915878,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "chat application like whatsapp/facebook messenger",
			"rawText": "chat application like whatsapp/facebook messenger",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "chat application like whatsapp/facebook messenger",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 86,
			"versionNonce": 951181056,
			"isDeleted": false,
			"id": "QPXiLeNcd8c8U0m9C2Wmb",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7472.710644633333,
			"y": -379.044133160898,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 602.1147412598721,
			"height": 52.00988331834776,
			"seed": 1327515942,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 37,
			"versionNonce": 1260359936,
			"isDeleted": false,
			"id": "kyE39vV2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7502.716364157415,
			"y": -269.5232874213907,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 222.65625,
			"height": 24,
			"seed": 1784627962,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "code karle approach",
			"rawText": "code karle approach",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "code karle approach",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 273,
			"versionNonce": 622722816,
			"isDeleted": false,
			"id": "B2J8BJfr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7498.715586292506,
			"y": -187.5076464247142,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 457.03125,
			"height": 192,
			"seed": 747473638,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "FR\n\nsupport one to one chat\ngroup chat, a user can send message\nto group of people\nread receipt (delivered, sent and seen)\nlast seen status of user\n(notification to recipient if online)",
			"rawText": "FR\n\nsupport one to one chat\ngroup chat, a user can send message\nto group of people\nread receipt (delivered, sent and seen)\nlast seen status of user\n(notification to recipient if online)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "FR\n\nsupport one to one chat\ngroup chat, a user can send message\nto group of people\nread receipt (delivered, sent and seen)\nlast seen status of user\n(notification to recipient if online)",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 76,
			"versionNonce": 1124430080,
			"isDeleted": false,
			"id": "qqrJaWo1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8194.848263989537,
			"y": -195.50916400028729,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 199.21875,
			"height": 144,
			"seed": 1113977402,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"rawText": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nlow latency\nhigh availability\nhigh consistency\nscalable",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 123,
			"versionNonce": 1862672128,
			"isDeleted": false,
			"id": "cm9BZbVD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7498.715586292506,
			"y": 92.54577395430732,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 292.96875,
			"height": 120,
			"seed": 1421025850,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Numbers\n\n2B users\n1.6B monthly active users\n65B chat messages/day",
			"rawText": "Numbers\n\n2B users\n1.6B monthly active users\n65B chat messages/day",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Numbers\n\n2B users\n1.6B monthly active users\n65B chat messages/day",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 88,
			"versionNonce": 53432576,
			"isDeleted": false,
			"id": "z4n5iYk4ihPjaIYS527mx",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7505.728481407493,
			"y": 266.70535825952265,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 976.7811561347826,
			"height": 525.7715540925161,
			"seed": 539975418,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "5de2d05313beec61e0728b25c5f33d61d95167cd",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 101,
			"versionNonce": 116014848,
			"isDeleted": false,
			"id": "wx0GRqPHjc5-RAQAzGnzr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7523.243099757072,
			"y": 830.1952977297218,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 608.0012284292603,
			"height": 525.7715540925161,
			"seed": 373298406,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "a1645b54dd28643e4706b2f39757923fde37e46d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 1662857472,
			"isDeleted": false,
			"id": "n0uZxXyV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7466.347296233794,
			"y": 1393.6852808012102,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2214.84375,
			"height": 10320,
			"seed": 723811942,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "We will support a One-to-One Chat wherein a person can send a message to another person or a user.There would be something called a Group Chat where\n\nsomebody could make a group of people and whenever anybody in the groupsends a message to the group, that message is received by everybody in the group.\n\nThe messages could contain text, it could contain images, it could contain videosand then it could extend to other kind of documents as well.\n\nThere is something called Read Receipt, which is basically the single tick whenthe message is sent,\n\ndouble tick when the message is delivered to theuser and a blue tick when the person sees the message.\n\nWe'll also show Last Seen time of a particular user.Coming to the non-functional requirements,\n\nthis platform needs to have a very very low latency becausefor a chat application it needs to look very real-time so,\n\nwhile you are sending a message, the other person should immediately be able to see that message.And obviously it should have a very high availability. This system\n\nshould not go down, no matter what happens.Also, there should not be any lag.\n\nIn other videos that we have talked about in the past,we were able to live with a lot of lag as well.\n\nBut in this video, we cannot have a lag because again, it needs to be a very real-time systemwherein I am typing something to you and you can see it then and there and then respond to it.\n\nComing to some scale numbers, these are approximate numbers of WhatsApp.Again, I do not know if these are actually correct or not but I just read somewhere.\n\nWhatsApp has roughly 2 billion users, out of which 1.6 billion users accessit on a monthly basis. These are unique users.\n\nEach day WhatsApp has somewhere close to 65 billion messages being sent across all the users.And that's a very big number.\n\nWe will try to look at how can we design a systemthat can deliver all of these functional requirements, with a very low latency\n\nand can live with these kind of numbers.Numbers for Facebook Messenger are approximately similar\n\nand other chat application could also be running at a very same scale.Let's look at the overall architecture of the whole system.\n\nWe'll first start with the Chatting Solution and thenwe'll look at other small pieces that surround it.\n\nLet's start with the User flow.All of these things that you see here are basically user devices.\n\nCould be mobile phones, could be web browsers,could be wearable devices like smart watch and all of that.\n\nLet's say user1 wants to send a message to user2.So, the flow goes like this -\n\nuser1 wants to send a message to user2 with a message id, m1.What happens is - user1 is talking to something called a WebSocket Handler 1.\n\nThere will be a lot of these WebSocket Handlers.What this is - is basically,\n\na WebSocket Handler is a server on our backend,which is keeping open connections with all the active users, right now.\n\nThese are the live users, who are having an active internet connection kind of a thing.All of these users are connected to some of the machines.\n\nThen, there'll be a lot of these machines.And, all of these would be distributed across the globe.\n\nSo that, people in certain geography,talk to the servers which are nearer to them, so as to have a lesser latency.\n\nLet's just say, user1 is connectedto this WebSocket Handler 1 and it sends this message to WebSocket Handler 1 saying,\n\nsend this message m1 to user U2.Now, this WebSocket Handler does 2 - 3 things when this happens.\n\nIt talks to something called a WebSocket Manager.WebSocket Manager is a repository of the fact that, which device is connected to what all users.\n\nBecause these are probably thousands of devices,we need to keep that information at some central place,\n\nwhich is this WebSocket Manager Service.It sits on top of a Redis, which stores two information mainly.\n\nFirst of all, it stores that user1 is connected to WebSocket Handler 1and WebSocket Handler 1 is connected to user1, user10, user20, something of that sort.\n\nSo, a list of user ids that a particular machine is connected to,that information gets stored in Redis.\n\nLet's say, a connection breaks between a user and a machine.And now, the user is connected to a different machine.\n\nSo, that information is updated through this WebSocket Manager, into this Redis.The second thing that WebSocket Handler 1 does is - talk to something called Message Service.\n\nMessage Service is basically the repository of all the messages in the system.It will have APIs to get a message by message id, get the message by user ids and various filters.\n\nSo, if you want to fetch all the unread messagesby a particular user and all of that, that would be powered by this Message Service.\n\nIt sits on top of a Cassandra database.Why Cassandra? Because, again we have these billions of users,\n\nwho will send many many billions of messages so,Cassandra is a fairly good data store to store that kind of a volume.\n\nPlus, the query pattern that we have fairly aligns with the query pattern that Cassandra is good at.So that's the reason we choose a Cassandra here.\n\nThere are two kinds of message services that we can build.Basically there are two kind of messaging platforms that we have.\n\nOne is something like a Facebook, which stores all of your messages. So,in that case everything would be stored in a Cassandra permanently.\n\nAnd, then there is something like a WhatsApp,which stores the messages only till the time it is not delivered to the user.\n\nOnce it gets a delivery acknowledgement, then it deletes the message.So, if we want to build a WhatsApp kind of system, we could delete the message from here also.\n\nDeletes are a bit inefficient in Cassandra so, if we were tobuild that kind of a system, we might choose some other data store as well.\n\nBut for now, Cassandra would work fairly fine.Coming back to.. we were at WebSocket Handler 1,\n\nwhich got this message saying U1 wants to send to U2, a message m1.Talk to both of these services and it would happen parallelly so, it can happen in any order.\n\nMessage Service would save the message into Cassandra and give the message id.Let's say message id is m1.\n\nWebSocket Manager will now tell WebSocket Handler 1,saying, user U2 is connected to this WebSocket Handler 2.\n\nNow, do whatever you want to do.Now, this guy, WebSocket Handler 1\n\nwill talk to WebSocket Handler 2 saying that I have got a message for U2.I believe that guy's connected to you. Go send them that message.\n\nNow, there are 2 - 3 possibilities.WebSocket Handler 2 could actually be connected to that user still and he will send the message.\n\nOr it could not be connected. It will say that I am not connected to the user. Theperson has probably gone offline.\n\nSo, he will not do anything and the flow ends there.Let's say, the WebSocket Handler 2 sends this message to U2.\n\nNow there are 2 - 3 things that can happen.Maybe the user is not using the app actively but the message got delivered.\n\nSo, this device will send a message to WebSocket Handler 2,saying that I have received the message.\n\nOr the second option could be - the person is actually open on the chatof this user U1 and could see the message then and there.\n\nSo, that device would send a message saying, I have received and seen the message m1.Now, this guy, WebSocket Handler 2 again queries WebSocket Manager,\n\nsaying that this message was now either delivered or read.I need to inform user U1 so tell me which machine is talking to user U1.\n\nIt will get this particular machine's IP, saying this guy is now handlinguser U1 and it will send this message to WebSocket Handler 1,\n\nsaying this particular message id m1, has now been read or received, whateverand go inform the user and this will be informed to the user.\n\nHow are these connections happening?These are WebSocket connections, which is basically a bi-directional connection.\n\nSo, there's no client and server here.Any party can send a message. So, that's how even server is able to send a message to the client.\n\nThese are built on top of TCP.In this whole process, we queried WebSocket Manager a lot of times.\n\nUser U1 calling for U2, U2 calling for U1 and all of that.Now, at the same time, if the user sends multiple messages, again, we'll try to do that.\n\nLet's try to cache this information somewhere.Each machine will cache 2 kinds of things.\n\nOne it will cache is - the list of users that are connected to itself.So, if user U2 was also connected to the same machine,\n\nit would have the data in memory. It would never have to call this manager.The other thing is - it would temporarily,\n\nfor a very short duration of time, maybe 10, 20, 30 seconds,cache the information about conversations that it has had recently.\n\nSo, if user U2 was connected to this handler H2,this guy (H1) will keep it in cache, saying user U2 is on this particular machine.\n\nBecause if U1 sends another message to this U2, it now need not call this WebSocket Manager.But, keep in mind, this second cache needs to\n\nbe stored with a very low time to live (TTL) and it should expire every 30 odd seconds.Because remember, these are global users.\n\nLet's say, if somebody is connecting from Sri Lanka,you would probably get connected to a server in India.\n\nThat's a fairly large amount of distance and that communication might break in betweenand the person might get connected to a different machine, the next time.\n\nSo to, kind of, handle those things easily, we'll keep this cache at a very low TTL.There are another set of things.\n\nNow, the receipts that we have sent to user U1 and user U2,all those receipts.. we need to decide whether we want to store them or not.\n\nSo if, let's say, we want to store the read receipts also,we can store that as a, probably, status in Cassandra, in the same table saying,\n\nthis particular message has a, to start with, status as sent.Then it will move to received. Then it will move to read.\n\nWe can decide.. you can decide that basedon your conversation with the interviewer, whether you want to store this information\n\nor even whether you want to store the messages in the first place or not.All of those things are a conversation that you need to have with your interviewer.\n\nBut, you still need to store it, for at least some time.Let's just say that - user U1 sent a message to user U2 and then went offline.\n\nNow, the receipts wouldn't go back.So at least, for a short duration of time, those read receipts need to be stored in the database\n\nand whenever user U1 comes online, then he'll get that.Let's just say, user U1 wanted to send a message to user U3.\n\nSo, a second message.. user U1 is sending a messageto user U3, which is some message m2, with some text.\n\nNow, what will happen is -again, it will store in, through Message Service,\n\nit will call WebSocket Manager, to get who is the machine which is handling user U3.User U3 is offline. There is no machine that is talking to user U3.\n\nSo now, WebSocket Manager will return a response saying, I don't have a machine.That flow ends there.\n\nThis WebSocket Handler 1 does not inform anybody because there is no machine talking to user U3.So, the flow breaks there.\n\nNow, when user U3 comes online, let's just say that, user U3 gets connected to thisWebSocket Handler H3.\n\nWhat this WebSocket Handler does in the very first place is - to query Message Service and ask for -are there any messages for user U3 that are not in received or read status.\n\nThis Message Service will respond back and user U3 will see all those messages.Then, when, as those messages are being received and read,\n\nthose communications will flow back through the same flowlike we discussed earlier.\n\nSo, then, these machines will start talking to each other,for user U3 as well and those receipts, will go on to other users as well.\n\nThere is a potential race condition here.When user U1 was sending a message for user U3,\n\nassume, at the exact same time user U3 came online.We said these are parallel calls, wherein a person is figuring out the machine\n\nwhich is being used for user U3 and storing the message.Let's just say that, the very first thing that happened was - WebSocket\n\nManager returned that there is no machine that is talking to user U3.The next thing that happens was - user U3\n\ncomes online and queries Message Service, saying that get me all the messages.The third thing that happens is - it stores into WebSocket Manager that\n\nthis machine 3 is handling user U3.The fourth thing that happens is - this message gets stored into this Message Service.\n\nNow, WebSocket Handler 3 thinks that - it has fetched all themessages for user U3 and displayed it on the device.\n\nThis WebSocket Handler 1 thinks that - user U3 isoffline and I have stored the messages and done my work.\n\nBut fundamentally, whatever this message m2 was, that has not been received by this guy (U3).Because, before that message was stored, this WebSocket Handler 3 retrieved all the messages.\n\nThese kind of race conditions could happen when you are doing parallel calls.There are multiple ways to handle it.\n\nYou can either do itsequentially but that will increase the latencies. So, I'll not recommend that.\n\nWhat another solution you could possibly do is - this WebSocketHandler keeps pulling the server once in a while,\n\nsaying are there any messages that I still missed. So, all of those messages could be pulled.But, that would happen at a fairly low frequency and those could be bulk calls, something like -\n\nare there any messages for user U1, U2, U3 to U100 which are in sent status,for all the active users that this machine is connected to.\n\nAnd, if it finds any messages, it will send all of those messages as well.There are certain things that happen on the device itself.\n\nLet's say user U1 was offline. And,you can still send message onto some user's chat, while you are offline.\n\nSo, let's say, U1 sent another message to somebody while it was offline.So, what would happen is - it will try to connect. Because internet is not there,\n\nit will not be able to connect to any servers.In that scenario, what will happen.. even, in all other scenarios also..\n\nall the messages would be stored in a local database which is persisted onto the device disk.Let's say, it's an android application.\n\nIt could use any kind of a android database likea SQLite or anything and store all those messages on the disk.\n\nNow, whenever the device gets the internet connection,it will pull those messages from a queue kind of a thing or that database\n\nand send those messages. So,this is how it would be able to handle scenarios where the device was offline.\n\nNow, we have the next thing as group messages. How does that work?Group messages almost work in a very similar way.\n\nLet's say, another scenario, U1 wanted to send a message to group g1, a message called m3.What would happen is - in case of groups, the behaviour is slightly different.\n\nThis WebSocket Handler wouldn't take care of fanning out to all the groups.This is a very lightweight service,\n\nwhich just takes a message from a user and sends it to somebodyor gets a message from somebody and sends it to a user. It doesn't have a lot of logic.\n\nFor group messages, what it will do is - it will just send a message to Message Service,saying user U1 wants to send a message m3 to group g1, store it and do whatever you need to do.\n\nSo, this message service will insert that into Cassandra saying the message is stored.Along with that, what it will also do,\n\nfor all the group messages, it will put all of those messages into a Kafka topic sayingthere's a group message that I've got, which is this user U1, sending to group g1,\n\na message m3. Go send it out.From Kafka, there will be something called a Group Message Handler.\n\nThis is basically a Kafka consumer, which is listening on to the same topicand it is responsible for sending out all the group messages.\n\nFirst of all, it does some validations that it needs to, assuming that's out of scope for us,saying whether U1 is even in the group to be able to send it to g1,\n\nbut assuming that's not a part of scope.It basically queries Group Service, to get all the users that are into group g1.\n\nIt gets a list of users, then it will remove the user U1 from that list.And now it has a list of the users that are supposed to get this message.\n\nNow, it follows the exact same flow that was used for one -to- one messagesbut, for all of these users.\n\nSo, it basically calls WebSocket Managersaying, give me all the machines that these users are connected with.\n\nIt will get a response saying machine 1 is connected to user U3; U4; U5,machine 2 is connected to some other set of users and all of that.\n\nThen it will send the messages to individual machines saying,to this user send this message, to this user send this message.\n\nAnd then the receipts and all will follow the exact same flow that was handled earlier.The next thing - what happens when people are\n\nuploading assets like images or videos or anything of that sort.The very first thing that happens when you are trying to upload\n\nany content is that - there is some kind of a compression that happens.Now, in real WhatsApp, there is encryption also that happens right at device\n\nand the encrypted messages are sent out.And when the messages are received, even the encrypted messages are\n\nreceived and they're decrypted but we'll keep that out of scope.We'll just think of some compression there.\n\nLet's say, U3 is sending a image to U2. So, what will happen is - U3 is sending to U2, some image.This is basically a two-step process.\n\nThe first step is - upload an image to a server and get an image idand then send that image id via the regular route to user U2. And then, U2 can fetch the image.\n\nHow the image upload works is - again, these arelightweight servers they wouldn't have any logic. So, very first thing is -\n\ncompression of the image, over here or video or anything. Then,it will talk to something called this Asset Service.\n\nSo, this U3 is talking to Asset Service through this Load Balancer. Again,all the authentication, authorization will happen at this layer and\n\nAsset Service now gets the whole image or video or whatever.Asset Service will use Amazon S3 as a data store and it will store all the images there.\n\nNow, based on which image is getting what kind ofhits on S3, it might decide to move some of the images on CDN\n\nand it could also decide to replicate into multiple CDNs or some CDNs,from where it is getting traffic.\n\nBut assuming, it has uploaded the image on S3 and it sends a response saying,let's say, it is a image i1. It will come as a regular message to U2,\n\nthrough this WebSocket Handler (H3).. these two WebSocket Handlers saying,send this message and the receipts will happen in the same way that we talked about earlier.\n\nThere could be one optimization that can happen.Let's say, there's a political event or a sports event\n\nand a lot of people are sharing the same image for some reason.Do we need to upload the same image multiple times,\n\nif five people are uploading the same image? Probably not!!So, before it even uploads to Asset Service, the first thing that the device will do is -\n\ntake a hash of those images and send the hash content to Asset Service.Basically, it's a way of asking - do you have this image already or not?\n\nIf you have it, then just send it to user U2.If you don't have it, then ask me and I'll upload it. Something of that sort.\n\nOf course, when it's about hashing,there would be various problems like duplicate hash outputs and collisions and all of that.\n\nSo, instead of taking one hash, we could probably take five differenthash algorithms and use all of them to get five different hashes\n\nand if all the five hashes are matching against an image,then we'll say that, an image is already there.\n\nIf it's not matching, then we'll say that, the image needs to be uploadedand it will follow the regular route that we talked about.\n\nAnd if it is already there, then anyway it's there, it just sends a message.Now, let's look at remaining few components and how they help in the whole system.\n\nSo, this is the user app, which talks to all of these components. It could be a browser as well.The very first thing is - something called User Service. This is basically a\n\nservice, which owns the user profile information.It could be - their name, their user id,\n\ntheir profile picture in case of WhatsApp and some user preferences. In case of Facebook, it will bea larger set of data. But all of that, whatever that data is,\n\nit would be residing in a clustered MySQL, which runs the user database.All of those information would also be cached in Redis cluster,\n\nvery similar to the way we have implemented in other similar solutions.Against a key, we'll be having the user\n\nprofile information and a lot of other information as well.There's something called Group Service, which basically maintains all the group information.\n\nIt basically has information of - which group has what all users.Think of it as a many-to-many table, with a user id and a group id\n\nand a time when user was added into the groupand maybe a status saying, whether the user is admin or something of that sort.\n\nAgain, this information would be stored in the MySQL cluster,which would be geographically distributed and it will have multiple slaves\n\nthrough which the read queries will be run. It will also have a Redis sitting on top of it. So,all the APIs like, let's say, get users in a group\n\nand something of that sort,would be powered by this Redis cluster and those APIs would be sitting within the Group Service.\n\nEach time, either User Service or Group Service, queries Redis and it does not find the data,is when they actually query one of the salves\n\nof these databases, fetch the information, put it into the Redis and respond back towhoever is calling them.\n\nAnd then, group service was used in the group messaging workflow, that we looked at earlier.Each action that a user is taking on their app, gives us a lot of information.\n\nFor example, if a person is visiting some user's profile a lot of times,that tells us that the person is interested in this user.\n\nIt could be used for some kind of Analytics.Let's say, if a particular person is talking a lot about sports,\n\nthat does tell us that the person is a sports enthusiast.How could we do that?\n\nAll events that are happening,either they are events within the app or they are messages or anything of that sort,\n\nwould be sent either to this Analytics Service and then to Kafka,or directly to Kafka, in case of messages.\n\nThere could be a Spark Streaming Consumer running on top of this,which could do a lot of inferences.\n\nFirst of all, it could do some message classification into some tags,like a message is a sports kind of a message or a general message or a\n\npolitics kind of a message and then try to classify users basis that. So,that is one kind of analytics.\n\nAnother thing could be, just simply,some information about what are people talking about, in general.\n\nThis is not possible if the messages are end to end encrypted.But if that's not the case, then we should be easily able to infer all of that.\n\nThere are two parts.One is - doing some logic, based on some streaming content.\n\nThat could be done by a simple Spark Streaming Consumer.And, that consumer would also put that data into Hadoop.\n\nAnd then, you can run a lot of analytics queries, based on Hadoop.Something like, which are the people who talk about sports a lot or which\n\nare the people who just talk about a particular kind of political party oranything of that sort. Those kind of analytics could be run out of that Hadoop cluster.\n\nThese events are also having one more usage.Each time a person does an activity on the app,\n\nthose events are listened by something called Last Seen Service.This Last Seen Service is basically, the service used to store the last seen time of a user.\n\nThis service.. I made it to sit on top of a Cassandra database,which has a column called user_id and a column called last_seen_time.\n\nThis could also alternatively sit on top of a Redis, if you have finite amount of data.But along with last seen time, if you want to store certain other information,\n\nthen Redis might have memory issues.So, in that scenario, you can use a Cassandra.\n\nYou might have a doubt that - when we use MySQL for user information,why don't we use a MySQL here? The reason is -\n\nlet's say, a user is on the app.Every five seconds, the app will send a notification that the user is live.\n\nSo, every five seconds, for each user, this will have ainsert into the database. What that means is - this is having an extremely high throughput\n\nand MySQL might not be able to support that because these are all the writes,which will go into the master node of MySQL.\n\nBut, if it's a Cassandra, it could be spread out easily across a lot of users.Redis might also have those update problem because\n\nfor all the users, you are doing a lot of inserts. So, Redis might not be able to scale.But, if it's a Cassandra, it should easily be able to scale to any amount of traffic,\n\nany amount of users and those things coming at any frequency.One more thing - There are two kinds of events that are spawned.\n\nOne are the events that are spawned by the app and one are the events that are spawned by the users.Example of events spawn by app could be - as soon as you turn the internet on,\n\nthe app would make a WebSocket connectionand pull in some requests. That is not a user activity. So,\n\nthat would not be captured as a, you know, activity of a user in the Last Seen Service.But, as soon as the person opens the app or closes the app\n\nor does anything within the context of an app,those are actually the events that Last Seen Service would be looking at.\n\nIn general, all the services that we looked at, we are looking at here,in the other previous section, all of those are, as usual, horizontally scalable.\n\nSo, when your number of users or anything increases,you just add more number of nodes and that should be able to handle itself.\n\nOther than that, you will obviously need to do a lot of monitoring,alerting - basically to ensure that you are able to get to your NFRs of\n\nno lag, low latency and high availability.So, some of the important things that you want to,\n\nkind of, keep a track of from a monitoring perspective is -the CPU memory utilization of your services, your disk utilization in the databases,\n\nyour throughputs and latency onto your web servicesand the disk utilization in your Kafka and more importantly the lag in Kafka.\n\nLet's say, if your lag increases, you need to add more number of consumers.So, all of those metrics you can capture, store it into a\n\nGrafana kind of a store and plot some graphs out of it.And also, you can build some alerting out of it. In case\n\nyour numbers go beyond a certain threshold, you can send out alerts.Those alerts could be used to make some decisions.\n\nFor example, if your throughput is increasing significantly,you could add more machines into a particular service\n\nand in fact those things could be automated as well.So, if you're using AWS kind of a thing, you might write a script which\n\nlooks at your throughput and it adds more nodes or removes certain nodes.All of those things are very important when it comes to\n\na chat application because one of your very critical NFR is that it needs to be actuallyreal time. If it's not real time, then it will give a very\n\nbad experience and then people will kind of drop out of your platform.\n",
			"rawText": "We will support a One-to-One Chat wherein a person can send a message to another person or a user.There would be something called a Group Chat where\n\nsomebody could make a group of people and whenever anybody in the groupsends a message to the group, that message is received by everybody in the group.\n\nThe messages could contain text, it could contain images, it could contain videosand then it could extend to other kind of documents as well.\n\nThere is something called Read Receipt, which is basically the single tick whenthe message is sent,\n\ndouble tick when the message is delivered to theuser and a blue tick when the person sees the message.\n\nWe'll also show Last Seen time of a particular user.Coming to the non-functional requirements,\n\nthis platform needs to have a very very low latency becausefor a chat application it needs to look very real-time so,\n\nwhile you are sending a message, the other person should immediately be able to see that message.And obviously it should have a very high availability. This system\n\nshould not go down, no matter what happens.Also, there should not be any lag.\n\nIn other videos that we have talked about in the past,we were able to live with a lot of lag as well.\n\nBut in this video, we cannot have a lag because again, it needs to be a very real-time systemwherein I am typing something to you and you can see it then and there and then respond to it.\n\nComing to some scale numbers, these are approximate numbers of WhatsApp.Again, I do not know if these are actually correct or not but I just read somewhere.\n\nWhatsApp has roughly 2 billion users, out of which 1.6 billion users accessit on a monthly basis. These are unique users.\n\nEach day WhatsApp has somewhere close to 65 billion messages being sent across all the users.And that's a very big number.\n\nWe will try to look at how can we design a systemthat can deliver all of these functional requirements, with a very low latency\n\nand can live with these kind of numbers.Numbers for Facebook Messenger are approximately similar\n\nand other chat application could also be running at a very same scale.Let's look at the overall architecture of the whole system.\n\nWe'll first start with the Chatting Solution and thenwe'll look at other small pieces that surround it.\n\nLet's start with the User flow.All of these things that you see here are basically user devices.\n\nCould be mobile phones, could be web browsers,could be wearable devices like smart watch and all of that.\n\nLet's say user1 wants to send a message to user2.So, the flow goes like this -\n\nuser1 wants to send a message to user2 with a message id, m1.What happens is - user1 is talking to something called a WebSocket Handler 1.\n\nThere will be a lot of these WebSocket Handlers.What this is - is basically,\n\na WebSocket Handler is a server on our backend,which is keeping open connections with all the active users, right now.\n\nThese are the live users, who are having an active internet connection kind of a thing.All of these users are connected to some of the machines.\n\nThen, there'll be a lot of these machines.And, all of these would be distributed across the globe.\n\nSo that, people in certain geography,talk to the servers which are nearer to them, so as to have a lesser latency.\n\nLet's just say, user1 is connectedto this WebSocket Handler 1 and it sends this message to WebSocket Handler 1 saying,\n\nsend this message m1 to user U2.Now, this WebSocket Handler does 2 - 3 things when this happens.\n\nIt talks to something called a WebSocket Manager.WebSocket Manager is a repository of the fact that, which device is connected to what all users.\n\nBecause these are probably thousands of devices,we need to keep that information at some central place,\n\nwhich is this WebSocket Manager Service.It sits on top of a Redis, which stores two information mainly.\n\nFirst of all, it stores that user1 is connected to WebSocket Handler 1and WebSocket Handler 1 is connected to user1, user10, user20, something of that sort.\n\nSo, a list of user ids that a particular machine is connected to,that information gets stored in Redis.\n\nLet's say, a connection breaks between a user and a machine.And now, the user is connected to a different machine.\n\nSo, that information is updated through this WebSocket Manager, into this Redis.The second thing that WebSocket Handler 1 does is - talk to something called Message Service.\n\nMessage Service is basically the repository of all the messages in the system.It will have APIs to get a message by message id, get the message by user ids and various filters.\n\nSo, if you want to fetch all the unread messagesby a particular user and all of that, that would be powered by this Message Service.\n\nIt sits on top of a Cassandra database.Why Cassandra? Because, again we have these billions of users,\n\nwho will send many many billions of messages so,Cassandra is a fairly good data store to store that kind of a volume.\n\nPlus, the query pattern that we have fairly aligns with the query pattern that Cassandra is good at.So that's the reason we choose a Cassandra here.\n\nThere are two kinds of message services that we can build.Basically there are two kind of messaging platforms that we have.\n\nOne is something like a Facebook, which stores all of your messages. So,in that case everything would be stored in a Cassandra permanently.\n\nAnd, then there is something like a WhatsApp,which stores the messages only till the time it is not delivered to the user.\n\nOnce it gets a delivery acknowledgement, then it deletes the message.So, if we want to build a WhatsApp kind of system, we could delete the message from here also.\n\nDeletes are a bit inefficient in Cassandra so, if we were tobuild that kind of a system, we might choose some other data store as well.\n\nBut for now, Cassandra would work fairly fine.Coming back to.. we were at WebSocket Handler 1,\n\nwhich got this message saying U1 wants to send to U2, a message m1.Talk to both of these services and it would happen parallelly so, it can happen in any order.\n\nMessage Service would save the message into Cassandra and give the message id.Let's say message id is m1.\n\nWebSocket Manager will now tell WebSocket Handler 1,saying, user U2 is connected to this WebSocket Handler 2.\n\nNow, do whatever you want to do.Now, this guy, WebSocket Handler 1\n\nwill talk to WebSocket Handler 2 saying that I have got a message for U2.I believe that guy's connected to you. Go send them that message.\n\nNow, there are 2 - 3 possibilities.WebSocket Handler 2 could actually be connected to that user still and he will send the message.\n\nOr it could not be connected. It will say that I am not connected to the user. Theperson has probably gone offline.\n\nSo, he will not do anything and the flow ends there.Let's say, the WebSocket Handler 2 sends this message to U2.\n\nNow there are 2 - 3 things that can happen.Maybe the user is not using the app actively but the message got delivered.\n\nSo, this device will send a message to WebSocket Handler 2,saying that I have received the message.\n\nOr the second option could be - the person is actually open on the chatof this user U1 and could see the message then and there.\n\nSo, that device would send a message saying, I have received and seen the message m1.Now, this guy, WebSocket Handler 2 again queries WebSocket Manager,\n\nsaying that this message was now either delivered or read.I need to inform user U1 so tell me which machine is talking to user U1.\n\nIt will get this particular machine's IP, saying this guy is now handlinguser U1 and it will send this message to WebSocket Handler 1,\n\nsaying this particular message id m1, has now been read or received, whateverand go inform the user and this will be informed to the user.\n\nHow are these connections happening?These are WebSocket connections, which is basically a bi-directional connection.\n\nSo, there's no client and server here.Any party can send a message. So, that's how even server is able to send a message to the client.\n\nThese are built on top of TCP.In this whole process, we queried WebSocket Manager a lot of times.\n\nUser U1 calling for U2, U2 calling for U1 and all of that.Now, at the same time, if the user sends multiple messages, again, we'll try to do that.\n\nLet's try to cache this information somewhere.Each machine will cache 2 kinds of things.\n\nOne it will cache is - the list of users that are connected to itself.So, if user U2 was also connected to the same machine,\n\nit would have the data in memory. It would never have to call this manager.The other thing is - it would temporarily,\n\nfor a very short duration of time, maybe 10, 20, 30 seconds,cache the information about conversations that it has had recently.\n\nSo, if user U2 was connected to this handler H2,this guy (H1) will keep it in cache, saying user U2 is on this particular machine.\n\nBecause if U1 sends another message to this U2, it now need not call this WebSocket Manager.But, keep in mind, this second cache needs to\n\nbe stored with a very low time to live (TTL) and it should expire every 30 odd seconds.Because remember, these are global users.\n\nLet's say, if somebody is connecting from Sri Lanka,you would probably get connected to a server in India.\n\nThat's a fairly large amount of distance and that communication might break in betweenand the person might get connected to a different machine, the next time.\n\nSo to, kind of, handle those things easily, we'll keep this cache at a very low TTL.There are another set of things.\n\nNow, the receipts that we have sent to user U1 and user U2,all those receipts.. we need to decide whether we want to store them or not.\n\nSo if, let's say, we want to store the read receipts also,we can store that as a, probably, status in Cassandra, in the same table saying,\n\nthis particular message has a, to start with, status as sent.Then it will move to received. Then it will move to read.\n\nWe can decide.. you can decide that basedon your conversation with the interviewer, whether you want to store this information\n\nor even whether you want to store the messages in the first place or not.All of those things are a conversation that you need to have with your interviewer.\n\nBut, you still need to store it, for at least some time.Let's just say that - user U1 sent a message to user U2 and then went offline.\n\nNow, the receipts wouldn't go back.So at least, for a short duration of time, those read receipts need to be stored in the database\n\nand whenever user U1 comes online, then he'll get that.Let's just say, user U1 wanted to send a message to user U3.\n\nSo, a second message.. user U1 is sending a messageto user U3, which is some message m2, with some text.\n\nNow, what will happen is -again, it will store in, through Message Service,\n\nit will call WebSocket Manager, to get who is the machine which is handling user U3.User U3 is offline. There is no machine that is talking to user U3.\n\nSo now, WebSocket Manager will return a response saying, I don't have a machine.That flow ends there.\n\nThis WebSocket Handler 1 does not inform anybody because there is no machine talking to user U3.So, the flow breaks there.\n\nNow, when user U3 comes online, let's just say that, user U3 gets connected to thisWebSocket Handler H3.\n\nWhat this WebSocket Handler does in the very first place is - to query Message Service and ask for -are there any messages for user U3 that are not in received or read status.\n\nThis Message Service will respond back and user U3 will see all those messages.Then, when, as those messages are being received and read,\n\nthose communications will flow back through the same flowlike we discussed earlier.\n\nSo, then, these machines will start talking to each other,for user U3 as well and those receipts, will go on to other users as well.\n\nThere is a potential race condition here.When user U1 was sending a message for user U3,\n\nassume, at the exact same time user U3 came online.We said these are parallel calls, wherein a person is figuring out the machine\n\nwhich is being used for user U3 and storing the message.Let's just say that, the very first thing that happened was - WebSocket\n\nManager returned that there is no machine that is talking to user U3.The next thing that happens was - user U3\n\ncomes online and queries Message Service, saying that get me all the messages.The third thing that happens is - it stores into WebSocket Manager that\n\nthis machine 3 is handling user U3.The fourth thing that happens is - this message gets stored into this Message Service.\n\nNow, WebSocket Handler 3 thinks that - it has fetched all themessages for user U3 and displayed it on the device.\n\nThis WebSocket Handler 1 thinks that - user U3 isoffline and I have stored the messages and done my work.\n\nBut fundamentally, whatever this message m2 was, that has not been received by this guy (U3).Because, before that message was stored, this WebSocket Handler 3 retrieved all the messages.\n\nThese kind of race conditions could happen when you are doing parallel calls.There are multiple ways to handle it.\n\nYou can either do itsequentially but that will increase the latencies. So, I'll not recommend that.\n\nWhat another solution you could possibly do is - this WebSocketHandler keeps pulling the server once in a while,\n\nsaying are there any messages that I still missed. So, all of those messages could be pulled.But, that would happen at a fairly low frequency and those could be bulk calls, something like -\n\nare there any messages for user U1, U2, U3 to U100 which are in sent status,for all the active users that this machine is connected to.\n\nAnd, if it finds any messages, it will send all of those messages as well.There are certain things that happen on the device itself.\n\nLet's say user U1 was offline. And,you can still send message onto some user's chat, while you are offline.\n\nSo, let's say, U1 sent another message to somebody while it was offline.So, what would happen is - it will try to connect. Because internet is not there,\n\nit will not be able to connect to any servers.In that scenario, what will happen.. even, in all other scenarios also..\n\nall the messages would be stored in a local database which is persisted onto the device disk.Let's say, it's an android application.\n\nIt could use any kind of a android database likea SQLite or anything and store all those messages on the disk.\n\nNow, whenever the device gets the internet connection,it will pull those messages from a queue kind of a thing or that database\n\nand send those messages. So,this is how it would be able to handle scenarios where the device was offline.\n\nNow, we have the next thing as group messages. How does that work?Group messages almost work in a very similar way.\n\nLet's say, another scenario, U1 wanted to send a message to group g1, a message called m3.What would happen is - in case of groups, the behaviour is slightly different.\n\nThis WebSocket Handler wouldn't take care of fanning out to all the groups.This is a very lightweight service,\n\nwhich just takes a message from a user and sends it to somebodyor gets a message from somebody and sends it to a user. It doesn't have a lot of logic.\n\nFor group messages, what it will do is - it will just send a message to Message Service,saying user U1 wants to send a message m3 to group g1, store it and do whatever you need to do.\n\nSo, this message service will insert that into Cassandra saying the message is stored.Along with that, what it will also do,\n\nfor all the group messages, it will put all of those messages into a Kafka topic sayingthere's a group message that I've got, which is this user U1, sending to group g1,\n\na message m3. Go send it out.From Kafka, there will be something called a Group Message Handler.\n\nThis is basically a Kafka consumer, which is listening on to the same topicand it is responsible for sending out all the group messages.\n\nFirst of all, it does some validations that it needs to, assuming that's out of scope for us,saying whether U1 is even in the group to be able to send it to g1,\n\nbut assuming that's not a part of scope.It basically queries Group Service, to get all the users that are into group g1.\n\nIt gets a list of users, then it will remove the user U1 from that list.And now it has a list of the users that are supposed to get this message.\n\nNow, it follows the exact same flow that was used for one -to- one messagesbut, for all of these users.\n\nSo, it basically calls WebSocket Managersaying, give me all the machines that these users are connected with.\n\nIt will get a response saying machine 1 is connected to user U3; U4; U5,machine 2 is connected to some other set of users and all of that.\n\nThen it will send the messages to individual machines saying,to this user send this message, to this user send this message.\n\nAnd then the receipts and all will follow the exact same flow that was handled earlier.The next thing - what happens when people are\n\nuploading assets like images or videos or anything of that sort.The very first thing that happens when you are trying to upload\n\nany content is that - there is some kind of a compression that happens.Now, in real WhatsApp, there is encryption also that happens right at device\n\nand the encrypted messages are sent out.And when the messages are received, even the encrypted messages are\n\nreceived and they're decrypted but we'll keep that out of scope.We'll just think of some compression there.\n\nLet's say, U3 is sending a image to U2. So, what will happen is - U3 is sending to U2, some image.This is basically a two-step process.\n\nThe first step is - upload an image to a server and get an image idand then send that image id via the regular route to user U2. And then, U2 can fetch the image.\n\nHow the image upload works is - again, these arelightweight servers they wouldn't have any logic. So, very first thing is -\n\ncompression of the image, over here or video or anything. Then,it will talk to something called this Asset Service.\n\nSo, this U3 is talking to Asset Service through this Load Balancer. Again,all the authentication, authorization will happen at this layer and\n\nAsset Service now gets the whole image or video or whatever.Asset Service will use Amazon S3 as a data store and it will store all the images there.\n\nNow, based on which image is getting what kind ofhits on S3, it might decide to move some of the images on CDN\n\nand it could also decide to replicate into multiple CDNs or some CDNs,from where it is getting traffic.\n\nBut assuming, it has uploaded the image on S3 and it sends a response saying,let's say, it is a image i1. It will come as a regular message to U2,\n\nthrough this WebSocket Handler (H3).. these two WebSocket Handlers saying,send this message and the receipts will happen in the same way that we talked about earlier.\n\nThere could be one optimization that can happen.Let's say, there's a political event or a sports event\n\nand a lot of people are sharing the same image for some reason.Do we need to upload the same image multiple times,\n\nif five people are uploading the same image? Probably not!!So, before it even uploads to Asset Service, the first thing that the device will do is -\n\ntake a hash of those images and send the hash content to Asset Service.Basically, it's a way of asking - do you have this image already or not?\n\nIf you have it, then just send it to user U2.If you don't have it, then ask me and I'll upload it. Something of that sort.\n\nOf course, when it's about hashing,there would be various problems like duplicate hash outputs and collisions and all of that.\n\nSo, instead of taking one hash, we could probably take five differenthash algorithms and use all of them to get five different hashes\n\nand if all the five hashes are matching against an image,then we'll say that, an image is already there.\n\nIf it's not matching, then we'll say that, the image needs to be uploadedand it will follow the regular route that we talked about.\n\nAnd if it is already there, then anyway it's there, it just sends a message.Now, let's look at remaining few components and how they help in the whole system.\n\nSo, this is the user app, which talks to all of these components. It could be a browser as well.The very first thing is - something called User Service. This is basically a\n\nservice, which owns the user profile information.It could be - their name, their user id,\n\ntheir profile picture in case of WhatsApp and some user preferences. In case of Facebook, it will bea larger set of data. But all of that, whatever that data is,\n\nit would be residing in a clustered MySQL, which runs the user database.All of those information would also be cached in Redis cluster,\n\nvery similar to the way we have implemented in other similar solutions.Against a key, we'll be having the user\n\nprofile information and a lot of other information as well.There's something called Group Service, which basically maintains all the group information.\n\nIt basically has information of - which group has what all users.Think of it as a many-to-many table, with a user id and a group id\n\nand a time when user was added into the groupand maybe a status saying, whether the user is admin or something of that sort.\n\nAgain, this information would be stored in the MySQL cluster,which would be geographically distributed and it will have multiple slaves\n\nthrough which the read queries will be run. It will also have a Redis sitting on top of it. So,all the APIs like, let's say, get users in a group\n\nand something of that sort,would be powered by this Redis cluster and those APIs would be sitting within the Group Service.\n\nEach time, either User Service or Group Service, queries Redis and it does not find the data,is when they actually query one of the salves\n\nof these databases, fetch the information, put it into the Redis and respond back towhoever is calling them.\n\nAnd then, group service was used in the group messaging workflow, that we looked at earlier.Each action that a user is taking on their app, gives us a lot of information.\n\nFor example, if a person is visiting some user's profile a lot of times,that tells us that the person is interested in this user.\n\nIt could be used for some kind of Analytics.Let's say, if a particular person is talking a lot about sports,\n\nthat does tell us that the person is a sports enthusiast.How could we do that?\n\nAll events that are happening,either they are events within the app or they are messages or anything of that sort,\n\nwould be sent either to this Analytics Service and then to Kafka,or directly to Kafka, in case of messages.\n\nThere could be a Spark Streaming Consumer running on top of this,which could do a lot of inferences.\n\nFirst of all, it could do some message classification into some tags,like a message is a sports kind of a message or a general message or a\n\npolitics kind of a message and then try to classify users basis that. So,that is one kind of analytics.\n\nAnother thing could be, just simply,some information about what are people talking about, in general.\n\nThis is not possible if the messages are end to end encrypted.But if that's not the case, then we should be easily able to infer all of that.\n\nThere are two parts.One is - doing some logic, based on some streaming content.\n\nThat could be done by a simple Spark Streaming Consumer.And, that consumer would also put that data into Hadoop.\n\nAnd then, you can run a lot of analytics queries, based on Hadoop.Something like, which are the people who talk about sports a lot or which\n\nare the people who just talk about a particular kind of political party oranything of that sort. Those kind of analytics could be run out of that Hadoop cluster.\n\nThese events are also having one more usage.Each time a person does an activity on the app,\n\nthose events are listened by something called Last Seen Service.This Last Seen Service is basically, the service used to store the last seen time of a user.\n\nThis service.. I made it to sit on top of a Cassandra database,which has a column called user_id and a column called last_seen_time.\n\nThis could also alternatively sit on top of a Redis, if you have finite amount of data.But along with last seen time, if you want to store certain other information,\n\nthen Redis might have memory issues.So, in that scenario, you can use a Cassandra.\n\nYou might have a doubt that - when we use MySQL for user information,why don't we use a MySQL here? The reason is -\n\nlet's say, a user is on the app.Every five seconds, the app will send a notification that the user is live.\n\nSo, every five seconds, for each user, this will have ainsert into the database. What that means is - this is having an extremely high throughput\n\nand MySQL might not be able to support that because these are all the writes,which will go into the master node of MySQL.\n\nBut, if it's a Cassandra, it could be spread out easily across a lot of users.Redis might also have those update problem because\n\nfor all the users, you are doing a lot of inserts. So, Redis might not be able to scale.But, if it's a Cassandra, it should easily be able to scale to any amount of traffic,\n\nany amount of users and those things coming at any frequency.One more thing - There are two kinds of events that are spawned.\n\nOne are the events that are spawned by the app and one are the events that are spawned by the users.Example of events spawn by app could be - as soon as you turn the internet on,\n\nthe app would make a WebSocket connectionand pull in some requests. That is not a user activity. So,\n\nthat would not be captured as a, you know, activity of a user in the Last Seen Service.But, as soon as the person opens the app or closes the app\n\nor does anything within the context of an app,those are actually the events that Last Seen Service would be looking at.\n\nIn general, all the services that we looked at, we are looking at here,in the other previous section, all of those are, as usual, horizontally scalable.\n\nSo, when your number of users or anything increases,you just add more number of nodes and that should be able to handle itself.\n\nOther than that, you will obviously need to do a lot of monitoring,alerting - basically to ensure that you are able to get to your NFRs of\n\nno lag, low latency and high availability.So, some of the important things that you want to,\n\nkind of, keep a track of from a monitoring perspective is -the CPU memory utilization of your services, your disk utilization in the databases,\n\nyour throughputs and latency onto your web servicesand the disk utilization in your Kafka and more importantly the lag in Kafka.\n\nLet's say, if your lag increases, you need to add more number of consumers.So, all of those metrics you can capture, store it into a\n\nGrafana kind of a store and plot some graphs out of it.And also, you can build some alerting out of it. In case\n\nyour numbers go beyond a certain threshold, you can send out alerts.Those alerts could be used to make some decisions.\n\nFor example, if your throughput is increasing significantly,you could add more machines into a particular service\n\nand in fact those things could be automated as well.So, if you're using AWS kind of a thing, you might write a script which\n\nlooks at your throughput and it adds more nodes or removes certain nodes.All of those things are very important when it comes to\n\na chat application because one of your very critical NFR is that it needs to be actuallyreal time. If it's not real time, then it will give a very\n\nbad experience and then people will kind of drop out of your platform.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "We will support a One-to-One Chat wherein a person can send a message to another person or a user.There would be something called a Group Chat where\n\nsomebody could make a group of people and whenever anybody in the groupsends a message to the group, that message is received by everybody in the group.\n\nThe messages could contain text, it could contain images, it could contain videosand then it could extend to other kind of documents as well.\n\nThere is something called Read Receipt, which is basically the single tick whenthe message is sent,\n\ndouble tick when the message is delivered to theuser and a blue tick when the person sees the message.\n\nWe'll also show Last Seen time of a particular user.Coming to the non-functional requirements,\n\nthis platform needs to have a very very low latency becausefor a chat application it needs to look very real-time so,\n\nwhile you are sending a message, the other person should immediately be able to see that message.And obviously it should have a very high availability. This system\n\nshould not go down, no matter what happens.Also, there should not be any lag.\n\nIn other videos that we have talked about in the past,we were able to live with a lot of lag as well.\n\nBut in this video, we cannot have a lag because again, it needs to be a very real-time systemwherein I am typing something to you and you can see it then and there and then respond to it.\n\nComing to some scale numbers, these are approximate numbers of WhatsApp.Again, I do not know if these are actually correct or not but I just read somewhere.\n\nWhatsApp has roughly 2 billion users, out of which 1.6 billion users accessit on a monthly basis. These are unique users.\n\nEach day WhatsApp has somewhere close to 65 billion messages being sent across all the users.And that's a very big number.\n\nWe will try to look at how can we design a systemthat can deliver all of these functional requirements, with a very low latency\n\nand can live with these kind of numbers.Numbers for Facebook Messenger are approximately similar\n\nand other chat application could also be running at a very same scale.Let's look at the overall architecture of the whole system.\n\nWe'll first start with the Chatting Solution and thenwe'll look at other small pieces that surround it.\n\nLet's start with the User flow.All of these things that you see here are basically user devices.\n\nCould be mobile phones, could be web browsers,could be wearable devices like smart watch and all of that.\n\nLet's say user1 wants to send a message to user2.So, the flow goes like this -\n\nuser1 wants to send a message to user2 with a message id, m1.What happens is - user1 is talking to something called a WebSocket Handler 1.\n\nThere will be a lot of these WebSocket Handlers.What this is - is basically,\n\na WebSocket Handler is a server on our backend,which is keeping open connections with all the active users, right now.\n\nThese are the live users, who are having an active internet connection kind of a thing.All of these users are connected to some of the machines.\n\nThen, there'll be a lot of these machines.And, all of these would be distributed across the globe.\n\nSo that, people in certain geography,talk to the servers which are nearer to them, so as to have a lesser latency.\n\nLet's just say, user1 is connectedto this WebSocket Handler 1 and it sends this message to WebSocket Handler 1 saying,\n\nsend this message m1 to user U2.Now, this WebSocket Handler does 2 - 3 things when this happens.\n\nIt talks to something called a WebSocket Manager.WebSocket Manager is a repository of the fact that, which device is connected to what all users.\n\nBecause these are probably thousands of devices,we need to keep that information at some central place,\n\nwhich is this WebSocket Manager Service.It sits on top of a Redis, which stores two information mainly.\n\nFirst of all, it stores that user1 is connected to WebSocket Handler 1and WebSocket Handler 1 is connected to user1, user10, user20, something of that sort.\n\nSo, a list of user ids that a particular machine is connected to,that information gets stored in Redis.\n\nLet's say, a connection breaks between a user and a machine.And now, the user is connected to a different machine.\n\nSo, that information is updated through this WebSocket Manager, into this Redis.The second thing that WebSocket Handler 1 does is - talk to something called Message Service.\n\nMessage Service is basically the repository of all the messages in the system.It will have APIs to get a message by message id, get the message by user ids and various filters.\n\nSo, if you want to fetch all the unread messagesby a particular user and all of that, that would be powered by this Message Service.\n\nIt sits on top of a Cassandra database.Why Cassandra? Because, again we have these billions of users,\n\nwho will send many many billions of messages so,Cassandra is a fairly good data store to store that kind of a volume.\n\nPlus, the query pattern that we have fairly aligns with the query pattern that Cassandra is good at.So that's the reason we choose a Cassandra here.\n\nThere are two kinds of message services that we can build.Basically there are two kind of messaging platforms that we have.\n\nOne is something like a Facebook, which stores all of your messages. So,in that case everything would be stored in a Cassandra permanently.\n\nAnd, then there is something like a WhatsApp,which stores the messages only till the time it is not delivered to the user.\n\nOnce it gets a delivery acknowledgement, then it deletes the message.So, if we want to build a WhatsApp kind of system, we could delete the message from here also.\n\nDeletes are a bit inefficient in Cassandra so, if we were tobuild that kind of a system, we might choose some other data store as well.\n\nBut for now, Cassandra would work fairly fine.Coming back to.. we were at WebSocket Handler 1,\n\nwhich got this message saying U1 wants to send to U2, a message m1.Talk to both of these services and it would happen parallelly so, it can happen in any order.\n\nMessage Service would save the message into Cassandra and give the message id.Let's say message id is m1.\n\nWebSocket Manager will now tell WebSocket Handler 1,saying, user U2 is connected to this WebSocket Handler 2.\n\nNow, do whatever you want to do.Now, this guy, WebSocket Handler 1\n\nwill talk to WebSocket Handler 2 saying that I have got a message for U2.I believe that guy's connected to you. Go send them that message.\n\nNow, there are 2 - 3 possibilities.WebSocket Handler 2 could actually be connected to that user still and he will send the message.\n\nOr it could not be connected. It will say that I am not connected to the user. Theperson has probably gone offline.\n\nSo, he will not do anything and the flow ends there.Let's say, the WebSocket Handler 2 sends this message to U2.\n\nNow there are 2 - 3 things that can happen.Maybe the user is not using the app actively but the message got delivered.\n\nSo, this device will send a message to WebSocket Handler 2,saying that I have received the message.\n\nOr the second option could be - the person is actually open on the chatof this user U1 and could see the message then and there.\n\nSo, that device would send a message saying, I have received and seen the message m1.Now, this guy, WebSocket Handler 2 again queries WebSocket Manager,\n\nsaying that this message was now either delivered or read.I need to inform user U1 so tell me which machine is talking to user U1.\n\nIt will get this particular machine's IP, saying this guy is now handlinguser U1 and it will send this message to WebSocket Handler 1,\n\nsaying this particular message id m1, has now been read or received, whateverand go inform the user and this will be informed to the user.\n\nHow are these connections happening?These are WebSocket connections, which is basically a bi-directional connection.\n\nSo, there's no client and server here.Any party can send a message. So, that's how even server is able to send a message to the client.\n\nThese are built on top of TCP.In this whole process, we queried WebSocket Manager a lot of times.\n\nUser U1 calling for U2, U2 calling for U1 and all of that.Now, at the same time, if the user sends multiple messages, again, we'll try to do that.\n\nLet's try to cache this information somewhere.Each machine will cache 2 kinds of things.\n\nOne it will cache is - the list of users that are connected to itself.So, if user U2 was also connected to the same machine,\n\nit would have the data in memory. It would never have to call this manager.The other thing is - it would temporarily,\n\nfor a very short duration of time, maybe 10, 20, 30 seconds,cache the information about conversations that it has had recently.\n\nSo, if user U2 was connected to this handler H2,this guy (H1) will keep it in cache, saying user U2 is on this particular machine.\n\nBecause if U1 sends another message to this U2, it now need not call this WebSocket Manager.But, keep in mind, this second cache needs to\n\nbe stored with a very low time to live (TTL) and it should expire every 30 odd seconds.Because remember, these are global users.\n\nLet's say, if somebody is connecting from Sri Lanka,you would probably get connected to a server in India.\n\nThat's a fairly large amount of distance and that communication might break in betweenand the person might get connected to a different machine, the next time.\n\nSo to, kind of, handle those things easily, we'll keep this cache at a very low TTL.There are another set of things.\n\nNow, the receipts that we have sent to user U1 and user U2,all those receipts.. we need to decide whether we want to store them or not.\n\nSo if, let's say, we want to store the read receipts also,we can store that as a, probably, status in Cassandra, in the same table saying,\n\nthis particular message has a, to start with, status as sent.Then it will move to received. Then it will move to read.\n\nWe can decide.. you can decide that basedon your conversation with the interviewer, whether you want to store this information\n\nor even whether you want to store the messages in the first place or not.All of those things are a conversation that you need to have with your interviewer.\n\nBut, you still need to store it, for at least some time.Let's just say that - user U1 sent a message to user U2 and then went offline.\n\nNow, the receipts wouldn't go back.So at least, for a short duration of time, those read receipts need to be stored in the database\n\nand whenever user U1 comes online, then he'll get that.Let's just say, user U1 wanted to send a message to user U3.\n\nSo, a second message.. user U1 is sending a messageto user U3, which is some message m2, with some text.\n\nNow, what will happen is -again, it will store in, through Message Service,\n\nit will call WebSocket Manager, to get who is the machine which is handling user U3.User U3 is offline. There is no machine that is talking to user U3.\n\nSo now, WebSocket Manager will return a response saying, I don't have a machine.That flow ends there.\n\nThis WebSocket Handler 1 does not inform anybody because there is no machine talking to user U3.So, the flow breaks there.\n\nNow, when user U3 comes online, let's just say that, user U3 gets connected to thisWebSocket Handler H3.\n\nWhat this WebSocket Handler does in the very first place is - to query Message Service and ask for -are there any messages for user U3 that are not in received or read status.\n\nThis Message Service will respond back and user U3 will see all those messages.Then, when, as those messages are being received and read,\n\nthose communications will flow back through the same flowlike we discussed earlier.\n\nSo, then, these machines will start talking to each other,for user U3 as well and those receipts, will go on to other users as well.\n\nThere is a potential race condition here.When user U1 was sending a message for user U3,\n\nassume, at the exact same time user U3 came online.We said these are parallel calls, wherein a person is figuring out the machine\n\nwhich is being used for user U3 and storing the message.Let's just say that, the very first thing that happened was - WebSocket\n\nManager returned that there is no machine that is talking to user U3.The next thing that happens was - user U3\n\ncomes online and queries Message Service, saying that get me all the messages.The third thing that happens is - it stores into WebSocket Manager that\n\nthis machine 3 is handling user U3.The fourth thing that happens is - this message gets stored into this Message Service.\n\nNow, WebSocket Handler 3 thinks that - it has fetched all themessages for user U3 and displayed it on the device.\n\nThis WebSocket Handler 1 thinks that - user U3 isoffline and I have stored the messages and done my work.\n\nBut fundamentally, whatever this message m2 was, that has not been received by this guy (U3).Because, before that message was stored, this WebSocket Handler 3 retrieved all the messages.\n\nThese kind of race conditions could happen when you are doing parallel calls.There are multiple ways to handle it.\n\nYou can either do itsequentially but that will increase the latencies. So, I'll not recommend that.\n\nWhat another solution you could possibly do is - this WebSocketHandler keeps pulling the server once in a while,\n\nsaying are there any messages that I still missed. So, all of those messages could be pulled.But, that would happen at a fairly low frequency and those could be bulk calls, something like -\n\nare there any messages for user U1, U2, U3 to U100 which are in sent status,for all the active users that this machine is connected to.\n\nAnd, if it finds any messages, it will send all of those messages as well.There are certain things that happen on the device itself.\n\nLet's say user U1 was offline. And,you can still send message onto some user's chat, while you are offline.\n\nSo, let's say, U1 sent another message to somebody while it was offline.So, what would happen is - it will try to connect. Because internet is not there,\n\nit will not be able to connect to any servers.In that scenario, what will happen.. even, in all other scenarios also..\n\nall the messages would be stored in a local database which is persisted onto the device disk.Let's say, it's an android application.\n\nIt could use any kind of a android database likea SQLite or anything and store all those messages on the disk.\n\nNow, whenever the device gets the internet connection,it will pull those messages from a queue kind of a thing or that database\n\nand send those messages. So,this is how it would be able to handle scenarios where the device was offline.\n\nNow, we have the next thing as group messages. How does that work?Group messages almost work in a very similar way.\n\nLet's say, another scenario, U1 wanted to send a message to group g1, a message called m3.What would happen is - in case of groups, the behaviour is slightly different.\n\nThis WebSocket Handler wouldn't take care of fanning out to all the groups.This is a very lightweight service,\n\nwhich just takes a message from a user and sends it to somebodyor gets a message from somebody and sends it to a user. It doesn't have a lot of logic.\n\nFor group messages, what it will do is - it will just send a message to Message Service,saying user U1 wants to send a message m3 to group g1, store it and do whatever you need to do.\n\nSo, this message service will insert that into Cassandra saying the message is stored.Along with that, what it will also do,\n\nfor all the group messages, it will put all of those messages into a Kafka topic sayingthere's a group message that I've got, which is this user U1, sending to group g1,\n\na message m3. Go send it out.From Kafka, there will be something called a Group Message Handler.\n\nThis is basically a Kafka consumer, which is listening on to the same topicand it is responsible for sending out all the group messages.\n\nFirst of all, it does some validations that it needs to, assuming that's out of scope for us,saying whether U1 is even in the group to be able to send it to g1,\n\nbut assuming that's not a part of scope.It basically queries Group Service, to get all the users that are into group g1.\n\nIt gets a list of users, then it will remove the user U1 from that list.And now it has a list of the users that are supposed to get this message.\n\nNow, it follows the exact same flow that was used for one -to- one messagesbut, for all of these users.\n\nSo, it basically calls WebSocket Managersaying, give me all the machines that these users are connected with.\n\nIt will get a response saying machine 1 is connected to user U3; U4; U5,machine 2 is connected to some other set of users and all of that.\n\nThen it will send the messages to individual machines saying,to this user send this message, to this user send this message.\n\nAnd then the receipts and all will follow the exact same flow that was handled earlier.The next thing - what happens when people are\n\nuploading assets like images or videos or anything of that sort.The very first thing that happens when you are trying to upload\n\nany content is that - there is some kind of a compression that happens.Now, in real WhatsApp, there is encryption also that happens right at device\n\nand the encrypted messages are sent out.And when the messages are received, even the encrypted messages are\n\nreceived and they're decrypted but we'll keep that out of scope.We'll just think of some compression there.\n\nLet's say, U3 is sending a image to U2. So, what will happen is - U3 is sending to U2, some image.This is basically a two-step process.\n\nThe first step is - upload an image to a server and get an image idand then send that image id via the regular route to user U2. And then, U2 can fetch the image.\n\nHow the image upload works is - again, these arelightweight servers they wouldn't have any logic. So, very first thing is -\n\ncompression of the image, over here or video or anything. Then,it will talk to something called this Asset Service.\n\nSo, this U3 is talking to Asset Service through this Load Balancer. Again,all the authentication, authorization will happen at this layer and\n\nAsset Service now gets the whole image or video or whatever.Asset Service will use Amazon S3 as a data store and it will store all the images there.\n\nNow, based on which image is getting what kind ofhits on S3, it might decide to move some of the images on CDN\n\nand it could also decide to replicate into multiple CDNs or some CDNs,from where it is getting traffic.\n\nBut assuming, it has uploaded the image on S3 and it sends a response saying,let's say, it is a image i1. It will come as a regular message to U2,\n\nthrough this WebSocket Handler (H3).. these two WebSocket Handlers saying,send this message and the receipts will happen in the same way that we talked about earlier.\n\nThere could be one optimization that can happen.Let's say, there's a political event or a sports event\n\nand a lot of people are sharing the same image for some reason.Do we need to upload the same image multiple times,\n\nif five people are uploading the same image? Probably not!!So, before it even uploads to Asset Service, the first thing that the device will do is -\n\ntake a hash of those images and send the hash content to Asset Service.Basically, it's a way of asking - do you have this image already or not?\n\nIf you have it, then just send it to user U2.If you don't have it, then ask me and I'll upload it. Something of that sort.\n\nOf course, when it's about hashing,there would be various problems like duplicate hash outputs and collisions and all of that.\n\nSo, instead of taking one hash, we could probably take five differenthash algorithms and use all of them to get five different hashes\n\nand if all the five hashes are matching against an image,then we'll say that, an image is already there.\n\nIf it's not matching, then we'll say that, the image needs to be uploadedand it will follow the regular route that we talked about.\n\nAnd if it is already there, then anyway it's there, it just sends a message.Now, let's look at remaining few components and how they help in the whole system.\n\nSo, this is the user app, which talks to all of these components. It could be a browser as well.The very first thing is - something called User Service. This is basically a\n\nservice, which owns the user profile information.It could be - their name, their user id,\n\ntheir profile picture in case of WhatsApp and some user preferences. In case of Facebook, it will bea larger set of data. But all of that, whatever that data is,\n\nit would be residing in a clustered MySQL, which runs the user database.All of those information would also be cached in Redis cluster,\n\nvery similar to the way we have implemented in other similar solutions.Against a key, we'll be having the user\n\nprofile information and a lot of other information as well.There's something called Group Service, which basically maintains all the group information.\n\nIt basically has information of - which group has what all users.Think of it as a many-to-many table, with a user id and a group id\n\nand a time when user was added into the groupand maybe a status saying, whether the user is admin or something of that sort.\n\nAgain, this information would be stored in the MySQL cluster,which would be geographically distributed and it will have multiple slaves\n\nthrough which the read queries will be run. It will also have a Redis sitting on top of it. So,all the APIs like, let's say, get users in a group\n\nand something of that sort,would be powered by this Redis cluster and those APIs would be sitting within the Group Service.\n\nEach time, either User Service or Group Service, queries Redis and it does not find the data,is when they actually query one of the salves\n\nof these databases, fetch the information, put it into the Redis and respond back towhoever is calling them.\n\nAnd then, group service was used in the group messaging workflow, that we looked at earlier.Each action that a user is taking on their app, gives us a lot of information.\n\nFor example, if a person is visiting some user's profile a lot of times,that tells us that the person is interested in this user.\n\nIt could be used for some kind of Analytics.Let's say, if a particular person is talking a lot about sports,\n\nthat does tell us that the person is a sports enthusiast.How could we do that?\n\nAll events that are happening,either they are events within the app or they are messages or anything of that sort,\n\nwould be sent either to this Analytics Service and then to Kafka,or directly to Kafka, in case of messages.\n\nThere could be a Spark Streaming Consumer running on top of this,which could do a lot of inferences.\n\nFirst of all, it could do some message classification into some tags,like a message is a sports kind of a message or a general message or a\n\npolitics kind of a message and then try to classify users basis that. So,that is one kind of analytics.\n\nAnother thing could be, just simply,some information about what are people talking about, in general.\n\nThis is not possible if the messages are end to end encrypted.But if that's not the case, then we should be easily able to infer all of that.\n\nThere are two parts.One is - doing some logic, based on some streaming content.\n\nThat could be done by a simple Spark Streaming Consumer.And, that consumer would also put that data into Hadoop.\n\nAnd then, you can run a lot of analytics queries, based on Hadoop.Something like, which are the people who talk about sports a lot or which\n\nare the people who just talk about a particular kind of political party oranything of that sort. Those kind of analytics could be run out of that Hadoop cluster.\n\nThese events are also having one more usage.Each time a person does an activity on the app,\n\nthose events are listened by something called Last Seen Service.This Last Seen Service is basically, the service used to store the last seen time of a user.\n\nThis service.. I made it to sit on top of a Cassandra database,which has a column called user_id and a column called last_seen_time.\n\nThis could also alternatively sit on top of a Redis, if you have finite amount of data.But along with last seen time, if you want to store certain other information,\n\nthen Redis might have memory issues.So, in that scenario, you can use a Cassandra.\n\nYou might have a doubt that - when we use MySQL for user information,why don't we use a MySQL here? The reason is -\n\nlet's say, a user is on the app.Every five seconds, the app will send a notification that the user is live.\n\nSo, every five seconds, for each user, this will have ainsert into the database. What that means is - this is having an extremely high throughput\n\nand MySQL might not be able to support that because these are all the writes,which will go into the master node of MySQL.\n\nBut, if it's a Cassandra, it could be spread out easily across a lot of users.Redis might also have those update problem because\n\nfor all the users, you are doing a lot of inserts. So, Redis might not be able to scale.But, if it's a Cassandra, it should easily be able to scale to any amount of traffic,\n\nany amount of users and those things coming at any frequency.One more thing - There are two kinds of events that are spawned.\n\nOne are the events that are spawned by the app and one are the events that are spawned by the users.Example of events spawn by app could be - as soon as you turn the internet on,\n\nthe app would make a WebSocket connectionand pull in some requests. That is not a user activity. So,\n\nthat would not be captured as a, you know, activity of a user in the Last Seen Service.But, as soon as the person opens the app or closes the app\n\nor does anything within the context of an app,those are actually the events that Last Seen Service would be looking at.\n\nIn general, all the services that we looked at, we are looking at here,in the other previous section, all of those are, as usual, horizontally scalable.\n\nSo, when your number of users or anything increases,you just add more number of nodes and that should be able to handle itself.\n\nOther than that, you will obviously need to do a lot of monitoring,alerting - basically to ensure that you are able to get to your NFRs of\n\nno lag, low latency and high availability.So, some of the important things that you want to,\n\nkind of, keep a track of from a monitoring perspective is -the CPU memory utilization of your services, your disk utilization in the databases,\n\nyour throughputs and latency onto your web servicesand the disk utilization in your Kafka and more importantly the lag in Kafka.\n\nLet's say, if your lag increases, you need to add more number of consumers.So, all of those metrics you can capture, store it into a\n\nGrafana kind of a store and plot some graphs out of it.And also, you can build some alerting out of it. In case\n\nyour numbers go beyond a certain threshold, you can send out alerts.Those alerts could be used to make some decisions.\n\nFor example, if your throughput is increasing significantly,you could add more machines into a particular service\n\nand in fact those things could be automated as well.So, if you're using AWS kind of a thing, you might write a script which\n\nlooks at your throughput and it adds more nodes or removes certain nodes.All of those things are very important when it comes to\n\na chat application because one of your very critical NFR is that it needs to be actuallyreal time. If it's not real time, then it will give a very\n\nbad experience and then people will kind of drop out of your platform.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 56,
			"versionNonce": 1296719616,
			"isDeleted": false,
			"id": "d1qP6EDITP61nuY1w9zmo",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7550.163734721474,
			"y": 12090.679354809548,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 337,
			"height": 357,
			"seed": 1568235194,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "49a8da992758b9bdc0f8fd3fa7bed331342b3440",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 31,
			"versionNonce": 1246695680,
			"isDeleted": false,
			"id": "6HV6XxZi",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7502.5516735785295,
			"y": 11866.700402413187,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 175.78125,
			"height": 24,
			"seed": 1876626298,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "SDFC (Approach)",
			"rawText": "SDFC (Approach)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "SDFC (Approach)",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 69,
			"versionNonce": 312901376,
			"isDeleted": false,
			"id": "kD4jp7Hd",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8152.563751919424,
			"y": 12196.290763070692,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 621.09375,
			"height": 24,
			"seed": 1866792678,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "kafka is pull based while redis pub-sub is push based",
			"rawText": "kafka is pull based while redis pub-sub is push based",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "kafka is pull based while redis pub-sub is push based",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 47,
			"versionNonce": 809824512,
			"isDeleted": false,
			"id": "79N6TRP_yVn3ARPKWpSVu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7601.085671081759,
			"y": 12594.27293181784,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 875,
			"height": 560,
			"seed": 788100410,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "5fde8a31dc23ccdd82f452e0a91b18fe4e260996",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 83,
			"versionNonce": 394174208,
			"isDeleted": false,
			"id": "YMX__7OXXVd3eQeyha-ng",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8734.557491009988,
			"y": 12610.14545913265,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 665.2814145459528,
			"height": 617.9249877929688,
			"seed": 534569786,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "553bf6185f9a3f51d39b203f59a8469e29767884",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "freedraw",
			"version": 27,
			"versionNonce": 478073088,
			"isDeleted": false,
			"id": "DTpNzKN8_xVLlmi5QsFHd",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8124.17988986445,
			"y": 12501.141533861532,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1.4822410462684275,
			"height": 29.643011659522017,
			"seed": 461306982,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					0,
					4.44644044101733
				],
				[
					0,
					8.892880882032841
				],
				[
					0,
					13.339377862608671
				],
				[
					0,
					17.785818303624183
				],
				[
					0,
					20.750130777489176
				],
				[
					0,
					22.232258744641513
				],
				[
					0,
					25.196571218504687
				],
				[
					0,
					26.678699185658843
				],
				[
					0,
					28.16088369236786
				],
				[
					0,
					29.643011659522017
				],
				[
					1.4822410462684275,
					29.643011659522017
				],
				[
					1.4822410462684275,
					29.643011659522017
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 92,
			"versionNonce": 206749440,
			"isDeleted": false,
			"id": "5M2I5n9funRNtnuR8PGHM",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8115.287008982416,
			"y": 12472.980678438942,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 72.62540118164998,
			"height": 71.14324494471839,
			"seed": 455684582,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-5.928624947727258,
					2.9642842040848336
				],
				[
					-8.892880882032841,
					5.928596677949827
				],
				[
					-13.339377862607762,
					10.375037118965338
				],
				[
					-16.303633796913346,
					11.857193355897834
				],
				[
					-17.785761764066592,
					17.785790033845842
				],
				[
					-20.750130777487357,
					17.785790033845842
				],
				[
					-20.750130777487357,
					22.232258744641513
				],
				[
					-22.232258744640603,
					23.71438671179385
				],
				[
					-23.71438671179385,
					25.196542948726346
				],
				[
					-23.71438671179385,
					28.16085542258952
				],
				[
					-23.71438671179385,
					29.643011659522017
				],
				[
					-23.71438671179385,
					32.60729586360685
				],
				[
					-22.232258744640603,
					34.08948037031769
				],
				[
					-20.750130777487357,
					37.05373630462236
				],
				[
					-19.26788973121893,
					37.05373630462236
				],
				[
					-17.785761764066592,
					41.50023328519819
				],
				[
					-14.821505829760099,
					42.98236125235053
				],
				[
					-13.339377862607762,
					44.464489219502866
				],
				[
					-11.857136816339334,
					47.42880169336786
				],
				[
					-7.410752914880504,
					48.910986200078696
				],
				[
					-5.928624947727258,
					51.87524213438337
				],
				[
					-1.4821279671532466,
					53.35742664109421
				],
				[
					2.964369013421674,
					57.80386708211154
				],
				[
					4.446496980574921,
					60.76817955597471
				],
				[
					8.89288088203375,
					63.732492029837886
				],
				[
					11.857249895454515,
					66.69674796414438
				],
				[
					14.821505829761008,
					68.17893247085522
				],
				[
					16.303633796913346,
					68.17893247085522
				],
				[
					19.26800281033502,
					71.14324494471839
				],
				[
					20.750130777488266,
					71.14324494471839
				],
				[
					22.232258744640603,
					71.14324494471839
				],
				[
					23.71438671179385,
					71.14324494471839
				],
				[
					25.196627758062277,
					71.14324494471839
				],
				[
					26.678755725215524,
					71.14324494471839
				],
				[
					28.16088369236877,
					71.14324494471839
				],
				[
					32.60738067294278,
					71.14324494471839
				],
				[
					34.08950864009603,
					69.66106043800755
				],
				[
					37.05376457440161,
					66.69674796414438
				],
				[
					40.018133587823286,
					63.732492029837886
				],
				[
					41.50026155497562,
					62.25030752312705
				],
				[
					44.464517489282116,
					60.76817955597471
				],
				[
					44.464517489282116,
					57.80386708211154
				],
				[
					45.94664545643445,
					57.80386708211154
				],
				[
					45.94664545643445,
					56.32173911495738
				],
				[
					45.94664545643445,
					53.35742664109421
				],
				[
					47.42888650270379,
					48.910986200078696
				],
				[
					47.42888650270379,
					45.9466737262137
				],
				[
					48.91101446985613,
					41.50023328519819
				],
				[
					48.91101446985613,
					38.5359208113332
				],
				[
					48.91101446985613,
					37.05373630462236
				],
				[
					48.91101446985613,
					34.08948037031769
				],
				[
					47.42888650270379,
					32.60729586360685
				],
				[
					47.42888650270379,
					31.125139626674354
				],
				[
					45.94664545643445,
					28.16085542258952
				],
				[
					44.464517489282116,
					26.678699185658843
				],
				[
					42.98238952212887,
					23.71438671179385
				],
				[
					41.50026155497562,
					22.232258744641513
				],
				[
					40.018133587823286,
					20.750102507709016
				],
				[
					38.53589254155486,
					19.26794627077834
				],
				[
					35.571636607248365,
					17.785790033845842
				],
				[
					34.08950864009603,
					14.821505829761008
				],
				[
					31.125139626674354,
					14.821505829761008
				],
				[
					29.643011659521108,
					11.857193355897834
				],
				[
					25.196627758062277,
					10.375037118965338
				],
				[
					23.71438671179385,
					8.89288088203466
				],
				[
					22.232258744640603,
					8.89288088203466
				],
				[
					19.26800281033502,
					7.410752914880504
				],
				[
					17.785874843181773,
					7.410752914880504
				],
				[
					16.303633796913346,
					5.928596677949827
				],
				[
					16.303633796913346,
					4.44644044101733
				],
				[
					13.339377862607762,
					4.44644044101733
				],
				[
					11.857249895454515,
					4.44644044101733
				],
				[
					10.375121928302178,
					4.44644044101733
				],
				[
					8.89288088203375,
					2.9642842040848336
				],
				[
					5.928624947727258,
					2.9642842040848336
				],
				[
					2.964369013421674,
					2.9642842040848336
				],
				[
					2.964369013421674,
					2.9642842040848336
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 40,
			"versionNonce": 645705984,
			"isDeleted": false,
			"id": "XW-_AvYYSCU7v1D3te9RF",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8973.452219141376,
			"y": 12475.944962643027,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 32.60726759382669,
			"height": 31.125196166232854,
			"seed": 2025437862,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					5.928624947728167,
					0
				],
				[
					10.375008849186997,
					0
				],
				[
					14.821505829761008,
					1.4821562369324965
				],
				[
					19.26800281033502,
					4.446468710795671
				],
				[
					20.750130777487357,
					5.928596677949827
				],
				[
					22.232258744641513,
					7.410752914880504
				],
				[
					23.71438671179385,
					10.375065388745497
				],
				[
					23.71438671179385,
					11.857221625676175
				],
				[
					23.71438671179385,
					13.339349592830331
				],
				[
					23.71438671179385,
					16.303662066693505
				],
				[
					23.71438671179385,
					17.785818303624183
				],
				[
					20.750130777487357,
					20.750102507709016
				],
				[
					17.7857617640675,
					23.71441498157401
				],
				[
					14.821505829761008,
					26.678727455437183
				],
				[
					11.857249895454515,
					31.125196166232854
				],
				[
					10.375008849186997,
					31.125196166232854
				],
				[
					16.303633796913346,
					31.125196166232854
				],
				[
					19.26800281033502,
					31.125196166232854
				],
				[
					22.232258744641513,
					31.125196166232854
				],
				[
					25.196514678946187,
					31.125196166232854
				],
				[
					28.16088369236786,
					29.643011659522017
				],
				[
					29.643011659520198,
					28.16085542258952
				],
				[
					31.125139626674354,
					28.16085542258952
				],
				[
					32.60726759382669,
					28.16085542258952
				],
				[
					32.60726759382669,
					28.16085542258952
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 113,
			"versionNonce": 295886592,
			"isDeleted": false,
			"id": "YzR7qZkpMeDIy1vm1_ySJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8974.934347108529,
			"y": 12444.819794746574,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 96.3399009725581,
			"height": 83.0004383006144,
			"seed": 1586487910,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-4.44638390145883,
					1.4821562369324965
				],
				[
					-5.928624947726348,
					2.964312473864993
				],
				[
					-10.375008849185178,
					4.446468710795671
				],
				[
					-11.857136816337515,
					7.410752914880504
				],
				[
					-13.339377862606852,
					8.892909151813
				],
				[
					-16.303633796913346,
					10.375065388743678
				],
				[
					-16.303633796913346,
					11.857221625676175
				],
				[
					-19.26788973121802,
					14.821505829761008
				],
				[
					-19.26788973121802,
					16.303662066693505
				],
				[
					-22.232258744639694,
					17.785818303624183
				],
				[
					-23.71438671179385,
					20.750130777489176
				],
				[
					-26.678642646098524,
					22.232258744641513
				],
				[
					-28.16088369236786,
					25.196571218504687
				],
				[
					-29.643011659520198,
					28.16088369236786
				],
				[
					-31.125139626672535,
					29.643011659522017
				],
				[
					-31.125139626672535,
					31.125167896452695
				],
				[
					-31.125139626672535,
					32.60732413338519
				],
				[
					-31.125139626672535,
					34.08948037031769
				],
				[
					-31.125139626672535,
					35.571636607248365
				],
				[
					-31.125139626672535,
					40.018077048265695
				],
				[
					-31.125139626672535,
					42.98238952212887
				],
				[
					-29.643011659520198,
					45.9466737262137
				],
				[
					-28.16088369236786,
					51.87527040416171
				],
				[
					-26.678642646098524,
					53.35742664109421
				],
				[
					-25.196514678946187,
					56.32173911495738
				],
				[
					-23.71438671179385,
					60.76817955597471
				],
				[
					-22.232258744639694,
					63.732492029837886
				],
				[
					-20.750130777487357,
					66.69680450370106
				],
				[
					-20.750130777487357,
					68.17893247085522
				],
				[
					-19.26788973121802,
					69.66111697756605
				],
				[
					-17.785761764065683,
					69.66111697756605
				],
				[
					-17.785761764065683,
					71.14324494471839
				],
				[
					-16.303633796913346,
					74.10755741858156
				],
				[
					-14.82150582975919,
					75.58968538573572
				],
				[
					-13.339377862606852,
					77.07186989244656
				],
				[
					-10.375008849185178,
					78.5539978595989
				],
				[
					-8.892880882032841,
					78.5539978595989
				],
				[
					-7.410752914880504,
					80.03612582675123
				],
				[
					-5.928624947726348,
					81.51831033346207
				],
				[
					-1.482127967152337,
					81.51831033346207
				],
				[
					1.482127967154156,
					81.51831033346207
				],
				[
					4.44649698057583,
					81.51831033346207
				],
				[
					7.410752914880504,
					81.51831033346207
				],
				[
					10.375121928302178,
					81.51831033346207
				],
				[
					13.339377862608671,
					81.51831033346207
				],
				[
					14.821505829761008,
					81.51831033346207
				],
				[
					16.303633796915165,
					81.51831033346207
				],
				[
					19.26800281033502,
					80.03612582675123
				],
				[
					20.750130777489176,
					80.03612582675123
				],
				[
					22.232258744641513,
					80.03612582675123
				],
				[
					25.196627758063187,
					78.5539978595989
				],
				[
					28.16088369236786,
					77.07186989244656
				],
				[
					29.643011659522017,
					77.07186989244656
				],
				[
					34.08950864009603,
					75.58968538573572
				],
				[
					35.571636607248365,
					74.10755741858156
				],
				[
					38.53600562067004,
					72.62537291187073
				],
				[
					42.98250260124587,
					71.14324494471839
				],
				[
					44.464517489283025,
					71.14324494471839
				],
				[
					45.94675853555054,
					69.66111697756605
				],
				[
					50.393255516124555,
					66.69680450370106
				],
				[
					51.87527040416353,
					65.21461999699022
				],
				[
					56.32176738473754,
					62.25036406268555
				],
				[
					57.80400843100506,
					60.76817955597471
				],
				[
					60.76826436531155,
					59.286023319042215
				],
				[
					60.76826436531155,
					57.80389535188988
				],
				[
					62.25027925334871,
					56.32173911495738
				],
				[
					62.25027925334871,
					54.839582878026704
				],
				[
					63.732520299618045,
					53.35742664109421
				],
				[
					65.21476134588556,
					48.91098620007688
				],
				[
					65.21476134588556,
					41.50023328519819
				],
				[
					65.21476134588556,
					37.05376457440252
				],
				[
					63.732520299618045,
					31.125167896452695
				],
				[
					59.286023319042215,
					25.196571218504687
				],
				[
					56.32176738473754,
					19.26797454055668
				],
				[
					53.35751145043105,
					19.26797454055668
				],
				[
					48.91101446985704,
					14.821505829761008
				],
				[
					48.91101446985704,
					13.339377862608671
				],
				[
					45.94675853555054,
					10.375065388743678
				],
				[
					41.50026155497653,
					7.410752914880504
				],
				[
					40.018020508707195,
					7.410752914880504
				],
				[
					37.05376457440252,
					4.446468710795671
				],
				[
					34.08950864009603,
					2.964312473864993
				],
				[
					31.125139626674354,
					2.964312473864993
				],
				[
					29.643011659522017,
					2.964312473864993
				],
				[
					28.16088369236786,
					2.964312473864993
				],
				[
					26.678755725215524,
					1.4821562369324965
				],
				[
					25.196627758063187,
					1.4821562369324965
				],
				[
					23.71438671179385,
					0
				],
				[
					20.750130777489176,
					0
				],
				[
					19.26800281033502,
					0
				],
				[
					17.785874843182683,
					-1.482127967152337
				],
				[
					14.821505829761008,
					-1.482127967152337
				],
				[
					13.339377862608671,
					-1.482127967152337
				],
				[
					10.375121928302178,
					-1.482127967152337
				],
				[
					8.89288088203466,
					-1.482127967152337
				],
				[
					7.410752914880504,
					-1.482127967152337
				],
				[
					5.928624947728167,
					-1.482127967152337
				],
				[
					5.928624947728167,
					-1.482127967152337
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "image",
			"version": 114,
			"versionNonce": 1975423232,
			"isDeleted": false,
			"id": "LWug73YEB2nt5EfLyrgar",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 7656.41103030326,
			"y": 13435.703345158223,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 911.8232193314697,
			"height": 1262.10344764608,
			"seed": 666145210,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "07d911de136c5ed5288e016d6abdd377ace5a046",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "freedraw",
			"version": 81,
			"versionNonce": 938409728,
			"isDeleted": false,
			"id": "YX9QKdQ9Bxc9LGdXAzLPL",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8080.8269966203125,
			"y": 13285.569718593693,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 28.16082715281027,
			"height": 60.76820782575305,
			"seed": 515349370,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.4821845067099275,
					0
				],
				[
					2.964312473863174,
					0
				],
				[
					4.446496980574011,
					0
				],
				[
					4.446496980574011,
					1.4821562369324965
				],
				[
					4.446496980574011,
					2.964312473863174
				],
				[
					5.928624947727258,
					4.446468710795671
				],
				[
					5.928624947727258,
					5.928596677948008
				],
				[
					5.928624947727258,
					7.410752914880504
				],
				[
					5.928624947727258,
					8.892909151811182
				],
				[
					5.928624947727258,
					11.857221625676175
				],
				[
					5.928624947727258,
					13.339349592828512
				],
				[
					4.446496980574011,
					16.303662066691686
				],
				[
					2.964312473863174,
					16.303662066691686
				],
				[
					2.964312473863174,
					17.785818303624183
				],
				[
					2.964312473863174,
					19.26797454055668
				],
				[
					2.964312473863174,
					20.750102507709016
				],
				[
					1.4821845067099275,
					20.750102507709016
				],
				[
					0,
					20.750102507709016
				],
				[
					0,
					22.232258744641513
				],
				[
					-1.4821279671532466,
					23.71441498157219
				],
				[
					-2.964255934306493,
					23.71441498157219
				],
				[
					-4.44644044101733,
					23.71441498157219
				],
				[
					-4.44644044101733,
					25.196571218504687
				],
				[
					-5.928568408169667,
					26.678727455435364
				],
				[
					-7.410752914880504,
					26.678727455435364
				],
				[
					-7.410752914880504,
					25.196571218504687
				],
				[
					-5.928568408169667,
					23.71441498157219
				],
				[
					-2.964255934306493,
					22.232258744641513
				],
				[
					-2.964255934306493,
					20.750102507709016
				],
				[
					-1.4821279671532466,
					19.26797454055668
				],
				[
					-1.4821279671532466,
					17.785818303624183
				],
				[
					0,
					17.785818303624183
				],
				[
					1.4821845067099275,
					17.785818303624183
				],
				[
					2.964312473863174,
					17.785818303624183
				],
				[
					4.446496980574011,
					17.785818303624183
				],
				[
					5.928624947727258,
					17.785818303624183
				],
				[
					7.410752914879595,
					19.26797454055668
				],
				[
					8.892937421590432,
					19.26797454055668
				],
				[
					10.375065388743678,
					20.750102507709016
				],
				[
					11.857193355896925,
					22.232258744641513
				],
				[
					11.857193355896925,
					23.71441498157219
				],
				[
					13.339434402165352,
					25.196571218504687
				],
				[
					14.82156236931769,
					28.16085542258952
				],
				[
					14.82156236931769,
					32.60732413338519
				],
				[
					16.303690336470936,
					34.08948037031587
				],
				[
					16.303690336470936,
					35.571608337470025
				],
				[
					17.785818303624183,
					38.5359208113332
				],
				[
					17.785818303624183,
					40.018077048265695
				],
				[
					17.785818303624183,
					41.50023328519637
				],
				[
					17.785818303624183,
					42.98236125235053
				],
				[
					17.785818303624183,
					44.46451748928121
				],
				[
					17.785818303624183,
					45.9466737262137
				],
				[
					16.303690336470936,
					45.9466737262137
				],
				[
					14.82156236931769,
					50.393114167229214
				],
				[
					11.857193355896925,
					51.87527040416171
				],
				[
					8.892937421590432,
					54.839582878024885
				],
				[
					7.410752914879595,
					56.32173911495738
				],
				[
					4.446496980574011,
					57.80386708210972
				],
				[
					1.4821845067099275,
					59.286023319042215
				],
				[
					0,
					59.286023319042215
				],
				[
					0,
					60.76820782575305
				],
				[
					-2.964255934306493,
					60.76820782575305
				],
				[
					-4.44644044101733,
					60.76820782575305
				],
				[
					-5.928568408169667,
					60.76820782575305
				],
				[
					-7.410752914880504,
					60.76820782575305
				],
				[
					-8.89288088203375,
					60.76820782575305
				],
				[
					-10.375008849186088,
					60.76820782575305
				],
				[
					-10.375008849186088,
					60.76820782575305
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 100,
			"versionNonce": 1103393024,
			"isDeleted": false,
			"id": "SkkayRKN5HtI11qNtZpcQ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8079.344868653159,
			"y": 13264.819616085984,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 85.96472250470015,
			"height": 97.82197240015557,
			"seed": 1810786298,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-1.4821279671532466,
					0
				],
				[
					-4.446440441016421,
					0
				],
				[
					-5.928624947727258,
					0
				],
				[
					-8.892880882032841,
					0
				],
				[
					-10.375065388743678,
					0
				],
				[
					-13.339377862607762,
					1.4821562369324965
				],
				[
					-14.821505829761008,
					2.964312473863174
				],
				[
					-16.303633796913346,
					2.964312473863174
				],
				[
					-17.785818303624183,
					4.44644044101733
				],
				[
					-20.750130777488266,
					8.892909151811182
				],
				[
					-23.71438671179385,
					10.375065388743678
				],
				[
					-23.71438671179385,
					13.339349592828512
				],
				[
					-26.678699185657024,
					14.821505829761008
				],
				[
					-26.678699185657024,
					17.785818303624183
				],
				[
					-28.16088369236786,
					20.750102507709016
				],
				[
					-29.643011659521108,
					26.678699185657024
				],
				[
					-31.125139626674354,
					28.16085542258952
				],
				[
					-32.60732413338519,
					34.08945210053753
				],
				[
					-34.08945210053753,
					38.5359208113332
				],
				[
					-35.571636607248365,
					40.018077048265695
				],
				[
					-35.571636607248365,
					41.50020501541803
				],
				[
					-35.571636607248365,
					42.98236125235053
				],
				[
					-35.571636607248365,
					44.46451748928121
				],
				[
					-35.571636607248365,
					45.9466737262137
				],
				[
					-35.571636607248365,
					47.42882996314438
				],
				[
					-37.05376457440161,
					48.91095793029854
				],
				[
					-37.05376457440161,
					51.87527040416171
				],
				[
					-38.53589254155486,
					53.35742664109421
				],
				[
					-38.53589254155486,
					54.839582878024885
				],
				[
					-38.53589254155486,
					57.80386708210972
				],
				[
					-38.53589254155486,
					60.76817955597471
				],
				[
					-38.53589254155486,
					66.69677623392272
				],
				[
					-38.53589254155486,
					71.14321667493823
				],
				[
					-38.53589254155486,
					74.10752914880322
				],
				[
					-37.05376457440161,
					75.5896853857339
				],
				[
					-37.05376457440161,
					78.55396958981873
				],
				[
					-35.571636607248365,
					83.0004383006144
				],
				[
					-32.60732413338519,
					85.96475077447758
				],
				[
					-32.60732413338519,
					87.44687874163174
				],
				[
					-31.125139626674354,
					88.92906324834257
				],
				[
					-29.643011659521108,
					90.41119121549491
				],
				[
					-28.16088369236786,
					94.85763165651224
				],
				[
					-25.196571218504687,
					94.85763165651224
				],
				[
					-19.26794627077743,
					96.33981616322308
				],
				[
					-16.303633796913346,
					96.33981616322308
				],
				[
					-10.375065388743678,
					94.85763165651224
				],
				[
					-5.928624947727258,
					94.85763165651224
				],
				[
					2.964312473863174,
					88.92906324834257
				],
				[
					7.410752914880504,
					87.44687874163174
				],
				[
					14.821562369318599,
					84.48256626776856
				],
				[
					22.232315284198194,
					80.03612582675123
				],
				[
					28.16082715281027,
					75.5896853857339
				],
				[
					32.60732413338519,
					72.62537291187073
				],
				[
					37.0538211139592,
					69.6610887077859
				],
				[
					40.018077048264786,
					66.69677623392272
				],
				[
					41.50020501541803,
					66.69677623392272
				],
				[
					41.50020501541803,
					63.732463760059545
				],
				[
					42.98233298257128,
					62.25033579290539
				],
				[
					44.464574028839706,
					62.25033579290539
				],
				[
					45.94670199599204,
					59.286023319042215
				],
				[
					47.42882996314529,
					56.32171084517904
				],
				[
					47.42882996314529,
					54.839582878024885
				],
				[
					47.42882996314529,
					50.393114167229214
				],
				[
					47.42882996314529,
					45.9466737262137
				],
				[
					45.94670199599204,
					38.5359208113332
				],
				[
					44.464574028839706,
					35.571608337470025
				],
				[
					40.018077048264786,
					31.125167896452695
				],
				[
					35.571580067690775,
					25.196571218504687
				],
				[
					31.125196166231945,
					22.232258744641513
				],
				[
					28.16082715281027,
					17.785818303624183
				],
				[
					25.196571218504687,
					16.303662066691686
				],
				[
					22.232315284198194,
					13.339349592828512
				],
				[
					17.785818303624183,
					11.857193355896015
				],
				[
					16.303690336470936,
					10.375065388743678
				],
				[
					14.821562369318599,
					8.892909151811182
				],
				[
					11.857193355896925,
					7.410752914880504
				],
				[
					10.375065388743678,
					7.410752914880504
				],
				[
					10.375065388743678,
					5.928596677948008
				],
				[
					8.892880882032841,
					5.928596677948008
				],
				[
					7.410752914880504,
					5.928596677948008
				],
				[
					5.928624947727258,
					4.44644044101733
				],
				[
					4.446440441016421,
					1.4821562369324965
				],
				[
					2.964312473863174,
					1.4821562369324965
				],
				[
					2.964312473863174,
					0
				],
				[
					1.4821279671532466,
					0
				],
				[
					0,
					-1.4821562369324965
				],
				[
					0,
					-1.4821562369324965
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "rectangle",
			"version": 285,
			"versionNonce": 2142707456,
			"isDeleted": false,
			"id": "ksfFY5p0vQaNP6axNY_IV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10048.463564348367,
			"y": -406.6248653048897,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2616.0009765625,
			"height": 15128.000183105469,
			"seed": 1622612454,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 87,
			"versionNonce": 1376669952,
			"isDeleted": false,
			"id": "h2Q3VR8v",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10108.463564348367,
			"y": -352.62507892793656,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 222.65625,
			"height": 120,
			"seed": 1676122278,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Notification Serive\n\ncode karle approach\n\n",
			"rawText": "Notification Serive\n\ncode karle approach\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Notification Serive\n\ncode karle approach\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 263,
			"versionNonce": 1501249280,
			"isDeleted": false,
			"id": "URXxK9yl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10084.062957049266,
			"y": 879.3457384887346,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2449.21875,
			"height": 7056,
			"seed": 416557286,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Let's design a notification service that is scalable enough.This is never a stand alone system but this is always embedded in some\n\nother system design. Even I have used it in a lot of othersystem designs videos that I have made. Let's say if you are building a\n\ne-commerce application or a booking system or anything of that sort.You'll always have a notification service which will be used to notify your consumers.\n\nLet's look at how can we build a notification service.Now let's look at some Functional (FRs) and Non Functional Requirements (NFRs)\n\nthat this platform should support.The very obvious first thing is that it should be able to send notifications.\n\nThe next thing is that it should be pluggable. Now what does pluggable mean?So let's say we want to support SMS and email as one form of notification. Now, tomorrow somebody\n\nmight want to say that I want to support in-app notifications as well.So it should be easy enough to add that. It can be further extended to a lot of kinds of notifications.\n\nSo, for example, you could have something like a WhatsApp notification or anything of that sort.So, extendability is something that should be taken care of.\n\nThe next thing is that it should be built as a SaaS product. Why SaaS? because the main idea isyou should know who's sending what number of notifications.\n\nAnd it should be possible for you to rate limit.There are two use cases where you'll need that.\n\nSo rate limiting as a offering you'll need, if you are giving out to other companies as a product to use.But, even internally, you would need to do some kind of rate limiting.\n\nLet's just say its being used by a company like Amazon.Now there are multiple business verticals.\n\nIf all of them send you notifications, then you'll end up getting hundreds of notifications in a day.So that's a very bad user experience.\n\nSo notification system should be able to overall put a rate limit across all the usersacross all the platforms saying a particular user should not get more than five notifications in a day.\n\nThere could be certain amount of classifications done.So there are two kinds of notifications.\n\nOne is a transactional notification saying you have made an order, this much amount of moneyhas been deducted from your account, something of that sort.\n\nSo transactional notifications are ok to get.But promotional notifications should always have a rate limit.\n\nSo if you're building for within your company, then you'll build a user level rate limiting.But if you're giving it out externally to other companies as a product, then you might want to put\n\na rate limiting saying how many requests can you make for this server.Or maybe make billing tiers and price them accordingly.\n\nSo basically this is something that you need to capture at least and then act upon.The next thing is prioritization. Again...\n\nwe'll support multiple priorities of messages.So the idea of priorities is that some messages are low priority and certain messages are high priority.\n\nLet's say, if you are sending a one time password (OTP), thenthat's a very high priority message. Why? Because if the user wouldn't get that SMS or email or anything,\n\nthen they would not log into your platform and they'll not do the transaction that they wanted to do.But if it's a promotional message, it is okay if it's low priority and if it gets delayed, if it goes to the\n\nuser let's say half an hour late also, it doesn't really matter.So we'll have this prioritization, basis which you'll always process the high priority messages first\n\nand then the low priority messages.Coming to the non functional requirements (NFRs). This platform should always be available. Why?\n\nBecause, if you are planning to build it as a  SaaS product which can be usedby other companies, then down time would really cost us a lot.\n\nPlus, it should be built in a way that it's easy enough to add more clients.And whenever we want, we should be able to attribute saying\n\nhow many clients have made us how many number of requests.Now, let's look at the overall architecture of the whole system. Just a disclaimer to start with,\n\nif you are building it for a small enough use case like let's just say if you want to send out someemail notifications to some customers, given some criteria,\n\nyou can build all of this as one deployable service and put all the logic in one place.But if you truly want to build it as a SaaS product wherein enormous number of clients would be\n\nusing it for a lot of notifications, then this kind of a system would probably be worth it.Let's just look at the starting point.\n\nThe starting point of the whole system is then a couple of clients i.e. Client 1, Client 2,could be any number of clients, who want to send out a notification.\n\nNow, there are 2-3 kinds of requests that they can send you. But all of those requests would comeinto something called as a Notification service, which is an interface for us to talk to the other\n\nteams in the company, other companies or anything that we want.There are two kinds of request mainly. One is where they tell you that I want to send this\n\nparticular content to this particular user, let's say a email id kind of a thing, as an e-mail.This is one of the requests. Other request could be saying, I have this user id and send them\n\nthis notification.And you decide how do you want to send, whether as an email or as a SMS or whatever?\n\nNormally the first kind of a model would be used by other companies where they want to decide thatthey need to send as SMS or email or whatever. The second model would generally be used when you\n\nare building this to be consumed within your own company.But normally as a SaaS product, its good to have both the interfaces. The idea\n\nof notification service is, for most kind of requests,it will just take the request, put it into Kafka and respond back to the client saying, I have taken\n\nthe request and I will send the notification in a couple of seconds at max.You could make this transaction as a synchronous flow but that will take a bit more time\n\nand that will keep the client blocked.So, it's probably best to take the request and dump it into a Kafka and move on.\n\nBut let's just say if for a very critical scenario, you need it to be a synchronous flow.You can basically make the whole process synchronous through API calls.\n\nBut assuming its a Kafka for now, let's look at what happens next.This Notification service would just do a very basic set of validations saying that email id should not be\n\nnull or user id should not be null, content should not be null, something of that sort.There might be a lot of other validations, given certain kinds of events that you want to do.\n\nAll of those validationswould happen in this component which is called Notification Validater and Prioritizer.\n\nIt does a couple of things. Validations is one part of it.The main thing that it does, it decides the priority for a message.\n\nSo based on some attribute within the message, let's say, we''ll keep a message type identifier kindof a thing in a request and based on that, it will decide the priority of a message.\n\nNormally, OTP is something which will be high priority because if the user can't login into thesystem, they can't place an order and things like that.\n\nThe second most high priority thing would be a transactional messagesaying your order has been placed, it will be delivered by so and so time.\n\nThe third, least priority one would would a promotional messagewherein you are sending out offers and coupons and stuff like that.\n\nSo, it decides the priority and puts the event into a Kafka topic, specific for each priority.So there'll be a topic for high priority messages, there'll be a different topic for medium priority,\n\nthere'll be a different topic for low priority.And while consuming, the consumers will first consume the high priority messages\n\nand then the medium and low priority.The idea is - we don't want any lag in the high priority messages, but we should be at times okay if\n\nthere's a spike on low priority message and if it takes time, that's okay.Now comes something called as a Rate Limiter. These two components can be interchanged\n\ndepending upon the conversation with your interviewer. But I'm keeping Rate Limiterbefore it because the next component is a slightly heavier component.\n\nRate Limiter does two kinds of rate limiting. 1) It checks that the client who's calling me,is that client allowed to call me these many number of times. That is the first thing.\n\n2) The user whom I'm sending this notification,am I supposed to send this notification to this user these many number of times.\n\nLet's go into detail.So there could be a subscription that we have with a certain client\n\nthat they can call us maybe 10 times in a second.All of those kind of rate limiting, would be one kind of rate limiting.\n\nThe other thing is there could be a configuration saying I cannot send more than threepromotional messages to a particular user in a day. That would be another kind of rate limiting.\n\nBoth these rate limiting would be implemented in a very similar way.Saying there would be a key.\n\nIt could be a client id, user id, anything.And whenever you get a request, you basically increment that key into this Redis for a certain timestamp.\n\nOr maybe the timestamp need not be a exact timestamp,it could be day, it could be second,\n\nit could be at a minute level or any level.The moment you exceed that threshold is when you drop that request.\n\nThere's one more thing that it does, which is called request counting.Let's just say with some of the clients you have a pay for use kind of a subscription model,\n\nsaying they can call you any number of times, there is no rate limiting as suchbut as the number of calls increases, the amount of money we charge them also increases.\n\nSo they pay at a request basis.For those kind of clients, we'll implement it in a very similar way. Just that we will not restrict the\n\nrequest. We'll keep incrementing the counter and then there can be reporting built on top of it.The next component is something called as a Notification Handler and User Preferences.\n\nFirst let's look at what are user preferences. User might give us a preference sayingdon't send me SMS, send me emails instead.\n\nOr a user could have said that I want to unsubscribe from all your promotional messages.So all of those would be handled by this User Preference Service.\n\nIt has two components that it talks to. One is a Preferences DB, which is a single source oftruth for all the user preferences that we have in our system.\n\nThis would be mainly used when we are building it for our own use.Let's say Amazon is building this notification system for their own use.\n\nThis will normally not be used when you're integrating with third parties.Third parties would handle this piece on their end. The second thing it will talk to is a User service\n\nwhich is basically - let's say you got a request saying to this user id 123, sendthis particular text.\n\nWhat is that user 123? It's something that you can search from user serviceto get the email id or phone number or anything of that sort, given a user id.\n\nThis basically could handle one more kind of rate limiting. A user might say that don't send memore than three promotional messages in a week or one promotional message in a week.\n\nSo, if that kind of a rate limiting also exists and want to support that,then this whole Rate Limiting module would come after this Notification Handler.\n\nBut, because this is a very light weight thing and this calls a DB, calls an external service,that's the reason I have kept it after the Rate Limiter.\n\nBut based on your conversation with your interviewer, you could swap either of these.Once we have all of this finalized, we basically have a full fledged system\n\nthat we can actually use to notify.We have a phone number,\n\nwe know that we'll send it as an SMS and we have the content or we have the email id,we know we'll send it as an e-mail and we have the content.\n\nAll of that is put into another Kafka for basically sending it out.Why do we need so many Kafkas?\n\nBecause let's just say we had a lot of SMSes and this SMS service is not able to handle it.One way is to increase the number of consumers.\n\nBut if there are certain spikes in certain clients, it's probably not worth to add a hardware for allthe time for that.\n\nSo we might as well put into Kafka and this SMS Handler could handle things at its own pace.There are multiple handlers that sit on top of this Kafka. You could decide to build\n\nall of these as one deployable unit, but again, with the SaaS (Software as a Service) thing in mind,I'll rather keep that as a separate service in each of them.\n\nSo there are multiple handlers. Let's take a couple of examples.So all the SMS requests that will come into this Kafka would be handled by this SMS Handler.\n\nPlus, there could be different topics for each of these.So email could have one topic, SMS could have one topic and stuff like that.\n\nNow SMS Handler might integrate with multiple vendors for sending SMSes.Let's say you are a global company. You have one vendor that deals with SMSes in Asia,\n\nanother vendor that deals with SMSes in USA , another vendor for Europe, stuff like that.So you could have multiple vendors that you are integrated with and all the SMS vendor integration\n\ncould be done through this SMS Handler.Now, let's say if you have... if you are in India and you have 5 vendors that work in India.\n\nSo what request should go to which vendor?What is the priority?\n\nHow do we distribute request amongst them?That piece could also be handled within this own handler. Same thing, you have for emails.\n\nYou have a Email Handler. And by the way, this communication with the handler and vendorcould be a sync call.\n\nMoving back to Email Handler. Email Handler takes all the e-mail requests and calls the email vendorwhich will send out the real emails.\n\nThis email vendor could be a simple SMTP server that you have at your end.Then you will have In-App Handler, which basically handles all the in-app notifications that you want to\n\nsend out or a push notification, kind of a thing.You can use a Firebase for Android and probably use a Apple push notification service for\n\nsending out such notifications on iOS platform.You could also have a IVRS Handler. A classic example would be, I don't know,\n\neither Amazon or Flipkart, one of them.When you place a very high value cash on delivery (CoD) order, they actually send you an IVRS call,\n\nsaying that we have got this order from you, do you, are you really sure you have kept this as a cash ondelivery order and you can press 1 or 2 to kind of confirm or reject.\n\nSo all of those things could be handled by the IVRS Handler.This is a very low throughput scenario and it would happen once in a while when compared to SMS\n\nor emails or anything of that sort.You can again scale these independently based on the kind of traffic you have.\n\nNow coming to pluggability.Let's say somebody comes and says that you need to add WhatsApp aslo as a notification mechanism.\n\nSo basically you just need to add a WhatsApp Handler and basically introduce a type calledWhatsApp Messaging at this layer and all of that can flow through all the way. This Kafka...\n\nthis basically Notification Handler will have a new topic for WhatsApp messages and aWhatsApp Handler will basically take care of sending those notifications out.\n\nSo that's how you can make it fairly pluggable.Now coming to what this Notification Tracker is? You always need to keep a track of what all\n\nnotifications you have sent. In case somebody sues you or there is someauditing required, you need to know what all communication you have sent out.\n\nSo for all of that, you have a Notification Tracker which puts all the notifications that you havesent out on its own Cassandra. This is normally a write only thing, which would be read\n\nonce in a while when there's an audit or something of that sort.Depending upon your traffic and the throughput, you could decide to club some of these components.\n\nSo for example, you can decide to club all of these components as a single deployable service.You could also club both these components into a single deployable service and\n\nyou can move the Prioritizer right there andmake lesser number of components and try to club all of this as one service as well\n\nif it's a very low throughput thing.You can decide it based on your conversation with your interviewer on how do you want to do that?\n\nNow, let's do something different.What if you want to send bulk notifications?\n\nWhat if you want to do something like - for all the users who have ordered a TV in last 24 hours,send them a notification like installation service or anything of that sort.\n\nOr for all the users who had ordered milk 3 days back, send them a notification thatwhether do you want to order the same thing again or not?\n\nSo all of those things come under something called as a bulk notification.Now, how do you want to do that?\n\nSo the very first thing is there would be a UI kind of a thing, which is represented as Bulk Notification UI,which will talk to something called as a Bulk Notification service, which takes\n\na filter criteria and a notification and sends it out.Filter criteria would be something like find all the users who have placed a milk order,\n\nanything in last three days and send them a notification with certain text.How does that work?\n\nSo there's something called as this User Transaction Data.This basically abstracts out a lot of services which are outside the scope of this notification service\n\nbut real business functional services.For example, again, taking the example of Amazon, let's say, there are a couple of services that handle\n\ntheir e-commerce orders.There are a couple of services that handle their pantry orders. All of those services would be\n\nputting their transactional information - that your order has been placed, it has been delivered,it has been canceled - all of those kind of attributes into various Kafka topics.\n\nWhat we could do is basically build a search functionality on top of those topics.Normally, in most companies, you do have those kind of products already built.\n\nBut assuming you don't have that, let's try to build that.And if we have that, we can just leverage it. What will happen is - this will put information\n\ninto a lot of Kafkas, lot of topics. I am abstracting it  out as this one Kafka.All of those information would be listened by something called as a Transaction Data Parser.\n\nNow, this Transaction Data Parser basically... first of all, parses all of that information.Now, because you have multiple clients\n\nand multiple services who are sending data, they could be putting in multiple formats of json or XML.So, for example, pantry (Amazon) could have a separate signature and regular e-commerce\n\ncould have a separate signature.This data parser basically takes all of those messages, puts it in a format or converts it\n\nin a format that it understands and then it puts it into its own data store.It could be Elasticsearch or a MongoDB kind of a structure where you could do\n\ncomplicated aggregations and nested queries.On top of this data store, there's something called as a Query Engine. That Query Engine basically\n\ntakes a query, which could be like an aggregation plus a filter kind of a thing,saying, find out all the users who are in Bangalore let's say, who have ordered some food item\n\nin the last few days, or find all the people who are having some items in their cart but have notplaced the order or any kind of a filter criteria that you want to build that would be powered by this\n\nQuery Engine. It would have its own DSL (Domain Specific Language), which would be a format -how do you kind of structure your query and that would be a signature that it exposes.\n\nNow, this Query Engine would query that thing on this data store.So it also understands the schema of this data store and it basically would return us a list of users\n\nthat match that criteria.Now this Bulk Notification service has a list of users that it has got from Query Engine,\n\nit has a message that it got from this UI, it basically call this Notification service saying sendthis notification to all of these users and these users, it would get from this Query Engine.\n\nThis Query Engine is not something which would just be used by this Notification service.It could be used by a lot of services.\n\nYou could have a very simple Rule Engine which possibly says that if a user has cancelled 10consecutive orders in last 3 days, go deactivate their account.\n\nThey are probably, you know, just doing fraud.Or, there could be a simple Fraud Engine running\n\nwhich has some criteria and takes some action basis that.All these condition and action kind of a thing, wherever you have a condition running\n\nand action happening, all of those could be, you know, powered by this kind of a thing.In fact, your Notification service itself is that kind of a thing.\n\nSo you have a filter criteria as your condition and action is basically the notification sending process.So this could also be a part of your Rule Engine.\n\nSomething like 5 days after an order has been delivered, send a mail to consumersfor giving a product review. So something of that sort.\n\nAnd this could then also be used  to build a Search platform altogether.But overall, this is something that and if this is something that is already built in the company,\n\nyou could just leverage that andhave this Bulk Notification service talk to the querying platform of that whole platform.\n\n\n",
			"rawText": "Let's design a notification service that is scalable enough.This is never a stand alone system but this is always embedded in some\n\nother system design. Even I have used it in a lot of othersystem designs videos that I have made. Let's say if you are building a\n\ne-commerce application or a booking system or anything of that sort.You'll always have a notification service which will be used to notify your consumers.\n\nLet's look at how can we build a notification service.Now let's look at some Functional (FRs) and Non Functional Requirements (NFRs)\n\nthat this platform should support.The very obvious first thing is that it should be able to send notifications.\n\nThe next thing is that it should be pluggable. Now what does pluggable mean?So let's say we want to support SMS and email as one form of notification. Now, tomorrow somebody\n\nmight want to say that I want to support in-app notifications as well.So it should be easy enough to add that. It can be further extended to a lot of kinds of notifications.\n\nSo, for example, you could have something like a WhatsApp notification or anything of that sort.So, extendability is something that should be taken care of.\n\nThe next thing is that it should be built as a SaaS product. Why SaaS? because the main idea isyou should know who's sending what number of notifications.\n\nAnd it should be possible for you to rate limit.There are two use cases where you'll need that.\n\nSo rate limiting as a offering you'll need, if you are giving out to other companies as a product to use.But, even internally, you would need to do some kind of rate limiting.\n\nLet's just say its being used by a company like Amazon.Now there are multiple business verticals.\n\nIf all of them send you notifications, then you'll end up getting hundreds of notifications in a day.So that's a very bad user experience.\n\nSo notification system should be able to overall put a rate limit across all the usersacross all the platforms saying a particular user should not get more than five notifications in a day.\n\nThere could be certain amount of classifications done.So there are two kinds of notifications.\n\nOne is a transactional notification saying you have made an order, this much amount of moneyhas been deducted from your account, something of that sort.\n\nSo transactional notifications are ok to get.But promotional notifications should always have a rate limit.\n\nSo if you're building for within your company, then you'll build a user level rate limiting.But if you're giving it out externally to other companies as a product, then you might want to put\n\na rate limiting saying how many requests can you make for this server.Or maybe make billing tiers and price them accordingly.\n\nSo basically this is something that you need to capture at least and then act upon.The next thing is prioritization. Again...\n\nwe'll support multiple priorities of messages.So the idea of priorities is that some messages are low priority and certain messages are high priority.\n\nLet's say, if you are sending a one time password (OTP), thenthat's a very high priority message. Why? Because if the user wouldn't get that SMS or email or anything,\n\nthen they would not log into your platform and they'll not do the transaction that they wanted to do.But if it's a promotional message, it is okay if it's low priority and if it gets delayed, if it goes to the\n\nuser let's say half an hour late also, it doesn't really matter.So we'll have this prioritization, basis which you'll always process the high priority messages first\n\nand then the low priority messages.Coming to the non functional requirements (NFRs). This platform should always be available. Why?\n\nBecause, if you are planning to build it as a  SaaS product which can be usedby other companies, then down time would really cost us a lot.\n\nPlus, it should be built in a way that it's easy enough to add more clients.And whenever we want, we should be able to attribute saying\n\nhow many clients have made us how many number of requests.Now, let's look at the overall architecture of the whole system. Just a disclaimer to start with,\n\nif you are building it for a small enough use case like let's just say if you want to send out someemail notifications to some customers, given some criteria,\n\nyou can build all of this as one deployable service and put all the logic in one place.But if you truly want to build it as a SaaS product wherein enormous number of clients would be\n\nusing it for a lot of notifications, then this kind of a system would probably be worth it.Let's just look at the starting point.\n\nThe starting point of the whole system is then a couple of clients i.e. Client 1, Client 2,could be any number of clients, who want to send out a notification.\n\nNow, there are 2-3 kinds of requests that they can send you. But all of those requests would comeinto something called as a Notification service, which is an interface for us to talk to the other\n\nteams in the company, other companies or anything that we want.There are two kinds of request mainly. One is where they tell you that I want to send this\n\nparticular content to this particular user, let's say a email id kind of a thing, as an e-mail.This is one of the requests. Other request could be saying, I have this user id and send them\n\nthis notification.And you decide how do you want to send, whether as an email or as a SMS or whatever?\n\nNormally the first kind of a model would be used by other companies where they want to decide thatthey need to send as SMS or email or whatever. The second model would generally be used when you\n\nare building this to be consumed within your own company.But normally as a SaaS product, its good to have both the interfaces. The idea\n\nof notification service is, for most kind of requests,it will just take the request, put it into Kafka and respond back to the client saying, I have taken\n\nthe request and I will send the notification in a couple of seconds at max.You could make this transaction as a synchronous flow but that will take a bit more time\n\nand that will keep the client blocked.So, it's probably best to take the request and dump it into a Kafka and move on.\n\nBut let's just say if for a very critical scenario, you need it to be a synchronous flow.You can basically make the whole process synchronous through API calls.\n\nBut assuming its a Kafka for now, let's look at what happens next.This Notification service would just do a very basic set of validations saying that email id should not be\n\nnull or user id should not be null, content should not be null, something of that sort.There might be a lot of other validations, given certain kinds of events that you want to do.\n\nAll of those validationswould happen in this component which is called Notification Validater and Prioritizer.\n\nIt does a couple of things. Validations is one part of it.The main thing that it does, it decides the priority for a message.\n\nSo based on some attribute within the message, let's say, we''ll keep a message type identifier kindof a thing in a request and based on that, it will decide the priority of a message.\n\nNormally, OTP is something which will be high priority because if the user can't login into thesystem, they can't place an order and things like that.\n\nThe second most high priority thing would be a transactional messagesaying your order has been placed, it will be delivered by so and so time.\n\nThe third, least priority one would would a promotional messagewherein you are sending out offers and coupons and stuff like that.\n\nSo, it decides the priority and puts the event into a Kafka topic, specific for each priority.So there'll be a topic for high priority messages, there'll be a different topic for medium priority,\n\nthere'll be a different topic for low priority.And while consuming, the consumers will first consume the high priority messages\n\nand then the medium and low priority.The idea is - we don't want any lag in the high priority messages, but we should be at times okay if\n\nthere's a spike on low priority message and if it takes time, that's okay.Now comes something called as a Rate Limiter. These two components can be interchanged\n\ndepending upon the conversation with your interviewer. But I'm keeping Rate Limiterbefore it because the next component is a slightly heavier component.\n\nRate Limiter does two kinds of rate limiting. 1) It checks that the client who's calling me,is that client allowed to call me these many number of times. That is the first thing.\n\n2) The user whom I'm sending this notification,am I supposed to send this notification to this user these many number of times.\n\nLet's go into detail.So there could be a subscription that we have with a certain client\n\nthat they can call us maybe 10 times in a second.All of those kind of rate limiting, would be one kind of rate limiting.\n\nThe other thing is there could be a configuration saying I cannot send more than threepromotional messages to a particular user in a day. That would be another kind of rate limiting.\n\nBoth these rate limiting would be implemented in a very similar way.Saying there would be a key.\n\nIt could be a client id, user id, anything.And whenever you get a request, you basically increment that key into this Redis for a certain timestamp.\n\nOr maybe the timestamp need not be a exact timestamp,it could be day, it could be second,\n\nit could be at a minute level or any level.The moment you exceed that threshold is when you drop that request.\n\nThere's one more thing that it does, which is called request counting.Let's just say with some of the clients you have a pay for use kind of a subscription model,\n\nsaying they can call you any number of times, there is no rate limiting as suchbut as the number of calls increases, the amount of money we charge them also increases.\n\nSo they pay at a request basis.For those kind of clients, we'll implement it in a very similar way. Just that we will not restrict the\n\nrequest. We'll keep incrementing the counter and then there can be reporting built on top of it.The next component is something called as a Notification Handler and User Preferences.\n\nFirst let's look at what are user preferences. User might give us a preference sayingdon't send me SMS, send me emails instead.\n\nOr a user could have said that I want to unsubscribe from all your promotional messages.So all of those would be handled by this User Preference Service.\n\nIt has two components that it talks to. One is a Preferences DB, which is a single source oftruth for all the user preferences that we have in our system.\n\nThis would be mainly used when we are building it for our own use.Let's say Amazon is building this notification system for their own use.\n\nThis will normally not be used when you're integrating with third parties.Third parties would handle this piece on their end. The second thing it will talk to is a User service\n\nwhich is basically - let's say you got a request saying to this user id 123, sendthis particular text.\n\nWhat is that user 123? It's something that you can search from user serviceto get the email id or phone number or anything of that sort, given a user id.\n\nThis basically could handle one more kind of rate limiting. A user might say that don't send memore than three promotional messages in a week or one promotional message in a week.\n\nSo, if that kind of a rate limiting also exists and want to support that,then this whole Rate Limiting module would come after this Notification Handler.\n\nBut, because this is a very light weight thing and this calls a DB, calls an external service,that's the reason I have kept it after the Rate Limiter.\n\nBut based on your conversation with your interviewer, you could swap either of these.Once we have all of this finalized, we basically have a full fledged system\n\nthat we can actually use to notify.We have a phone number,\n\nwe know that we'll send it as an SMS and we have the content or we have the email id,we know we'll send it as an e-mail and we have the content.\n\nAll of that is put into another Kafka for basically sending it out.Why do we need so many Kafkas?\n\nBecause let's just say we had a lot of SMSes and this SMS service is not able to handle it.One way is to increase the number of consumers.\n\nBut if there are certain spikes in certain clients, it's probably not worth to add a hardware for allthe time for that.\n\nSo we might as well put into Kafka and this SMS Handler could handle things at its own pace.There are multiple handlers that sit on top of this Kafka. You could decide to build\n\nall of these as one deployable unit, but again, with the SaaS (Software as a Service) thing in mind,I'll rather keep that as a separate service in each of them.\n\nSo there are multiple handlers. Let's take a couple of examples.So all the SMS requests that will come into this Kafka would be handled by this SMS Handler.\n\nPlus, there could be different topics for each of these.So email could have one topic, SMS could have one topic and stuff like that.\n\nNow SMS Handler might integrate with multiple vendors for sending SMSes.Let's say you are a global company. You have one vendor that deals with SMSes in Asia,\n\nanother vendor that deals with SMSes in USA , another vendor for Europe, stuff like that.So you could have multiple vendors that you are integrated with and all the SMS vendor integration\n\ncould be done through this SMS Handler.Now, let's say if you have... if you are in India and you have 5 vendors that work in India.\n\nSo what request should go to which vendor?What is the priority?\n\nHow do we distribute request amongst them?That piece could also be handled within this own handler. Same thing, you have for emails.\n\nYou have a Email Handler. And by the way, this communication with the handler and vendorcould be a sync call.\n\nMoving back to Email Handler. Email Handler takes all the e-mail requests and calls the email vendorwhich will send out the real emails.\n\nThis email vendor could be a simple SMTP server that you have at your end.Then you will have In-App Handler, which basically handles all the in-app notifications that you want to\n\nsend out or a push notification, kind of a thing.You can use a Firebase for Android and probably use a Apple push notification service for\n\nsending out such notifications on iOS platform.You could also have a IVRS Handler. A classic example would be, I don't know,\n\neither Amazon or Flipkart, one of them.When you place a very high value cash on delivery (CoD) order, they actually send you an IVRS call,\n\nsaying that we have got this order from you, do you, are you really sure you have kept this as a cash ondelivery order and you can press 1 or 2 to kind of confirm or reject.\n\nSo all of those things could be handled by the IVRS Handler.This is a very low throughput scenario and it would happen once in a while when compared to SMS\n\nor emails or anything of that sort.You can again scale these independently based on the kind of traffic you have.\n\nNow coming to pluggability.Let's say somebody comes and says that you need to add WhatsApp aslo as a notification mechanism.\n\nSo basically you just need to add a WhatsApp Handler and basically introduce a type calledWhatsApp Messaging at this layer and all of that can flow through all the way. This Kafka...\n\nthis basically Notification Handler will have a new topic for WhatsApp messages and aWhatsApp Handler will basically take care of sending those notifications out.\n\nSo that's how you can make it fairly pluggable.Now coming to what this Notification Tracker is? You always need to keep a track of what all\n\nnotifications you have sent. In case somebody sues you or there is someauditing required, you need to know what all communication you have sent out.\n\nSo for all of that, you have a Notification Tracker which puts all the notifications that you havesent out on its own Cassandra. This is normally a write only thing, which would be read\n\nonce in a while when there's an audit or something of that sort.Depending upon your traffic and the throughput, you could decide to club some of these components.\n\nSo for example, you can decide to club all of these components as a single deployable service.You could also club both these components into a single deployable service and\n\nyou can move the Prioritizer right there andmake lesser number of components and try to club all of this as one service as well\n\nif it's a very low throughput thing.You can decide it based on your conversation with your interviewer on how do you want to do that?\n\nNow, let's do something different.What if you want to send bulk notifications?\n\nWhat if you want to do something like - for all the users who have ordered a TV in last 24 hours,send them a notification like installation service or anything of that sort.\n\nOr for all the users who had ordered milk 3 days back, send them a notification thatwhether do you want to order the same thing again or not?\n\nSo all of those things come under something called as a bulk notification.Now, how do you want to do that?\n\nSo the very first thing is there would be a UI kind of a thing, which is represented as Bulk Notification UI,which will talk to something called as a Bulk Notification service, which takes\n\na filter criteria and a notification and sends it out.Filter criteria would be something like find all the users who have placed a milk order,\n\nanything in last three days and send them a notification with certain text.How does that work?\n\nSo there's something called as this User Transaction Data.This basically abstracts out a lot of services which are outside the scope of this notification service\n\nbut real business functional services.For example, again, taking the example of Amazon, let's say, there are a couple of services that handle\n\ntheir e-commerce orders.There are a couple of services that handle their pantry orders. All of those services would be\n\nputting their transactional information - that your order has been placed, it has been delivered,it has been canceled - all of those kind of attributes into various Kafka topics.\n\nWhat we could do is basically build a search functionality on top of those topics.Normally, in most companies, you do have those kind of products already built.\n\nBut assuming you don't have that, let's try to build that.And if we have that, we can just leverage it. What will happen is - this will put information\n\ninto a lot of Kafkas, lot of topics. I am abstracting it  out as this one Kafka.All of those information would be listened by something called as a Transaction Data Parser.\n\nNow, this Transaction Data Parser basically... first of all, parses all of that information.Now, because you have multiple clients\n\nand multiple services who are sending data, they could be putting in multiple formats of json or XML.So, for example, pantry (Amazon) could have a separate signature and regular e-commerce\n\ncould have a separate signature.This data parser basically takes all of those messages, puts it in a format or converts it\n\nin a format that it understands and then it puts it into its own data store.It could be Elasticsearch or a MongoDB kind of a structure where you could do\n\ncomplicated aggregations and nested queries.On top of this data store, there's something called as a Query Engine. That Query Engine basically\n\ntakes a query, which could be like an aggregation plus a filter kind of a thing,saying, find out all the users who are in Bangalore let's say, who have ordered some food item\n\nin the last few days, or find all the people who are having some items in their cart but have notplaced the order or any kind of a filter criteria that you want to build that would be powered by this\n\nQuery Engine. It would have its own DSL (Domain Specific Language), which would be a format -how do you kind of structure your query and that would be a signature that it exposes.\n\nNow, this Query Engine would query that thing on this data store.So it also understands the schema of this data store and it basically would return us a list of users\n\nthat match that criteria.Now this Bulk Notification service has a list of users that it has got from Query Engine,\n\nit has a message that it got from this UI, it basically call this Notification service saying sendthis notification to all of these users and these users, it would get from this Query Engine.\n\nThis Query Engine is not something which would just be used by this Notification service.It could be used by a lot of services.\n\nYou could have a very simple Rule Engine which possibly says that if a user has cancelled 10consecutive orders in last 3 days, go deactivate their account.\n\nThey are probably, you know, just doing fraud.Or, there could be a simple Fraud Engine running\n\nwhich has some criteria and takes some action basis that.All these condition and action kind of a thing, wherever you have a condition running\n\nand action happening, all of those could be, you know, powered by this kind of a thing.In fact, your Notification service itself is that kind of a thing.\n\nSo you have a filter criteria as your condition and action is basically the notification sending process.So this could also be a part of your Rule Engine.\n\nSomething like 5 days after an order has been delivered, send a mail to consumersfor giving a product review. So something of that sort.\n\nAnd this could then also be used  to build a Search platform altogether.But overall, this is something that and if this is something that is already built in the company,\n\nyou could just leverage that andhave this Bulk Notification service talk to the querying platform of that whole platform.\n\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Let's design a notification service that is scalable enough.This is never a stand alone system but this is always embedded in some\n\nother system design. Even I have used it in a lot of othersystem designs videos that I have made. Let's say if you are building a\n\ne-commerce application or a booking system or anything of that sort.You'll always have a notification service which will be used to notify your consumers.\n\nLet's look at how can we build a notification service.Now let's look at some Functional (FRs) and Non Functional Requirements (NFRs)\n\nthat this platform should support.The very obvious first thing is that it should be able to send notifications.\n\nThe next thing is that it should be pluggable. Now what does pluggable mean?So let's say we want to support SMS and email as one form of notification. Now, tomorrow somebody\n\nmight want to say that I want to support in-app notifications as well.So it should be easy enough to add that. It can be further extended to a lot of kinds of notifications.\n\nSo, for example, you could have something like a WhatsApp notification or anything of that sort.So, extendability is something that should be taken care of.\n\nThe next thing is that it should be built as a SaaS product. Why SaaS? because the main idea isyou should know who's sending what number of notifications.\n\nAnd it should be possible for you to rate limit.There are two use cases where you'll need that.\n\nSo rate limiting as a offering you'll need, if you are giving out to other companies as a product to use.But, even internally, you would need to do some kind of rate limiting.\n\nLet's just say its being used by a company like Amazon.Now there are multiple business verticals.\n\nIf all of them send you notifications, then you'll end up getting hundreds of notifications in a day.So that's a very bad user experience.\n\nSo notification system should be able to overall put a rate limit across all the usersacross all the platforms saying a particular user should not get more than five notifications in a day.\n\nThere could be certain amount of classifications done.So there are two kinds of notifications.\n\nOne is a transactional notification saying you have made an order, this much amount of moneyhas been deducted from your account, something of that sort.\n\nSo transactional notifications are ok to get.But promotional notifications should always have a rate limit.\n\nSo if you're building for within your company, then you'll build a user level rate limiting.But if you're giving it out externally to other companies as a product, then you might want to put\n\na rate limiting saying how many requests can you make for this server.Or maybe make billing tiers and price them accordingly.\n\nSo basically this is something that you need to capture at least and then act upon.The next thing is prioritization. Again...\n\nwe'll support multiple priorities of messages.So the idea of priorities is that some messages are low priority and certain messages are high priority.\n\nLet's say, if you are sending a one time password (OTP), thenthat's a very high priority message. Why? Because if the user wouldn't get that SMS or email or anything,\n\nthen they would not log into your platform and they'll not do the transaction that they wanted to do.But if it's a promotional message, it is okay if it's low priority and if it gets delayed, if it goes to the\n\nuser let's say half an hour late also, it doesn't really matter.So we'll have this prioritization, basis which you'll always process the high priority messages first\n\nand then the low priority messages.Coming to the non functional requirements (NFRs). This platform should always be available. Why?\n\nBecause, if you are planning to build it as a  SaaS product which can be usedby other companies, then down time would really cost us a lot.\n\nPlus, it should be built in a way that it's easy enough to add more clients.And whenever we want, we should be able to attribute saying\n\nhow many clients have made us how many number of requests.Now, let's look at the overall architecture of the whole system. Just a disclaimer to start with,\n\nif you are building it for a small enough use case like let's just say if you want to send out someemail notifications to some customers, given some criteria,\n\nyou can build all of this as one deployable service and put all the logic in one place.But if you truly want to build it as a SaaS product wherein enormous number of clients would be\n\nusing it for a lot of notifications, then this kind of a system would probably be worth it.Let's just look at the starting point.\n\nThe starting point of the whole system is then a couple of clients i.e. Client 1, Client 2,could be any number of clients, who want to send out a notification.\n\nNow, there are 2-3 kinds of requests that they can send you. But all of those requests would comeinto something called as a Notification service, which is an interface for us to talk to the other\n\nteams in the company, other companies or anything that we want.There are two kinds of request mainly. One is where they tell you that I want to send this\n\nparticular content to this particular user, let's say a email id kind of a thing, as an e-mail.This is one of the requests. Other request could be saying, I have this user id and send them\n\nthis notification.And you decide how do you want to send, whether as an email or as a SMS or whatever?\n\nNormally the first kind of a model would be used by other companies where they want to decide thatthey need to send as SMS or email or whatever. The second model would generally be used when you\n\nare building this to be consumed within your own company.But normally as a SaaS product, its good to have both the interfaces. The idea\n\nof notification service is, for most kind of requests,it will just take the request, put it into Kafka and respond back to the client saying, I have taken\n\nthe request and I will send the notification in a couple of seconds at max.You could make this transaction as a synchronous flow but that will take a bit more time\n\nand that will keep the client blocked.So, it's probably best to take the request and dump it into a Kafka and move on.\n\nBut let's just say if for a very critical scenario, you need it to be a synchronous flow.You can basically make the whole process synchronous through API calls.\n\nBut assuming its a Kafka for now, let's look at what happens next.This Notification service would just do a very basic set of validations saying that email id should not be\n\nnull or user id should not be null, content should not be null, something of that sort.There might be a lot of other validations, given certain kinds of events that you want to do.\n\nAll of those validationswould happen in this component which is called Notification Validater and Prioritizer.\n\nIt does a couple of things. Validations is one part of it.The main thing that it does, it decides the priority for a message.\n\nSo based on some attribute within the message, let's say, we''ll keep a message type identifier kindof a thing in a request and based on that, it will decide the priority of a message.\n\nNormally, OTP is something which will be high priority because if the user can't login into thesystem, they can't place an order and things like that.\n\nThe second most high priority thing would be a transactional messagesaying your order has been placed, it will be delivered by so and so time.\n\nThe third, least priority one would would a promotional messagewherein you are sending out offers and coupons and stuff like that.\n\nSo, it decides the priority and puts the event into a Kafka topic, specific for each priority.So there'll be a topic for high priority messages, there'll be a different topic for medium priority,\n\nthere'll be a different topic for low priority.And while consuming, the consumers will first consume the high priority messages\n\nand then the medium and low priority.The idea is - we don't want any lag in the high priority messages, but we should be at times okay if\n\nthere's a spike on low priority message and if it takes time, that's okay.Now comes something called as a Rate Limiter. These two components can be interchanged\n\ndepending upon the conversation with your interviewer. But I'm keeping Rate Limiterbefore it because the next component is a slightly heavier component.\n\nRate Limiter does two kinds of rate limiting. 1) It checks that the client who's calling me,is that client allowed to call me these many number of times. That is the first thing.\n\n2) The user whom I'm sending this notification,am I supposed to send this notification to this user these many number of times.\n\nLet's go into detail.So there could be a subscription that we have with a certain client\n\nthat they can call us maybe 10 times in a second.All of those kind of rate limiting, would be one kind of rate limiting.\n\nThe other thing is there could be a configuration saying I cannot send more than threepromotional messages to a particular user in a day. That would be another kind of rate limiting.\n\nBoth these rate limiting would be implemented in a very similar way.Saying there would be a key.\n\nIt could be a client id, user id, anything.And whenever you get a request, you basically increment that key into this Redis for a certain timestamp.\n\nOr maybe the timestamp need not be a exact timestamp,it could be day, it could be second,\n\nit could be at a minute level or any level.The moment you exceed that threshold is when you drop that request.\n\nThere's one more thing that it does, which is called request counting.Let's just say with some of the clients you have a pay for use kind of a subscription model,\n\nsaying they can call you any number of times, there is no rate limiting as suchbut as the number of calls increases, the amount of money we charge them also increases.\n\nSo they pay at a request basis.For those kind of clients, we'll implement it in a very similar way. Just that we will not restrict the\n\nrequest. We'll keep incrementing the counter and then there can be reporting built on top of it.The next component is something called as a Notification Handler and User Preferences.\n\nFirst let's look at what are user preferences. User might give us a preference sayingdon't send me SMS, send me emails instead.\n\nOr a user could have said that I want to unsubscribe from all your promotional messages.So all of those would be handled by this User Preference Service.\n\nIt has two components that it talks to. One is a Preferences DB, which is a single source oftruth for all the user preferences that we have in our system.\n\nThis would be mainly used when we are building it for our own use.Let's say Amazon is building this notification system for their own use.\n\nThis will normally not be used when you're integrating with third parties.Third parties would handle this piece on their end. The second thing it will talk to is a User service\n\nwhich is basically - let's say you got a request saying to this user id 123, sendthis particular text.\n\nWhat is that user 123? It's something that you can search from user serviceto get the email id or phone number or anything of that sort, given a user id.\n\nThis basically could handle one more kind of rate limiting. A user might say that don't send memore than three promotional messages in a week or one promotional message in a week.\n\nSo, if that kind of a rate limiting also exists and want to support that,then this whole Rate Limiting module would come after this Notification Handler.\n\nBut, because this is a very light weight thing and this calls a DB, calls an external service,that's the reason I have kept it after the Rate Limiter.\n\nBut based on your conversation with your interviewer, you could swap either of these.Once we have all of this finalized, we basically have a full fledged system\n\nthat we can actually use to notify.We have a phone number,\n\nwe know that we'll send it as an SMS and we have the content or we have the email id,we know we'll send it as an e-mail and we have the content.\n\nAll of that is put into another Kafka for basically sending it out.Why do we need so many Kafkas?\n\nBecause let's just say we had a lot of SMSes and this SMS service is not able to handle it.One way is to increase the number of consumers.\n\nBut if there are certain spikes in certain clients, it's probably not worth to add a hardware for allthe time for that.\n\nSo we might as well put into Kafka and this SMS Handler could handle things at its own pace.There are multiple handlers that sit on top of this Kafka. You could decide to build\n\nall of these as one deployable unit, but again, with the SaaS (Software as a Service) thing in mind,I'll rather keep that as a separate service in each of them.\n\nSo there are multiple handlers. Let's take a couple of examples.So all the SMS requests that will come into this Kafka would be handled by this SMS Handler.\n\nPlus, there could be different topics for each of these.So email could have one topic, SMS could have one topic and stuff like that.\n\nNow SMS Handler might integrate with multiple vendors for sending SMSes.Let's say you are a global company. You have one vendor that deals with SMSes in Asia,\n\nanother vendor that deals with SMSes in USA , another vendor for Europe, stuff like that.So you could have multiple vendors that you are integrated with and all the SMS vendor integration\n\ncould be done through this SMS Handler.Now, let's say if you have... if you are in India and you have 5 vendors that work in India.\n\nSo what request should go to which vendor?What is the priority?\n\nHow do we distribute request amongst them?That piece could also be handled within this own handler. Same thing, you have for emails.\n\nYou have a Email Handler. And by the way, this communication with the handler and vendorcould be a sync call.\n\nMoving back to Email Handler. Email Handler takes all the e-mail requests and calls the email vendorwhich will send out the real emails.\n\nThis email vendor could be a simple SMTP server that you have at your end.Then you will have In-App Handler, which basically handles all the in-app notifications that you want to\n\nsend out or a push notification, kind of a thing.You can use a Firebase for Android and probably use a Apple push notification service for\n\nsending out such notifications on iOS platform.You could also have a IVRS Handler. A classic example would be, I don't know,\n\neither Amazon or Flipkart, one of them.When you place a very high value cash on delivery (CoD) order, they actually send you an IVRS call,\n\nsaying that we have got this order from you, do you, are you really sure you have kept this as a cash ondelivery order and you can press 1 or 2 to kind of confirm or reject.\n\nSo all of those things could be handled by the IVRS Handler.This is a very low throughput scenario and it would happen once in a while when compared to SMS\n\nor emails or anything of that sort.You can again scale these independently based on the kind of traffic you have.\n\nNow coming to pluggability.Let's say somebody comes and says that you need to add WhatsApp aslo as a notification mechanism.\n\nSo basically you just need to add a WhatsApp Handler and basically introduce a type calledWhatsApp Messaging at this layer and all of that can flow through all the way. This Kafka...\n\nthis basically Notification Handler will have a new topic for WhatsApp messages and aWhatsApp Handler will basically take care of sending those notifications out.\n\nSo that's how you can make it fairly pluggable.Now coming to what this Notification Tracker is? You always need to keep a track of what all\n\nnotifications you have sent. In case somebody sues you or there is someauditing required, you need to know what all communication you have sent out.\n\nSo for all of that, you have a Notification Tracker which puts all the notifications that you havesent out on its own Cassandra. This is normally a write only thing, which would be read\n\nonce in a while when there's an audit or something of that sort.Depending upon your traffic and the throughput, you could decide to club some of these components.\n\nSo for example, you can decide to club all of these components as a single deployable service.You could also club both these components into a single deployable service and\n\nyou can move the Prioritizer right there andmake lesser number of components and try to club all of this as one service as well\n\nif it's a very low throughput thing.You can decide it based on your conversation with your interviewer on how do you want to do that?\n\nNow, let's do something different.What if you want to send bulk notifications?\n\nWhat if you want to do something like - for all the users who have ordered a TV in last 24 hours,send them a notification like installation service or anything of that sort.\n\nOr for all the users who had ordered milk 3 days back, send them a notification thatwhether do you want to order the same thing again or not?\n\nSo all of those things come under something called as a bulk notification.Now, how do you want to do that?\n\nSo the very first thing is there would be a UI kind of a thing, which is represented as Bulk Notification UI,which will talk to something called as a Bulk Notification service, which takes\n\na filter criteria and a notification and sends it out.Filter criteria would be something like find all the users who have placed a milk order,\n\nanything in last three days and send them a notification with certain text.How does that work?\n\nSo there's something called as this User Transaction Data.This basically abstracts out a lot of services which are outside the scope of this notification service\n\nbut real business functional services.For example, again, taking the example of Amazon, let's say, there are a couple of services that handle\n\ntheir e-commerce orders.There are a couple of services that handle their pantry orders. All of those services would be\n\nputting their transactional information - that your order has been placed, it has been delivered,it has been canceled - all of those kind of attributes into various Kafka topics.\n\nWhat we could do is basically build a search functionality on top of those topics.Normally, in most companies, you do have those kind of products already built.\n\nBut assuming you don't have that, let's try to build that.And if we have that, we can just leverage it. What will happen is - this will put information\n\ninto a lot of Kafkas, lot of topics. I am abstracting it  out as this one Kafka.All of those information would be listened by something called as a Transaction Data Parser.\n\nNow, this Transaction Data Parser basically... first of all, parses all of that information.Now, because you have multiple clients\n\nand multiple services who are sending data, they could be putting in multiple formats of json or XML.So, for example, pantry (Amazon) could have a separate signature and regular e-commerce\n\ncould have a separate signature.This data parser basically takes all of those messages, puts it in a format or converts it\n\nin a format that it understands and then it puts it into its own data store.It could be Elasticsearch or a MongoDB kind of a structure where you could do\n\ncomplicated aggregations and nested queries.On top of this data store, there's something called as a Query Engine. That Query Engine basically\n\ntakes a query, which could be like an aggregation plus a filter kind of a thing,saying, find out all the users who are in Bangalore let's say, who have ordered some food item\n\nin the last few days, or find all the people who are having some items in their cart but have notplaced the order or any kind of a filter criteria that you want to build that would be powered by this\n\nQuery Engine. It would have its own DSL (Domain Specific Language), which would be a format -how do you kind of structure your query and that would be a signature that it exposes.\n\nNow, this Query Engine would query that thing on this data store.So it also understands the schema of this data store and it basically would return us a list of users\n\nthat match that criteria.Now this Bulk Notification service has a list of users that it has got from Query Engine,\n\nit has a message that it got from this UI, it basically call this Notification service saying sendthis notification to all of these users and these users, it would get from this Query Engine.\n\nThis Query Engine is not something which would just be used by this Notification service.It could be used by a lot of services.\n\nYou could have a very simple Rule Engine which possibly says that if a user has cancelled 10consecutive orders in last 3 days, go deactivate their account.\n\nThey are probably, you know, just doing fraud.Or, there could be a simple Fraud Engine running\n\nwhich has some criteria and takes some action basis that.All these condition and action kind of a thing, wherever you have a condition running\n\nand action happening, all of those could be, you know, powered by this kind of a thing.In fact, your Notification service itself is that kind of a thing.\n\nSo you have a filter criteria as your condition and action is basically the notification sending process.So this could also be a part of your Rule Engine.\n\nSomething like 5 days after an order has been delivered, send a mail to consumersfor giving a product review. So something of that sort.\n\nAnd this could then also be used  to build a Search platform altogether.But overall, this is something that and if this is something that is already built in the company,\n\nyou could just leverage that andhave this Bulk Notification service talk to the querying platform of that whole platform.\n\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 349,
			"versionNonce": 2115776768,
			"isDeleted": false,
			"id": "dQRmeEzB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10111.6662091336,
			"y": -225.64798715411632,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 550.78125,
			"height": 240,
			"seed": 1448816998,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "FR\n\nsend notification\nsaas product can be used by other services\npluggable / extensible to support other \nnotification methods as well\n\nsupport prioritization of messages\n\nrate limit on promotional messages sent to user",
			"rawText": "FR\n\nsend notification\nsaas product can be used by other services\npluggable / extensible to support other \nnotification methods as well\n\nsupport prioritization of messages\n\nrate limit on promotional messages sent to user",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "FR\n\nsend notification\nsaas product can be used by other services\npluggable / extensible to support other \nnotification methods as well\n\nsupport prioritization of messages\n\nrate limit on promotional messages sent to user",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 61,
			"versionNonce": 633036544,
			"isDeleted": false,
			"id": "p5KYGBRm",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10715.487990138998,
			"y": -227.37323154147737,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 234.375,
			"height": 120,
			"seed": 1768465338,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "NFR\n\nHighly available\nSupport many clients\n",
			"rawText": "NFR\n\nHighly available\nSupport many clients\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nHighly available\nSupport many clients\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 166,
			"versionNonce": 762188032,
			"isDeleted": false,
			"id": "1zDj6I2Fh_NgBZSzgkORs",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10182.551348372466,
			"y": 51.26517290869734,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1288,
			"height": 615,
			"seed": 1367307130,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "a51cd2e9e27bb25effa8f3e63871fb32431bc107",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "rectangle",
			"version": 247,
			"versionNonce": 888635136,
			"isDeleted": false,
			"id": "YpBX3CxjMr0rIerfrCcRG",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12684.04115037753,
			"y": -395.12790465857324,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 3717.063741167325,
			"height": 14510.402674453635,
			"seed": 833418918,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false
		},
		{
			"type": "image",
			"version": 148,
			"versionNonce": 1468264704,
			"isDeleted": false,
			"id": "FZlRIqrLcN0pt5GbOEhFO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12742.000511969993,
			"y": -198.8900670363945,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 814,
			"height": 420,
			"seed": 1683214118,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "86f97602d9fa36226a2ae2fa5aed908113694349",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 81,
			"versionNonce": 1202691840,
			"isDeleted": false,
			"id": "yXalUWY5",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12740.8439956141,
			"y": -337.00208947470355,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 421.875,
			"height": 72,
			"seed": 1311740966,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Cab Booking system (Uber, Lyft, Ola)\n\nCode karle approach",
			"rawText": "Cab Booking system (Uber, Lyft, Ola)\n\nCode karle approach",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Cab Booking system (Uber, Lyft, Ola)\n\nCode karle approach",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 58,
			"versionNonce": 64868608,
			"isDeleted": false,
			"id": "hjd7hPeLjwlHdmWStbiug",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12794.450336022366,
			"y": 306.59666881867315,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 683.3188898753534,
			"height": 617.9249877929688,
			"seed": 1780214458,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "aa335dbc519481f82eb45ec0644f3ba75319d7ae",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 66,
			"versionNonce": 241417984,
			"isDeleted": false,
			"id": "4HINzNITh5imOrUMH-b2s",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12786.416989246492,
			"y": 1012.1168467432103,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1048.1494529781485,
			"height": 617.9249877929688,
			"seed": 271026810,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c821b812d974068ae07d16bdb3a0c3186f1c28bf",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 67,
			"versionNonce": 1241231616,
			"isDeleted": false,
			"id": "vZj3YT7-UVXSwfRGT0EoO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12791.860452817882,
			"y": 1713.8841735870137,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1123,
			"height": 406,
			"seed": 1629583418,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "6750b87a45dcdcd4a4658d29857798a82be8c772",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 13,
			"versionNonce": 697556736,
			"isDeleted": false,
			"id": "r6prEPDs",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12787.345800539952,
			"y": 2215.513392106763,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 3562.5,
			"height": 7152,
			"seed": 666313190,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "design a cab booking system, something like an Uber or OLA or Lyft.Let's start with the functional and non functional requirements that we want this system to support.\n\nSo, very first thing is - as a customer, when you open your app, you should be able to see what cabs are around you.So, that is the See Cab feature in your vicinity.\n\nThe next thing is - if you want to book a cab from one place, point A to point B let's say, you need to know how much time it will take to travelfrom point A to point B. And, you should be able to get an approximate price of how much would it cost you to book a cab via this platform.\n\nThe next thing is - you should obviously be able to book a cab.We'll not get into the varieties of.. types of cab like go, premium and all of that. We'll just assume that there is one type of cab.\n\nYou can add more features, simply! That's not a big trouble.The next thing is - there should be a very good location tracking of what driver was at what place at what point in time, for various reasons.\n\nFrom a non-functional standpoint, this platform should be global and it should be accessible to people of all countries.At least, we'll design it in that way.\n\nWhat that means is - you need to have servers in a lot of geographies so as to make sure that people in a certain geographyare accessing the servers near to them and thereby reducing the latency.\n\nNext obvious thing - it needs to work at a fairly low latency.Though this is not very, very mission critical, but it still needs to be, you know, reasonably fast.\n\nAvailability should be very high.This system should not go down. It will cause a lot of problems to people who are stuck somewhere, if the system is down.\n\nAnd at the same time, it should have high consistency.High Availability - High Consistency, might seem to you that it is trying to violate the CAP theorem, which basically says that -\n\nassuming all the systems in the world are distributed nowadays, so out of availability and consistent, you can just get one.The idea is - certain components of this need to be very highly available and certain other components need to be very highly consistent,\n\nnot both at the same time.From a scale standpoint, this system should scale to a very good number.\n\nIf I look at just some of the statistics of Uber, there are roughly 100 million active users that use Uber on a monthly basis. These are unique users.And Uber, in general, does roughly 14 million rides per day.\n\nSo with that thought in mind, let's try to look at a system that can scale up to these numbers, with these criterion.Now, the main problem that companies like Uber are trying to solve is - when you have a customer's location, who wants to book a cab,\n\nyou try to find out some few drivers who are very near to this location and then using some logic,try to come up with the best driver who is suited to do this trip for this customer.\n\nSo the problem then becomes, how do you find these 2 - 3 closest drivers to this customer?There are multiple ways to do that. We'll go over one of the ways which uses a concept called segment and mapping segments, basically.\n\nNow, this is a term that I just made up. It's not an industry standard term. So, just keep that in mind.Now let's just say, you have a city, something like this.\n\nThe idea is you basically divide it into rectangular segments.So, you kind of divide this city into multiple pieces.\n\nAnd you say that - this is probably your segment id 1.This is your segment id 2, something of that sort.\n\nNow, the idea is - you are dividing a city.It'll normally be divided into a lot more segments than what you can see here.\n\nNow, the idea is - given certain coordinates of the segment boundary and given certain coordinates of a cab,you should be able to figure out which segment does a cab belong in.\n\nNow, the problem looks trivial, and it is not difficult also.So, think of it like a standard coordinate system.\n\nThis is point (0,0). This is (0,1). This is (1,0). This is (1,1).Somewhere here.\n\nNow, if a point lies somewhere in between here, let's say (0.4, 0.5),you should be able to mathematically say that this point lies within this boundary.\n\nA very similar logic we'll try to use when we try to assign a particular segment to a cab.Also, keep in mind that cabs continuously moving and their locations are continuously changing.\n\nSo, we'll try to make sure that we get continuous pings from all the cabs and then keep a track of which segment do they belong in.A cab could be here right now. Could be in this particular segment. And the cab driver is going via a road, over here. Now, this changes the segment.\n\nAnd this information would be calculated at runtime, as and when we are getting pings from the cab.So, we'll have something called a Maps Service.\n\nThis Maps Service will do a couple of things.The very first thing is that - it will be responsible for dividing the city into these segments and taking care of the segments.\n\nThe other thing it will also do is - given a lat long of a cab and given a lat long of a customer,tell which segment do these users belong to at this point in time.\n\nThis service will also be used to calculate ETA from point A to point B and the route from point A to point B and thus even the distance.But, we'll abstract out. We'll not go into much detail on how that ETA and distance piece is implemented.\n\nThink of it for now as if we'll be using a Google Maps Service and we'll go over the details of implementation of thatwhen we do another system design video on implementing Google Maps.\n\nWith that being said, there is also one more thing that this service does.So let's just say, there is a huge amount of traffic or huge amount of cab drivers in this particular segment. And it is getting unmanageable.\n\nSo the idea of segment is - it should be a small set of drivers that are in the segment.So this service will take care of dividing this segment into multiple parts. It could do it into 4 parts. It could divide it into 6 parts.\n\nThat logic resides within Maps Service.Let's just say, there is very less traffic in some other locality.\n\nSo, it could also decide to merge a couple of segments into one segment and say, this whole thing is now one segment.So all the segment management remains within this service.\n\nNow, let's look at the overall architecture and how individual users and drivers get connected to the system.All the users get connected through this User App, which talks to a Load Balancer, which talks to something called as a User Service.\n\nThis User Service is your repository of all the user information.Plus, it is also a proxy, that will connect to other services to get any information that a user wants.\n\nSo, for example, if a user wants to see their profile, update their profile, all the APIs to do that are powered by User Service.If somebody wants to fetch user information, any other service for example, then all the APIs for that are powered by this service.\n\nLet's say, if a user wants to see their trips, then this User Service will talk to Trip Service, fetch all the trips for that user and send it back to the user.So that's the responsibility of User Service.\n\nFrom a database standpoint, it sits on top of a MySQL cluster, which stores all the user information within that.And it also uses a Redis for caching the same information.\n\nSo let's say, a GET API to get a user's information is called, it first queries the Redis. If it has information, it returns from there. If it doesn't haveinformation, then it queries a MySQL slave, fetches that information, stores it in Redis and then returns back to whoever was calling.\n\nThe next flow that the user calls is basically when they try to book a cab.The whole screen that the customer, kind of, goes through when they are trying to book a cab is powered by this Cab Request Service.\n\nEssentially what it does is -it basically makes a WebSocket connection with the User's App, which displays them a few cabs onto their UI  which are around them.\n\nAlso, it places a request with something called a Cab Finder. We'll go over this in the next section. Whenever Cab Finder responds back with a cab,this Cab Request Service talks to the User App, basically sends them a response, through this WebSocket connection,\n\nsaying that the cab is booked and these are the details and whatever is required.This is approximately the major user flows.\n\nNow quickly, let's look at the driver flows.A driver basically talks via the Driver App.\n\nAgain, there is a very similar Driver Service, exactly similar to the User Service.But for drivers, again, all the APIs for getting, updating all the driver information is powered via this.\n\nIf a driver wants to see their payment information for example, their payment history, this Driver Service will expose an APIwhich the Driver App will call and Driver Service will internally call a Payment Service to get that information and respond back.\n\nIt could call Trip Service to get the trips of all the drivers. And, all the UI data gets powered by this service.This service sits on top of another MySQL which has all the driver information.\n\nAnd it uses Redis for caching in exactly the same way the User Service does.This Driver App also talks to something called as a Location Service through a series of servers,\n\nagain maintaining a WebSocket connection with these servers.And, as and when a driver is moving through the city, every 5 seconds or 10 seconds, their location is being sent out to this Location Service,\n\nwhich then queries the Map Service that we talked about earlier, to find out which segment does the driver belong to.And when the customer places this cab request, customer's segment is calculated, driver segments are calculated\n\nand they are mixed and matched by the Cab Finder and a couple of other components to give the best suited driver for a particular trip.Now, let's look at how does a customer and driver come together.\n\nAll the active drivers in the system, who are online right now, ready for trips and all, are mentioned as D1, D2, D3.There'll be a lot more such drivers.\n\nAll those drivers.. each of them is connected to one of the servers through a WebSocket connection.And those servers are called out as WebSocket Handler 1, WebSocket Handler 2, WebSocket Handler 3.\n\nNow, why do we need WebSocket here?So, we always need a connection between the driver and a service.. for a lot of reasons.\n\nOne of the very first things is that - a driver continuously sends location pings to the backend, telling about the location.Now, if each time they start creating a new connection, that's a kind of a heavy operation. So, we'll have this connection live.\n\nAlso, at times, the servers might want to talk to driver. So, let's say, if a trip is assigned to a driver, we need to inform the driver.So, we can reuse the same connection to talk to a driver and tell them that this is the trip information that you have to do right now.\n\nFor all of that, there are these WebSocket Handler servers.In the real world, there'll be hundreds of such servers, who are interfacing with all the drivers, which are throughout the world, geographically split.\n\nNow, let's say, somebody in the system identifies that a trip is being given to a driver and to reach out to the driver,they first need to know that which out of these hundreds of WebSocket Handler servers, do I need to talk to.\n\nFor that, there is something called as a WebSocket Manager.Now, this WebSocket Manager is another distributed service which manages the fact that which server is connected to what all drivers.\n\nSo, let's say, D3 is a new driver that has come online right now and through the load balancer, it got connected to WebSocket Handler 3.So, this Handler will inform the Manager, saying I have now got connected to D3 also. So, if there's anything for D3, inform me.\n\nAnd this Manager will store this in it's database.Now, let's say, this connection got broken and D3 is offline right now. Again this Handler will inform the  Manager that D3 is now offline.\n\nDo not reach out to me for any communication of D3.This manager sits on top of a Redis cluster.\n\nThis Redis would not just be storing data in-memory, it will also be storing it in a persistent store on disk.And it will basically store 2 kinds of mapping.\n\nOne is saying that.. the most frequently used one, is that - which driver is connected to which host..which is saying something like D1 is connected to H1.\n\nSimilarly, there'll be an entry for each of the drivers in the system, saying which driver_id is connected to what host_id.It'll also have a reverse mapping, saying which host_id is connected to what all driver_id.\n\nSo, it could have a mapping saying H1 is connected to D1, D2, D3, so on and so forth. Because that mapping might be used for something.Coming to other things that this WebSocket is used for.\n\nSo these drivers/ devices send location pings to our backend, let's say, every 5 seconds.So, every 5 seconds, we get a hit about the location information.\n\nAll the location related information is managed by something called Location Service. It does a lot of things.One of the things that happens here is - it stores the information about the driver's location into it's Cassandra.\n\nWhy Cassandra?Because, again, there are like thousands probably or maybe even millions of drivers across the globe\n\nwho are sending their location updates every 5 seconds.So, there are a lot of updates happening. So, a Cassandra should be able to easily scale up to that number. That's the main reason.\n\nThere are 2 kinds of information that get stored here.One is - the live location of the driver, which is the last known location.\n\nThe other thing that is stored is - while a driver is doing a trip with a customer, we need to know exactly what was the route followed,for any auditing purpose or billing purpose.\n\nVery common use case is - Once we know the points that the driver followed, we would be able to trace that out and then come upwith the real distance that the driver actually travelled and then use that to come up with the pricing.\n\nSo all of those things are basically responsibilities of Location Service.Location Service also talks to Map Service.\n\nRemember, Map Service from the previous section. Map Service is a service that maintains the segments that we have createdthroughout the city and throughout the globe. So, Map Service maintains not just the segments, it also gives us the ETA, which will be the\n\ntime taken from point A to point B and the distance that will be followed and also the route that should be followed from point A to point B.Think of Map Service as an abstraction that we have. We'll not go into the details of implementation of Map Service right now.\n\nI have made another video which is on the design of Google Maps, that goes into details of how Map Service is implemented.But, that being said, Location Service, as soon as it gets a ping from a driver,\n\nit basically queries Map Service and tries to figure out that this lat long belongs to which segment.It then stores it into it's Redis, saying, this segment has these drivers.\n\nThis update happens only when a driver's segment changes. If he's in the same segment, then no change happens.This basically is used for a lot of purposes. So, let's say, we want to find out drivers in a vicinity,\n\nwe'll query this service saying who all are the drivers that are basically in S1.There is one more thing that Map Service does. It basically keeps a mapping of which all are the segments surrounding a particular segment.\n\nWhich, we'll come to in a while on how it is being used.There's something called as Trip Service. Trip Service is basically the source of truth for all the trip information.\n\nIt sits on top of a MySQL database and a Cassandra database.It uses MySQL for all the live information, basically information of all the trips that are either about to happen in some near future or are in progress.\n\nOnce the trip is completed, then it basically can move to Cassandra.Now, why don't we store all the information in MySQL? Because over time, this will become a very massive volume of data.\n\nPlus, if it is just for read queries, Cassandra is also good enough. So, we don't really need to store it in MySQL.The main reason of storing it in MySQL is because trip would have a lot of information.\n\nIt would have information about the customers, about the divers, about potential start times; end times, about the potential distances,about the real values and maybe some events information that have come in between, maybe some payment information and a lot of other things.\n\nNow, if you look at it in tables terms, these will be a lot of tables.And, for each event that comes in against a trip, we might need to update a lot of such tables.\n\nAnd there, it is very good to have transactional properties.So, that's the reason we'll be using a MySQL for all the trips that will be updated.\n\nAnd once the trip is completed, then we can move it to Cassandra.Now, this movement from MySQL to Cassandra is taken up by this Trip Archiver Service, which basically is a cron,\n\nwhich spawns once in every probably 12 hours and pulls the data from MySQL and puts it into Cassandra.Coming back to Trip Service.. Trip Service will expose all the APIs around trips. So, if you want to get a trip by id or if you want to get all the trips\n\nof a particular driver or all the trips of a user, all of those APIs would be powered by Trip Service.And let's say, if it's a search by a driver_id, it will query MySQL, it will query Cassandra, it will get the results from both of them, merge them\n\nand then return it back to whoever was calling. So, that's how it's flow would be.Now, let's get to the main flow on what happens when a customer actually requests a cab.\n\nThe customer flow begins at this point where they basically make a request to Cab Request Service through againan open connection between both the parties, the Customer and this service.\n\nAnd basically, what the customer says is - this is my source lat long. I need to go to a destination which is identified by certain lat long. Get me a cab.I'm assuming there is just one type of cab and no varieties and types of cab. If you want to implement, that is a straightforward thing to implement.\n\nBut given this request, Cab Request Service then queries something called as Cab Finder,which is responsible to come up with that one driver who will do the trip.\n\nAt the end of all of it, Cab Finder will respond back to Cab Request Service saying, this is your trip_id, this is your driver_id,go send it back to the customer.. in a nice form, with all the details about the driver and all of that. And Cab Service would send that.\n\nCab Finder will also put a notification into a Kafka, whether or not it was able to find a driver.Let's say, if it's not able to find a driver, may be because there is a scarcity of drivers, all of that would go into Kafka,\n\nwhich can be used for further Analytics like for example, telling drivers that this is a location where there are more customers and less driversso why don't you go into that location to get more trips or something of that sort.\n\nComing to what Cab Finder does.The very first thing Cab Finder would do is basically - it has a source lat long, which is basically identifier of a particular location of a customer.\n\nIt will first of all query Location Service saying, get me the segment in which this customer currently is.Along with that, also give me a list of drivers that are near this customer.\n\nWhat it does is - it first of all queries Map Service with the lat long of the customer, to get the segment which the customer is in.It then queries surrounding segments. So, I'll try to explain why do we need surrounding segments.\n\nSo, let's say, there is a rectangle like this and customer was sitting here.There were a couple of drivers in various locations in this segment. There could possibly be a driver just here.\n\nBut, if we query all the drivers within this segment, then we'll get a driver who is far away.But, a driver is just next to customer, maybe in another segment.\n\nSo, for doing that, we basically.. let's say if it is segment S1, we need to find all the segments that aresurrounding S1 and get the closest 10 drivers, let's say, in all of those segments.\n\nSo, let's say, there could be a couple of segments over here and maybe you can have something like this. This is S2, S3, S4, something of that sort.So, we'll query all of these segments. Basically, we'll not query, we'll just off load that job to Map Service saying, get me all the segments\n\nthat are surrounding this segment S1, that Location Service gets. Then, Location Service basically figures out all the driversand then tells Map Service to get the closest 10 drivers to this customer, out of a list of those drivers.\n\nDistance between the customer and the driver is also something Map Service is good at.Remember, it is able to find and identify the distance between two points.\n\nSo, it can identify the distance between two customers and drivers, taking into account the road distance, not the aerial distance.Let's say, it got some 5 - 10 drivers which are close by to the customer. Location Service will return it to Cab Finder.\n\nNow basically, we need to identify 1 driver out of these 10 who will do the trip.Now, there comes something called modes. There could be multiple modes in which this cab request could be served.\n\nWe could say that for certain kind of customers, just pick the best driver.Let's say, if it's a premium customer, then we just pick the best driver out of the lot and assign that.\n\nOr, if it's an average customer, we might want to do some different thing.We might want to broadcast to all the drivers and whoever accepts first, we can assign that driver to the trip.\n\nSo, all of these modes are basically something that Cab Finder decides that which mode I want to run it in.Given whatever mode it is, it might need some additional inputs.\n\nSo, if it's the best driver mode, then it might need to stack rank all the drivers.So, all of these are basically something that is handled by Driver Priority Engine. We'll get to the logic, what it follows, later on.\n\nCab Finder then queries Driver Priority Engine saying, I have these drivers for this kind of a customer, you just arrange them and give me back.Then it gets a list of those drivers. And given the mode and given the list, it then tries to identify one of the drivers who will actually do that trip.\n\nIt then queries WebSocket Manager and asks WebSocket Manager saying,which was the host that was actually, you know, integrating with this particular driver. It will then call WebSocket Handler.\n\nLet's say it chose D1, it will then call this Handler 1 saying, D1 you have a trip, go do it.The same notification would be sent via Cab Request Service to Customer saying, Customer, you have got a new driver, which is driver D1.\n\nAnd then the regular flow follows wherein the driver starts moving to the customer's location.So, this is how we'll figure out, how to assign a driver to a customer.\n\nOnce a driver is assigned, basically, what it means is, a trip has to be created and updated.So, this will then basically update the Trip Service saying, I've created a trip with this customer, with this particular start point, this end point,\n\nthis driver and whatever information it needs to. And, that gets persisted into this MySQL via this Trip Service.So, this is basically the booking flow.\n\nAs part of the booking flow, we had inserted a lot of events.Whether Cab Finder was able to find a ride for the customer or not. And even the Location Service was putting in a lot of events into Kafka.\n\nNow, let's try to look at how do we use those events.This Kafka is getting a lot of events like location update events, trip update events, no driver found events, a lot of things.\n\nLet's look at some of the use cases where we can utilize those events to our benefit.One of the very common thing is - whenever a trip is completed, we need to initiate a payment to the driver.\n\nThat could be aggregated over a few hours or a few days or something of that sort. But, we still need to store information about a potential payment.There would be a Payment Service, which sits on top of this Kafka, which would have a Kafka consumer, which listens to all the\n\ntrip completion events. And as soon as a trip is completed, it would insert a record in it's Payment MySQL database, which says that -this particular driver, did this particular trip_id, for a user with user_id, and with lots of attributes like distance travelled, time taken and all of that.\n\nAnd finally an amount of money that needs to be paid to this driver.If that needs to be an instantaneous payment, this Payment Service could talk to a Payment Gateway to deliver a payment.. like transact the money.\n\nOr, if it needs to be aggregated, then it can basically run a cron which does the payment every once in a few days or something of that sort.If, let's say, a driver wants to see their payment history, there would be APIs that would be running out of this service,\n\nwhich will give all the payment transaction information against a particular driver,which we talked about in the very first section that, could be powered through Driver service, talking to Payment Service.\n\nNow, let's look at some other use cases.On top of this Kafka cluster, there would be a Spark Streaming Cluster in which some Spark streaming jobs would be running.\n\nOne of the very common things is to basically create a heat map.If, let's say, from a particular geography, we are getting a lot of events saying, there are no drivers found,\n\nthat means that, there is a surge of customers in that area and there are very few drivers.So, we can create a heat map within Driver App, powered by this Streaming, which kind of shows a particular segment or a few areas,\n\nwhich are having this kind of a scarcity so drivers can move to locations to get more tips.This is a classic example of a Streaming kind of an application.\n\nWhat it will also do is - it will basically put all the events into a Hadoop cluster, which can be used for further Analytics.On top of this Hadoop cluster, we could run a lot of ML jobs or regular Spark jobs, which will do a lot of things.\n\nSo, the very first thing is basically to do a customer classification into various categories.So, if a customer takes a trip with us every day, we'll classify them as a premium customer.\n\nIf it's a once in a while coming customer, then it would be just another customer for us.Same classification could be done for drivers.\n\nSo, there'll be these User Profiling and Driver Profiling jobs, which would ideally be a ML classification model running,which will classify those users as premium or regular, or drivers as premium drivers or regular drivers.\n\nThe same information would also be used to create an ML model, which can do the Driver Priority that we talked about in the previous section.So, based on certain attributes of drivers, for example, their ratings or the customer feedback or their ETA..\n\nbasically the accuracy of how much ETA was supposed to happen and how much ETA did actually the driver take.There could be a lot of attributes on which we stack rank the drivers.\n\nAll of those could be aggregated in these jobs and drivers could be given a score.And using those scores, drivers could be ranked by Driver Priority Engine. So, something of that sort could also be built.\n\nNow, we could also power the same... I forgot to make this link.This same information could be used to generate a fraud score.\n\nLet's say, if there is a very high correlation between a driver and a customer. Let's say, if all the location pings say thata customer and driver move together or if all the trips done by a driver are against a particular customer.\n\nFor most of them, we can safely say that this customer and driver are either friends or that's the same personusing two mobile phones to book a trip by this customer and do a trip and thereby, you know, using the..\n\nthere's something called as incentive programme run by these ubers and all the other companies.So, it's basically a way to exploit that kind of a programme. So, all those kind of frauds could be captured by these kind of models again.\n\nThe same data could be used as an input into Map Service.Let's say, if we don't have traffic information into maps. All these lat longs could basically power the traffic information of Map Service.\n\nWe can safely assume that - we'll not know the exact number of people traveling on the road,but, if some road has more of our cars, then we can safely assume that probably there is more traffic also there.\n\nIf we are at a Uber scale, we can safely assume that.So, that could be an input into Map Service or at least the traffic data and some of the road condition data also.\n\nSo, if the average speed of a driver on certain roads is very high, we can safely assume that that's a freeway or a highway or a good road.If the average speed is very low, we can assume that there is either high traffic or the road is not in good condition.\n\nOr there is something wrong with the road.And also the same information could then be used to come up with a better, enhanced ETA Calculation Engine.\n\nExact details of it, we'll go over in the Google Maps video. So, I would recommend that you look at that.But this could be one of the use cases where we use all of these information.\n",
			"rawText": "design a cab booking system, something like an Uber or OLA or Lyft.Let's start with the functional and non functional requirements that we want this system to support.\n\nSo, very first thing is - as a customer, when you open your app, you should be able to see what cabs are around you.So, that is the See Cab feature in your vicinity.\n\nThe next thing is - if you want to book a cab from one place, point A to point B let's say, you need to know how much time it will take to travelfrom point A to point B. And, you should be able to get an approximate price of how much would it cost you to book a cab via this platform.\n\nThe next thing is - you should obviously be able to book a cab.We'll not get into the varieties of.. types of cab like go, premium and all of that. We'll just assume that there is one type of cab.\n\nYou can add more features, simply! That's not a big trouble.The next thing is - there should be a very good location tracking of what driver was at what place at what point in time, for various reasons.\n\nFrom a non-functional standpoint, this platform should be global and it should be accessible to people of all countries.At least, we'll design it in that way.\n\nWhat that means is - you need to have servers in a lot of geographies so as to make sure that people in a certain geographyare accessing the servers near to them and thereby reducing the latency.\n\nNext obvious thing - it needs to work at a fairly low latency.Though this is not very, very mission critical, but it still needs to be, you know, reasonably fast.\n\nAvailability should be very high.This system should not go down. It will cause a lot of problems to people who are stuck somewhere, if the system is down.\n\nAnd at the same time, it should have high consistency.High Availability - High Consistency, might seem to you that it is trying to violate the CAP theorem, which basically says that -\n\nassuming all the systems in the world are distributed nowadays, so out of availability and consistent, you can just get one.The idea is - certain components of this need to be very highly available and certain other components need to be very highly consistent,\n\nnot both at the same time.From a scale standpoint, this system should scale to a very good number.\n\nIf I look at just some of the statistics of Uber, there are roughly 100 million active users that use Uber on a monthly basis. These are unique users.And Uber, in general, does roughly 14 million rides per day.\n\nSo with that thought in mind, let's try to look at a system that can scale up to these numbers, with these criterion.Now, the main problem that companies like Uber are trying to solve is - when you have a customer's location, who wants to book a cab,\n\nyou try to find out some few drivers who are very near to this location and then using some logic,try to come up with the best driver who is suited to do this trip for this customer.\n\nSo the problem then becomes, how do you find these 2 - 3 closest drivers to this customer?There are multiple ways to do that. We'll go over one of the ways which uses a concept called segment and mapping segments, basically.\n\nNow, this is a term that I just made up. It's not an industry standard term. So, just keep that in mind.Now let's just say, you have a city, something like this.\n\nThe idea is you basically divide it into rectangular segments.So, you kind of divide this city into multiple pieces.\n\nAnd you say that - this is probably your segment id 1.This is your segment id 2, something of that sort.\n\nNow, the idea is - you are dividing a city.It'll normally be divided into a lot more segments than what you can see here.\n\nNow, the idea is - given certain coordinates of the segment boundary and given certain coordinates of a cab,you should be able to figure out which segment does a cab belong in.\n\nNow, the problem looks trivial, and it is not difficult also.So, think of it like a standard coordinate system.\n\nThis is point (0,0). This is (0,1). This is (1,0). This is (1,1).Somewhere here.\n\nNow, if a point lies somewhere in between here, let's say (0.4, 0.5),you should be able to mathematically say that this point lies within this boundary.\n\nA very similar logic we'll try to use when we try to assign a particular segment to a cab.Also, keep in mind that cabs continuously moving and their locations are continuously changing.\n\nSo, we'll try to make sure that we get continuous pings from all the cabs and then keep a track of which segment do they belong in.A cab could be here right now. Could be in this particular segment. And the cab driver is going via a road, over here. Now, this changes the segment.\n\nAnd this information would be calculated at runtime, as and when we are getting pings from the cab.So, we'll have something called a Maps Service.\n\nThis Maps Service will do a couple of things.The very first thing is that - it will be responsible for dividing the city into these segments and taking care of the segments.\n\nThe other thing it will also do is - given a lat long of a cab and given a lat long of a customer,tell which segment do these users belong to at this point in time.\n\nThis service will also be used to calculate ETA from point A to point B and the route from point A to point B and thus even the distance.But, we'll abstract out. We'll not go into much detail on how that ETA and distance piece is implemented.\n\nThink of it for now as if we'll be using a Google Maps Service and we'll go over the details of implementation of thatwhen we do another system design video on implementing Google Maps.\n\nWith that being said, there is also one more thing that this service does.So let's just say, there is a huge amount of traffic or huge amount of cab drivers in this particular segment. And it is getting unmanageable.\n\nSo the idea of segment is - it should be a small set of drivers that are in the segment.So this service will take care of dividing this segment into multiple parts. It could do it into 4 parts. It could divide it into 6 parts.\n\nThat logic resides within Maps Service.Let's just say, there is very less traffic in some other locality.\n\nSo, it could also decide to merge a couple of segments into one segment and say, this whole thing is now one segment.So all the segment management remains within this service.\n\nNow, let's look at the overall architecture and how individual users and drivers get connected to the system.All the users get connected through this User App, which talks to a Load Balancer, which talks to something called as a User Service.\n\nThis User Service is your repository of all the user information.Plus, it is also a proxy, that will connect to other services to get any information that a user wants.\n\nSo, for example, if a user wants to see their profile, update their profile, all the APIs to do that are powered by User Service.If somebody wants to fetch user information, any other service for example, then all the APIs for that are powered by this service.\n\nLet's say, if a user wants to see their trips, then this User Service will talk to Trip Service, fetch all the trips for that user and send it back to the user.So that's the responsibility of User Service.\n\nFrom a database standpoint, it sits on top of a MySQL cluster, which stores all the user information within that.And it also uses a Redis for caching the same information.\n\nSo let's say, a GET API to get a user's information is called, it first queries the Redis. If it has information, it returns from there. If it doesn't haveinformation, then it queries a MySQL slave, fetches that information, stores it in Redis and then returns back to whoever was calling.\n\nThe next flow that the user calls is basically when they try to book a cab.The whole screen that the customer, kind of, goes through when they are trying to book a cab is powered by this Cab Request Service.\n\nEssentially what it does is -it basically makes a WebSocket connection with the User's App, which displays them a few cabs onto their UI  which are around them.\n\nAlso, it places a request with something called a Cab Finder. We'll go over this in the next section. Whenever Cab Finder responds back with a cab,this Cab Request Service talks to the User App, basically sends them a response, through this WebSocket connection,\n\nsaying that the cab is booked and these are the details and whatever is required.This is approximately the major user flows.\n\nNow quickly, let's look at the driver flows.A driver basically talks via the Driver App.\n\nAgain, there is a very similar Driver Service, exactly similar to the User Service.But for drivers, again, all the APIs for getting, updating all the driver information is powered via this.\n\nIf a driver wants to see their payment information for example, their payment history, this Driver Service will expose an APIwhich the Driver App will call and Driver Service will internally call a Payment Service to get that information and respond back.\n\nIt could call Trip Service to get the trips of all the drivers. And, all the UI data gets powered by this service.This service sits on top of another MySQL which has all the driver information.\n\nAnd it uses Redis for caching in exactly the same way the User Service does.This Driver App also talks to something called as a Location Service through a series of servers,\n\nagain maintaining a WebSocket connection with these servers.And, as and when a driver is moving through the city, every 5 seconds or 10 seconds, their location is being sent out to this Location Service,\n\nwhich then queries the Map Service that we talked about earlier, to find out which segment does the driver belong to.And when the customer places this cab request, customer's segment is calculated, driver segments are calculated\n\nand they are mixed and matched by the Cab Finder and a couple of other components to give the best suited driver for a particular trip.Now, let's look at how does a customer and driver come together.\n\nAll the active drivers in the system, who are online right now, ready for trips and all, are mentioned as D1, D2, D3.There'll be a lot more such drivers.\n\nAll those drivers.. each of them is connected to one of the servers through a WebSocket connection.And those servers are called out as WebSocket Handler 1, WebSocket Handler 2, WebSocket Handler 3.\n\nNow, why do we need WebSocket here?So, we always need a connection between the driver and a service.. for a lot of reasons.\n\nOne of the very first things is that - a driver continuously sends location pings to the backend, telling about the location.Now, if each time they start creating a new connection, that's a kind of a heavy operation. So, we'll have this connection live.\n\nAlso, at times, the servers might want to talk to driver. So, let's say, if a trip is assigned to a driver, we need to inform the driver.So, we can reuse the same connection to talk to a driver and tell them that this is the trip information that you have to do right now.\n\nFor all of that, there are these WebSocket Handler servers.In the real world, there'll be hundreds of such servers, who are interfacing with all the drivers, which are throughout the world, geographically split.\n\nNow, let's say, somebody in the system identifies that a trip is being given to a driver and to reach out to the driver,they first need to know that which out of these hundreds of WebSocket Handler servers, do I need to talk to.\n\nFor that, there is something called as a WebSocket Manager.Now, this WebSocket Manager is another distributed service which manages the fact that which server is connected to what all drivers.\n\nSo, let's say, D3 is a new driver that has come online right now and through the load balancer, it got connected to WebSocket Handler 3.So, this Handler will inform the Manager, saying I have now got connected to D3 also. So, if there's anything for D3, inform me.\n\nAnd this Manager will store this in it's database.Now, let's say, this connection got broken and D3 is offline right now. Again this Handler will inform the  Manager that D3 is now offline.\n\nDo not reach out to me for any communication of D3.This manager sits on top of a Redis cluster.\n\nThis Redis would not just be storing data in-memory, it will also be storing it in a persistent store on disk.And it will basically store 2 kinds of mapping.\n\nOne is saying that.. the most frequently used one, is that - which driver is connected to which host..which is saying something like D1 is connected to H1.\n\nSimilarly, there'll be an entry for each of the drivers in the system, saying which driver_id is connected to what host_id.It'll also have a reverse mapping, saying which host_id is connected to what all driver_id.\n\nSo, it could have a mapping saying H1 is connected to D1, D2, D3, so on and so forth. Because that mapping might be used for something.Coming to other things that this WebSocket is used for.\n\nSo these drivers/ devices send location pings to our backend, let's say, every 5 seconds.So, every 5 seconds, we get a hit about the location information.\n\nAll the location related information is managed by something called Location Service. It does a lot of things.One of the things that happens here is - it stores the information about the driver's location into it's Cassandra.\n\nWhy Cassandra?Because, again, there are like thousands probably or maybe even millions of drivers across the globe\n\nwho are sending their location updates every 5 seconds.So, there are a lot of updates happening. So, a Cassandra should be able to easily scale up to that number. That's the main reason.\n\nThere are 2 kinds of information that get stored here.One is - the live location of the driver, which is the last known location.\n\nThe other thing that is stored is - while a driver is doing a trip with a customer, we need to know exactly what was the route followed,for any auditing purpose or billing purpose.\n\nVery common use case is - Once we know the points that the driver followed, we would be able to trace that out and then come upwith the real distance that the driver actually travelled and then use that to come up with the pricing.\n\nSo all of those things are basically responsibilities of Location Service.Location Service also talks to Map Service.\n\nRemember, Map Service from the previous section. Map Service is a service that maintains the segments that we have createdthroughout the city and throughout the globe. So, Map Service maintains not just the segments, it also gives us the ETA, which will be the\n\ntime taken from point A to point B and the distance that will be followed and also the route that should be followed from point A to point B.Think of Map Service as an abstraction that we have. We'll not go into the details of implementation of Map Service right now.\n\nI have made another video which is on the design of Google Maps, that goes into details of how Map Service is implemented.But, that being said, Location Service, as soon as it gets a ping from a driver,\n\nit basically queries Map Service and tries to figure out that this lat long belongs to which segment.It then stores it into it's Redis, saying, this segment has these drivers.\n\nThis update happens only when a driver's segment changes. If he's in the same segment, then no change happens.This basically is used for a lot of purposes. So, let's say, we want to find out drivers in a vicinity,\n\nwe'll query this service saying who all are the drivers that are basically in S1.There is one more thing that Map Service does. It basically keeps a mapping of which all are the segments surrounding a particular segment.\n\nWhich, we'll come to in a while on how it is being used.There's something called as Trip Service. Trip Service is basically the source of truth for all the trip information.\n\nIt sits on top of a MySQL database and a Cassandra database.It uses MySQL for all the live information, basically information of all the trips that are either about to happen in some near future or are in progress.\n\nOnce the trip is completed, then it basically can move to Cassandra.Now, why don't we store all the information in MySQL? Because over time, this will become a very massive volume of data.\n\nPlus, if it is just for read queries, Cassandra is also good enough. So, we don't really need to store it in MySQL.The main reason of storing it in MySQL is because trip would have a lot of information.\n\nIt would have information about the customers, about the divers, about potential start times; end times, about the potential distances,about the real values and maybe some events information that have come in between, maybe some payment information and a lot of other things.\n\nNow, if you look at it in tables terms, these will be a lot of tables.And, for each event that comes in against a trip, we might need to update a lot of such tables.\n\nAnd there, it is very good to have transactional properties.So, that's the reason we'll be using a MySQL for all the trips that will be updated.\n\nAnd once the trip is completed, then we can move it to Cassandra.Now, this movement from MySQL to Cassandra is taken up by this Trip Archiver Service, which basically is a cron,\n\nwhich spawns once in every probably 12 hours and pulls the data from MySQL and puts it into Cassandra.Coming back to Trip Service.. Trip Service will expose all the APIs around trips. So, if you want to get a trip by id or if you want to get all the trips\n\nof a particular driver or all the trips of a user, all of those APIs would be powered by Trip Service.And let's say, if it's a search by a driver_id, it will query MySQL, it will query Cassandra, it will get the results from both of them, merge them\n\nand then return it back to whoever was calling. So, that's how it's flow would be.Now, let's get to the main flow on what happens when a customer actually requests a cab.\n\nThe customer flow begins at this point where they basically make a request to Cab Request Service through againan open connection between both the parties, the Customer and this service.\n\nAnd basically, what the customer says is - this is my source lat long. I need to go to a destination which is identified by certain lat long. Get me a cab.I'm assuming there is just one type of cab and no varieties and types of cab. If you want to implement, that is a straightforward thing to implement.\n\nBut given this request, Cab Request Service then queries something called as Cab Finder,which is responsible to come up with that one driver who will do the trip.\n\nAt the end of all of it, Cab Finder will respond back to Cab Request Service saying, this is your trip_id, this is your driver_id,go send it back to the customer.. in a nice form, with all the details about the driver and all of that. And Cab Service would send that.\n\nCab Finder will also put a notification into a Kafka, whether or not it was able to find a driver.Let's say, if it's not able to find a driver, may be because there is a scarcity of drivers, all of that would go into Kafka,\n\nwhich can be used for further Analytics like for example, telling drivers that this is a location where there are more customers and less driversso why don't you go into that location to get more trips or something of that sort.\n\nComing to what Cab Finder does.The very first thing Cab Finder would do is basically - it has a source lat long, which is basically identifier of a particular location of a customer.\n\nIt will first of all query Location Service saying, get me the segment in which this customer currently is.Along with that, also give me a list of drivers that are near this customer.\n\nWhat it does is - it first of all queries Map Service with the lat long of the customer, to get the segment which the customer is in.It then queries surrounding segments. So, I'll try to explain why do we need surrounding segments.\n\nSo, let's say, there is a rectangle like this and customer was sitting here.There were a couple of drivers in various locations in this segment. There could possibly be a driver just here.\n\nBut, if we query all the drivers within this segment, then we'll get a driver who is far away.But, a driver is just next to customer, maybe in another segment.\n\nSo, for doing that, we basically.. let's say if it is segment S1, we need to find all the segments that aresurrounding S1 and get the closest 10 drivers, let's say, in all of those segments.\n\nSo, let's say, there could be a couple of segments over here and maybe you can have something like this. This is S2, S3, S4, something of that sort.So, we'll query all of these segments. Basically, we'll not query, we'll just off load that job to Map Service saying, get me all the segments\n\nthat are surrounding this segment S1, that Location Service gets. Then, Location Service basically figures out all the driversand then tells Map Service to get the closest 10 drivers to this customer, out of a list of those drivers.\n\nDistance between the customer and the driver is also something Map Service is good at.Remember, it is able to find and identify the distance between two points.\n\nSo, it can identify the distance between two customers and drivers, taking into account the road distance, not the aerial distance.Let's say, it got some 5 - 10 drivers which are close by to the customer. Location Service will return it to Cab Finder.\n\nNow basically, we need to identify 1 driver out of these 10 who will do the trip.Now, there comes something called modes. There could be multiple modes in which this cab request could be served.\n\nWe could say that for certain kind of customers, just pick the best driver.Let's say, if it's a premium customer, then we just pick the best driver out of the lot and assign that.\n\nOr, if it's an average customer, we might want to do some different thing.We might want to broadcast to all the drivers and whoever accepts first, we can assign that driver to the trip.\n\nSo, all of these modes are basically something that Cab Finder decides that which mode I want to run it in.Given whatever mode it is, it might need some additional inputs.\n\nSo, if it's the best driver mode, then it might need to stack rank all the drivers.So, all of these are basically something that is handled by Driver Priority Engine. We'll get to the logic, what it follows, later on.\n\nCab Finder then queries Driver Priority Engine saying, I have these drivers for this kind of a customer, you just arrange them and give me back.Then it gets a list of those drivers. And given the mode and given the list, it then tries to identify one of the drivers who will actually do that trip.\n\nIt then queries WebSocket Manager and asks WebSocket Manager saying,which was the host that was actually, you know, integrating with this particular driver. It will then call WebSocket Handler.\n\nLet's say it chose D1, it will then call this Handler 1 saying, D1 you have a trip, go do it.The same notification would be sent via Cab Request Service to Customer saying, Customer, you have got a new driver, which is driver D1.\n\nAnd then the regular flow follows wherein the driver starts moving to the customer's location.So, this is how we'll figure out, how to assign a driver to a customer.\n\nOnce a driver is assigned, basically, what it means is, a trip has to be created and updated.So, this will then basically update the Trip Service saying, I've created a trip with this customer, with this particular start point, this end point,\n\nthis driver and whatever information it needs to. And, that gets persisted into this MySQL via this Trip Service.So, this is basically the booking flow.\n\nAs part of the booking flow, we had inserted a lot of events.Whether Cab Finder was able to find a ride for the customer or not. And even the Location Service was putting in a lot of events into Kafka.\n\nNow, let's try to look at how do we use those events.This Kafka is getting a lot of events like location update events, trip update events, no driver found events, a lot of things.\n\nLet's look at some of the use cases where we can utilize those events to our benefit.One of the very common thing is - whenever a trip is completed, we need to initiate a payment to the driver.\n\nThat could be aggregated over a few hours or a few days or something of that sort. But, we still need to store information about a potential payment.There would be a Payment Service, which sits on top of this Kafka, which would have a Kafka consumer, which listens to all the\n\ntrip completion events. And as soon as a trip is completed, it would insert a record in it's Payment MySQL database, which says that -this particular driver, did this particular trip_id, for a user with user_id, and with lots of attributes like distance travelled, time taken and all of that.\n\nAnd finally an amount of money that needs to be paid to this driver.If that needs to be an instantaneous payment, this Payment Service could talk to a Payment Gateway to deliver a payment.. like transact the money.\n\nOr, if it needs to be aggregated, then it can basically run a cron which does the payment every once in a few days or something of that sort.If, let's say, a driver wants to see their payment history, there would be APIs that would be running out of this service,\n\nwhich will give all the payment transaction information against a particular driver,which we talked about in the very first section that, could be powered through Driver service, talking to Payment Service.\n\nNow, let's look at some other use cases.On top of this Kafka cluster, there would be a Spark Streaming Cluster in which some Spark streaming jobs would be running.\n\nOne of the very common things is to basically create a heat map.If, let's say, from a particular geography, we are getting a lot of events saying, there are no drivers found,\n\nthat means that, there is a surge of customers in that area and there are very few drivers.So, we can create a heat map within Driver App, powered by this Streaming, which kind of shows a particular segment or a few areas,\n\nwhich are having this kind of a scarcity so drivers can move to locations to get more tips.This is a classic example of a Streaming kind of an application.\n\nWhat it will also do is - it will basically put all the events into a Hadoop cluster, which can be used for further Analytics.On top of this Hadoop cluster, we could run a lot of ML jobs or regular Spark jobs, which will do a lot of things.\n\nSo, the very first thing is basically to do a customer classification into various categories.So, if a customer takes a trip with us every day, we'll classify them as a premium customer.\n\nIf it's a once in a while coming customer, then it would be just another customer for us.Same classification could be done for drivers.\n\nSo, there'll be these User Profiling and Driver Profiling jobs, which would ideally be a ML classification model running,which will classify those users as premium or regular, or drivers as premium drivers or regular drivers.\n\nThe same information would also be used to create an ML model, which can do the Driver Priority that we talked about in the previous section.So, based on certain attributes of drivers, for example, their ratings or the customer feedback or their ETA..\n\nbasically the accuracy of how much ETA was supposed to happen and how much ETA did actually the driver take.There could be a lot of attributes on which we stack rank the drivers.\n\nAll of those could be aggregated in these jobs and drivers could be given a score.And using those scores, drivers could be ranked by Driver Priority Engine. So, something of that sort could also be built.\n\nNow, we could also power the same... I forgot to make this link.This same information could be used to generate a fraud score.\n\nLet's say, if there is a very high correlation between a driver and a customer. Let's say, if all the location pings say thata customer and driver move together or if all the trips done by a driver are against a particular customer.\n\nFor most of them, we can safely say that this customer and driver are either friends or that's the same personusing two mobile phones to book a trip by this customer and do a trip and thereby, you know, using the..\n\nthere's something called as incentive programme run by these ubers and all the other companies.So, it's basically a way to exploit that kind of a programme. So, all those kind of frauds could be captured by these kind of models again.\n\nThe same data could be used as an input into Map Service.Let's say, if we don't have traffic information into maps. All these lat longs could basically power the traffic information of Map Service.\n\nWe can safely assume that - we'll not know the exact number of people traveling on the road,but, if some road has more of our cars, then we can safely assume that probably there is more traffic also there.\n\nIf we are at a Uber scale, we can safely assume that.So, that could be an input into Map Service or at least the traffic data and some of the road condition data also.\n\nSo, if the average speed of a driver on certain roads is very high, we can safely assume that that's a freeway or a highway or a good road.If the average speed is very low, we can assume that there is either high traffic or the road is not in good condition.\n\nOr there is something wrong with the road.And also the same information could then be used to come up with a better, enhanced ETA Calculation Engine.\n\nExact details of it, we'll go over in the Google Maps video. So, I would recommend that you look at that.But this could be one of the use cases where we use all of these information.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "design a cab booking system, something like an Uber or OLA or Lyft.Let's start with the functional and non functional requirements that we want this system to support.\n\nSo, very first thing is - as a customer, when you open your app, you should be able to see what cabs are around you.So, that is the See Cab feature in your vicinity.\n\nThe next thing is - if you want to book a cab from one place, point A to point B let's say, you need to know how much time it will take to travelfrom point A to point B. And, you should be able to get an approximate price of how much would it cost you to book a cab via this platform.\n\nThe next thing is - you should obviously be able to book a cab.We'll not get into the varieties of.. types of cab like go, premium and all of that. We'll just assume that there is one type of cab.\n\nYou can add more features, simply! That's not a big trouble.The next thing is - there should be a very good location tracking of what driver was at what place at what point in time, for various reasons.\n\nFrom a non-functional standpoint, this platform should be global and it should be accessible to people of all countries.At least, we'll design it in that way.\n\nWhat that means is - you need to have servers in a lot of geographies so as to make sure that people in a certain geographyare accessing the servers near to them and thereby reducing the latency.\n\nNext obvious thing - it needs to work at a fairly low latency.Though this is not very, very mission critical, but it still needs to be, you know, reasonably fast.\n\nAvailability should be very high.This system should not go down. It will cause a lot of problems to people who are stuck somewhere, if the system is down.\n\nAnd at the same time, it should have high consistency.High Availability - High Consistency, might seem to you that it is trying to violate the CAP theorem, which basically says that -\n\nassuming all the systems in the world are distributed nowadays, so out of availability and consistent, you can just get one.The idea is - certain components of this need to be very highly available and certain other components need to be very highly consistent,\n\nnot both at the same time.From a scale standpoint, this system should scale to a very good number.\n\nIf I look at just some of the statistics of Uber, there are roughly 100 million active users that use Uber on a monthly basis. These are unique users.And Uber, in general, does roughly 14 million rides per day.\n\nSo with that thought in mind, let's try to look at a system that can scale up to these numbers, with these criterion.Now, the main problem that companies like Uber are trying to solve is - when you have a customer's location, who wants to book a cab,\n\nyou try to find out some few drivers who are very near to this location and then using some logic,try to come up with the best driver who is suited to do this trip for this customer.\n\nSo the problem then becomes, how do you find these 2 - 3 closest drivers to this customer?There are multiple ways to do that. We'll go over one of the ways which uses a concept called segment and mapping segments, basically.\n\nNow, this is a term that I just made up. It's not an industry standard term. So, just keep that in mind.Now let's just say, you have a city, something like this.\n\nThe idea is you basically divide it into rectangular segments.So, you kind of divide this city into multiple pieces.\n\nAnd you say that - this is probably your segment id 1.This is your segment id 2, something of that sort.\n\nNow, the idea is - you are dividing a city.It'll normally be divided into a lot more segments than what you can see here.\n\nNow, the idea is - given certain coordinates of the segment boundary and given certain coordinates of a cab,you should be able to figure out which segment does a cab belong in.\n\nNow, the problem looks trivial, and it is not difficult also.So, think of it like a standard coordinate system.\n\nThis is point (0,0). This is (0,1). This is (1,0). This is (1,1).Somewhere here.\n\nNow, if a point lies somewhere in between here, let's say (0.4, 0.5),you should be able to mathematically say that this point lies within this boundary.\n\nA very similar logic we'll try to use when we try to assign a particular segment to a cab.Also, keep in mind that cabs continuously moving and their locations are continuously changing.\n\nSo, we'll try to make sure that we get continuous pings from all the cabs and then keep a track of which segment do they belong in.A cab could be here right now. Could be in this particular segment. And the cab driver is going via a road, over here. Now, this changes the segment.\n\nAnd this information would be calculated at runtime, as and when we are getting pings from the cab.So, we'll have something called a Maps Service.\n\nThis Maps Service will do a couple of things.The very first thing is that - it will be responsible for dividing the city into these segments and taking care of the segments.\n\nThe other thing it will also do is - given a lat long of a cab and given a lat long of a customer,tell which segment do these users belong to at this point in time.\n\nThis service will also be used to calculate ETA from point A to point B and the route from point A to point B and thus even the distance.But, we'll abstract out. We'll not go into much detail on how that ETA and distance piece is implemented.\n\nThink of it for now as if we'll be using a Google Maps Service and we'll go over the details of implementation of thatwhen we do another system design video on implementing Google Maps.\n\nWith that being said, there is also one more thing that this service does.So let's just say, there is a huge amount of traffic or huge amount of cab drivers in this particular segment. And it is getting unmanageable.\n\nSo the idea of segment is - it should be a small set of drivers that are in the segment.So this service will take care of dividing this segment into multiple parts. It could do it into 4 parts. It could divide it into 6 parts.\n\nThat logic resides within Maps Service.Let's just say, there is very less traffic in some other locality.\n\nSo, it could also decide to merge a couple of segments into one segment and say, this whole thing is now one segment.So all the segment management remains within this service.\n\nNow, let's look at the overall architecture and how individual users and drivers get connected to the system.All the users get connected through this User App, which talks to a Load Balancer, which talks to something called as a User Service.\n\nThis User Service is your repository of all the user information.Plus, it is also a proxy, that will connect to other services to get any information that a user wants.\n\nSo, for example, if a user wants to see their profile, update their profile, all the APIs to do that are powered by User Service.If somebody wants to fetch user information, any other service for example, then all the APIs for that are powered by this service.\n\nLet's say, if a user wants to see their trips, then this User Service will talk to Trip Service, fetch all the trips for that user and send it back to the user.So that's the responsibility of User Service.\n\nFrom a database standpoint, it sits on top of a MySQL cluster, which stores all the user information within that.And it also uses a Redis for caching the same information.\n\nSo let's say, a GET API to get a user's information is called, it first queries the Redis. If it has information, it returns from there. If it doesn't haveinformation, then it queries a MySQL slave, fetches that information, stores it in Redis and then returns back to whoever was calling.\n\nThe next flow that the user calls is basically when they try to book a cab.The whole screen that the customer, kind of, goes through when they are trying to book a cab is powered by this Cab Request Service.\n\nEssentially what it does is -it basically makes a WebSocket connection with the User's App, which displays them a few cabs onto their UI  which are around them.\n\nAlso, it places a request with something called a Cab Finder. We'll go over this in the next section. Whenever Cab Finder responds back with a cab,this Cab Request Service talks to the User App, basically sends them a response, through this WebSocket connection,\n\nsaying that the cab is booked and these are the details and whatever is required.This is approximately the major user flows.\n\nNow quickly, let's look at the driver flows.A driver basically talks via the Driver App.\n\nAgain, there is a very similar Driver Service, exactly similar to the User Service.But for drivers, again, all the APIs for getting, updating all the driver information is powered via this.\n\nIf a driver wants to see their payment information for example, their payment history, this Driver Service will expose an APIwhich the Driver App will call and Driver Service will internally call a Payment Service to get that information and respond back.\n\nIt could call Trip Service to get the trips of all the drivers. And, all the UI data gets powered by this service.This service sits on top of another MySQL which has all the driver information.\n\nAnd it uses Redis for caching in exactly the same way the User Service does.This Driver App also talks to something called as a Location Service through a series of servers,\n\nagain maintaining a WebSocket connection with these servers.And, as and when a driver is moving through the city, every 5 seconds or 10 seconds, their location is being sent out to this Location Service,\n\nwhich then queries the Map Service that we talked about earlier, to find out which segment does the driver belong to.And when the customer places this cab request, customer's segment is calculated, driver segments are calculated\n\nand they are mixed and matched by the Cab Finder and a couple of other components to give the best suited driver for a particular trip.Now, let's look at how does a customer and driver come together.\n\nAll the active drivers in the system, who are online right now, ready for trips and all, are mentioned as D1, D2, D3.There'll be a lot more such drivers.\n\nAll those drivers.. each of them is connected to one of the servers through a WebSocket connection.And those servers are called out as WebSocket Handler 1, WebSocket Handler 2, WebSocket Handler 3.\n\nNow, why do we need WebSocket here?So, we always need a connection between the driver and a service.. for a lot of reasons.\n\nOne of the very first things is that - a driver continuously sends location pings to the backend, telling about the location.Now, if each time they start creating a new connection, that's a kind of a heavy operation. So, we'll have this connection live.\n\nAlso, at times, the servers might want to talk to driver. So, let's say, if a trip is assigned to a driver, we need to inform the driver.So, we can reuse the same connection to talk to a driver and tell them that this is the trip information that you have to do right now.\n\nFor all of that, there are these WebSocket Handler servers.In the real world, there'll be hundreds of such servers, who are interfacing with all the drivers, which are throughout the world, geographically split.\n\nNow, let's say, somebody in the system identifies that a trip is being given to a driver and to reach out to the driver,they first need to know that which out of these hundreds of WebSocket Handler servers, do I need to talk to.\n\nFor that, there is something called as a WebSocket Manager.Now, this WebSocket Manager is another distributed service which manages the fact that which server is connected to what all drivers.\n\nSo, let's say, D3 is a new driver that has come online right now and through the load balancer, it got connected to WebSocket Handler 3.So, this Handler will inform the Manager, saying I have now got connected to D3 also. So, if there's anything for D3, inform me.\n\nAnd this Manager will store this in it's database.Now, let's say, this connection got broken and D3 is offline right now. Again this Handler will inform the  Manager that D3 is now offline.\n\nDo not reach out to me for any communication of D3.This manager sits on top of a Redis cluster.\n\nThis Redis would not just be storing data in-memory, it will also be storing it in a persistent store on disk.And it will basically store 2 kinds of mapping.\n\nOne is saying that.. the most frequently used one, is that - which driver is connected to which host..which is saying something like D1 is connected to H1.\n\nSimilarly, there'll be an entry for each of the drivers in the system, saying which driver_id is connected to what host_id.It'll also have a reverse mapping, saying which host_id is connected to what all driver_id.\n\nSo, it could have a mapping saying H1 is connected to D1, D2, D3, so on and so forth. Because that mapping might be used for something.Coming to other things that this WebSocket is used for.\n\nSo these drivers/ devices send location pings to our backend, let's say, every 5 seconds.So, every 5 seconds, we get a hit about the location information.\n\nAll the location related information is managed by something called Location Service. It does a lot of things.One of the things that happens here is - it stores the information about the driver's location into it's Cassandra.\n\nWhy Cassandra?Because, again, there are like thousands probably or maybe even millions of drivers across the globe\n\nwho are sending their location updates every 5 seconds.So, there are a lot of updates happening. So, a Cassandra should be able to easily scale up to that number. That's the main reason.\n\nThere are 2 kinds of information that get stored here.One is - the live location of the driver, which is the last known location.\n\nThe other thing that is stored is - while a driver is doing a trip with a customer, we need to know exactly what was the route followed,for any auditing purpose or billing purpose.\n\nVery common use case is - Once we know the points that the driver followed, we would be able to trace that out and then come upwith the real distance that the driver actually travelled and then use that to come up with the pricing.\n\nSo all of those things are basically responsibilities of Location Service.Location Service also talks to Map Service.\n\nRemember, Map Service from the previous section. Map Service is a service that maintains the segments that we have createdthroughout the city and throughout the globe. So, Map Service maintains not just the segments, it also gives us the ETA, which will be the\n\ntime taken from point A to point B and the distance that will be followed and also the route that should be followed from point A to point B.Think of Map Service as an abstraction that we have. We'll not go into the details of implementation of Map Service right now.\n\nI have made another video which is on the design of Google Maps, that goes into details of how Map Service is implemented.But, that being said, Location Service, as soon as it gets a ping from a driver,\n\nit basically queries Map Service and tries to figure out that this lat long belongs to which segment.It then stores it into it's Redis, saying, this segment has these drivers.\n\nThis update happens only when a driver's segment changes. If he's in the same segment, then no change happens.This basically is used for a lot of purposes. So, let's say, we want to find out drivers in a vicinity,\n\nwe'll query this service saying who all are the drivers that are basically in S1.There is one more thing that Map Service does. It basically keeps a mapping of which all are the segments surrounding a particular segment.\n\nWhich, we'll come to in a while on how it is being used.There's something called as Trip Service. Trip Service is basically the source of truth for all the trip information.\n\nIt sits on top of a MySQL database and a Cassandra database.It uses MySQL for all the live information, basically information of all the trips that are either about to happen in some near future or are in progress.\n\nOnce the trip is completed, then it basically can move to Cassandra.Now, why don't we store all the information in MySQL? Because over time, this will become a very massive volume of data.\n\nPlus, if it is just for read queries, Cassandra is also good enough. So, we don't really need to store it in MySQL.The main reason of storing it in MySQL is because trip would have a lot of information.\n\nIt would have information about the customers, about the divers, about potential start times; end times, about the potential distances,about the real values and maybe some events information that have come in between, maybe some payment information and a lot of other things.\n\nNow, if you look at it in tables terms, these will be a lot of tables.And, for each event that comes in against a trip, we might need to update a lot of such tables.\n\nAnd there, it is very good to have transactional properties.So, that's the reason we'll be using a MySQL for all the trips that will be updated.\n\nAnd once the trip is completed, then we can move it to Cassandra.Now, this movement from MySQL to Cassandra is taken up by this Trip Archiver Service, which basically is a cron,\n\nwhich spawns once in every probably 12 hours and pulls the data from MySQL and puts it into Cassandra.Coming back to Trip Service.. Trip Service will expose all the APIs around trips. So, if you want to get a trip by id or if you want to get all the trips\n\nof a particular driver or all the trips of a user, all of those APIs would be powered by Trip Service.And let's say, if it's a search by a driver_id, it will query MySQL, it will query Cassandra, it will get the results from both of them, merge them\n\nand then return it back to whoever was calling. So, that's how it's flow would be.Now, let's get to the main flow on what happens when a customer actually requests a cab.\n\nThe customer flow begins at this point where they basically make a request to Cab Request Service through againan open connection between both the parties, the Customer and this service.\n\nAnd basically, what the customer says is - this is my source lat long. I need to go to a destination which is identified by certain lat long. Get me a cab.I'm assuming there is just one type of cab and no varieties and types of cab. If you want to implement, that is a straightforward thing to implement.\n\nBut given this request, Cab Request Service then queries something called as Cab Finder,which is responsible to come up with that one driver who will do the trip.\n\nAt the end of all of it, Cab Finder will respond back to Cab Request Service saying, this is your trip_id, this is your driver_id,go send it back to the customer.. in a nice form, with all the details about the driver and all of that. And Cab Service would send that.\n\nCab Finder will also put a notification into a Kafka, whether or not it was able to find a driver.Let's say, if it's not able to find a driver, may be because there is a scarcity of drivers, all of that would go into Kafka,\n\nwhich can be used for further Analytics like for example, telling drivers that this is a location where there are more customers and less driversso why don't you go into that location to get more trips or something of that sort.\n\nComing to what Cab Finder does.The very first thing Cab Finder would do is basically - it has a source lat long, which is basically identifier of a particular location of a customer.\n\nIt will first of all query Location Service saying, get me the segment in which this customer currently is.Along with that, also give me a list of drivers that are near this customer.\n\nWhat it does is - it first of all queries Map Service with the lat long of the customer, to get the segment which the customer is in.It then queries surrounding segments. So, I'll try to explain why do we need surrounding segments.\n\nSo, let's say, there is a rectangle like this and customer was sitting here.There were a couple of drivers in various locations in this segment. There could possibly be a driver just here.\n\nBut, if we query all the drivers within this segment, then we'll get a driver who is far away.But, a driver is just next to customer, maybe in another segment.\n\nSo, for doing that, we basically.. let's say if it is segment S1, we need to find all the segments that aresurrounding S1 and get the closest 10 drivers, let's say, in all of those segments.\n\nSo, let's say, there could be a couple of segments over here and maybe you can have something like this. This is S2, S3, S4, something of that sort.So, we'll query all of these segments. Basically, we'll not query, we'll just off load that job to Map Service saying, get me all the segments\n\nthat are surrounding this segment S1, that Location Service gets. Then, Location Service basically figures out all the driversand then tells Map Service to get the closest 10 drivers to this customer, out of a list of those drivers.\n\nDistance between the customer and the driver is also something Map Service is good at.Remember, it is able to find and identify the distance between two points.\n\nSo, it can identify the distance between two customers and drivers, taking into account the road distance, not the aerial distance.Let's say, it got some 5 - 10 drivers which are close by to the customer. Location Service will return it to Cab Finder.\n\nNow basically, we need to identify 1 driver out of these 10 who will do the trip.Now, there comes something called modes. There could be multiple modes in which this cab request could be served.\n\nWe could say that for certain kind of customers, just pick the best driver.Let's say, if it's a premium customer, then we just pick the best driver out of the lot and assign that.\n\nOr, if it's an average customer, we might want to do some different thing.We might want to broadcast to all the drivers and whoever accepts first, we can assign that driver to the trip.\n\nSo, all of these modes are basically something that Cab Finder decides that which mode I want to run it in.Given whatever mode it is, it might need some additional inputs.\n\nSo, if it's the best driver mode, then it might need to stack rank all the drivers.So, all of these are basically something that is handled by Driver Priority Engine. We'll get to the logic, what it follows, later on.\n\nCab Finder then queries Driver Priority Engine saying, I have these drivers for this kind of a customer, you just arrange them and give me back.Then it gets a list of those drivers. And given the mode and given the list, it then tries to identify one of the drivers who will actually do that trip.\n\nIt then queries WebSocket Manager and asks WebSocket Manager saying,which was the host that was actually, you know, integrating with this particular driver. It will then call WebSocket Handler.\n\nLet's say it chose D1, it will then call this Handler 1 saying, D1 you have a trip, go do it.The same notification would be sent via Cab Request Service to Customer saying, Customer, you have got a new driver, which is driver D1.\n\nAnd then the regular flow follows wherein the driver starts moving to the customer's location.So, this is how we'll figure out, how to assign a driver to a customer.\n\nOnce a driver is assigned, basically, what it means is, a trip has to be created and updated.So, this will then basically update the Trip Service saying, I've created a trip with this customer, with this particular start point, this end point,\n\nthis driver and whatever information it needs to. And, that gets persisted into this MySQL via this Trip Service.So, this is basically the booking flow.\n\nAs part of the booking flow, we had inserted a lot of events.Whether Cab Finder was able to find a ride for the customer or not. And even the Location Service was putting in a lot of events into Kafka.\n\nNow, let's try to look at how do we use those events.This Kafka is getting a lot of events like location update events, trip update events, no driver found events, a lot of things.\n\nLet's look at some of the use cases where we can utilize those events to our benefit.One of the very common thing is - whenever a trip is completed, we need to initiate a payment to the driver.\n\nThat could be aggregated over a few hours or a few days or something of that sort. But, we still need to store information about a potential payment.There would be a Payment Service, which sits on top of this Kafka, which would have a Kafka consumer, which listens to all the\n\ntrip completion events. And as soon as a trip is completed, it would insert a record in it's Payment MySQL database, which says that -this particular driver, did this particular trip_id, for a user with user_id, and with lots of attributes like distance travelled, time taken and all of that.\n\nAnd finally an amount of money that needs to be paid to this driver.If that needs to be an instantaneous payment, this Payment Service could talk to a Payment Gateway to deliver a payment.. like transact the money.\n\nOr, if it needs to be aggregated, then it can basically run a cron which does the payment every once in a few days or something of that sort.If, let's say, a driver wants to see their payment history, there would be APIs that would be running out of this service,\n\nwhich will give all the payment transaction information against a particular driver,which we talked about in the very first section that, could be powered through Driver service, talking to Payment Service.\n\nNow, let's look at some other use cases.On top of this Kafka cluster, there would be a Spark Streaming Cluster in which some Spark streaming jobs would be running.\n\nOne of the very common things is to basically create a heat map.If, let's say, from a particular geography, we are getting a lot of events saying, there are no drivers found,\n\nthat means that, there is a surge of customers in that area and there are very few drivers.So, we can create a heat map within Driver App, powered by this Streaming, which kind of shows a particular segment or a few areas,\n\nwhich are having this kind of a scarcity so drivers can move to locations to get more tips.This is a classic example of a Streaming kind of an application.\n\nWhat it will also do is - it will basically put all the events into a Hadoop cluster, which can be used for further Analytics.On top of this Hadoop cluster, we could run a lot of ML jobs or regular Spark jobs, which will do a lot of things.\n\nSo, the very first thing is basically to do a customer classification into various categories.So, if a customer takes a trip with us every day, we'll classify them as a premium customer.\n\nIf it's a once in a while coming customer, then it would be just another customer for us.Same classification could be done for drivers.\n\nSo, there'll be these User Profiling and Driver Profiling jobs, which would ideally be a ML classification model running,which will classify those users as premium or regular, or drivers as premium drivers or regular drivers.\n\nThe same information would also be used to create an ML model, which can do the Driver Priority that we talked about in the previous section.So, based on certain attributes of drivers, for example, their ratings or the customer feedback or their ETA..\n\nbasically the accuracy of how much ETA was supposed to happen and how much ETA did actually the driver take.There could be a lot of attributes on which we stack rank the drivers.\n\nAll of those could be aggregated in these jobs and drivers could be given a score.And using those scores, drivers could be ranked by Driver Priority Engine. So, something of that sort could also be built.\n\nNow, we could also power the same... I forgot to make this link.This same information could be used to generate a fraud score.\n\nLet's say, if there is a very high correlation between a driver and a customer. Let's say, if all the location pings say thata customer and driver move together or if all the trips done by a driver are against a particular customer.\n\nFor most of them, we can safely say that this customer and driver are either friends or that's the same personusing two mobile phones to book a trip by this customer and do a trip and thereby, you know, using the..\n\nthere's something called as incentive programme run by these ubers and all the other companies.So, it's basically a way to exploit that kind of a programme. So, all those kind of frauds could be captured by these kind of models again.\n\nThe same data could be used as an input into Map Service.Let's say, if we don't have traffic information into maps. All these lat longs could basically power the traffic information of Map Service.\n\nWe can safely assume that - we'll not know the exact number of people traveling on the road,but, if some road has more of our cars, then we can safely assume that probably there is more traffic also there.\n\nIf we are at a Uber scale, we can safely assume that.So, that could be an input into Map Service or at least the traffic data and some of the road condition data also.\n\nSo, if the average speed of a driver on certain roads is very high, we can safely assume that that's a freeway or a highway or a good road.If the average speed is very low, we can assume that there is either high traffic or the road is not in good condition.\n\nOr there is something wrong with the road.And also the same information could then be used to come up with a better, enhanced ETA Calculation Engine.\n\nExact details of it, we'll go over in the Google Maps video. So, I would recommend that you look at that.But this could be one of the use cases where we use all of these information.\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 31,
			"versionNonce": 1365086464,
			"isDeleted": false,
			"id": "ufGBW57t",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10085.558504230698,
			"y": 7982.734487741423,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 152.34375,
			"height": 72,
			"seed": 264360038,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "SDFC approach\n\n",
			"rawText": "SDFC approach\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "SDFC approach\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 70,
			"versionNonce": 700448512,
			"isDeleted": false,
			"id": "HpydFRHHCU2-n06zSFoks",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10081.352626655771,
			"y": 8045.050726429294,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 615,
			"height": 350,
			"seed": 566018234,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "8324497ac137c0afcafcca5f6a22f00634a79092",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 74,
			"versionNonce": 1367568640,
			"isDeleted": false,
			"id": "Q-U_VzppKR1Cj___A8u8v",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10839.063468712426,
			"y": 8051.227426227062,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 582.8048271964406,
			"height": 617.9249877929688,
			"seed": 889125242,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "7607f8c4c94fd1f870e7e138b6b46b8d38c7ec66",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 62,
			"versionNonce": 258481920,
			"isDeleted": false,
			"id": "8JjePUgznhbCsCY9JFo9h",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10111.333275355099,
			"y": 8726.63894028379,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1328.077585704291,
			"height": 617.9249877929688,
			"seed": 1734206694,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "59870602d9b0a55262c906f1e9ea6046819ea48e",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 89,
			"versionNonce": 300765440,
			"isDeleted": false,
			"id": "_9nXQ3yF4elRwwwy7qfF2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10487.804276438712,
			"y": 9442.826783768127,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1242.7541653936803,
			"height": 617.9249877929688,
			"seed": 1888142586,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "12012894797097ff86ae0f99cc1595a0a433bf8d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 81,
			"versionNonce": 1259093760,
			"isDeleted": false,
			"id": "-BdvrfKrma5RLS9YzSu9u",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10982.893990238084,
			"y": 10308.443946642148,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 814,
			"height": 487,
			"seed": 162319718,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "cdfd687cd2ee6e0338809e73343d6e2a300867b7",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 66,
			"versionNonce": 1780166912,
			"isDeleted": false,
			"id": "gsW-fNR-t877vR0zEpXuI",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12847.758613710921,
			"y": 9683.92745941826,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 741,
			"height": 410,
			"seed": 918784166,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "020ec1b001018c0f21f991f2e64cf6aeb823f93c",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 26,
			"versionNonce": 1026318080,
			"isDeleted": false,
			"id": "zDkyguCH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12885.66323250937,
			"y": 9524.741560619463,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 152.34375,
			"height": 48,
			"seed": 782911162,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "sdfc approach\n",
			"rawText": "sdfc approach\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "sdfc approach\n",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 135,
			"versionNonce": 1099763968,
			"isDeleted": false,
			"id": "3bRYsFAJ-SQQ9Cgvl1H5A",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 16419.742153616447,
			"y": -392.0487254831678,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2023.999633789063,
			"height": 4240.000305175781,
			"seed": 773770874,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 176,
			"versionNonce": 910720768,
			"isDeleted": false,
			"id": "nhyVjvOz",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 16449.257281439564,
			"y": -354.74769338438796,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 515.625,
			"height": 288,
			"seed": 1329197798,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Proximity Service (Yelp)\n\nFR\n\nUser: \n    Search for a place near to his lat, long\n    (Give rating/review to a place)\nBusiness:\n    Onboard\n    (Add photos)\n\n",
			"rawText": "Proximity Service (Yelp)\n\nFR\n\nUser: \n    Search for a place near to his lat, long\n    (Give rating/review to a place)\nBusiness:\n    Onboard\n    (Add photos)\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Proximity Service (Yelp)\n\nFR\n\nUser: \n    Search for a place near to his lat, long\n    (Give rating/review to a place)\nBusiness:\n    Onboard\n    (Add photos)\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 126,
			"versionNonce": 264433920,
			"isDeleted": false,
			"id": "a6pdZcXL",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 17089.56094443452,
			"y": -307.019414514701,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 468.75,
			"height": 168,
			"seed": 1047521338,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "NFR\n\nhigh availability\nscalable\nhigh consistency for user view\neach user should see same rating, review\n",
			"rawText": "NFR\n\nhigh availability\nscalable\nhigh consistency for user view\neach user should see same rating, review\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nhigh availability\nscalable\nhigh consistency for user view\neach user should see same rating, review\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 89,
			"versionNonce": 1994432256,
			"isDeleted": false,
			"id": "VmKGddZY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 16453.10167599,
			"y": -47.29936931852387,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 187.5,
			"height": 168,
			"seed": 1107302394,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Numbers\n\n178M total users\n60M dau\n500M places\n\n",
			"rawText": "Numbers\n\n178M total users\n60M dau\n500M places\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Numbers\n\n178M total users\n60M dau\n500M places\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 40,
			"versionNonce": 1547489536,
			"isDeleted": false,
			"id": "NXDGb_zvl3uKyvaLFwwoB",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 16517.409304199908,
			"y": 81.10904206492788,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 302.39051632782827,
			"height": 410.9070254695434,
			"seed": 1370786618,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9fad32f3bbb62a0bbca2ad026cb6906ba9604cb6",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 18,
			"versionNonce": 796180224,
			"isDeleted": false,
			"id": "RiLVEWDw",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12964.90794098934,
			"y": -113.06817484757516,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 70.3125,
			"height": 24,
			"seed": 26387834,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "nearby",
			"rawText": "nearby",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "nearby",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 466,
			"versionNonce": 1048228096,
			"isDeleted": false,
			"id": "UGatZIbr",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 12867.468031260229,
			"y": 10141.443648559243,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1054.6875,
			"height": 144,
			"seed": 507439930,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "store user information like user id, user phone number, gmail, etc.\nstore driver information like licence no, car details, name of driver, age, etc.\nstore trip information like trip id, from, to, driver_id, user_id, status, amount, invoice\n\nstore driver live location for some time. I'll not store data for more than a day.\n",
			"rawText": "store user information like user id, user phone number, gmail, etc.\nstore driver information like licence no, car details, name of driver, age, etc.\nstore trip information like trip id, from, to, driver_id, user_id, status, amount, invoice\n\nstore driver live location for some time. I'll not store data for more than a day.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "store user information like user id, user phone number, gmail, etc.\nstore driver information like licence no, car details, name of driver, age, etc.\nstore trip information like trip id, from, to, driver_id, user_id, status, amount, invoice\n\nstore driver live location for some time. I'll not store data for more than a day.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 69,
			"versionNonce": 8707840,
			"isDeleted": false,
			"id": "ClzhRHmv7zMbGxZB-Y0UD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 16518.62522565852,
			"y": 595.7692260390834,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 775.6930697826629,
			"height": 617.9249877929688,
			"seed": 385440442,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996513,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "76f92a4e37096e5fe9b8fc57f374365df5a71e94",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 64,
			"versionNonce": 1576833280,
			"isDeleted": false,
			"id": "PAkyx_to4FR9WNVE_jEIl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 17592.89341944666,
			"y": 611.828464289993,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 720.2080569078104,
			"height": 617.9249877929688,
			"seed": 1359723194,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "63ba5bffe509f9268fa4d1172fb21eb974cece29",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 63,
			"versionNonce": 2056322816,
			"isDeleted": false,
			"id": "TEH2vWxuwk5M6OSiXU-ae",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 14131.1608999501,
			"y": -92.10036726733733,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 552.6382703326998,
			"height": 617.9249877929688,
			"seed": 1706145530,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "eeca2afad21f4895852ec17ce15fdb2443987bbd",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 66,
			"versionNonce": 1916956928,
			"isDeleted": false,
			"id": "Hx6iYryMKhXwhn2G7ANe_",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 14304.122511912194,
			"y": 712.6445134752673,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 720.6095813526828,
			"height": 617.9249877929688,
			"seed": 120306298,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "bb8d7a4a4796634a1a9c93ca0ca0374fb891e1b8",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 42,
			"versionNonce": 504962816,
			"isDeleted": false,
			"id": "df3NpiikJ75Oq0yYw8w6J",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 15352.977903653957,
			"y": 972.2687517519614,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 728.440343308041,
			"height": 617.9249877929688,
			"seed": 1236772922,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c7e0c3405bc1ef38b40ef939199f34610208d1c8",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 46,
			"versionNonce": 1120686336,
			"isDeleted": false,
			"id": "plke1sHUGwS6QCe7ckh-2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -1560.978715049152,
			"y": -467.5019375494125,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 633,
			"height": 491,
			"seed": 511970298,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "6fda8365b4b99a6ba01f69995e6adadedbc5dde9",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 84,
			"versionNonce": 1537031936,
			"isDeleted": false,
			"id": "EMYbnv1zUeytQMinrHEza",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -1526.1775191872337,
			"y": -511.422612493008,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 562,
			"height": 38,
			"seed": 1878243834,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "ef1076a542272126d3ce250d7f775c1317a4f872",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 53,
			"versionNonce": 656027904,
			"isDeleted": false,
			"id": "XIq9jKqSLLx__9HL0XrsY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -1447.5088046664805,
			"y": 45.174732242603966,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 638.8320259641657,
			"height": 369.933207786498,
			"seed": 1723069350,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "972dac4143327cd1bc33c8b761184ecc3d6baf98",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 185,
			"versionNonce": 329080576,
			"isDeleted": false,
			"id": "YAaSTsneQtNMCVCzeVQK-",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -1425.8589408363603,
			"y": 446.78396783918873,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 471.2830785433066,
			"height": 734.8190503104769,
			"seed": 1657761318,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "29d54a4fbc7c9206f7b3ee8fbde6d4a659ac8354",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 598,
			"versionNonce": 111939840,
			"isDeleted": false,
			"id": "hTNsy3Hl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -1399.511206817501,
			"y": 1191.415037935609,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 730.37109375,
			"height": 69.83306989221721,
			"seed": 937506810,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 8.31346070145443,
			"fontFamily": 3,
			"text": "Understanding Polling: Polling means to continuously check the status or retrieve data from multiple sources at predefined intervals. \nUnlike event-driven approaches where systems respond only to specific triggers, polling actively queries devices or services to gather information.\n\n\nShort Polling : Where we check for new message at regular interval and if there is not message we return null otherwise return message.\nLong Polling : Where we check for new message at regular interval but we wait for sometime before return anything. Let's say I send a request to check\nfor message and wait for response for 3 seconds before returning Null. And if there is message i can directly return ",
			"rawText": "Understanding Polling: Polling means to continuously check the status or retrieve data from multiple sources at predefined intervals. \nUnlike event-driven approaches where systems respond only to specific triggers, polling actively queries devices or services to gather information.\n\n\nShort Polling : Where we check for new message at regular interval and if there is not message we return null otherwise return message.\nLong Polling : Where we check for new message at regular interval but we wait for sometime before return anything. Let's say I send a request to check\nfor message and wait for response for 3 seconds before returning Null. And if there is message i can directly return ",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Understanding Polling: Polling means to continuously check the status or retrieve data from multiple sources at predefined intervals. \nUnlike event-driven approaches where systems respond only to specific triggers, polling actively queries devices or services to gather information.\n\n\nShort Polling : Where we check for new message at regular interval and if there is not message we return null otherwise return message.\nLong Polling : Where we check for new message at regular interval but we wait for sometime before return anything. Let's say I send a request to check\nfor message and wait for response for 3 seconds before returning Null. And if there is message i can directly return ",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 107,
			"versionNonce": 379158272,
			"isDeleted": false,
			"id": "xACvEqTj6LzcDUAuoxQwG",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18474.582616505373,
			"y": -377.73189413396994,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2824.000244140625,
			"height": 4256.0003662109375,
			"seed": 84489830,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 47,
			"versionNonce": 1493299456,
			"isDeleted": false,
			"id": "5b4sAUQN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18556.982518849123,
			"y": -277.1068849786965,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 222.65625,
			"height": 120,
			"seed": 1671835302,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Twitter\n\ncode karle approach\n\n",
			"rawText": "Twitter\n\ncode karle approach\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Twitter\n\ncode karle approach\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 119,
			"versionNonce": 621911808,
			"isDeleted": false,
			"id": "6eR5Ye3N",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18565.582296070803,
			"y": -150.95060217230002,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 597.65625,
			"height": 144,
			"seed": 654255802,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "FR\ntweet (text 140 character/images/short videos/gifs)\nretweet\nfollow/unfollow\nsearch\nlike",
			"rawText": "FR\ntweet (text 140 character/images/short videos/gifs)\nretweet\nfollow/unfollow\nsearch\nlike",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "FR\ntweet (text 140 character/images/short videos/gifs)\nretweet\nfollow/unfollow\nsearch\nlike",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 296,
			"versionNonce": 630968576,
			"isDeleted": false,
			"id": "OnBNEXo8",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19447.582265553225,
			"y": -186.95066320745627,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 585.9375,
			"height": 288,
			"seed": 47621222,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "NFR\n\nread heavy platform\nfast rendering\nfast tweet\nlow latency\nhigh available\nsome delay of post arriving in my timeline\nis ok. Let say modi tweeted it's ok if i see it\n5 sec later. but other delay like page load, tweet\ndelay is not ok\n",
			"rawText": "NFR\n\nread heavy platform\nfast rendering\nfast tweet\nlow latency\nhigh available\nsome delay of post arriving in my timeline\nis ok. Let say modi tweeted it's ok if i see it\n5 sec later. but other delay like page load, tweet\ndelay is not ok\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nread heavy platform\nfast rendering\nfast tweet\nlow latency\nhigh available\nsome delay of post arriving in my timeline\nis ok. Let say modi tweeted it's ok if i see it\n5 sec later. but other delay like page load, tweet\ndelay is not ok\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 68,
			"versionNonce": 1871036160,
			"isDeleted": false,
			"id": "t1l-iSXjl9owACC5yirfE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18575.58217400049,
			"y": 117.54932153375455,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 451,
			"height": 303,
			"seed": 2014341478,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "7826b94a5e86cdd1e50404173cdae4c10498bb4a",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 47,
			"versionNonce": 66695424,
			"isDeleted": false,
			"id": "XrrytC8ghTRR0UBVRo-YP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19255.582082447756,
			"y": 164.54932153375478,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 323,
			"height": 444,
			"seed": 2073044986,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "e258017b2d0fdc8ee943cc0b320a916ad71d2f35",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 330,
			"versionNonce": 376823552,
			"isDeleted": false,
			"id": "ig80S1YH",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19705.582143482912,
			"y": 295.5493367925437,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 808.59375,
			"height": 120,
			"seed": 1069811962,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "inactive is deleted accounts we don't delete account but soft delete\nthe users who didn't use twitter in last 30 days are moved to passive\nlive are who are using it right now\nactive means offline but used the app in last 30 days\nfamous is politician, actors or anyone with huge fan base",
			"rawText": "inactive is deleted accounts we don't delete account but soft delete\nthe users who didn't use twitter in last 30 days are moved to passive\nlive are who are using it right now\nactive means offline but used the app in last 30 days\nfamous is politician, actors or anyone with huge fan base",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "inactive is deleted accounts we don't delete account but soft delete\nthe users who didn't use twitter in last 30 days are moved to passive\nlive are who are using it right now\nactive means offline but used the app in last 30 days\nfamous is politician, actors or anyone with huge fan base",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 67,
			"versionNonce": 463180032,
			"isDeleted": false,
			"id": "A6aMn23bSh05-iAYjTOIe",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18566.082112965334,
			"y": 720.049382568911,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1303,
			"height": 600,
			"seed": 1630249722,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c3670fef905c01a0436178b1de5e8cc31d54c79c",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 1098,
			"versionNonce": 711065344,
			"isDeleted": false,
			"id": "kqbLdAvO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 20114.582387623537,
			"y": 1504.549428345278,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1089.84375,
			"height": 456,
			"seed": 1341363130,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "so user has two timelines first his own and then his home in home he has posts from all \nfollowing users while in his timelines all post made by him.\n\ntweet service provides all apis to interact with tweet db. all get api by tweet id, user id,\netc.\n\ntimeline service also talks with graph service to get all following users.\n\nfetching all following then getting tweets from them from cassandra is not efficient so we'll\ncache this timeline\n\nso there is a tweet processor which consumes tweet from kafka. so for this tweet made by\nelon musk let me find his followers. Now for all the followers build their timeline and put\nit into cache\n\n\nnow timeline service can direcly serve timeline for active users from redis. however if a\npassive user comes after long time it still needs to create timeline using not so efficient\nmethod. Also store it back to redis for future.",
			"rawText": "so user has two timelines first his own and then his home in home he has posts from all \nfollowing users while in his timelines all post made by him.\n\ntweet service provides all apis to interact with tweet db. all get api by tweet id, user id,\netc.\n\ntimeline service also talks with graph service to get all following users.\n\nfetching all following then getting tweets from them from cassandra is not efficient so we'll\ncache this timeline\n\nso there is a tweet processor which consumes tweet from kafka. so for this tweet made by\nelon musk let me find his followers. Now for all the followers build their timeline and put\nit into cache\n\n\nnow timeline service can direcly serve timeline for active users from redis. however if a\npassive user comes after long time it still needs to create timeline using not so efficient\nmethod. Also store it back to redis for future.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "so user has two timelines first his own and then his home in home he has posts from all \nfollowing users while in his timelines all post made by him.\n\ntweet service provides all apis to interact with tweet db. all get api by tweet id, user id,\netc.\n\ntimeline service also talks with graph service to get all following users.\n\nfetching all following then getting tweets from them from cassandra is not efficient so we'll\ncache this timeline\n\nso there is a tweet processor which consumes tweet from kafka. so for this tweet made by\nelon musk let me find his followers. Now for all the followers build their timeline and put\nit into cache\n\n\nnow timeline service can direcly serve timeline for active users from redis. however if a\npassive user comes after long time it still needs to create timeline using not so efficient\nmethod. Also store it back to redis for future.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 564,
			"versionNonce": 604074240,
			"isDeleted": false,
			"id": "NDiP8EJX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 20126.08217400049,
			"y": 2026.0494436040672,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1113.28125,
			"height": 120,
			"seed": 187782886,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "for live user we'll handle it differently as soon as a new tweet is pulled from kafka by tweet \nprocessor to create a time line it store in redis and also put the timeline back in kafka. so \nuser don't have to pull the timeline from their end. the live web socket connection reads that \ntheir is a message for this live user and give them their new timeline.\n",
			"rawText": "for live user we'll handle it differently as soon as a new tweet is pulled from kafka by tweet \nprocessor to create a time line it store in redis and also put the timeline back in kafka. so \nuser don't have to pull the timeline from their end. the live web socket connection reads that \ntheir is a message for this live user and give them their new timeline.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "for live user we'll handle it differently as soon as a new tweet is pulled from kafka by tweet \nprocessor to create a time line it store in redis and also put the timeline back in kafka. so \nuser don't have to pull the timeline from their end. the live web socket connection reads that \ntheir is a message for this live user and give them their new timeline.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 51,
			"versionNonce": 734666496,
			"isDeleted": false,
			"id": "uv-RcsE00ISxmWh0aw-fE",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18808.082296070803,
			"y": 1537.0493062749658,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1275,
			"height": 596,
			"seed": 809122726,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "563b2ddb3b60aca3352945b7b44a0994021b1060",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 197,
			"versionNonce": 1688948992,
			"isDeleted": false,
			"id": "hYby7TSA",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 20134.08220451807,
			"y": 2221.5493215337547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1089.84375,
			"height": 48,
			"seed": 928636666,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "the current reddis approach is still inefficient for famous users. let say a famous celebrity\ntweets and has 240 million subscribers we need to make 240M timelines",
			"rawText": "the current reddis approach is still inefficient for famous users. let say a famous celebrity\ntweets and has 240 million subscribers we need to make 240M timelines",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "the current reddis approach is still inefficient for famous users. let say a famous celebrity\ntweets and has 240 million subscribers we need to make 240M timelines",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 141,
			"versionNonce": 187580160,
			"isDeleted": false,
			"id": "6ZoHHB3q",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19644.08220451807,
			"y": 1813.2584124428458,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 156.234375,
			"height": 29.090909090909108,
			"seed": 913091770,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 12.121212121212128,
			"fontFamily": 3,
			"text": "also use user service \nto get status",
			"rawText": "also use user service \nto get status",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "also use user service \nto get status",
			"lineHeight": 1.2
		},
		{
			"type": "freedraw",
			"version": 38,
			"versionNonce": 890843392,
			"isDeleted": false,
			"id": "wFEc1P183uUkz4Z9PmcmW",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19718.082296070803,
			"y": 1879.5493520513328,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 42.0001220703125,
			"height": 30,
			"seed": 1943018426,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-6.00006103515625,
					0
				],
				[
					-18.000030517578125,
					0
				],
				[
					-26.00006103515625,
					0
				],
				[
					-30,
					0
				],
				[
					-36.00006103515625,
					0
				],
				[
					-38.000030517578125,
					0
				],
				[
					-40,
					-1.999969482421875
				],
				[
					-42.0001220703125,
					-1.999969482421875
				],
				[
					-42.0001220703125,
					-4.0000152587890625
				],
				[
					-42.0001220703125,
					-7.9999542236328125
				],
				[
					-42.0001220703125,
					-10
				],
				[
					-42.0001220703125,
					-11.999969482421875
				],
				[
					-42.0001220703125,
					-14.000015258789062
				],
				[
					-40,
					-14.000015258789062
				],
				[
					-38.000030517578125,
					-14.000015258789062
				],
				[
					-38.000030517578125,
					-15.999984741210938
				],
				[
					-38.000030517578125,
					-17.999954223632812
				],
				[
					-38.000030517578125,
					-20
				],
				[
					-36.00006103515625,
					-20
				],
				[
					-34.000091552734375,
					-20
				],
				[
					-34.000091552734375,
					-21.999969482421875
				],
				[
					-32.0001220703125,
					-21.999969482421875
				],
				[
					-32.0001220703125,
					-24.000015258789062
				],
				[
					-30,
					-25.999984741210938
				],
				[
					-28.000030517578125,
					-27.999954223632812
				],
				[
					-28.000030517578125,
					-30
				],
				[
					-26.00006103515625,
					-30
				],
				[
					-26.00006103515625,
					-30
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "text",
			"version": 845,
			"versionNonce": 688807680,
			"isDeleted": false,
			"id": "PuOHqWMS",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18815.08220451807,
			"y": 2506.5493215337547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2325,
			"height": 153.6,
			"seed": 1516403258,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "let say when building a timeline instead of only storing tweets with active user. we'll also store in redis who all famous celebrity this user follows. So when this user refreshes his timeline. we can query only those famous users for their tweets.\n\n\nalso we won't be updating in redis for 240M user in case the post is coming from famous user. \n\ntime line servie will merge the data from normal active user. Also it will get the list for all famous user this person is following get their tweet and merge both and render.\n\nto get tweet of all famous user first timeline service query graph service to find all famous users this user if following then call tweet service for their tweet. ",
			"rawText": "let say when building a timeline instead of only storing tweets with active user. we'll also store in redis who all famous celebrity this user follows. So when this user refreshes his timeline. we can query only those famous users for their tweets.\n\n\nalso we won't be updating in redis for 240M user in case the post is coming from famous user. \n\ntime line servie will merge the data from normal active user. Also it will get the list for all famous user this person is following get their tweet and merge both and render.\n\nto get tweet of all famous user first timeline service query graph service to find all famous users this user if following then call tweet service for their tweet. ",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "let say when building a timeline instead of only storing tweets with active user. we'll also store in redis who all famous celebrity this user follows. So when this user refreshes his timeline. we can query only those famous users for their tweets.\n\n\nalso we won't be updating in redis for 240M user in case the post is coming from famous user. \n\ntime line servie will merge the data from normal active user. Also it will get the list for all famous user this person is following get their tweet and merge both and render.\n\nto get tweet of all famous user first timeline service query graph service to find all famous users this user if following then call tweet service for their tweet. ",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 358,
			"versionNonce": 2093682944,
			"isDeleted": false,
			"id": "TZtcP6Gg",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18840.08218925928,
			"y": 2794.549352051333,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2371.875,
			"height": 38.4,
			"seed": 271893862,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "now let say elon musk is following donald trump both are famous, the above thing we can use from them also. otherwise since tweet processor is building tweet for normal active user following normal active user. we can add one logic like if post is from \nfamous user only update feed for famous user following.",
			"rawText": "now let say elon musk is following donald trump both are famous, the above thing we can use from them also. otherwise since tweet processor is building tweet for normal active user following normal active user. we can add one logic like if post is from \nfamous user only update feed for famous user following.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "now let say elon musk is following donald trump both are famous, the above thing we can use from them also. otherwise since tweet processor is building tweet for normal active user following normal active user. we can add one logic like if post is from \nfamous user only update feed for famous user following.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 73,
			"versionNonce": 1441431296,
			"isDeleted": false,
			"id": "OGUrlkeD",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 18814.08220451807,
			"y": 2912.549382568911,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 525,
			"height": 19.2,
			"seed": 680010938,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "cassandra, reddis and kafka are under huge pressure here",
			"rawText": "cassandra, reddis and kafka are under huge pressure here",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "cassandra, reddis and kafka are under huge pressure here",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 101,
			"versionNonce": 859894016,
			"isDeleted": false,
			"id": "yc5cTbC5",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 20250.082265553225,
			"y": 3146.5493215337547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 825,
			"height": 19.2,
			"seed": 472575546,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "one thing u can do with spark streaming is what is the most searched word in last 1 hour",
			"rawText": "one thing u can do with spark streaming is what is the most searched word in last 1 hour",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "one thing u can do with spark streaming is what is the most searched word in last 1 hour",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 71,
			"versionNonce": 1380097792,
			"isDeleted": false,
			"id": "EKP0uRVdXljg3_oxNjBAS",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 19194.294792590972,
			"y": 2987.086797119692,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1006.5746407487273,
			"height": 617.9249877929688,
			"seed": 166141114,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "4b3d6df109cbef0729335bc7b0f05c6efff0649b",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 282,
			"versionNonce": 1610273024,
			"isDeleted": false,
			"id": "UL97gfcl",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 20314.08220451807,
			"y": 3326.5493215337547,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 853.125,
			"height": 57.599999999999994,
			"seed": 769881062,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "why are we using a notification service here? twitter can run a weekly cron job which sees \nall post in last week and create a newsletter and send to passive user like this week you \nmissed these stuff to bring them back on platform.",
			"rawText": "why are we using a notification service here? twitter can run a weekly cron job which sees \nall post in last week and create a newsletter and send to passive user like this week you \nmissed these stuff to bring them back on platform.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "why are we using a notification service here? twitter can run a weekly cron job which sees \nall post in last week and create a newsletter and send to passive user like this week you \nmissed these stuff to bring them back on platform.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 90,
			"versionNonce": 1318502144,
			"isDeleted": false,
			"id": "zyZT6utNPonHKbYsOAwA4",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 11657.526276770299,
			"y": 305.08017314000824,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 987,
			"height": 345,
			"seed": 437317050,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "408f32e9287da6ef7b445bb5738c78e26d1d653d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 444117248,
			"isDeleted": false,
			"id": "pci0oUNJ",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 11993.461903487863,
			"y": 243.53141697571678,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 93.75,
			"height": 19.2,
			"seed": 199198118,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "simplified",
			"rawText": "simplified",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "simplified",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 1801903872,
			"isDeleted": false,
			"id": "6UmRdEQs",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 10409.61174297675,
			"y": 10963.817474197127,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2203.125,
			"height": 134.4,
			"seed": 1873380474,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "clients put message in kafka through notification service. Then notification validator performs simple checks like content should not be null, etc. and priortize the notification and puts the message in kafka, in kafka there will be \ntopic for high, medium, low priority message. The consumers will give more priority to high then medium then low. Then we have rate limiter it does 2 kinds of rate limiting first it checks the clients who have made the request is he \n\\allowed to make this request and 2nd am i allowed to send this user the notification these many times. So we'll use redis counter to for client or user. and once we send this we increment the counter. There are also rules for rate \nlimiting but not going deep in that. can have different rules like client can call 4 times in a sec. Or can send 10 notification to this user. Then notification handler and user prefernces service it checks the user prefernces db to \ncheck what is the preferred mode of user to be notified. Or the user has opt for subscription. it also talks to user service to get email, phone no., etc. for communication. Then we can add the message along with communication details \ninto kafka there will be topic for sms consumers, email consumers, etc. Then email, sms, handlers can consume these messages and talk to vendor to send notification. We are tracking the notification we have send using notification \ntracking service and saving it into cassandra",
			"rawText": "clients put message in kafka through notification service. Then notification validator performs simple checks like content should not be null, etc. and priortize the notification and puts the message in kafka, in kafka there will be \ntopic for high, medium, low priority message. The consumers will give more priority to high then medium then low. Then we have rate limiter it does 2 kinds of rate limiting first it checks the clients who have made the request is he \n\\allowed to make this request and 2nd am i allowed to send this user the notification these many times. So we'll use redis counter to for client or user. and once we send this we increment the counter. There are also rules for rate \nlimiting but not going deep in that. can have different rules like client can call 4 times in a sec. Or can send 10 notification to this user. Then notification handler and user prefernces service it checks the user prefernces db to \ncheck what is the preferred mode of user to be notified. Or the user has opt for subscription. it also talks to user service to get email, phone no., etc. for communication. Then we can add the message along with communication details \ninto kafka there will be topic for sms consumers, email consumers, etc. Then email, sms, handlers can consume these messages and talk to vendor to send notification. We are tracking the notification we have send using notification \ntracking service and saving it into cassandra",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "clients put message in kafka through notification service. Then notification validator performs simple checks like content should not be null, etc. and priortize the notification and puts the message in kafka, in kafka there will be \ntopic for high, medium, low priority message. The consumers will give more priority to high then medium then low. Then we have rate limiter it does 2 kinds of rate limiting first it checks the clients who have made the request is he \n\\allowed to make this request and 2nd am i allowed to send this user the notification these many times. So we'll use redis counter to for client or user. and once we send this we increment the counter. There are also rules for rate \nlimiting but not going deep in that. can have different rules like client can call 4 times in a sec. Or can send 10 notification to this user. Then notification handler and user prefernces service it checks the user prefernces db to \ncheck what is the preferred mode of user to be notified. Or the user has opt for subscription. it also talks to user service to get email, phone no., etc. for communication. Then we can add the message along with communication details \ninto kafka there will be topic for sms consumers, email consumers, etc. Then email, sms, handlers can consume these messages and talk to vendor to send notification. We are tracking the notification we have send using notification \ntracking service and saving it into cassandra",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 117,
			"versionNonce": 171610368,
			"isDeleted": false,
			"id": "oujLSX0xdBbHUNF2X4S6M",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21332.932905376558,
			"y": -384.4701293736289,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2712.0001220703125,
			"height": 4176.000061035156,
			"seed": 1692136934,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 35,
			"versionNonce": 959643392,
			"isDeleted": false,
			"id": "etzdfeCq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21375.40115509107,
			"y": -350.09015972684136,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 262.5,
			"height": 57.599999999999994,
			"seed": 331339834,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "Facebook or News Feed system\n\n",
			"rawText": "Facebook or News Feed system\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Facebook or News Feed system\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 186,
			"versionNonce": 1723887872,
			"isDeleted": false,
			"id": "8mOQF302Zyi-OHZ987U-X",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21843.67253559063,
			"y": -311.98069376006737,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 845,
			"height": 584,
			"seed": 1158761382,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "3851bec2a79b14494e2963f692f3292263900a91",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 73,
			"versionNonce": 947592960,
			"isDeleted": false,
			"id": "sAwfdGLn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22179.71542359568,
			"y": -182.41551312305558,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 37.5,
			"height": 19.2,
			"seed": 479876454,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "time",
			"rawText": "time",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "time",
			"lineHeight": 1.2
		},
		{
			"type": "freedraw",
			"version": 193,
			"versionNonce": 2005553408,
			"isDeleted": false,
			"id": "TGup5u4Hzxt77v7U_M0zW",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21884.974760272456,
			"y": -106.43790569689168,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 121.82603956583989,
			"height": 428.35629544175924,
			"seed": 125206054,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					-2.6198761421983363,
					0
				],
				[
					-3.9298142132938665,
					0
				],
				[
					-6.549790297362051,
					0
				],
				[
					-11.789542581758724,
					2.6198761421978816
				],
				[
					-14.40951866582327,
					2.6198761421978816
				],
				[
					-23.579185105387296,
					6.5497902973634154
				],
				[
					-31.438913473848515,
					10.479654481594707
				],
				[
					-32.74895148681753,
					11.789592552693648
				],
				[
					-35.36882762901587,
					14.409518665825885
				],
				[
					-37.98870377121057,
					14.409518665825885
				],
				[
					-40.60867985527875,
					15.71945673692494
				],
				[
					-43.22855599747709,
					18.339382850057177
				],
				[
					-45.848532081541634,
					19.649370892090474
				],
				[
					-47.1584701526408,
					19.649370892090474
				],
				[
					-49.77834629483914,
					20.959308963189414
				],
				[
					-52.398322378907324,
					22.26924703428847
				],
				[
					-55.01819852110566,
					24.889173147420706
				],
				[
					-60.25805074736854,
					28.819037331651884
				],
				[
					-64.18786496066605,
					30.12902537368518
				],
				[
					-66.80784104473423,
					34.05888955791636
				],
				[
					-68.11777911582976,
					35.36882762901541
				],
				[
					-72.04769327099712,
					39.29874178418095
				],
				[
					-73.35763134209628,
					41.91861792637894
				],
				[
					-75.97750748429462,
					44.53854403951118
				],
				[
					-81.2173597105575,
					49.778396265775655
				],
				[
					-85.14727386572486,
					55.01819852110589
				],
				[
					-90.38702615012153,
					58.94811267627142
				],
				[
					-94.31694030528524,
					65.49790297363484
				],
				[
					-98.2468544604526,
					72.04769327099837
				],
				[
					-102.17666867374646,
					75.97755745522966
				],
				[
					-106.10658282891382,
					79.90742163946084
				],
				[
					-107.41652090001298,
					89.0771380499566
				],
				[
					-110.03639704221132,
					95.62692834732013
				],
				[
					-110.03639704221132,
					99.55679253155131
				],
				[
					-112.65637312627587,
					106.10658282891484
				],
				[
					-112.65637312627587,
					111.34643505517931
				],
				[
					-115.2762492684742,
					121.82608953677413
				],
				[
					-115.2762492684742,
					130.9958059472698
				],
				[
					-115.2762492684742,
					138.85553431573226
				],
				[
					-117.89622535254239,
					148.02525072622802
				],
				[
					-117.89622535254239,
					153.26505298155826
				],
				[
					-117.89622535254239,
					158.50490520782284
				],
				[
					-117.89622535254239,
					166.3646335762853
				],
				[
					-119.20616342364156,
					172.91447384458309
				],
				[
					-119.20616342364156,
					183.39407835524355
				],
				[
					-119.20616342364156,
					189.94386865260697
				],
				[
					-119.20616342364156,
					196.4936589499705
				],
				[
					-119.20616342364156,
					203.04344924733402
				],
				[
					-119.20616342364156,
					209.59323954469744
				],
				[
					-119.20616342364156,
					217.4530678550285
				],
				[
					-119.20616342364156,
					224.00285815239204
				],
				[
					-119.20616342364156,
					233.17252459195345
				],
				[
					-119.20616342364156,
					238.41237681821792
				],
				[
					-120.51610149474072,
					243.6522290444825
				],
				[
					-120.51610149474072,
					250.20201934184593
				],
				[
					-121.82603956583989,
					259.37168578140745
				],
				[
					-121.82603956583989,
					264.6115380076719
				],
				[
					-121.82603956583989,
					269.8513902339364
				],
				[
					-121.82603956583989,
					272.4712663761344
				],
				[
					-121.82603956583989,
					276.40118053129993
				],
				[
					-121.82603956583989,
					280.33099474459686
				],
				[
					-121.82603956583989,
					285.57084697086145
				],
				[
					-121.82603956583989,
					290.8106991971259
				],
				[
					-121.82603956583989,
					297.36048949448946
				],
				[
					-121.82603956583989,
					301.2903037077864
				],
				[
					-121.82603956583989,
					303.9102797918529
				],
				[
					-121.82603956583989,
					306.53015593405087
				],
				[
					-121.82603956583989,
					310.4600700892164
				],
				[
					-121.82603956583989,
					314.38988430251334
				],
				[
					-121.82603956583989,
					317.00986038657993
				],
				[
					-121.82603956583989,
					320.93967459987687
				],
				[
					-121.82603956583989,
					324.8695887550424
				],
				[
					-121.82603956583989,
					327.4894648972404
				],
				[
					-121.82603956583989,
					328.79950291020793
				],
				[
					-121.82603956583989,
					331.41937905240593
				],
				[
					-121.82603956583989,
					336.6592312786704
				],
				[
					-121.82603956583989,
					339.2791074208684
				],
				[
					-119.20616342364156,
					344.5189596471329
				],
				[
					-119.20616342364156,
					348.4488738022984
				],
				[
					-117.89622535254239,
					351.0687499444964
				],
				[
					-117.89622535254239,
					358.9284783129589
				],
				[
					-116.58618733957337,
					361.54845439702535
				],
				[
					-113.96631119737503,
					365.4782686103223
				],
				[
					-112.65637312627587,
					370.7181208365869
				],
				[
					-112.65637312627587,
					374.6480349917523
				],
				[
					-108.72645897111215,
					378.57784920504935
				],
				[
					-107.41652090001298,
					381.1978252891158
				],
				[
					-107.41652090001298,
					385.12763950241276
				],
				[
					-106.10658282891382,
					391.6774297997763
				],
				[
					-102.17666867374646,
					394.2974058838429
				],
				[
					-100.8667306026473,
					396.91728202604077
				],
				[
					-98.2468544604526,
					399.53715816823876
				],
				[
					-96.93681644748358,
					402.15713425230535
				],
				[
					-94.31694030528524,
					404.77701039450324
				],
				[
					-91.6970641630869,
					406.0869484656023
				],
				[
					-89.07708807902236,
					407.39698647856983
				],
				[
					-86.45721193682402,
					410.0168626207678
				],
				[
					-82.52729778165667,
					411.32680069186677
				],
				[
					-79.90742163945833,
					413.94677677593336
				],
				[
					-75.97750748429462,
					415.2567148470323
				],
				[
					-72.04769327099712,
					416.56665291813124
				],
				[
					-69.42771718692893,
					417.8765909892303
				],
				[
					-68.11777911582976,
					417.8765909892303
				],
				[
					-65.49790297363506,
					419.18652906032924
				],
				[
					-62.87792688956688,
					420.4965670732968
				],
				[
					-58.948112676269375,
					421.8065051443958
				],
				[
					-56.32813659220483,
					423.11644321549477
				],
				[
					-55.01819852110566,
					424.4263812865938
				],
				[
					-52.398322378907324,
					424.4263812865938
				],
				[
					-51.08828436593831,
					424.4263812865938
				],
				[
					-47.1584701526408,
					424.4263812865938
				],
				[
					-44.538494068576256,
					427.0463573706603
				],
				[
					-43.22855599747709,
					427.0463573706603
				],
				[
					-41.91861792637792,
					427.0463573706603
				],
				[
					-40.60867985527875,
					428.35629544175924
				],
				[
					-40.60867985527875,
					428.35629544175924
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 84,
			"versionNonce": 1505705728,
			"isDeleted": false,
			"id": "PQrL_cdwf_gigA1TC146F",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21843.056142346075,
			"y": 315.3685494765699,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 17.029494749895093,
			"height": 11.789642523628004,
			"seed": 1866585510,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.3099380710991682,
					1.3099380710989408
				],
				[
					2.6199760840681847,
					1.3099380710989408
				],
				[
					3.929914155167353,
					2.6199760840664794
				],
				[
					6.549790297365689,
					2.6199760840664794
				],
				[
					7.859728368464857,
					3.929914155165534
				],
				[
					9.169766381430236,
					5.239852226264475
				],
				[
					11.789642523628572,
					6.549790297363529
				],
				[
					13.09958059472774,
					7.85972836846247
				],
				[
					14.409518665826909,
					7.85972836846247
				],
				[
					15.719556678795925,
					9.169766381430009
				],
				[
					17.029494749895093,
					9.169766381430009
				],
				[
					17.029494749895093,
					10.47970445252895
				],
				[
					15.719556678795925,
					10.47970445252895
				],
				[
					14.409518665826909,
					10.47970445252895
				],
				[
					11.789642523628572,
					10.47970445252895
				],
				[
					9.169766381430236,
					10.47970445252895
				],
				[
					6.549790297365689,
					11.789642523628004
				],
				[
					3.929914155167353,
					11.789642523628004
				],
				[
					2.6199760840681847,
					11.789642523628004
				],
				[
					2.6199760840681847,
					11.789642523628004
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "text",
			"version": 259,
			"versionNonce": 337129728,
			"isDeleted": false,
			"id": "wlWxcC0S",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21877.11503190399,
			"y": 314.05861140547086,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 806.25,
			"height": 57.599999999999994,
			"seed": 269538598,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "lag means if a user posts something it is ok if it takes 5-10 seconds to arrive on\nmy timeline, but latency wise it should be fast, fast page loads, fast success message\non posts, etc.",
			"rawText": "lag means if a user posts something it is ok if it takes 5-10 seconds to arrive on\nmy timeline, but latency wise it should be fast, fast page loads, fast success message\non posts, etc.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "lag means if a user posts something it is ok if it takes 5-10 seconds to arrive on\nmy timeline, but latency wise it should be fast, fast page loads, fast success message\non posts, etc.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 62,
			"versionNonce": 2105499392,
			"isDeleted": false,
			"id": "epmTac9dMcnOeyEQduQb7",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21398.608045545545,
			"y": -218.1006698441338,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 304,
			"height": 391,
			"seed": 238530726,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9730d6e75c6b7791934ae691d0dd422c256d5954",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 43,
			"versionNonce": 602542336,
			"isDeleted": false,
			"id": "cUhb3H0IbnSAOa-F-y3YT",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21405.13974564166,
			"y": 420.16514426345157,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 826.0543471721215,
			"height": 602.5807073574414,
			"seed": 1237706086,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "db9311c325b7a5e103a5b0f0b34d7609400609a5",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 63,
			"versionNonce": 1950056192,
			"isDeleted": false,
			"id": "Nt3ck4O6",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22296.301610935257,
			"y": 515.7921225817058,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 487.5,
			"height": 19.2,
			"seed": 1765968378,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "for graph db instead of my sql we'll use a graph db.",
			"rawText": "for graph db instead of my sql we'll use a graph db.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "for graph db instead of my sql we'll use a graph db.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 446,
			"versionNonce": 511701248,
			"isDeleted": false,
			"id": "07B6UXLz",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22811.115168284774,
			"y": 1062.044618390541,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 862.5,
			"height": 76.8,
			"seed": 1849051814,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "asset service add or removes static content from cdn based on how frequently it is accessed.\nWhen a new post is made it is accessed frequently so we can put it into cdn when after some\ntime we see frequency of that post accessed is decreased so asset service can remove that \ncontent to make room for new posts.",
			"rawText": "asset service add or removes static content from cdn based on how frequently it is accessed.\nWhen a new post is made it is accessed frequently so we can put it into cdn when after some\ntime we see frequency of that post accessed is decreased so asset service can remove that \ncontent to make room for new posts.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "asset service add or removes static content from cdn based on how frequently it is accessed.\nWhen a new post is made it is accessed frequently so we can put it into cdn when after some\ntime we see frequency of that post accessed is decreased so asset service can remove that \ncontent to make room for new posts.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 168,
			"versionNonce": 2121506560,
			"isDeleted": false,
			"id": "AVN2jA4E",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22834.694453332027,
			"y": 1203.8475883226472,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 656.25,
			"height": 38.4,
			"seed": 1519988346,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996514,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "post indigestion service puts a new post into cassandra and into kafka\n",
			"rawText": "post indigestion service puts a new post into cassandra and into kafka\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "post indigestion service puts a new post into cassandra and into kafka\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 892,
			"versionNonce": 190435584,
			"isDeleted": false,
			"id": "Wr6nolRw",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22830.109520170365,
			"y": 1276.8777601324368,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 834.375,
			"height": 192,
			"seed": 1463203898,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "analytics service is one of the consumer of kafka, there is spark streaming \ncluster, where machine learning models find tags for the post, people in the\npost, etc. Now after find this info, we are again putting it in kafka. This\nprocess will take some time however in our NFR we said some lag is okay to \nrender new post to friends timeline. Now this post along with tags is \nconsumed by post processor service which talks to user and friends/group\nservice to get friends of the user who has made post. it creates a timeline\nfor friends of this user and put this timeline with user_id like u3: [post1, post2, ....]\n\n",
			"rawText": "analytics service is one of the consumer of kafka, there is spark streaming \ncluster, where machine learning models find tags for the post, people in the\npost, etc. Now after find this info, we are again putting it in kafka. This\nprocess will take some time however in our NFR we said some lag is okay to \nrender new post to friends timeline. Now this post along with tags is \nconsumed by post processor service which talks to user and friends/group\nservice to get friends of the user who has made post. it creates a timeline\nfor friends of this user and put this timeline with user_id like u3: [post1, post2, ....]\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "analytics service is one of the consumer of kafka, there is spark streaming \ncluster, where machine learning models find tags for the post, people in the\npost, etc. Now after find this info, we are again putting it in kafka. This\nprocess will take some time however in our NFR we said some lag is okay to \nrender new post to friends timeline. Now this post along with tags is \nconsumed by post processor service which talks to user and friends/group\nservice to get friends of the user who has made post. it creates a timeline\nfor friends of this user and put this timeline with user_id like u3: [post1, post2, ....]\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 997,
			"versionNonce": 1286061824,
			"isDeleted": false,
			"id": "lkhJGUSO",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22836.004291461235,
			"y": 1502.190556355928,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 918.75,
			"height": 172.79999999999998,
			"seed": 445794618,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "the post processor creates time line with posts from normal active user and put that in redis.\nif someone famous makes a post creating timeline for all their friends/follower is inefficient.\nSo time line service can get all posts for a user time from redis (contain normal active users\nposts). Also it can ask group service to get friends of this user and figure who are famous. Then \nit asks post service for posts from these famous users. Timeline service then aggregate the posts\nand returns to user.\n\nFor live user, post processor after creating the timeline can push it back into one of the kafka\ntopic, where using a live user service sends the timeline to live user via web socket.",
			"rawText": "the post processor creates time line with posts from normal active user and put that in redis.\nif someone famous makes a post creating timeline for all their friends/follower is inefficient.\nSo time line service can get all posts for a user time from redis (contain normal active users\nposts). Also it can ask group service to get friends of this user and figure who are famous. Then \nit asks post service for posts from these famous users. Timeline service then aggregate the posts\nand returns to user.\n\nFor live user, post processor after creating the timeline can push it back into one of the kafka\ntopic, where using a live user service sends the timeline to live user via web socket.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "the post processor creates time line with posts from normal active user and put that in redis.\nif someone famous makes a post creating timeline for all their friends/follower is inefficient.\nSo time line service can get all posts for a user time from redis (contain normal active users\nposts). Also it can ask group service to get friends of this user and figure who are famous. Then \nit asks post service for posts from these famous users. Timeline service then aggregate the posts\nand returns to user.\n\nFor live user, post processor after creating the timeline can push it back into one of the kafka\ntopic, where using a live user service sends the timeline to live user via web socket.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 265,
			"versionNonce": 33009920,
			"isDeleted": false,
			"id": "kvYNncYL",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22849.103872055963,
			"y": 1717.0236481268903,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 900,
			"height": 38.4,
			"seed": 1817977402,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "we have archival service which puts old timeline from redis to cassandra. this make sure we are \nremoving old timeline from redis to free memory",
			"rawText": "we have archival service which puts old timeline from redis to cassandra. this make sure we are \nremoving old timeline from redis to free memory",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "we have archival service which puts old timeline from redis to cassandra. this make sure we are \nremoving old timeline from redis to free memory",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 417,
			"versionNonce": 2136465152,
			"isDeleted": false,
			"id": "5pAHZoTY",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22822.904710866507,
			"y": 1834.9198734794331,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 928.125,
			"height": 57.599999999999994,
			"seed": 1648938170,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "like service store all likes/dislikes done on a post in cassandra. schema looks something like this\npostid, userid, type like/dislike/heart . We are also storing this info in redis, redis stores the \nnumber of likes on a post. Also we put this info in kafka for tracking",
			"rawText": "like service store all likes/dislikes done on a post in cassandra. schema looks something like this\npostid, userid, type like/dislike/heart . We are also storing this info in redis, redis stores the \nnumber of likes on a post. Also we put this info in kafka for tracking",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "like service store all likes/dislikes done on a post in cassandra. schema looks something like this\npostid, userid, type like/dislike/heart . We are also storing this info in redis, redis stores the \nnumber of likes on a post. Also we put this info in kafka for tracking",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 195,
			"versionNonce": 702124288,
			"isDeleted": false,
			"id": "XVbBtdby",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22820.28483472431,
			"y": 1955.4360249451083,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 768.75,
			"height": 19.2,
			"seed": 376929382,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "sharing a post is nothing but another new post but with parent id of original post",
			"rawText": "sharing a post is nothing but another new post but with parent id of original post",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "sharing a post is nothing but another new post but with parent id of original post",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 71,
			"versionNonce": 654573312,
			"isDeleted": false,
			"id": "hQhhfoTMTCqmNRiFZMHCh",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21558.36190903387,
			"y": 1148.1743458095902,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1226.987172619168,
			"height": 602.5807073574414,
			"seed": 881887162,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "1173ec89fb3aa9e68239fc5df57953dbe8bb3361",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 273,
			"versionNonce": 981430528,
			"isDeleted": false,
			"id": "DOgYyA9b",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22816.682530014223,
			"y": 2016.3490697134953,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 984.375,
			"height": 57.599999999999994,
			"seed": 1575862566,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "activity tracker will save all activities in cassandra. like userid, timestamp, activity (new post \nwith postid/ liked post along with postid/ commented with post id and comment/ search with search string)\nall of these will be stored.",
			"rawText": "activity tracker will save all activities in cassandra. like userid, timestamp, activity (new post \nwith postid/ liked post along with postid/ commented with post id and comment/ search with search string)\nall of these will be stored.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "activity tracker will save all activities in cassandra. like userid, timestamp, activity (new post \nwith postid/ liked post along with postid/ commented with post id and comment/ search with search string)\nall of these will be stored.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 109,
			"versionNonce": 1143742208,
			"isDeleted": false,
			"id": "uqtyeS92",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22824.542258382684,
			"y": 2122.4557025133445,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 806.25,
			"height": 19.2,
			"seed": 1900799654,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "search service is similar to twitter puts everything in elastic db where we can search",
			"rawText": "search service is similar to twitter puts everything in elastic db where we can search",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "search service is similar to twitter puts everything in elastic db where we can search",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 624,
			"versionNonce": 2070499584,
			"isDeleted": false,
			"id": "3OxzPo1r",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 22816.372591943124,
			"y": 2220.702556973797,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1031.25,
			"height": 153.6,
			"seed": 120760102,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 16,
			"fontFamily": 3,
			"text": "trends is similar to twitter what words/topics are trending now we'll store in redis with ttl like 1 day \nbecause next day it might change\n\nUser profiling is nothing but seeing what user likes or posts user interacts with show more of these pages or \nuser as recommendation or give these post more priority\n\nGroup weight is nothing but like say i'm friend with u1, u3, u4 however i'm liking more posts of u1 as well \ncommenting on his. Thus u1 weight will be more and i'll see more of his posts as a result",
			"rawText": "trends is similar to twitter what words/topics are trending now we'll store in redis with ttl like 1 day \nbecause next day it might change\n\nUser profiling is nothing but seeing what user likes or posts user interacts with show more of these pages or \nuser as recommendation or give these post more priority\n\nGroup weight is nothing but like say i'm friend with u1, u3, u4 however i'm liking more posts of u1 as well \ncommenting on his. Thus u1 weight will be more and i'll see more of his posts as a result",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "trends is similar to twitter what words/topics are trending now we'll store in redis with ttl like 1 day \nbecause next day it might change\n\nUser profiling is nothing but seeing what user likes or posts user interacts with show more of these pages or \nuser as recommendation or give these post more priority\n\nGroup weight is nothing but like say i'm friend with u1, u3, u4 however i'm liking more posts of u1 as well \ncommenting on his. Thus u1 weight will be more and i'll see more of his posts as a result",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 66,
			"versionNonce": 1196441344,
			"isDeleted": false,
			"id": "aEXmpK_ksT9S_5hCt5c2t",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 21528.501515031232,
			"y": 1852.473223974553,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1233.0000000000002,
			"height": 538,
			"seed": 1903411174,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "873dd5f38896490492477fdee6d5871249189540",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 907,
			"versionNonce": 1142370560,
			"isDeleted": false,
			"id": "g7CnSBlq",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 8.968797400062613,
			"y": -1867.555979382691,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1307.8125,
			"height": 820.8,
			"seed": 60814394,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 36,
			"fontFamily": 3,
			"text": "always ask if it is a high level question or low level \nlet say design youtube don't straing away jump in design\nclarify which components interview is more interested in \nwhat are out of scope\n\nalso check for scale of the application you are building \nlet say design a chat application, the design is different\nfor 50 people using it or millions of people using it\n\ntime your solution, don't go deep in one component that you\nleave others hanging. first propose a high level view. and \nask interviewer where can i go deep\n\nyou are not expected to know everything, don't make up things\nif you don't know\n\nask interview is it going in right direction, what additional \nthings we can do here? Are you with me. Any questions for this\ndesign or for me",
			"rawText": "always ask if it is a high level question or low level \nlet say design youtube don't straing away jump in design\nclarify which components interview is more interested in \nwhat are out of scope\n\nalso check for scale of the application you are building \nlet say design a chat application, the design is different\nfor 50 people using it or millions of people using it\n\ntime your solution, don't go deep in one component that you\nleave others hanging. first propose a high level view. and \nask interviewer where can i go deep\n\nyou are not expected to know everything, don't make up things\nif you don't know\n\nask interview is it going in right direction, what additional \nthings we can do here? Are you with me. Any questions for this\ndesign or for me",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "always ask if it is a high level question or low level \nlet say design youtube don't straing away jump in design\nclarify which components interview is more interested in \nwhat are out of scope\n\nalso check for scale of the application you are building \nlet say design a chat application, the design is different\nfor 50 people using it or millions of people using it\n\ntime your solution, don't go deep in one component that you\nleave others hanging. first propose a high level view. and \nask interviewer where can i go deep\n\nyou are not expected to know everything, don't make up things\nif you don't know\n\nask interview is it going in right direction, what additional \nthings we can do here? Are you with me. Any questions for this\ndesign or for me",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 161,
			"versionNonce": 284188416,
			"isDeleted": false,
			"id": "BSZzpjd9u1v2__UhkVcDC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24070.93123479085,
			"y": -378.19389824390385,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2432.000732421876,
			"height": 3936.0000610351562,
			"seed": 440368896,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 340,
			"versionNonce": 2080968960,
			"isDeleted": false,
			"id": "lDmmRV5s",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24177.53447270152,
			"y": -314.6286733236493,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 503.90625,
			"height": 288,
			"seed": 356462848,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "Youtube or steaming platform\n\nFR\n\n1. people should be able to \nupload videos\n2. homepage for user with recommendation/\nmost viewed videos and ability to \nsearch for video they like\n3. play video\n4. support all devices laptop/mobile/tablet\n(like/comment/dislike a video)",
			"rawText": "Youtube or steaming platform\n\nFR\n\n1. people should be able to \nupload videos\n2. homepage for user with recommendation/\nmost viewed videos and ability to \nsearch for video they like\n3. play video\n4. support all devices laptop/mobile/tablet\n(like/comment/dislike a video)",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Youtube or steaming platform\n\nFR\n\n1. people should be able to \nupload videos\n2. homepage for user with recommendation/\nmost viewed videos and ability to \nsearch for video they like\n3. play video\n4. support all devices laptop/mobile/tablet\n(like/comment/dislike a video)",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 122,
			"versionNonce": 1905032960,
			"isDeleted": false,
			"id": "647c9lnp",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24834.48122148851,
			"y": -276.8151573521003,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 363.28125,
			"height": 168,
			"seed": 1597734656,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "NFR\n\nno buffering (atleast as low as\npossible)\nlow latency\nhigh availability\nno need for strong consistency",
			"rawText": "NFR\n\nno buffering (atleast as low as\npossible)\nlow latency\nhigh availability\nno need for strong consistency",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "NFR\n\nno buffering (atleast as low as\npossible)\nlow latency\nhigh availability\nno need for strong consistency",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 29,
			"versionNonce": 448721152,
			"isDeleted": false,
			"id": "znTJCEk2",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24266.747288176786,
			"y": 29.90858835384813,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 222.65625,
			"height": 48,
			"seed": 764321536,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "users of the system\n",
			"rawText": "users of the system\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "users of the system\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 109,
			"versionNonce": 698654464,
			"isDeleted": false,
			"id": "D4oEJvhwBI8worxDqL-DC",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24200.060108982027,
			"y": 73.28118813728844,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 313.62955778634966,
			"height": 197.1217670889815,
			"seed": 175243008,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "90691b2f1307bae06a16df11b18248c610fd0d4f",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 216,
			"versionNonce": 666423552,
			"isDeleted": false,
			"id": "IuzXaL9p",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24585.268090207424,
			"y": 89.15662075720707,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 550.78125,
			"height": 144,
			"seed": 1511005952,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "client is nothing but ur laptop, mobile, etc.\nuser is you who is viewing the content on some \nclient.\nproduction house is the user/entity who uploads\na video.\n",
			"rawText": "client is nothing but ur laptop, mobile, etc.\nuser is you who is viewing the content on some \nclient.\nproduction house is the user/entity who uploads\na video.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "client is nothing but ur laptop, mobile, etc.\nuser is you who is viewing the content on some \nclient.\nproduction house is the user/entity who uploads\na video.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 137,
			"versionNonce": 1773715200,
			"isDeleted": false,
			"id": "rfzgVMLO1dRHYSJX_JeoM",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24205.320777868732,
			"y": 310.64193643391366,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 399.34667940543375,
			"height": 339.1656927884472,
			"seed": 2027434240,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c18e296ea95154a898ceef8e623f2ca0d7dd8838",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 353,
			"versionNonce": 980857088,
			"isDeleted": false,
			"id": "FswBqwg4",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24645.728095282262,
			"y": 345.1114876300679,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 539.0625,
			"height": 168,
			"seed": 425775360,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "clients know which device it is on. and what\nformat it can support. so based on some logic\nlet say it asks for best quality. The video\ncomes in chunk. Let say for some reason client\nfigures out that 1080p next chunk are coming\nlate so it will lower the quality and ask for\nlow rated chunk",
			"rawText": "clients know which device it is on. and what\nformat it can support. so based on some logic\nlet say it asks for best quality. The video\ncomes in chunk. Let say for some reason client\nfigures out that 1080p next chunk are coming\nlate so it will lower the quality and ask for\nlow rated chunk",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "clients know which device it is on. and what\nformat it can support. so based on some logic\nlet say it asks for best quality. The video\ncomes in chunk. Let say for some reason client\nfigures out that 1080p next chunk are coming\nlate so it will lower the quality and ask for\nlow rated chunk",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 189,
			"versionNonce": 1380507392,
			"isDeleted": false,
			"id": "7MY4Ol6u",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24668.58490245875,
			"y": 704.369078008454,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 585.9375,
			"height": 120,
			"seed": 2063929600,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "store the video in amazon s3 and store video\nmetadata in cassandra, like video_id, user_id,etc.\n\nasset onboarding service also put a message in\nkafka ",
			"rawText": "store the video in amazon s3 and store video\nmetadata in cassandra, like video_id, user_id,etc.\n\nasset onboarding service also put a message in\nkafka ",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "store the video in amazon s3 and store video\nmetadata in cassandra, like video_id, user_id,etc.\n\nasset onboarding service also put a message in\nkafka ",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 61,
			"versionNonce": 2054721792,
			"isDeleted": false,
			"id": "41AYZZotO8PwS_VJxep2C",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24108.76614330625,
			"y": 685.5674509328771,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 513.5631941276172,
			"height": 339.1656927884472,
			"seed": 1734344448,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9ee611bfa5007dc397a4b6fbc3d9fce11d523023",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 645,
			"versionNonce": 1943338752,
			"isDeleted": false,
			"id": "nigqxDEP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24674.852083357528,
			"y": 863.4451667187502,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1066.40625,
			"height": 168,
			"seed": 195924224,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "content processor has multiple tasks\nfirst it chunks the raw video in 100s or 1000s of chunks then this is put in to kafka\nthe next service content filter picks this message from kafka, does some work and again put\ninto kafka, then content tagger does something same. transcoder convert raw file to \ndifferent formats like mp4, mkv, mp3, etc. then each of these chunk and different files\nare converted into different pixel ratio or quality\nthen these chunks are uploaded in cdn. Also each chunk knows the next chunk to it.",
			"rawText": "content processor has multiple tasks\nfirst it chunks the raw video in 100s or 1000s of chunks then this is put in to kafka\nthe next service content filter picks this message from kafka, does some work and again put\ninto kafka, then content tagger does something same. transcoder convert raw file to \ndifferent formats like mp4, mkv, mp3, etc. then each of these chunk and different files\nare converted into different pixel ratio or quality\nthen these chunks are uploaded in cdn. Also each chunk knows the next chunk to it.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "content processor has multiple tasks\nfirst it chunks the raw video in 100s or 1000s of chunks then this is put in to kafka\nthe next service content filter picks this message from kafka, does some work and again put\ninto kafka, then content tagger does something same. transcoder convert raw file to \ndifferent formats like mp4, mkv, mp3, etc. then each of these chunk and different files\nare converted into different pixel ratio or quality\nthen these chunks are uploaded in cdn. Also each chunk knows the next chunk to it.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 329,
			"versionNonce": 524185856,
			"isDeleted": false,
			"id": "kHYHY5RK",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24677.064056029012,
			"y": 1069.8938211592301,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1746.09375,
			"height": 72,
			"seed": 331542784,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "asset service is consuming of the topic from kafka, it stores like how many chunk a video have formats etc in cassandra\n\nnotification service informs the user that full movie/video upload is done. And video is now fully uploaded. Note it inform the uploader of the video",
			"rawText": "asset service is consuming of the topic from kafka, it stores like how many chunk a video have formats etc in cassandra\n\nnotification service informs the user that full movie/video upload is done. And video is now fully uploaded. Note it inform the uploader of the video",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "asset service is consuming of the topic from kafka, it stores like how many chunk a video have formats etc in cassandra\n\nnotification service informs the user that full movie/video upload is done. And video is now fully uploaded. Note it inform the uploader of the video",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 145,
			"versionNonce": 1323114240,
			"isDeleted": false,
			"id": "cWmLRkMQ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24790.61075831216,
			"y": 1282.0567195834324,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 937.5,
			"height": 48,
			"seed": 1689886464,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "analytics service can be used to track the people geography where they are login\nfrom. User age group, etc.",
			"rawText": "analytics service can be used to track the people geography where they are login\nfrom. User age group, etc.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "analytics service can be used to track the people geography where they are login\nfrom. User age group, etc.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 134,
			"versionNonce": 1883787520,
			"isDeleted": false,
			"id": "MbmSY9qV",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24802.407955268853,
			"y": 1363.8988646361713,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 984.375,
			"height": 48,
			"seed": 1575247616,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "home page service fetches all those videos which needs to be displayed to this user.\n",
			"rawText": "home page service fetches all those videos which needs to be displayed to this user.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "home page service fetches all those videos which needs to be displayed to this user.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 54,
			"versionNonce": 1407270656,
			"isDeleted": false,
			"id": "M_4iTNMO7iWS4F1oT7HRJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24077.049466989953,
			"y": 1237.2647511347745,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 680.2208880436824,
			"height": 339.1656927884472,
			"seed": 2037284608,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9a9b187322d23803d1a00c7012a62d31bce8b120",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 292,
			"versionNonce": 1159082240,
			"isDeleted": false,
			"id": "J2CpLufT",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24114.49137353316,
			"y": 1601.3148833397654,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 949.21875,
			"height": 72,
			"seed": 1951883008,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "user playing video talks to host identity service which knows where are u coming \nfrom it talks to asset service to get list of all cdns which has this video. Then\nfrom the list HIS(hos identity service) will try to find the closest to user.",
			"rawText": "user playing video talks to host identity service which knows where are u coming \nfrom it talks to asset service to get list of all cdns which has this video. Then\nfrom the list HIS(hos identity service) will try to find the closest to user.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "user playing video talks to host identity service which knows where are u coming \nfrom it talks to asset service to get list of all cdns which has this video. Then\nfrom the list HIS(hos identity service) will try to find the closest to user.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 237,
			"versionNonce": 1667325696,
			"isDeleted": false,
			"id": "B2Ux2e62",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24122.601874366985,
			"y": 1700.115335533047,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1945.3125,
			"height": 48,
			"seed": 316915456,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "stream stats logger generate analytics on watched content, like how much minutes video watched, how long video completed like 50% or something like that. Which can be\nput in kafka for analytics again.",
			"rawText": "stream stats logger generate analytics on watched content, like how much minutes video watched, how long video completed like 50% or something like that. Which can be\nput in kafka for analytics again.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "stream stats logger generate analytics on watched content, like how much minutes video watched, how long video completed like 50% or something like that. Which can be\nput in kafka for analytics again.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 75,
			"versionNonce": 86511872,
			"isDeleted": false,
			"id": "f93lJ9yOJuMAUSizfWKzn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24138.75259351625,
			"y": 1778.4552092735435,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 646.0298910256137,
			"height": 339.1656927884472,
			"seed": 1609367296,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9cfc4549be808a2fe4899386af6dde183ec8de6f",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 108,
			"versionNonce": 1306361600,
			"isDeleted": false,
			"id": "kRwxhPreKRSm_g88fANEu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 25233.286077182183,
			"y": -23.2559680245389,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1049,
			"height": 249,
			"seed": 1476825344,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "d5697fedd9830321acefb57f3e47510db401897f",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 37,
			"versionNonce": 670953728,
			"isDeleted": false,
			"id": "JqfIyA7OS6Pi8ICetkF9D",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 25239.956244488563,
			"y": 257.52694922840396,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1074,
			"height": 76,
			"seed": 1002692352,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "f3b39384feac3fee384fd87edfb26fce45a0d034",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 29,
			"versionNonce": 1406508800,
			"isDeleted": false,
			"id": "5MXUNryUnJ7qZdHwvYE-G",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 25359.951086266658,
			"y": 348.45232562945023,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 842.0000000000001,
			"height": 103,
			"seed": 998297856,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "34e5234ab65deb3906a849d234fc864a74f9ecee",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 86,
			"versionNonce": 890753280,
			"isDeleted": false,
			"id": "mwP2hyoa7vMl7KLE0Yuzq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 25335.489196911094,
			"y": 454.34654226571183,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1047,
			"height": 144,
			"seed": 1578139392,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "67e3f9705a6a3fb0e46cdb1d8bba459851b42f39",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 244,
			"versionNonce": 633978624,
			"isDeleted": false,
			"id": "iB_-023h1J_cgX2-DbB1U",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 25758.159505596643,
			"y": 632.6906471529917,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 726.4999150047202,
			"height": 340.32484907332224,
			"seed": 1167200512,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "827bda7cc58028264f9b5a17244cdb50ad9f2ae0",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 37,
			"versionNonce": 1140175104,
			"isDeleted": false,
			"id": "2OWK096X91vIX55himngv",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 24525.80197431804,
			"y": 2670.738486878243,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 812.8936862314627,
			"height": 617.9249877929688,
			"seed": 1622032128,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "194f7c6037246ba3202dcc17c5b0180b77ccf07c",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "rectangle",
			"version": 396,
			"versionNonce": 237285632,
			"isDeleted": false,
			"id": "_d-iD2t8DFkGLlvuIYixf",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26513.876147501323,
			"y": -365.64360294248763,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2263.337078728444,
			"height": 20117.246529447733,
			"seed": 138878720,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718426328105,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 72,
			"versionNonce": 2081919232,
			"isDeleted": false,
			"id": "3xKpRBBO",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26599.52417109108,
			"y": -317.5632742180445,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 480.46875,
			"height": 72,
			"seed": 1560829696,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "video call platform (zoom/google meeting)\n\n",
			"rawText": "video call platform (zoom/google meeting)\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "video call platform (zoom/google meeting)\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 150,
			"versionNonce": 530972416,
			"isDeleted": false,
			"id": "h-XOVygKttJ5MKsCU9YZl",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26597.88267992339,
			"y": -251.69826476616402,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 432.3562462061475,
			"height": 339.3031958415698,
			"seed": 698249472,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "549351481f525fd919e9ca273ca170e6d6f0e50e",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 169,
			"versionNonce": 352153856,
			"isDeleted": false,
			"id": "hYTzjY1w",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27089.893768991624,
			"y": -170.12111335724842,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1582.03125,
			"height": 24,
			"seed": 1540165888,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "video and screen share are basically similarly implemented like in video the input is your camera while in screen share input is screen",
			"rawText": "video and screen share are basically similarly implemented like in video the input is your camera while in screen share input is screen",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "video and screen share are basically similarly implemented like in video the input is your camera while in screen share input is screen",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 79,
			"versionNonce": 1485709056,
			"isDeleted": false,
			"id": "WFbOSNpVjUldX17XTlR09",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26608.743037730277,
			"y": 129.49082101247632,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 404.45112234788024,
			"height": 321.8756848685214,
			"seed": 813191424,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "71bc4072dd17380eecfe3e0b76211dd63ca3747e",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 113,
			"versionNonce": 1445417216,
			"isDeleted": false,
			"id": "xXQUn7ed",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27051.790678300764,
			"y": 202.62601838639068,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1054.6875,
			"height": 24,
			"seed": 562224896,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "super fast means audio and video is lag is not good, so it should deliver the content fast",
			"rawText": "super fast means audio and video is lag is not good, so it should deliver the content fast",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "super fast means audio and video is lag is not good, so it should deliver the content fast",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 61,
			"versionNonce": 2138193664,
			"isDeleted": false,
			"id": "nwbdkLGX",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27053.447306941092,
			"y": 280.4888284084377,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 398.4375,
			"height": 24,
			"seed": 1549291776,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "losing few frames in call is okay.",
			"rawText": "losing few frames in call is okay.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "losing few frames in call is okay.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 65,
			"versionNonce": 387264768,
			"isDeleted": false,
			"id": "2B4lYr4h5R2XNz_lWCY7B",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26661.99228847062,
			"y": 584.5750303220133,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 768,
			"height": 356,
			"seed": 1494290688,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "98db28127419166f1020c7589caa4fbe9bffc41f",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 48,
			"versionNonce": 1959943936,
			"isDeleted": false,
			"id": "Rqvz6cH7",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26821.515758300608,
			"y": 550.5233413471205,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 480.46875,
			"height": 24,
			"seed": 1175924992,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "the communication between user and server",
			"rawText": "the communication between user and server",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "the communication between user and server",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 1061622016,
			"isDeleted": false,
			"id": "UiLGuYYm",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27706.16897625071,
			"y": 643.2959987211142,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 117.1875,
			"height": 24,
			"seed": 553287424,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "TCP VS UDP",
			"rawText": "TCP VS UDP",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "TCP VS UDP",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 319,
			"versionNonce": 154042112,
			"isDeleted": false,
			"id": "QxgGJ1f9",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26732.0564214036,
			"y": 1045.862888364978,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1828.125,
			"height": 48,
			"seed": 1511259904,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996515,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "In UDP we may get out of order data packets, some packets missing. We should be okay with that if some frames are out of order or missing in video chat app.\nWe'll be using UDP for video/audio transfer only. For other we'll still be using normal TCP",
			"rawText": "In UDP we may get out of order data packets, some packets missing. We should be okay with that if some frames are out of order or missing in video chat app.\nWe'll be using UDP for video/audio transfer only. For other we'll still be using normal TCP",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "In UDP we may get out of order data packets, some packets missing. We should be okay with that if some frames are out of order or missing in video chat app.\nWe'll be using UDP for video/audio transfer only. For other we'll still be using normal TCP",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 36,
			"versionNonce": 1178398976,
			"isDeleted": false,
			"id": "FOAHiEWjXb7A9l8bOd782",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26662.881317279545,
			"y": 1186.2677699594365,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 569.0802271518684,
			"height": 617.9249877929688,
			"seed": 39829248,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "0884b62eec78e164990ca51806bb6d8f55237d5d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 97,
			"versionNonce": 2097585920,
			"isDeleted": false,
			"id": "CJTsmJPmaKrUgN0w8xt2I",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26672.174546154205,
			"y": 1880.1600037383987,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 587.7684825769214,
			"height": 587.7684825769214,
			"seed": 586596096,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "88ca3ee87a6edabf3c877975e84585c8a2483bcf",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 3,
			"versionNonce": 863424768,
			"isDeleted": false,
			"id": "EQTzlDTw",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27531.391937253848,
			"y": 1376.3653262187727,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1125,
			"height": 552,
			"seed": 436736256,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "let say user u1 wants to initiate a video call with u2. u1 can inform web socket handler\ntelling i want to make a video call to user u2. Now few scenario can happen, u2 is offline\nthen we show either show error message to u1 or we show ringing sound and after some time\ndrop the call. but let say u2 is online then handler will send a request to u2 that you\nhave a incoming call from u1, do you accept it or not? if u2 accepts it, it follows the same\nroute and the call is established, if u2 rejects again same route but now we can show u1 some\nerror message that u2 has not picked your call. We should not be using same route for actual\nvideo call because websocket protocol is build on top of TCP. and we want UDP for video call\n\nUDP is a connectionless protocol(no connection), whenever u1 want to send a data to u2. it\nis done like this send this data to this ip address with this port. Here u1 can directly\nsend data to u2 and vice versa without a need for central server. For this u1 needs u2 ip and \nvice versa. Connector job is identify ip address of both u1 and u2. Also inform them these ips. \n\nSo first u1 calls connector it tells u1 it's ip address, similarly u2 calls connector and it\ntell u2 it's ip address. Then through web socket handler they'll interchange ip address.\nThen they'll start sending UDP message to each other. apart from that they'll also exchange \nattributes about their connection and configuration. Example U1 is on 5G and u2 is on 2G. So\na decision is made what quality data packets to send.\n\n\nNOW SINCE UDP IS SUCH NICE WHY NOT UDP FOR ALL USE CASE. One of the reason is their are firewall\nrestriction which don't allow UDP connections",
			"rawText": "let say user u1 wants to initiate a video call with u2. u1 can inform web socket handler\ntelling i want to make a video call to user u2. Now few scenario can happen, u2 is offline\nthen we show either show error message to u1 or we show ringing sound and after some time\ndrop the call. but let say u2 is online then handler will send a request to u2 that you\nhave a incoming call from u1, do you accept it or not? if u2 accepts it, it follows the same\nroute and the call is established, if u2 rejects again same route but now we can show u1 some\nerror message that u2 has not picked your call. We should not be using same route for actual\nvideo call because websocket protocol is build on top of TCP. and we want UDP for video call\n\nUDP is a connectionless protocol(no connection), whenever u1 want to send a data to u2. it\nis done like this send this data to this ip address with this port. Here u1 can directly\nsend data to u2 and vice versa without a need for central server. For this u1 needs u2 ip and \nvice versa. Connector job is identify ip address of both u1 and u2. Also inform them these ips. \n\nSo first u1 calls connector it tells u1 it's ip address, similarly u2 calls connector and it\ntell u2 it's ip address. Then through web socket handler they'll interchange ip address.\nThen they'll start sending UDP message to each other. apart from that they'll also exchange \nattributes about their connection and configuration. Example U1 is on 5G and u2 is on 2G. So\na decision is made what quality data packets to send.\n\n\nNOW SINCE UDP IS SUCH NICE WHY NOT UDP FOR ALL USE CASE. One of the reason is their are firewall\nrestriction which don't allow UDP connections",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "let say user u1 wants to initiate a video call with u2. u1 can inform web socket handler\ntelling i want to make a video call to user u2. Now few scenario can happen, u2 is offline\nthen we show either show error message to u1 or we show ringing sound and after some time\ndrop the call. but let say u2 is online then handler will send a request to u2 that you\nhave a incoming call from u1, do you accept it or not? if u2 accepts it, it follows the same\nroute and the call is established, if u2 rejects again same route but now we can show u1 some\nerror message that u2 has not picked your call. We should not be using same route for actual\nvideo call because websocket protocol is build on top of TCP. and we want UDP for video call\n\nUDP is a connectionless protocol(no connection), whenever u1 want to send a data to u2. it\nis done like this send this data to this ip address with this port. Here u1 can directly\nsend data to u2 and vice versa without a need for central server. For this u1 needs u2 ip and \nvice versa. Connector job is identify ip address of both u1 and u2. Also inform them these ips. \n\nSo first u1 calls connector it tells u1 it's ip address, similarly u2 calls connector and it\ntell u2 it's ip address. Then through web socket handler they'll interchange ip address.\nThen they'll start sending UDP message to each other. apart from that they'll also exchange \nattributes about their connection and configuration. Example U1 is on 5G and u2 is on 2G. So\na decision is made what quality data packets to send.\n\n\nNOW SINCE UDP IS SUCH NICE WHY NOT UDP FOR ALL USE CASE. One of the reason is their are firewall\nrestriction which don't allow UDP connections",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 430,
			"versionNonce": 14335744,
			"isDeleted": false,
			"id": "HtbUBsgh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26558.9362638324,
			"y": 3416.5346209759923,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2132.8125,
			"height": 1032,
			"seed": 952499968,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "let's identify how each of the users identify their own public IP address. So, I have drawn a small diagram here to make it easy for us.\n\nThis is the same connector component.Let's say, connector has a IP address of 1.2.3.4.\n\nAnd these are the three devices that we have in the system who want to understand their own public IP address.\n\nLet's say, this laptop has a IP address of 192.160.1.1, which is a private series IP address. This mobile device again has a 192.160.1.2 IP address.\n\nAnd this could be a smart tv, IP phone, anything, which has a IP address of 192.160.1.3. Let's say, if this laptop wants to identify its public IP address then, what exactly happens.\n\nThis laptop would then talk to ISP's router via a lot of routers. It could be talking to it's home router then a couple of more routers in between.\n\nAt the end it will talk to ISP's router. Let's say this laptop establishes this connection with this ISP's router on port P1.\n\nExternally, let's say, the the public IP address of this router is A.B.C.D.\n\nThese routers will have firewalls. They'll have something called as a Network Address Translator and a lot of things.\n\nThis NAT essentially (Network Address Translator) converts this public IP address into this private IP address.\n\nLet's see how would that work? So this device would send a message to this connector component asking for it's public IP address.\n\nIf you send a request essentially to 1.2.3.4, that request will go here. This router will forward the request to 1.2.3.4.\n\nNow, when this connector gets the request, it will get to know that I have got a request from A.B.C.D from a particular port, let's say P1.\n\nIf this device was connected to port P1 of this particular router, then connector will get to know that P1 was the port through which I got the request.\n\nSo in the response, it will send this kind of a message. It will say to the same IP address, A.B.C.D of this router, on this port, let's say it is P1 in this case,\n\nit will send the same message, saying your public IP address is A.B.C.D:P1.\n\nThis device will get to know that my public IP address is A.B.C.D on port P1.\n\nNow, same thing happens when these devices connect. It will send a request to router connected on port P2 on the router. Then the request goes forward to connector.\n\nConnector sends back a response because now it will know that it got connected to port P2 on this device. It will send that request.\n\nNAT will convert that request, which was supposed to come for A.B.C.D:P2 (for the port) to this particular device's IP address.\n\nAnd this guy will also get to know. Similarly, all three of them will get to know that their public IP address is A.B.C.D, with individual port - P1, P2, P3 whatever that is.\n\nSo, this is how a device gets to know their public IP address.",
			"rawText": "let's identify how each of the users identify their own public IP address. So, I have drawn a small diagram here to make it easy for us.\n\nThis is the same connector component.Let's say, connector has a IP address of 1.2.3.4.\n\nAnd these are the three devices that we have in the system who want to understand their own public IP address.\n\nLet's say, this laptop has a IP address of 192.160.1.1, which is a private series IP address. This mobile device again has a 192.160.1.2 IP address.\n\nAnd this could be a smart tv, IP phone, anything, which has a IP address of 192.160.1.3. Let's say, if this laptop wants to identify its public IP address then, what exactly happens.\n\nThis laptop would then talk to ISP's router via a lot of routers. It could be talking to it's home router then a couple of more routers in between.\n\nAt the end it will talk to ISP's router. Let's say this laptop establishes this connection with this ISP's router on port P1.\n\nExternally, let's say, the the public IP address of this router is A.B.C.D.\n\nThese routers will have firewalls. They'll have something called as a Network Address Translator and a lot of things.\n\nThis NAT essentially (Network Address Translator) converts this public IP address into this private IP address.\n\nLet's see how would that work? So this device would send a message to this connector component asking for it's public IP address.\n\nIf you send a request essentially to 1.2.3.4, that request will go here. This router will forward the request to 1.2.3.4.\n\nNow, when this connector gets the request, it will get to know that I have got a request from A.B.C.D from a particular port, let's say P1.\n\nIf this device was connected to port P1 of this particular router, then connector will get to know that P1 was the port through which I got the request.\n\nSo in the response, it will send this kind of a message. It will say to the same IP address, A.B.C.D of this router, on this port, let's say it is P1 in this case,\n\nit will send the same message, saying your public IP address is A.B.C.D:P1.\n\nThis device will get to know that my public IP address is A.B.C.D on port P1.\n\nNow, same thing happens when these devices connect. It will send a request to router connected on port P2 on the router. Then the request goes forward to connector.\n\nConnector sends back a response because now it will know that it got connected to port P2 on this device. It will send that request.\n\nNAT will convert that request, which was supposed to come for A.B.C.D:P2 (for the port) to this particular device's IP address.\n\nAnd this guy will also get to know. Similarly, all three of them will get to know that their public IP address is A.B.C.D, with individual port - P1, P2, P3 whatever that is.\n\nSo, this is how a device gets to know their public IP address.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "let's identify how each of the users identify their own public IP address. So, I have drawn a small diagram here to make it easy for us.\n\nThis is the same connector component.Let's say, connector has a IP address of 1.2.3.4.\n\nAnd these are the three devices that we have in the system who want to understand their own public IP address.\n\nLet's say, this laptop has a IP address of 192.160.1.1, which is a private series IP address. This mobile device again has a 192.160.1.2 IP address.\n\nAnd this could be a smart tv, IP phone, anything, which has a IP address of 192.160.1.3. Let's say, if this laptop wants to identify its public IP address then, what exactly happens.\n\nThis laptop would then talk to ISP's router via a lot of routers. It could be talking to it's home router then a couple of more routers in between.\n\nAt the end it will talk to ISP's router. Let's say this laptop establishes this connection with this ISP's router on port P1.\n\nExternally, let's say, the the public IP address of this router is A.B.C.D.\n\nThese routers will have firewalls. They'll have something called as a Network Address Translator and a lot of things.\n\nThis NAT essentially (Network Address Translator) converts this public IP address into this private IP address.\n\nLet's see how would that work? So this device would send a message to this connector component asking for it's public IP address.\n\nIf you send a request essentially to 1.2.3.4, that request will go here. This router will forward the request to 1.2.3.4.\n\nNow, when this connector gets the request, it will get to know that I have got a request from A.B.C.D from a particular port, let's say P1.\n\nIf this device was connected to port P1 of this particular router, then connector will get to know that P1 was the port through which I got the request.\n\nSo in the response, it will send this kind of a message. It will say to the same IP address, A.B.C.D of this router, on this port, let's say it is P1 in this case,\n\nit will send the same message, saying your public IP address is A.B.C.D:P1.\n\nThis device will get to know that my public IP address is A.B.C.D on port P1.\n\nNow, same thing happens when these devices connect. It will send a request to router connected on port P2 on the router. Then the request goes forward to connector.\n\nConnector sends back a response because now it will know that it got connected to port P2 on this device. It will send that request.\n\nNAT will convert that request, which was supposed to come for A.B.C.D:P2 (for the port) to this particular device's IP address.\n\nAnd this guy will also get to know. Similarly, all three of them will get to know that their public IP address is A.B.C.D, with individual port - P1, P2, P3 whatever that is.\n\nSo, this is how a device gets to know their public IP address.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 128,
			"versionNonce": 510963968,
			"isDeleted": false,
			"id": "VD-kfMYsY7lJBa7WwWBMP",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27263.207439923866,
			"y": 2524.1562914278816,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 725.2279458665903,
			"height": 799.0937551678171,
			"seed": 1389048064,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "345d0655d876501dfda5772b281ac2c533be9f5c",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 3,
			"versionNonce": 892002048,
			"isDeleted": false,
			"id": "lXWpg736",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26830.62740541141,
			"y": 4575.77823861651,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1359.375,
			"height": 312,
			"seed": 323768576,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "There is something called as a Symmetric NAT. \nWhat that is, is basically when this device wants to connect to this connector, it basically connects via port P1.\nSo, if there's a symmetric NAT, it will make sure that only this connector can talk back to P2.\nWhat we are doing essentially is.. there is this user device U3 of another user who's also talking to the same port.\nIn the scenario, there was one connector which got to know of this port.\nAnd then there is U1 which is also talking to the same port.\nBut in case there's a symmetric NAT, then this wouldn't work.\nThis firewall will block this connection of U3 trying to access this port.\nAnd if that happens, this whole thing goes for a toss and then we cannot do any of it.\nSo what is the solution?\nSo the solution now is putting something called as a Call Server in between.\nWhat this Call Server does is basically a combination of connector + data transfer.\n",
			"rawText": "There is something called as a Symmetric NAT. \nWhat that is, is basically when this device wants to connect to this connector, it basically connects via port P1.\nSo, if there's a symmetric NAT, it will make sure that only this connector can talk back to P2.\nWhat we are doing essentially is.. there is this user device U3 of another user who's also talking to the same port.\nIn the scenario, there was one connector which got to know of this port.\nAnd then there is U1 which is also talking to the same port.\nBut in case there's a symmetric NAT, then this wouldn't work.\nThis firewall will block this connection of U3 trying to access this port.\nAnd if that happens, this whole thing goes for a toss and then we cannot do any of it.\nSo what is the solution?\nSo the solution now is putting something called as a Call Server in between.\nWhat this Call Server does is basically a combination of connector + data transfer.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "There is something called as a Symmetric NAT. \nWhat that is, is basically when this device wants to connect to this connector, it basically connects via port P1.\nSo, if there's a symmetric NAT, it will make sure that only this connector can talk back to P2.\nWhat we are doing essentially is.. there is this user device U3 of another user who's also talking to the same port.\nIn the scenario, there was one connector which got to know of this port.\nAnd then there is U1 which is also talking to the same port.\nBut in case there's a symmetric NAT, then this wouldn't work.\nThis firewall will block this connection of U3 trying to access this port.\nAnd if that happens, this whole thing goes for a toss and then we cannot do any of it.\nSo what is the solution?\nSo the solution now is putting something called as a Call Server in between.\nWhat this Call Server does is basically a combination of connector + data transfer.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 53,
			"versionNonce": 783716608,
			"isDeleted": false,
			"id": "E1tLxQQkHVvz7lsIwDUsj",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26757.547980490534,
			"y": 4963.180401118923,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 495,
			"height": 546,
			"seed": 1284611840,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c01a4d619d82f34510090ec815aa296e688c1726",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 10,
			"versionNonce": 712441600,
			"isDeleted": false,
			"id": "FqkhuJZN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27400.064723584608,
			"y": 5020.731174724812,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1359.375,
			"height": 168,
			"seed": 613621504,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "This Call Server then, through a similar process, is able to identify each of their addresses. It gets to know. \nIt sends them also. Then, this serves as a intermediate layer for these two parties to talk to each other. So, \nU1.. it doesn't send directly to U2 any information.. U1 basically sends all the information to Call Server. \nCall Server then redirects all the information to U2. U2 again sends the information to Call Server and Call Server \nsends the information to U1. This is how the communication, if it cannot happen in a peer to peer model, it would \nhappen through something called as this Call Server.  This protocol is called webRTC\n",
			"rawText": "This Call Server then, through a similar process, is able to identify each of their addresses. It gets to know. \nIt sends them also. Then, this serves as a intermediate layer for these two parties to talk to each other. So, \nU1.. it doesn't send directly to U2 any information.. U1 basically sends all the information to Call Server. \nCall Server then redirects all the information to U2. U2 again sends the information to Call Server and Call Server \nsends the information to U1. This is how the communication, if it cannot happen in a peer to peer model, it would \nhappen through something called as this Call Server.  This protocol is called webRTC\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "This Call Server then, through a similar process, is able to identify each of their addresses. It gets to know. \nIt sends them also. Then, this serves as a intermediate layer for these two parties to talk to each other. So, \nU1.. it doesn't send directly to U2 any information.. U1 basically sends all the information to Call Server. \nCall Server then redirects all the information to U2. U2 again sends the information to Call Server and Call Server \nsends the information to U1. This is how the communication, if it cannot happen in a peer to peer model, it would \nhappen through something called as this Call Server.  This protocol is called webRTC\n",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 248,
			"versionNonce": 465334528,
			"isDeleted": false,
			"id": "ozACFAzD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27490.087227357784,
			"y": 5756.796695340545,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1230.46875,
			"height": 144,
			"seed": 1927196928,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "So, for group video calling, we will follow a slightly different and a hybrid approach.\nFirst of all, we'll classify groups into two categories.\nSo, all the groups who have <= to five users will be the groups which have small number of users.\nAnd other will be called as a group with large number of users.\n\nFive is configurable here. Based on number of participant in call we'll figure out which approach to take",
			"rawText": "So, for group video calling, we will follow a slightly different and a hybrid approach.\nFirst of all, we'll classify groups into two categories.\nSo, all the groups who have <= to five users will be the groups which have small number of users.\nAnd other will be called as a group with large number of users.\n\nFive is configurable here. Based on number of participant in call we'll figure out which approach to take",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "So, for group video calling, we will follow a slightly different and a hybrid approach.\nFirst of all, we'll classify groups into two categories.\nSo, all the groups who have <= to five users will be the groups which have small number of users.\nAnd other will be called as a group with large number of users.\n\nFive is configurable here. Based on number of participant in call we'll figure out which approach to take",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 18,
			"versionNonce": 1631526656,
			"isDeleted": false,
			"id": "45gDhTx3W7wisXnMo8UcY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26782.58699484998,
			"y": 5681.506376763256,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 468.00000000000006,
			"height": 418,
			"seed": 2091261696,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "2335b3be87ba5264142a34752f5b04a7271f17f8",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 13,
			"versionNonce": 1872830208,
			"isDeleted": false,
			"id": "CVr8qXWJ",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27475.966013327125,
			"y": 5979.204940969255,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1441.40625,
			"height": 240,
			"seed": 1224957696,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "these 4 users and they want to do a group video call amongst them.\nNow, let's say, if U1 is actually talking about something, U1's data needs to be sent to U2, U3 and U4.\nNow, let's just imagine if these are connected by a peer to peer model,\nwhat exactly would happen is U1 would send a particular piece of information to U2, then to U3, then to U4, all separately.\nNow, for 3 - 4 users, this this is a fairly fine thing.\nBut, let's imagine this for 100 users.\nThat's a problem.\nSo, we'll say that if these are small number of users, this is probably okay.\nBut if there are larger number of users, this wouldn't work and we'll follow the approach via the Call Server.\nU1 will just send this piece of information to Call Server. Call Server would then send it to all the three users.",
			"rawText": "these 4 users and they want to do a group video call amongst them.\nNow, let's say, if U1 is actually talking about something, U1's data needs to be sent to U2, U3 and U4.\nNow, let's just imagine if these are connected by a peer to peer model,\nwhat exactly would happen is U1 would send a particular piece of information to U2, then to U3, then to U4, all separately.\nNow, for 3 - 4 users, this this is a fairly fine thing.\nBut, let's imagine this for 100 users.\nThat's a problem.\nSo, we'll say that if these are small number of users, this is probably okay.\nBut if there are larger number of users, this wouldn't work and we'll follow the approach via the Call Server.\nU1 will just send this piece of information to Call Server. Call Server would then send it to all the three users.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "these 4 users and they want to do a group video call amongst them.\nNow, let's say, if U1 is actually talking about something, U1's data needs to be sent to U2, U3 and U4.\nNow, let's just imagine if these are connected by a peer to peer model,\nwhat exactly would happen is U1 would send a particular piece of information to U2, then to U3, then to U4, all separately.\nNow, for 3 - 4 users, this this is a fairly fine thing.\nBut, let's imagine this for 100 users.\nThat's a problem.\nSo, we'll say that if these are small number of users, this is probably okay.\nBut if there are larger number of users, this wouldn't work and we'll follow the approach via the Call Server.\nU1 will just send this piece of information to Call Server. Call Server would then send it to all the three users.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 152,
			"versionNonce": 767840512,
			"isDeleted": false,
			"id": "NI3u4gsu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27477.620338909215,
			"y": 6277.558389302478,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1207.03125,
			"height": 48,
			"seed": 209350912,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "also if you want to record the call, using call server approach is the only way. peer to peer approach \nwon't work here.",
			"rawText": "also if you want to record the call, using call server approach is the only way. peer to peer approach \nwon't work here.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "also if you want to record the call, using call server approach is the only way. peer to peer approach \nwon't work here.",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 20,
			"versionNonce": 1009073920,
			"isDeleted": false,
			"id": "nkbpZ7la",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27480.069703953995,
			"y": 6366.961568277614,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1359.375,
			"height": 144,
			"seed": 1890021632,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371996516,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "This is not an insecure channel. \nIf let's say, U1 and U2 are communicating with each other, hypothetically, let's say it's a one to one conversation.\nWhen the handshake happens, they would also exchange a set of cryptographic keys through which the \nwhole conversation would be encrypted. So, U1 would encrypt the piece of payload that it sends out to U2\nand U2, when it receives the payload, it can decrypt the payload and then play the video.\nSo, anybody listening to that conversation in between would have no clue about what is happening.",
			"rawText": "This is not an insecure channel. \nIf let's say, U1 and U2 are communicating with each other, hypothetically, let's say it's a one to one conversation.\nWhen the handshake happens, they would also exchange a set of cryptographic keys through which the \nwhole conversation would be encrypted. So, U1 would encrypt the piece of payload that it sends out to U2\nand U2, when it receives the payload, it can decrypt the payload and then play the video.\nSo, anybody listening to that conversation in between would have no clue about what is happening.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "This is not an insecure channel. \nIf let's say, U1 and U2 are communicating with each other, hypothetically, let's say it's a one to one conversation.\nWhen the handshake happens, they would also exchange a set of cryptographic keys through which the \nwhole conversation would be encrypted. So, U1 would encrypt the piece of payload that it sends out to U2\nand U2, when it receives the payload, it can decrypt the payload and then play the video.\nSo, anybody listening to that conversation in between would have no clue about what is happening.",
			"lineHeight": 1.2
		},
		{
			"type": "freedraw",
			"version": 17,
			"versionNonce": 2097635072,
			"isDeleted": false,
			"id": "SkrlOQYU8rvKIYSeIZIQ7",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26973.961966359428,
			"y": 4973.2516008149,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 26.943389241729164,
			"height": 25.718730078661793,
			"seed": 329519360,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718371999442,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					1.2246825223883206,
					0
				],
				[
					2.4493650447802793,
					0
				],
				[
					6.123506049236312,
					-2.4494117634239956
				],
				[
					8.572871094016591,
					-7.348188571627361
				],
				[
					11.02223613879687,
					-9.797600335051357
				],
				[
					12.247012098472624,
					-12.247012098475352
				],
				[
					12.247012098472624,
					-13.47171798018735
				],
				[
					14.696377143252903,
					-13.47171798018735
				],
				[
					15.921059665644862,
					-13.47171798018735
				],
				[
					22.044565714881173,
					-19.59522402942457
				],
				[
					23.269248237269494,
					-20.81990655181471
				],
				[
					23.269248237269494,
					-22.04461243352671
				],
				[
					25.718706719337206,
					-24.494024196949795
				],
				[
					26.943389241729164,
					-25.718730078661793
				],
				[
					26.943389241729164,
					-25.718730078661793
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 16,
			"versionNonce": 1391025920,
			"isDeleted": false,
			"id": "AhZCduV9Wp1OMP2vOpa5H",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26991.10770854746,
			"y": 4940.18468216461,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 15.921153102932294,
			"height": 8.572894453339359,
			"seed": 1551364352,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718372000929,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					2.449458482067712,
					0
				],
				[
					3.6741410044560325,
					0
				],
				[
					4.898823526847991,
					0
				],
				[
					7.348282008915703,
					0
				],
				[
					8.572964531304024,
					0
				],
				[
					9.797647053695982,
					0
				],
				[
					12.247012098476262,
					0
				],
				[
					13.471788058152015,
					0
				],
				[
					14.696470580543973,
					0
				],
				[
					15.921153102932294,
					2.449388404101228
				],
				[
					15.921153102932294,
					6.123506049237221
				],
				[
					15.921153102932294,
					7.348188571627361
				],
				[
					15.921153102932294,
					8.572894453339359
				],
				[
					15.921153102932294,
					8.572894453339359
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "text",
			"version": 15,
			"versionNonce": 617307904,
			"isDeleted": false,
			"id": "6xdQfrFL",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27027.848744842886,
			"y": 4923.038846539288,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 117.1875,
			"height": 24,
			"seed": 1979052288,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718372009207,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "signalling",
			"rawText": "signalling",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "signalling",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 5,
			"versionNonce": 41426688,
			"isDeleted": false,
			"id": "kO1dGTPA",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26969.06314283258,
			"y": 5077.351203651936,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 46.875,
			"height": 24,
			"seed": 1400107264,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718372015298,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "stun",
			"rawText": "stun",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "stun",
			"lineHeight": 1.2
		},
		{
			"type": "text",
			"version": 5,
			"versionNonce": 1737809664,
			"isDeleted": false,
			"id": "UxyZxBGC",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27057.241592566683,
			"y": 5180.226123966583,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 46.875,
			"height": 24,
			"seed": 839594240,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718372020293,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "turn",
			"rawText": "turn",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "turn",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 74,
			"versionNonce": 1422278400,
			"isDeleted": false,
			"id": "jjJMxxW6UMNJ7U0d8IR7_",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26872.26957920441,
			"y": 6564.27506348836,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1166,
			"height": 519,
			"seed": 103969024,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718425930233,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c4bfc9c79da4c950f1ff74c64787e9343e792136",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 3,
			"versionNonce": 1276514560,
			"isDeleted": false,
			"id": "TZ2mnRxk",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26564.29935560307,
			"y": 7264.361445199469,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 1980.46875,
			"height": 11712,
			"seed": 1319137536,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718426342846,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "\n\nNow, if you look at any videoconferencing platform, they always have a chat system along with that. We can use the same architecture we used for WhatsApp design\n\nU1, wants to initiate a call with a user U2. All live users in the system are connected to one of the WebSocket Handler, similar to WhatsApp.\nThen we have web socket manager who keeps tracks of which user is connected to which web socket handler. Web socket manager sits on top of redis, now redis\nwill not only keep this data inmemory but also flush the info to persistant data store to make it fault tolerant.\n\n\nuser U1 wants to initiate a call with user U2. It makes a call to WebSocket Handler, which basically calls something called as a Signalling Service.\nSignalling Service is the one that initiates the conversation between two parties.\nIt will also have some policies, which will check for certain conditions. So, let's say, if you have something like a Facebook and you want to put a restriction saying, \nif you are not friends, then you cannot make a video call between two parties or to a user, then all of those things would sit within Signalling Service.\nIt would also use User Service, a repository of all the users in the system to power such functionalities.\nNow, if there's something like Zoom, such a thing would not exist because there is a concept of guest user in Zoom.\n\n\nNow, Signalling Service will basically talk to U2 and basically tell the WebSocket Handler of U2 to ask U2, if U2 wants to accept the call or not.\nIf U2 rejects the call or if U2 is offline, then it can be handled in certain ways.\nBut if let's say U2 accepts the call, then Signalling Server basically informs U1 that U2 has accepted your call.\nNow we can initiate the conversation.\nThen comes something called as a Connector.\nSo, all of the users will talk to all of these components.\nI have not drawn the arrows because that will clutter the diagram.\nBut now at this point, what happens is - both U1 and U2 talk to this Connector component.\nRemember the connector component in the previous segment, which was also called as the STUN Server in the WebRTC world.\nSo, this component is responsible for telling each of the parties about their publicly accessible IP addresses.\nNow, through Connector, they'll get to know their public IP address.\nAnd again, through this similar WebSocket Handler via Signalling Server, they would communicate these two things to each other,\nsaying my IP address is this, my IP address is that.\nNow both of them know each other's IP addresses.\nThen, they will also do another handshake which talks about what kind of a bitrate they can support,\nwhat kind of codec they can support, what kind of bandwidth they have available.\nSo, all of those information would also be shared, again via WebSocket Handler.\nOnce that thing is established between both the parties, then they can start with the communication.\nBasically then a regular peer to peer connection is established between U1 and U2\nand they can start sending packets to each other and continue with the video call.\nNow, the way video call would actually work\nis those videos would not be bigger chunks like five - five seconds each.\n\nIn this scenario, we'll use much smaller chunks, which is of a few milliseconds kind of a thing,\n\nor maybe one-fourth of a second or one-fifth of a second, something of that sort\n\nand those big chunks would be sent across to each other\n\nso that the experience is nearly seamless.\n\nAnd it looks more of a real time thing.\n\nNow, let's just say, it is not able to establish a peer to peer connection for whatever reason\n\nmaybe public IP address is not there, maybe that's a symmetric NAT,\n\nwhatever happens, if that is not something that can be done, then comes something called as a Call Server,\n\nwhich in the WebRTC world is called as a TURN system.\n\nNow, each of them communicate to each other through this TURN Server.\n\nU1 sends a message to TURN Server and this server sends it to U2.\n\nSimilarly, U2 sends a message to this server and this server sends it to U1.\n\nSo, this basically becomes a point which is orchestrating communication between both the parties.\n\nThis is how your regular one-on-one connection or a regular one-on-one video call would work out.\n\nNow, you remember, in the beginning of the call, there was a handshake which talked about what kind of bandwidth requirements we have.\n\nNow, bandwidth is something that is not very constant.\n\nWhile a call is happening, there could be a network that gets choked in between and..\n\nlet's say, U2's network got choked and U2 now wants to support a lower definition video instead of a high definition video\n\nthen, in the middle of the call also, it should be able to talk to U1, again via the WebSocket Handler saying now I don't have enough bandwidth.\n\nMaybe earlier it was supporting a high definition video, but now it wants to support a low definition video.\n\nThose things could be changed in the middle of the call as well, again via the same route of WebSocket Handler and Signalling Service.\n\nNow, each time there is such a change happening in the video call, that does impact the experience, a little bit at least.\n\nAs a person who's made the system, you definitely want to be aware of all such changes.\n\nSo, whenever such a thing happens, Signalling Service would basically put out an event into Kafka.\n\nSo, once Signalling Service puts that event into Kafka saying,  bandwidth was changed,\n\nit can be further used for some kind of processing to figure out how stable the networks are, in which geographies\n\nand based on that, we can make some business decisions.\n\nThat is something that we need to capture.\n\nAlong with that, these devices could send some analytics information along with everything else\n\nlike maybe how frequently the Wi-Fi is changing, what kind of a battery usage is there while being on a video call,\n\nhow much data is being consumed while on the video call.\n\nAll of those details, each of the devices would send to WebSocket Handler\n\nand WebSocket Handler would send to Analytics Service, which is basically, purely a system that is taking inputs for analytics,\n\nAnalytics Service then puts the events into Kafka, which we'll look at later on how can we process.\n\nwe might want to support a recording feature then comes something called as a Logger Service. \nNow, when U1 sends a message to Call Server to send to U2,\n\nCall Server not only sends it to U2 but it also sends to something called as a Logger Service.\n\nSimilarly, when U2 is sending a message to U1 via Call Server,\n\nit will not just send it to U1, but will also send to this Logger Service.\n\nThe Logger Service then basically aggregates all of those small - small chunks of data\n\nand keeps storing that into a distributed file system.\n\nYou can use anything over here. You can use a network file system, or you could use a system\n\nlike S3 or you can just dump it into Hadoop.\n\nYou can use anything over here.\n\nBut the idea is - this Logger Service would be storing all of those small chunks in a permanent data store that is fault tolerant.\n\nNow, it would be here just for a short period of time, till the time the call is active.\n\nOnce the call gets disconnected between U1 and U2, it, via WebSocket Handler,\n\nSignalling Service would get to know that the call has been finished.\n\nSignalling Service would then put an event into Kafka saying the call has been finished,\n\nif somebody needs to do something, go do that.\n\nThen comes something called as a File Creator.\n\nAgain, for a lack of better word, I have called it File Creator.\n\nThe idea of this is - whenever a call is terminated, this File Creator would listen to that event..\n\neach call would have a meeting id kind of a thing..\n\nand File Creator would get to know that this meeting id has terminated.\n\nSimilarly, all the file chunks that were stored in the distributed file system, would also be stored against that meeting id.\n\nSo, this File Creator would basically read all of that data, which is basically all the chunks of that whole\n\nconversation, process them, make a video out of it and store it in another location.\n\nI would want to use an Amazon S3 over here because now we need a fairly distributed store\n\nbecause you don't know how many number of times that video would be seen. So, we can use this over here.\n\nSimilarly, you can use any other standard store as well.\n\nNow, once it has created a file, it can send a notification to the users who are involved in the conversation,\n\nsaying your meeting has been recorded,\n\nhere is the file, here is the link, go access it.\n\nSo, that's how this flow would end.\n\nNow, let's look at how does a group conversation happen.\n\nSo remember, group conversations, we were building them in two modes.\n\nIf there are small number of people like three or four people, we could possibly build a peer to peer communication between all of them.\n\nBut now, each packet of information would be sent to all the users.\n\nThat is one way.\n\nThe other way is through Call Server in case we have more number of users, let's say hundreds of users,\n\nthen, each device talking to hundreds of others, would be too much of a trouble to manage.\n\nSo then, Call Server comes in.\n\nNow, one to one communication is slightly different because you just have two parties.\n\nYou just need to relay the information sent from one party to the other party.\n\nBut a group conversation is slightly tricky. Why? Because there you need to do something called as Transcoding.\n\nIf you have not looked at the video that I have made on Netflix, I would suggest to watch that because that\n\ntalks in much detail about what this transcoding means.\n\nBut the main idea of transcoding is -\n\nif let's say, there is a source video and there are multiple users who are trying to access it.\n\nEach user might be coming from a different kind of a bandwidth availability, different kind of a codec\n\nthat it can support, different kind of a file format that it can support.\n\nSo the idea of transcoding is to convert an original video into multiple such format in which you can\n\nsupport all the devices, having a wide variety of bandwidth ranges, wide variety of bitrates and all of that.\n\nNow, what happens in a group video call -\n\nlet's say there is a user U3 also over here.\n\nNow, this user U3, is having a very, very bad internet connection, and user U1 and U2 want to have a high definition call.\n\nAnd let's say there are hundreds of users let's say, but three for our example. Basic idea is I want to do the conversation through Call Server.\n\nNow, U1 and U2 want to have a high definition call. U3 wants to have a low definition call.\n\nNow, how do you do it?\n\nSo, what happens is - on the packets..\n\nlet's just say U1 is talking about something and that needs to be sent to U2 and U3.\n\nSo, the message would come back to this Call Server from U1.\n\nCall Server knows that U2 is having a high definition ability.\n\nSo, it would send the same package that it got from U1, which was in high definition, directly to U2.\n\nIt also knows that U3 needs to have a low definition video.\n\nSo then, it will call something called as a transcoding service.\n\nNow, this Transcoding Service could physically, from a hardware standpoint, be running on the same machine to minimize the latency.\n\nBut logically, it's a different component.\n\nSo then Call Server talks to Transcoding Service which transcodes the high definition video into a low definition format and sends that to U3.\n\nOn the other side, when U3 is talking about something, U3 anyway would talk in a low definition, right?\n\nSo transcoding can happen just one way.\n\nYou can convert a high definition video into a low definition video, but you cannot convert a low definition video into a high definition video.\n\nSo the video parts that U3 is sending to the Call Server, it knows that it's a low definition video,\n\nI can anyway not convert it into high definition.\n\nIt would send that as it is to U1 and U2.\n\nSo all that intelligence is built within this Call Server\n\nabout each user and what kind of bandwidths and bitrates and all of those things they support.\n\nAnd it would use a cache based on Redis to keep all of that information.\n\nNow, again, when you have a group called, each of them could be having a wide variety of network connectivity.\n\nAnd each of their bandwidth requirement might change during the call.\n\nSo, let's say, U3 started off with a high definition requirement, but in between it wanted to have a low definition requirement.\n\nSomething of that sort could also happen.\n\nSo, again, that communication would happen via Signalling Service and Call Server would get to know that\n\nnow U3 has moved to a low definition mode.\n\nSo, now I need to start using the Transcoding Service.\n\nMaybe earlier it did not have the requirement to do this transcoding.\n\nSo all of those things would be handled by Call Server at runtime.\n\nNow, let's look at the last component, which is basically Analytics.\n\nSo, there's something called as this Analytics Engine which will power all the analytics.\n\nIn the previous sections, we had put in a bunch of events into Kafka.\n\nThis analytics engine, would basically read all of those events and publish some kind of reports.\n\nNow, if you want to do a very simple analytics, like just figuring out how many number of calls happened in a day\n\nor something very trivial like, how many times people generally get dropped off in a call.\n\nSo, if it's a basic set of analytics, then you can basically put all of that information in a time series database and plot some graph on top of it.\n\n\nBut if you want to do some fancy analytics and some really smart things built on top of it,\n\nthen you can use a Hadoop cluster to put all of that data and you can run some Spark jobs to basically do a lot of\n\ndata crunching and publishing out some smarter reports.\n\nNow, let's look at some intelligence that exists within the client.\n\nSo, let's take an example of U1 doing a video conversation with U2.\n\nSo, clients as we know are intelligent enough to identify what all bandwidths they can support,\n\nwhat all bitrates they want to support, what all codecs that they can support and communicate that to the other party.\n\nThey are also intelligent enough to come up with a consensus on what configuration of the communication they would want to support.\n\nNow, let's say U1 and U2 are talking in a peer to peer fashion.\n\nNow, let's just say due to some reason, there is an issue in the network and the call is getting dropped off.\n\nOr let's say the public IP address of one of the users is changing.\n\nIn that scenario, the clients would automatically be able to figure out that this is happening\n\nand they would be intelligent enough to mutually decide that we would now move the call from a peer-to-peer fashion\n\nto something via this Call Server.\n\nAnd this would happen dynamically without users doing something about it.\n\nSo, that level of intelligence also exists within the client.\n\nNow, how would that work?\n\nSo, let's say that these two communicate via this WebSocket Handler and this Signalling Service\n\nand we need to now move the connection to the Call Server.\n\nAnd it need not happen exactly at the same time.\n\nBoth of the clients can move the communication at their own pace to the Call Server.\n\nSo, let's say, U1 first gets to know that we have decided that we'll move the communication to Call Server.\n\nSo, U1 will send all the data to Call Server and Call Server will take care of sending that data to U2.\n\nBut U2 could still be sending the data to U1 directly.\n\nAnd when U2 decides or gets to know that the communication needs to be moved to via this Call Server,\n\nthen U2 could basically follow this new route.\n\nSo, all of that can happen independently and each of the clients can do that at their own pace.\n\nNow, the same thing could happen in a group conversation also.\n\nSo group conversation, if it is happening in a peer-to-peer fashion, the clients or the devices could then decide to move it\n\nto a Call Server, at runtime, if they are having any issues.\n\nNext, let's look at how do we use this system to support a live broadcast of some massive event.\n\n\n\n\nNow, let's just say that there is a big sporting event happening somewhere. Let's just say, for example,\n\na India v/s Pakistan cricket World Cup final. Possibly millions of people would want to watch it.\n\nSo, let's see how can we scale this system to work at that scale where millions of users are trying to watch a livestream.\n\nSo, everything on this side of this red line is outside the scope of the system.\n\nBut this is because it's an input into our system. So that's why, I have put it.\n\nSo, in any kind of an event, whether it be a political event, a sporting event, whatever,\n\nthere would be multiple cameras and multiple audio devices that would be taking inputs.\n\nSo, there could be a bunch of cameras, there could also be a bunch of audio devices.\n\nI'm assuming there is something called as an Input Manager.\n\nIt could be hardware. It could be software which basically aggregates all of that and decides that\n\nwhich camera out of those three or five I want to stream right now, which audio device out of those many, I want to stream right now.\n\nIt then basically send me an audio plus video combination into the system that needs to be streamed.\n\nWe'll try to follow a very similar model that we had for a group conversation, using a Call Server.\n\nNow, this Input Manager basically sends the request to a Call Server saying this is the stream,\n\nnow, send it across to whoever wants to watch it.\n\nNow, the thing with these kind of massive scale live streams is, there are a lot of users on a wide variety of devices.\n\nSo in our example, let's say there are some.. or a lot of users on mobile devices.\n\nThere are a lot of users on TVs.\n\nThere are another lots of users on TVs for example,\n\nand there are a lot of other users on laptops.\n\nSo these are the devices that we want to support.\n\nComing back to this Call Server which got our input stream.\n\nWhat this Call Server will do is - it will basically forward the request to multiple transcoders.\n\nNow, the thing with transcoders is - if it's a good enough hardware and we have one input stream and we want to\n\nconvert that into another output stream of a different format, it can do that in real time.\n\nWhile the stream is coming in, it can transcode it and send it out.\n\nAll we need is - multiple transcoders, which is a function of how many output formats do we want.\n\nLet's say, if in this example we have three kinds of users, we'll possibly have three kind of output formats\n\nand therefore three sets of transcoders.\n\nSo it will send that to all those transcoders, which will then send the transcoded output to a set of Call Servers.\n\nNow, what this Call Server gets is essentially the file format that would be sent out to one type of users.\n\nSo in this case, there are three file formats.\n\nSo there'll be three such Call Servers and three such transcoders. I have made just two for representation purposes.\n\nNow, let's say, this Call Server gets all the data that is to be sent to mobile devices.\n\nIt would then send to multiple Call Servers.\n\nNow, this Call Server is not sending directly to users. Why?\n\nBecause remember, any sporting event would probably be seen by a lot of people in a lot of geographies.\n\nSo, we need a CDN kind of a thing with which we can first distribute in a lot of geographies\n\nand then from those geographies, we can distribute out to multiple users.\n\nKind of taking an inspiration from something that Netflix has done\n\nwherein they put a hardware at a ISP's end and just send that request to the ISP first.\n\nAnd then from ISP, it is sent out to users. So, a very similar approach I'm trying to follow here.\n\nSo, this Call Server would send to multiple such Call Servers and all these servers would be geographically distributed across the globe.\n\nAnd then individual Call Sever will talk to one type of user.\n\nSo, each Call Server.. so, if one Call Server is dedicated for mobile users,\n\nthen it'll talk to thousands of users, but only mobile users so that it can just to work on one stream of data.\n\nIf there are multiple streams, then we'll have to have a lot of logic about\n\nwhich stream to send out to which user, which will complicate the process.\n\nSo, this Server gets all the data, for example, for laptop users so it will send out to all those.\n\nThis Call Server, for example, gets the input stream for TV users. It will stream out to all of those users.\n\nSimilarly, as many number of Call servers as we need, they would send out the payload to the users that they work for.\n\nNow, this management, that needs to be a system that kind of records that which Call Server is talking\n\nto which user, in case there is a downtime on this Call Server, we can bring up another Call Server that can fulfill\n\nthose particular users. So, we can use something like a WebSocket Manager that we have used earlier, to orchestrate\n\nthe communication between these Call Servers.\n\nBut, that's a very minute detail.\n\nSo, I am skipping over that.\n\nNow, the idea is - we want to keep these Call Servers as close to the users as possible because otherwise\n\nif there are a lot of routers in between, all those routers will have to carry the same set of information multiple times.\n\nSo, if this Call Server is close to the users, that latency would be minimized\n\nbecause this is just a couple of hops in between the Call Servers.\n\nBut from Call Sever to users, there could be a lot of hops.\n\nSo, we want to minimize the number of hops over here because this is where the data is getting replicated multiple times.\n\nIf there are more number of hops on this side, data is being sent only once.\n\nSo, that is still okay, if you have a larger path over here.\n\nSo, we'll try to push these servers as close to the users as possible.\n\n",
			"rawText": "\n\nNow, if you look at any videoconferencing platform, they always have a chat system along with that. We can use the same architecture we used for WhatsApp design\n\nU1, wants to initiate a call with a user U2. All live users in the system are connected to one of the WebSocket Handler, similar to WhatsApp.\nThen we have web socket manager who keeps tracks of which user is connected to which web socket handler. Web socket manager sits on top of redis, now redis\nwill not only keep this data inmemory but also flush the info to persistant data store to make it fault tolerant.\n\n\nuser U1 wants to initiate a call with user U2. It makes a call to WebSocket Handler, which basically calls something called as a Signalling Service.\nSignalling Service is the one that initiates the conversation between two parties.\nIt will also have some policies, which will check for certain conditions. So, let's say, if you have something like a Facebook and you want to put a restriction saying, \nif you are not friends, then you cannot make a video call between two parties or to a user, then all of those things would sit within Signalling Service.\nIt would also use User Service, a repository of all the users in the system to power such functionalities.\nNow, if there's something like Zoom, such a thing would not exist because there is a concept of guest user in Zoom.\n\n\nNow, Signalling Service will basically talk to U2 and basically tell the WebSocket Handler of U2 to ask U2, if U2 wants to accept the call or not.\nIf U2 rejects the call or if U2 is offline, then it can be handled in certain ways.\nBut if let's say U2 accepts the call, then Signalling Server basically informs U1 that U2 has accepted your call.\nNow we can initiate the conversation.\nThen comes something called as a Connector.\nSo, all of the users will talk to all of these components.\nI have not drawn the arrows because that will clutter the diagram.\nBut now at this point, what happens is - both U1 and U2 talk to this Connector component.\nRemember the connector component in the previous segment, which was also called as the STUN Server in the WebRTC world.\nSo, this component is responsible for telling each of the parties about their publicly accessible IP addresses.\nNow, through Connector, they'll get to know their public IP address.\nAnd again, through this similar WebSocket Handler via Signalling Server, they would communicate these two things to each other,\nsaying my IP address is this, my IP address is that.\nNow both of them know each other's IP addresses.\nThen, they will also do another handshake which talks about what kind of a bitrate they can support,\nwhat kind of codec they can support, what kind of bandwidth they have available.\nSo, all of those information would also be shared, again via WebSocket Handler.\nOnce that thing is established between both the parties, then they can start with the communication.\nBasically then a regular peer to peer connection is established between U1 and U2\nand they can start sending packets to each other and continue with the video call.\nNow, the way video call would actually work\nis those videos would not be bigger chunks like five - five seconds each.\n\nIn this scenario, we'll use much smaller chunks, which is of a few milliseconds kind of a thing,\n\nor maybe one-fourth of a second or one-fifth of a second, something of that sort\n\nand those big chunks would be sent across to each other\n\nso that the experience is nearly seamless.\n\nAnd it looks more of a real time thing.\n\nNow, let's just say, it is not able to establish a peer to peer connection for whatever reason\n\nmaybe public IP address is not there, maybe that's a symmetric NAT,\n\nwhatever happens, if that is not something that can be done, then comes something called as a Call Server,\n\nwhich in the WebRTC world is called as a TURN system.\n\nNow, each of them communicate to each other through this TURN Server.\n\nU1 sends a message to TURN Server and this server sends it to U2.\n\nSimilarly, U2 sends a message to this server and this server sends it to U1.\n\nSo, this basically becomes a point which is orchestrating communication between both the parties.\n\nThis is how your regular one-on-one connection or a regular one-on-one video call would work out.\n\nNow, you remember, in the beginning of the call, there was a handshake which talked about what kind of bandwidth requirements we have.\n\nNow, bandwidth is something that is not very constant.\n\nWhile a call is happening, there could be a network that gets choked in between and..\n\nlet's say, U2's network got choked and U2 now wants to support a lower definition video instead of a high definition video\n\nthen, in the middle of the call also, it should be able to talk to U1, again via the WebSocket Handler saying now I don't have enough bandwidth.\n\nMaybe earlier it was supporting a high definition video, but now it wants to support a low definition video.\n\nThose things could be changed in the middle of the call as well, again via the same route of WebSocket Handler and Signalling Service.\n\nNow, each time there is such a change happening in the video call, that does impact the experience, a little bit at least.\n\nAs a person who's made the system, you definitely want to be aware of all such changes.\n\nSo, whenever such a thing happens, Signalling Service would basically put out an event into Kafka.\n\nSo, once Signalling Service puts that event into Kafka saying,  bandwidth was changed,\n\nit can be further used for some kind of processing to figure out how stable the networks are, in which geographies\n\nand based on that, we can make some business decisions.\n\nThat is something that we need to capture.\n\nAlong with that, these devices could send some analytics information along with everything else\n\nlike maybe how frequently the Wi-Fi is changing, what kind of a battery usage is there while being on a video call,\n\nhow much data is being consumed while on the video call.\n\nAll of those details, each of the devices would send to WebSocket Handler\n\nand WebSocket Handler would send to Analytics Service, which is basically, purely a system that is taking inputs for analytics,\n\nAnalytics Service then puts the events into Kafka, which we'll look at later on how can we process.\n\nwe might want to support a recording feature then comes something called as a Logger Service. \nNow, when U1 sends a message to Call Server to send to U2,\n\nCall Server not only sends it to U2 but it also sends to something called as a Logger Service.\n\nSimilarly, when U2 is sending a message to U1 via Call Server,\n\nit will not just send it to U1, but will also send to this Logger Service.\n\nThe Logger Service then basically aggregates all of those small - small chunks of data\n\nand keeps storing that into a distributed file system.\n\nYou can use anything over here. You can use a network file system, or you could use a system\n\nlike S3 or you can just dump it into Hadoop.\n\nYou can use anything over here.\n\nBut the idea is - this Logger Service would be storing all of those small chunks in a permanent data store that is fault tolerant.\n\nNow, it would be here just for a short period of time, till the time the call is active.\n\nOnce the call gets disconnected between U1 and U2, it, via WebSocket Handler,\n\nSignalling Service would get to know that the call has been finished.\n\nSignalling Service would then put an event into Kafka saying the call has been finished,\n\nif somebody needs to do something, go do that.\n\nThen comes something called as a File Creator.\n\nAgain, for a lack of better word, I have called it File Creator.\n\nThe idea of this is - whenever a call is terminated, this File Creator would listen to that event..\n\neach call would have a meeting id kind of a thing..\n\nand File Creator would get to know that this meeting id has terminated.\n\nSimilarly, all the file chunks that were stored in the distributed file system, would also be stored against that meeting id.\n\nSo, this File Creator would basically read all of that data, which is basically all the chunks of that whole\n\nconversation, process them, make a video out of it and store it in another location.\n\nI would want to use an Amazon S3 over here because now we need a fairly distributed store\n\nbecause you don't know how many number of times that video would be seen. So, we can use this over here.\n\nSimilarly, you can use any other standard store as well.\n\nNow, once it has created a file, it can send a notification to the users who are involved in the conversation,\n\nsaying your meeting has been recorded,\n\nhere is the file, here is the link, go access it.\n\nSo, that's how this flow would end.\n\nNow, let's look at how does a group conversation happen.\n\nSo remember, group conversations, we were building them in two modes.\n\nIf there are small number of people like three or four people, we could possibly build a peer to peer communication between all of them.\n\nBut now, each packet of information would be sent to all the users.\n\nThat is one way.\n\nThe other way is through Call Server in case we have more number of users, let's say hundreds of users,\n\nthen, each device talking to hundreds of others, would be too much of a trouble to manage.\n\nSo then, Call Server comes in.\n\nNow, one to one communication is slightly different because you just have two parties.\n\nYou just need to relay the information sent from one party to the other party.\n\nBut a group conversation is slightly tricky. Why? Because there you need to do something called as Transcoding.\n\nIf you have not looked at the video that I have made on Netflix, I would suggest to watch that because that\n\ntalks in much detail about what this transcoding means.\n\nBut the main idea of transcoding is -\n\nif let's say, there is a source video and there are multiple users who are trying to access it.\n\nEach user might be coming from a different kind of a bandwidth availability, different kind of a codec\n\nthat it can support, different kind of a file format that it can support.\n\nSo the idea of transcoding is to convert an original video into multiple such format in which you can\n\nsupport all the devices, having a wide variety of bandwidth ranges, wide variety of bitrates and all of that.\n\nNow, what happens in a group video call -\n\nlet's say there is a user U3 also over here.\n\nNow, this user U3, is having a very, very bad internet connection, and user U1 and U2 want to have a high definition call.\n\nAnd let's say there are hundreds of users let's say, but three for our example. Basic idea is I want to do the conversation through Call Server.\n\nNow, U1 and U2 want to have a high definition call. U3 wants to have a low definition call.\n\nNow, how do you do it?\n\nSo, what happens is - on the packets..\n\nlet's just say U1 is talking about something and that needs to be sent to U2 and U3.\n\nSo, the message would come back to this Call Server from U1.\n\nCall Server knows that U2 is having a high definition ability.\n\nSo, it would send the same package that it got from U1, which was in high definition, directly to U2.\n\nIt also knows that U3 needs to have a low definition video.\n\nSo then, it will call something called as a transcoding service.\n\nNow, this Transcoding Service could physically, from a hardware standpoint, be running on the same machine to minimize the latency.\n\nBut logically, it's a different component.\n\nSo then Call Server talks to Transcoding Service which transcodes the high definition video into a low definition format and sends that to U3.\n\nOn the other side, when U3 is talking about something, U3 anyway would talk in a low definition, right?\n\nSo transcoding can happen just one way.\n\nYou can convert a high definition video into a low definition video, but you cannot convert a low definition video into a high definition video.\n\nSo the video parts that U3 is sending to the Call Server, it knows that it's a low definition video,\n\nI can anyway not convert it into high definition.\n\nIt would send that as it is to U1 and U2.\n\nSo all that intelligence is built within this Call Server\n\nabout each user and what kind of bandwidths and bitrates and all of those things they support.\n\nAnd it would use a cache based on Redis to keep all of that information.\n\nNow, again, when you have a group called, each of them could be having a wide variety of network connectivity.\n\nAnd each of their bandwidth requirement might change during the call.\n\nSo, let's say, U3 started off with a high definition requirement, but in between it wanted to have a low definition requirement.\n\nSomething of that sort could also happen.\n\nSo, again, that communication would happen via Signalling Service and Call Server would get to know that\n\nnow U3 has moved to a low definition mode.\n\nSo, now I need to start using the Transcoding Service.\n\nMaybe earlier it did not have the requirement to do this transcoding.\n\nSo all of those things would be handled by Call Server at runtime.\n\nNow, let's look at the last component, which is basically Analytics.\n\nSo, there's something called as this Analytics Engine which will power all the analytics.\n\nIn the previous sections, we had put in a bunch of events into Kafka.\n\nThis analytics engine, would basically read all of those events and publish some kind of reports.\n\nNow, if you want to do a very simple analytics, like just figuring out how many number of calls happened in a day\n\nor something very trivial like, how many times people generally get dropped off in a call.\n\nSo, if it's a basic set of analytics, then you can basically put all of that information in a time series database and plot some graph on top of it.\n\n\nBut if you want to do some fancy analytics and some really smart things built on top of it,\n\nthen you can use a Hadoop cluster to put all of that data and you can run some Spark jobs to basically do a lot of\n\ndata crunching and publishing out some smarter reports.\n\nNow, let's look at some intelligence that exists within the client.\n\nSo, let's take an example of U1 doing a video conversation with U2.\n\nSo, clients as we know are intelligent enough to identify what all bandwidths they can support,\n\nwhat all bitrates they want to support, what all codecs that they can support and communicate that to the other party.\n\nThey are also intelligent enough to come up with a consensus on what configuration of the communication they would want to support.\n\nNow, let's say U1 and U2 are talking in a peer to peer fashion.\n\nNow, let's just say due to some reason, there is an issue in the network and the call is getting dropped off.\n\nOr let's say the public IP address of one of the users is changing.\n\nIn that scenario, the clients would automatically be able to figure out that this is happening\n\nand they would be intelligent enough to mutually decide that we would now move the call from a peer-to-peer fashion\n\nto something via this Call Server.\n\nAnd this would happen dynamically without users doing something about it.\n\nSo, that level of intelligence also exists within the client.\n\nNow, how would that work?\n\nSo, let's say that these two communicate via this WebSocket Handler and this Signalling Service\n\nand we need to now move the connection to the Call Server.\n\nAnd it need not happen exactly at the same time.\n\nBoth of the clients can move the communication at their own pace to the Call Server.\n\nSo, let's say, U1 first gets to know that we have decided that we'll move the communication to Call Server.\n\nSo, U1 will send all the data to Call Server and Call Server will take care of sending that data to U2.\n\nBut U2 could still be sending the data to U1 directly.\n\nAnd when U2 decides or gets to know that the communication needs to be moved to via this Call Server,\n\nthen U2 could basically follow this new route.\n\nSo, all of that can happen independently and each of the clients can do that at their own pace.\n\nNow, the same thing could happen in a group conversation also.\n\nSo group conversation, if it is happening in a peer-to-peer fashion, the clients or the devices could then decide to move it\n\nto a Call Server, at runtime, if they are having any issues.\n\nNext, let's look at how do we use this system to support a live broadcast of some massive event.\n\n\n\n\nNow, let's just say that there is a big sporting event happening somewhere. Let's just say, for example,\n\na India v/s Pakistan cricket World Cup final. Possibly millions of people would want to watch it.\n\nSo, let's see how can we scale this system to work at that scale where millions of users are trying to watch a livestream.\n\nSo, everything on this side of this red line is outside the scope of the system.\n\nBut this is because it's an input into our system. So that's why, I have put it.\n\nSo, in any kind of an event, whether it be a political event, a sporting event, whatever,\n\nthere would be multiple cameras and multiple audio devices that would be taking inputs.\n\nSo, there could be a bunch of cameras, there could also be a bunch of audio devices.\n\nI'm assuming there is something called as an Input Manager.\n\nIt could be hardware. It could be software which basically aggregates all of that and decides that\n\nwhich camera out of those three or five I want to stream right now, which audio device out of those many, I want to stream right now.\n\nIt then basically send me an audio plus video combination into the system that needs to be streamed.\n\nWe'll try to follow a very similar model that we had for a group conversation, using a Call Server.\n\nNow, this Input Manager basically sends the request to a Call Server saying this is the stream,\n\nnow, send it across to whoever wants to watch it.\n\nNow, the thing with these kind of massive scale live streams is, there are a lot of users on a wide variety of devices.\n\nSo in our example, let's say there are some.. or a lot of users on mobile devices.\n\nThere are a lot of users on TVs.\n\nThere are another lots of users on TVs for example,\n\nand there are a lot of other users on laptops.\n\nSo these are the devices that we want to support.\n\nComing back to this Call Server which got our input stream.\n\nWhat this Call Server will do is - it will basically forward the request to multiple transcoders.\n\nNow, the thing with transcoders is - if it's a good enough hardware and we have one input stream and we want to\n\nconvert that into another output stream of a different format, it can do that in real time.\n\nWhile the stream is coming in, it can transcode it and send it out.\n\nAll we need is - multiple transcoders, which is a function of how many output formats do we want.\n\nLet's say, if in this example we have three kinds of users, we'll possibly have three kind of output formats\n\nand therefore three sets of transcoders.\n\nSo it will send that to all those transcoders, which will then send the transcoded output to a set of Call Servers.\n\nNow, what this Call Server gets is essentially the file format that would be sent out to one type of users.\n\nSo in this case, there are three file formats.\n\nSo there'll be three such Call Servers and three such transcoders. I have made just two for representation purposes.\n\nNow, let's say, this Call Server gets all the data that is to be sent to mobile devices.\n\nIt would then send to multiple Call Servers.\n\nNow, this Call Server is not sending directly to users. Why?\n\nBecause remember, any sporting event would probably be seen by a lot of people in a lot of geographies.\n\nSo, we need a CDN kind of a thing with which we can first distribute in a lot of geographies\n\nand then from those geographies, we can distribute out to multiple users.\n\nKind of taking an inspiration from something that Netflix has done\n\nwherein they put a hardware at a ISP's end and just send that request to the ISP first.\n\nAnd then from ISP, it is sent out to users. So, a very similar approach I'm trying to follow here.\n\nSo, this Call Server would send to multiple such Call Servers and all these servers would be geographically distributed across the globe.\n\nAnd then individual Call Sever will talk to one type of user.\n\nSo, each Call Server.. so, if one Call Server is dedicated for mobile users,\n\nthen it'll talk to thousands of users, but only mobile users so that it can just to work on one stream of data.\n\nIf there are multiple streams, then we'll have to have a lot of logic about\n\nwhich stream to send out to which user, which will complicate the process.\n\nSo, this Server gets all the data, for example, for laptop users so it will send out to all those.\n\nThis Call Server, for example, gets the input stream for TV users. It will stream out to all of those users.\n\nSimilarly, as many number of Call servers as we need, they would send out the payload to the users that they work for.\n\nNow, this management, that needs to be a system that kind of records that which Call Server is talking\n\nto which user, in case there is a downtime on this Call Server, we can bring up another Call Server that can fulfill\n\nthose particular users. So, we can use something like a WebSocket Manager that we have used earlier, to orchestrate\n\nthe communication between these Call Servers.\n\nBut, that's a very minute detail.\n\nSo, I am skipping over that.\n\nNow, the idea is - we want to keep these Call Servers as close to the users as possible because otherwise\n\nif there are a lot of routers in between, all those routers will have to carry the same set of information multiple times.\n\nSo, if this Call Server is close to the users, that latency would be minimized\n\nbecause this is just a couple of hops in between the Call Servers.\n\nBut from Call Sever to users, there could be a lot of hops.\n\nSo, we want to minimize the number of hops over here because this is where the data is getting replicated multiple times.\n\nIf there are more number of hops on this side, data is being sent only once.\n\nSo, that is still okay, if you have a larger path over here.\n\nSo, we'll try to push these servers as close to the users as possible.\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "\n\nNow, if you look at any videoconferencing platform, they always have a chat system along with that. We can use the same architecture we used for WhatsApp design\n\nU1, wants to initiate a call with a user U2. All live users in the system are connected to one of the WebSocket Handler, similar to WhatsApp.\nThen we have web socket manager who keeps tracks of which user is connected to which web socket handler. Web socket manager sits on top of redis, now redis\nwill not only keep this data inmemory but also flush the info to persistant data store to make it fault tolerant.\n\n\nuser U1 wants to initiate a call with user U2. It makes a call to WebSocket Handler, which basically calls something called as a Signalling Service.\nSignalling Service is the one that initiates the conversation between two parties.\nIt will also have some policies, which will check for certain conditions. So, let's say, if you have something like a Facebook and you want to put a restriction saying, \nif you are not friends, then you cannot make a video call between two parties or to a user, then all of those things would sit within Signalling Service.\nIt would also use User Service, a repository of all the users in the system to power such functionalities.\nNow, if there's something like Zoom, such a thing would not exist because there is a concept of guest user in Zoom.\n\n\nNow, Signalling Service will basically talk to U2 and basically tell the WebSocket Handler of U2 to ask U2, if U2 wants to accept the call or not.\nIf U2 rejects the call or if U2 is offline, then it can be handled in certain ways.\nBut if let's say U2 accepts the call, then Signalling Server basically informs U1 that U2 has accepted your call.\nNow we can initiate the conversation.\nThen comes something called as a Connector.\nSo, all of the users will talk to all of these components.\nI have not drawn the arrows because that will clutter the diagram.\nBut now at this point, what happens is - both U1 and U2 talk to this Connector component.\nRemember the connector component in the previous segment, which was also called as the STUN Server in the WebRTC world.\nSo, this component is responsible for telling each of the parties about their publicly accessible IP addresses.\nNow, through Connector, they'll get to know their public IP address.\nAnd again, through this similar WebSocket Handler via Signalling Server, they would communicate these two things to each other,\nsaying my IP address is this, my IP address is that.\nNow both of them know each other's IP addresses.\nThen, they will also do another handshake which talks about what kind of a bitrate they can support,\nwhat kind of codec they can support, what kind of bandwidth they have available.\nSo, all of those information would also be shared, again via WebSocket Handler.\nOnce that thing is established between both the parties, then they can start with the communication.\nBasically then a regular peer to peer connection is established between U1 and U2\nand they can start sending packets to each other and continue with the video call.\nNow, the way video call would actually work\nis those videos would not be bigger chunks like five - five seconds each.\n\nIn this scenario, we'll use much smaller chunks, which is of a few milliseconds kind of a thing,\n\nor maybe one-fourth of a second or one-fifth of a second, something of that sort\n\nand those big chunks would be sent across to each other\n\nso that the experience is nearly seamless.\n\nAnd it looks more of a real time thing.\n\nNow, let's just say, it is not able to establish a peer to peer connection for whatever reason\n\nmaybe public IP address is not there, maybe that's a symmetric NAT,\n\nwhatever happens, if that is not something that can be done, then comes something called as a Call Server,\n\nwhich in the WebRTC world is called as a TURN system.\n\nNow, each of them communicate to each other through this TURN Server.\n\nU1 sends a message to TURN Server and this server sends it to U2.\n\nSimilarly, U2 sends a message to this server and this server sends it to U1.\n\nSo, this basically becomes a point which is orchestrating communication between both the parties.\n\nThis is how your regular one-on-one connection or a regular one-on-one video call would work out.\n\nNow, you remember, in the beginning of the call, there was a handshake which talked about what kind of bandwidth requirements we have.\n\nNow, bandwidth is something that is not very constant.\n\nWhile a call is happening, there could be a network that gets choked in between and..\n\nlet's say, U2's network got choked and U2 now wants to support a lower definition video instead of a high definition video\n\nthen, in the middle of the call also, it should be able to talk to U1, again via the WebSocket Handler saying now I don't have enough bandwidth.\n\nMaybe earlier it was supporting a high definition video, but now it wants to support a low definition video.\n\nThose things could be changed in the middle of the call as well, again via the same route of WebSocket Handler and Signalling Service.\n\nNow, each time there is such a change happening in the video call, that does impact the experience, a little bit at least.\n\nAs a person who's made the system, you definitely want to be aware of all such changes.\n\nSo, whenever such a thing happens, Signalling Service would basically put out an event into Kafka.\n\nSo, once Signalling Service puts that event into Kafka saying,  bandwidth was changed,\n\nit can be further used for some kind of processing to figure out how stable the networks are, in which geographies\n\nand based on that, we can make some business decisions.\n\nThat is something that we need to capture.\n\nAlong with that, these devices could send some analytics information along with everything else\n\nlike maybe how frequently the Wi-Fi is changing, what kind of a battery usage is there while being on a video call,\n\nhow much data is being consumed while on the video call.\n\nAll of those details, each of the devices would send to WebSocket Handler\n\nand WebSocket Handler would send to Analytics Service, which is basically, purely a system that is taking inputs for analytics,\n\nAnalytics Service then puts the events into Kafka, which we'll look at later on how can we process.\n\nwe might want to support a recording feature then comes something called as a Logger Service. \nNow, when U1 sends a message to Call Server to send to U2,\n\nCall Server not only sends it to U2 but it also sends to something called as a Logger Service.\n\nSimilarly, when U2 is sending a message to U1 via Call Server,\n\nit will not just send it to U1, but will also send to this Logger Service.\n\nThe Logger Service then basically aggregates all of those small - small chunks of data\n\nand keeps storing that into a distributed file system.\n\nYou can use anything over here. You can use a network file system, or you could use a system\n\nlike S3 or you can just dump it into Hadoop.\n\nYou can use anything over here.\n\nBut the idea is - this Logger Service would be storing all of those small chunks in a permanent data store that is fault tolerant.\n\nNow, it would be here just for a short period of time, till the time the call is active.\n\nOnce the call gets disconnected between U1 and U2, it, via WebSocket Handler,\n\nSignalling Service would get to know that the call has been finished.\n\nSignalling Service would then put an event into Kafka saying the call has been finished,\n\nif somebody needs to do something, go do that.\n\nThen comes something called as a File Creator.\n\nAgain, for a lack of better word, I have called it File Creator.\n\nThe idea of this is - whenever a call is terminated, this File Creator would listen to that event..\n\neach call would have a meeting id kind of a thing..\n\nand File Creator would get to know that this meeting id has terminated.\n\nSimilarly, all the file chunks that were stored in the distributed file system, would also be stored against that meeting id.\n\nSo, this File Creator would basically read all of that data, which is basically all the chunks of that whole\n\nconversation, process them, make a video out of it and store it in another location.\n\nI would want to use an Amazon S3 over here because now we need a fairly distributed store\n\nbecause you don't know how many number of times that video would be seen. So, we can use this over here.\n\nSimilarly, you can use any other standard store as well.\n\nNow, once it has created a file, it can send a notification to the users who are involved in the conversation,\n\nsaying your meeting has been recorded,\n\nhere is the file, here is the link, go access it.\n\nSo, that's how this flow would end.\n\nNow, let's look at how does a group conversation happen.\n\nSo remember, group conversations, we were building them in two modes.\n\nIf there are small number of people like three or four people, we could possibly build a peer to peer communication between all of them.\n\nBut now, each packet of information would be sent to all the users.\n\nThat is one way.\n\nThe other way is through Call Server in case we have more number of users, let's say hundreds of users,\n\nthen, each device talking to hundreds of others, would be too much of a trouble to manage.\n\nSo then, Call Server comes in.\n\nNow, one to one communication is slightly different because you just have two parties.\n\nYou just need to relay the information sent from one party to the other party.\n\nBut a group conversation is slightly tricky. Why? Because there you need to do something called as Transcoding.\n\nIf you have not looked at the video that I have made on Netflix, I would suggest to watch that because that\n\ntalks in much detail about what this transcoding means.\n\nBut the main idea of transcoding is -\n\nif let's say, there is a source video and there are multiple users who are trying to access it.\n\nEach user might be coming from a different kind of a bandwidth availability, different kind of a codec\n\nthat it can support, different kind of a file format that it can support.\n\nSo the idea of transcoding is to convert an original video into multiple such format in which you can\n\nsupport all the devices, having a wide variety of bandwidth ranges, wide variety of bitrates and all of that.\n\nNow, what happens in a group video call -\n\nlet's say there is a user U3 also over here.\n\nNow, this user U3, is having a very, very bad internet connection, and user U1 and U2 want to have a high definition call.\n\nAnd let's say there are hundreds of users let's say, but three for our example. Basic idea is I want to do the conversation through Call Server.\n\nNow, U1 and U2 want to have a high definition call. U3 wants to have a low definition call.\n\nNow, how do you do it?\n\nSo, what happens is - on the packets..\n\nlet's just say U1 is talking about something and that needs to be sent to U2 and U3.\n\nSo, the message would come back to this Call Server from U1.\n\nCall Server knows that U2 is having a high definition ability.\n\nSo, it would send the same package that it got from U1, which was in high definition, directly to U2.\n\nIt also knows that U3 needs to have a low definition video.\n\nSo then, it will call something called as a transcoding service.\n\nNow, this Transcoding Service could physically, from a hardware standpoint, be running on the same machine to minimize the latency.\n\nBut logically, it's a different component.\n\nSo then Call Server talks to Transcoding Service which transcodes the high definition video into a low definition format and sends that to U3.\n\nOn the other side, when U3 is talking about something, U3 anyway would talk in a low definition, right?\n\nSo transcoding can happen just one way.\n\nYou can convert a high definition video into a low definition video, but you cannot convert a low definition video into a high definition video.\n\nSo the video parts that U3 is sending to the Call Server, it knows that it's a low definition video,\n\nI can anyway not convert it into high definition.\n\nIt would send that as it is to U1 and U2.\n\nSo all that intelligence is built within this Call Server\n\nabout each user and what kind of bandwidths and bitrates and all of those things they support.\n\nAnd it would use a cache based on Redis to keep all of that information.\n\nNow, again, when you have a group called, each of them could be having a wide variety of network connectivity.\n\nAnd each of their bandwidth requirement might change during the call.\n\nSo, let's say, U3 started off with a high definition requirement, but in between it wanted to have a low definition requirement.\n\nSomething of that sort could also happen.\n\nSo, again, that communication would happen via Signalling Service and Call Server would get to know that\n\nnow U3 has moved to a low definition mode.\n\nSo, now I need to start using the Transcoding Service.\n\nMaybe earlier it did not have the requirement to do this transcoding.\n\nSo all of those things would be handled by Call Server at runtime.\n\nNow, let's look at the last component, which is basically Analytics.\n\nSo, there's something called as this Analytics Engine which will power all the analytics.\n\nIn the previous sections, we had put in a bunch of events into Kafka.\n\nThis analytics engine, would basically read all of those events and publish some kind of reports.\n\nNow, if you want to do a very simple analytics, like just figuring out how many number of calls happened in a day\n\nor something very trivial like, how many times people generally get dropped off in a call.\n\nSo, if it's a basic set of analytics, then you can basically put all of that information in a time series database and plot some graph on top of it.\n\n\nBut if you want to do some fancy analytics and some really smart things built on top of it,\n\nthen you can use a Hadoop cluster to put all of that data and you can run some Spark jobs to basically do a lot of\n\ndata crunching and publishing out some smarter reports.\n\nNow, let's look at some intelligence that exists within the client.\n\nSo, let's take an example of U1 doing a video conversation with U2.\n\nSo, clients as we know are intelligent enough to identify what all bandwidths they can support,\n\nwhat all bitrates they want to support, what all codecs that they can support and communicate that to the other party.\n\nThey are also intelligent enough to come up with a consensus on what configuration of the communication they would want to support.\n\nNow, let's say U1 and U2 are talking in a peer to peer fashion.\n\nNow, let's just say due to some reason, there is an issue in the network and the call is getting dropped off.\n\nOr let's say the public IP address of one of the users is changing.\n\nIn that scenario, the clients would automatically be able to figure out that this is happening\n\nand they would be intelligent enough to mutually decide that we would now move the call from a peer-to-peer fashion\n\nto something via this Call Server.\n\nAnd this would happen dynamically without users doing something about it.\n\nSo, that level of intelligence also exists within the client.\n\nNow, how would that work?\n\nSo, let's say that these two communicate via this WebSocket Handler and this Signalling Service\n\nand we need to now move the connection to the Call Server.\n\nAnd it need not happen exactly at the same time.\n\nBoth of the clients can move the communication at their own pace to the Call Server.\n\nSo, let's say, U1 first gets to know that we have decided that we'll move the communication to Call Server.\n\nSo, U1 will send all the data to Call Server and Call Server will take care of sending that data to U2.\n\nBut U2 could still be sending the data to U1 directly.\n\nAnd when U2 decides or gets to know that the communication needs to be moved to via this Call Server,\n\nthen U2 could basically follow this new route.\n\nSo, all of that can happen independently and each of the clients can do that at their own pace.\n\nNow, the same thing could happen in a group conversation also.\n\nSo group conversation, if it is happening in a peer-to-peer fashion, the clients or the devices could then decide to move it\n\nto a Call Server, at runtime, if they are having any issues.\n\nNext, let's look at how do we use this system to support a live broadcast of some massive event.\n\n\n\n\nNow, let's just say that there is a big sporting event happening somewhere. Let's just say, for example,\n\na India v/s Pakistan cricket World Cup final. Possibly millions of people would want to watch it.\n\nSo, let's see how can we scale this system to work at that scale where millions of users are trying to watch a livestream.\n\nSo, everything on this side of this red line is outside the scope of the system.\n\nBut this is because it's an input into our system. So that's why, I have put it.\n\nSo, in any kind of an event, whether it be a political event, a sporting event, whatever,\n\nthere would be multiple cameras and multiple audio devices that would be taking inputs.\n\nSo, there could be a bunch of cameras, there could also be a bunch of audio devices.\n\nI'm assuming there is something called as an Input Manager.\n\nIt could be hardware. It could be software which basically aggregates all of that and decides that\n\nwhich camera out of those three or five I want to stream right now, which audio device out of those many, I want to stream right now.\n\nIt then basically send me an audio plus video combination into the system that needs to be streamed.\n\nWe'll try to follow a very similar model that we had for a group conversation, using a Call Server.\n\nNow, this Input Manager basically sends the request to a Call Server saying this is the stream,\n\nnow, send it across to whoever wants to watch it.\n\nNow, the thing with these kind of massive scale live streams is, there are a lot of users on a wide variety of devices.\n\nSo in our example, let's say there are some.. or a lot of users on mobile devices.\n\nThere are a lot of users on TVs.\n\nThere are another lots of users on TVs for example,\n\nand there are a lot of other users on laptops.\n\nSo these are the devices that we want to support.\n\nComing back to this Call Server which got our input stream.\n\nWhat this Call Server will do is - it will basically forward the request to multiple transcoders.\n\nNow, the thing with transcoders is - if it's a good enough hardware and we have one input stream and we want to\n\nconvert that into another output stream of a different format, it can do that in real time.\n\nWhile the stream is coming in, it can transcode it and send it out.\n\nAll we need is - multiple transcoders, which is a function of how many output formats do we want.\n\nLet's say, if in this example we have three kinds of users, we'll possibly have three kind of output formats\n\nand therefore three sets of transcoders.\n\nSo it will send that to all those transcoders, which will then send the transcoded output to a set of Call Servers.\n\nNow, what this Call Server gets is essentially the file format that would be sent out to one type of users.\n\nSo in this case, there are three file formats.\n\nSo there'll be three such Call Servers and three such transcoders. I have made just two for representation purposes.\n\nNow, let's say, this Call Server gets all the data that is to be sent to mobile devices.\n\nIt would then send to multiple Call Servers.\n\nNow, this Call Server is not sending directly to users. Why?\n\nBecause remember, any sporting event would probably be seen by a lot of people in a lot of geographies.\n\nSo, we need a CDN kind of a thing with which we can first distribute in a lot of geographies\n\nand then from those geographies, we can distribute out to multiple users.\n\nKind of taking an inspiration from something that Netflix has done\n\nwherein they put a hardware at a ISP's end and just send that request to the ISP first.\n\nAnd then from ISP, it is sent out to users. So, a very similar approach I'm trying to follow here.\n\nSo, this Call Server would send to multiple such Call Servers and all these servers would be geographically distributed across the globe.\n\nAnd then individual Call Sever will talk to one type of user.\n\nSo, each Call Server.. so, if one Call Server is dedicated for mobile users,\n\nthen it'll talk to thousands of users, but only mobile users so that it can just to work on one stream of data.\n\nIf there are multiple streams, then we'll have to have a lot of logic about\n\nwhich stream to send out to which user, which will complicate the process.\n\nSo, this Server gets all the data, for example, for laptop users so it will send out to all those.\n\nThis Call Server, for example, gets the input stream for TV users. It will stream out to all of those users.\n\nSimilarly, as many number of Call servers as we need, they would send out the payload to the users that they work for.\n\nNow, this management, that needs to be a system that kind of records that which Call Server is talking\n\nto which user, in case there is a downtime on this Call Server, we can bring up another Call Server that can fulfill\n\nthose particular users. So, we can use something like a WebSocket Manager that we have used earlier, to orchestrate\n\nthe communication between these Call Servers.\n\nBut, that's a very minute detail.\n\nSo, I am skipping over that.\n\nNow, the idea is - we want to keep these Call Servers as close to the users as possible because otherwise\n\nif there are a lot of routers in between, all those routers will have to carry the same set of information multiple times.\n\nSo, if this Call Server is close to the users, that latency would be minimized\n\nbecause this is just a couple of hops in between the Call Servers.\n\nBut from Call Sever to users, there could be a lot of hops.\n\nSo, we want to minimize the number of hops over here because this is where the data is getting replicated multiple times.\n\nIf there are more number of hops on this side, data is being sent only once.\n\nSo, that is still okay, if you have a larger path over here.\n\nSo, we'll try to push these servers as close to the users as possible.\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 34,
			"versionNonce": 515232000,
			"isDeleted": false,
			"id": "zeVm_nz5wkOtO_1tq-QSb",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 26804.85514200394,
			"y": 19103.41789871028,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1111,
			"height": 503,
			"seed": 777748224,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718426266691,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "6143fc669f356267e04dc77a23ad2235aeaaa52e",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 113,
			"versionNonce": 1413402880,
			"isDeleted": false,
			"id": "Fbm0t2fW",
			"fillStyle": "solid",
			"strokeWidth": 0.5,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 27051.730474497286,
			"y": 19059.764879105845,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 574.21875,
			"height": 24,
			"seed": 859561728,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718426295466,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "platform for live streaming to millions of users.",
			"rawText": "platform for live streaming to millions of users.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "platform for live streaming to millions of users.",
			"lineHeight": 1.2
		},
		{
			"type": "rectangle",
			"version": 613,
			"versionNonce": 1212872316,
			"isDeleted": false,
			"id": "xABIffHG_G0AwwtlIXL99",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28780.37515638074,
			"y": -359.5791263084193,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 2349.0055144540192,
			"height": 21012.31627985051,
			"seed": 161722624,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718693504793,
			"link": null,
			"locked": false
		},
		{
			"type": "text",
			"version": 19,
			"versionNonce": 962171136,
			"isDeleted": false,
			"id": "3PYrazsY",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28822.727841156273,
			"y": -326.8265394354539,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 128.90625,
			"height": 96,
			"seed": 2106695424,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718528572321,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "google maps\n\nFR\n",
			"rawText": "google maps\n\nFR\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "google maps\n\nFR\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 47,
			"versionNonce": 2081657088,
			"isDeleted": false,
			"id": "DnWWbn_PYVUKNRAqFKkvq",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28816.11157272278,
			"y": -226.9166306558534,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 466,
			"height": 246,
			"seed": 1554784000,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718528584282,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "72cb5c325198512c48e4e83e10a10e6c28016544",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 210,
			"versionNonce": 520699648,
			"isDeleted": false,
			"id": "6gnlcBPn",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 29340.341881033688,
			"y": -208.71325169247973,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 632.8125,
			"height": 120,
			"seed": 2539264,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718528714723,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "given point a and b, what it the distance and time.\nwhat road to follow.\n\npluggable means extensible traffic can be added later.\nConstructions, accidents, etc.",
			"rawText": "given point a and b, what it the distance and time.\nwhat road to follow.\n\npluggable means extensible traffic can be added later.\nConstructions, accidents, etc.",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "given point a and b, what it the distance and time.\nwhat road to follow.\n\npluggable means extensible traffic can be added later.\nConstructions, accidents, etc.",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 25,
			"versionNonce": 1173913344,
			"isDeleted": false,
			"id": "cH1ImX40DZMpLbQ8-S021",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28819.99627957989,
			"y": 46.083750191202626,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 336,
			"height": 383,
			"seed": 897585408,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718528802143,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "25193ec4a733878333fa0d7a90b4c0dd3443939d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 270,
			"versionNonce": 764083968,
			"isDeleted": false,
			"id": "GOcvzo8d",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 29257.06698521581,
			"y": 120.37943555751565,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 785.15625,
			"height": 192,
			"seed": 979513600,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718528905603,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "should give good road accuracy, if it doesn't give the best \nroute that's okay but that route should lead to our destination.\n\n\nit is okay if it takes 2-3 sec to give route info or do behind the \nscene calculations.\n\n",
			"rawText": "should give good road accuracy, if it doesn't give the best \nroute that's okay but that route should lead to our destination.\n\n\nit is okay if it takes 2-3 sec to give route info or do behind the \nscene calculations.\n\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "should give good road accuracy, if it doesn't give the best \nroute that's okay but that route should lead to our destination.\n\n\nit is okay if it takes 2-3 sec to give route info or do behind the \nscene calculations.\n\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 71,
			"versionNonce": 1306787584,
			"isDeleted": false,
			"id": "nJkoAkKirwYkyq6y6a7a8",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28831.922822302517,
			"y": 479.63860927473274,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 892,
			"height": 450,
			"seed": 800215296,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718530074932,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "037d2d2d634b19f31e74cc578148046b396f9475",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 94,
			"versionNonce": 1623228160,
			"isDeleted": false,
			"id": "S_OqyYGyFn_OXDTvNRSq1",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28836.952942984673,
			"y": 1000.41200210591,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 1020,
			"height": 369,
			"seed": 1099870464,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718530098928,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "09d6bda0215c9532f4dfedc2d3730ccc7e61b7e6",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 171,
			"versionNonce": 957783808,
			"isDeleted": false,
			"id": "EBKEik1Y",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 29933.855895166562,
			"y": 1058.0141319148497,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "transparent",
			"width": 574.21875,
			"height": 96,
			"seed": 639250688,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718530167445,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "or we can use floyd warshall algorithm to find\nshortest distance b/w all vertices and cache this\ninfo for each segment for fast lookup.\n",
			"rawText": "or we can use floyd warshall algorithm to find\nshortest distance b/w all vertices and cache this\ninfo for each segment for fast lookup.\n",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "or we can use floyd warshall algorithm to find\nshortest distance b/w all vertices and cache this\ninfo for each segment for fast lookup.\n",
			"lineHeight": 1.2
		},
		{
			"type": "image",
			"version": 458,
			"versionNonce": 440193280,
			"isDeleted": false,
			"id": "L2L79E0yzHWanvmrS_g86",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28841.568182413823,
			"y": 1404.4021827134004,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 2293.5057201509553,
			"height": 3582.04797941147,
			"seed": 1290227968,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718533077564,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "9d101771299a99146400d583cc9004a8c03c9843",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "rectangle",
			"version": 134,
			"versionNonce": 2004877056,
			"isDeleted": false,
			"id": "-bunlo2_P4Vpujt_-472S",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 29949.228112847148,
			"y": 4113.233573777519,
			"strokeColor": "#e03131",
			"backgroundColor": "#f50f0f",
			"width": 711.0809068620038,
			"height": 424.6733682131344,
			"seed": 1547276544,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718533017100,
			"link": null,
			"locked": false
		},
		{
			"type": "image",
			"version": 453,
			"versionNonce": 2016861952,
			"isDeleted": false,
			"id": "FLsT8Twn2F4o_NdqUScnu",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 29983.834941072826,
			"y": 4146.092399882657,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 618,
			"height": 382,
			"seed": 1929068288,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718533030106,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "f225c067dd2478ee07e414a6815205530bd1cc19",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "rectangle",
			"version": 56,
			"versionNonce": 1481437440,
			"isDeleted": false,
			"id": "UFfYoe9_ZIvOCxQTTsbYN",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 30153.334708981318,
			"y": 3364.294171195955,
			"strokeColor": "#e03131",
			"backgroundColor": "#f50f0f",
			"width": 205.7527173333183,
			"height": 223.85879470978443,
			"seed": 1139659008,
			"groupIds": [],
			"frameId": null,
			"roundness": {
				"type": 3
			},
			"boundElements": [],
			"updated": 1718533073998,
			"link": null,
			"locked": false
		},
		{
			"type": "image",
			"version": 223,
			"versionNonce": 388071168,
			"isDeleted": false,
			"id": "ShYHWoHAwKEV6OaWuaeQD",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 30170.657966169034,
			"y": 3374.8960835126964,
			"strokeColor": "transparent",
			"backgroundColor": "#f50f0f",
			"width": 153,
			"height": 215,
			"seed": 1756360960,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718533084664,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "fd2b74ccf6d6396606fdce0bcf611371627ae05d",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 146,
			"versionNonce": 500743936,
			"isDeleted": false,
			"id": "WbVZE7YXvV6BxuqvmeOUh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 30226.789423882943,
			"y": 1441.4082973649997,
			"strokeColor": "transparent",
			"backgroundColor": "#f50f0f",
			"width": 672.5910687854984,
			"height": 953.7131170669371,
			"seed": 1846394624,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718533139076,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "c7d4b696a6229f049fe0e3fca18e2b7199ce1b58",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 95,
			"versionNonce": 2049817412,
			"isDeleted": false,
			"id": "mNUKkqRoLsKS-4Ngp-SiU",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28939.98901053849,
			"y": 4822.0432330821095,
			"strokeColor": "transparent",
			"backgroundColor": "#f50f0f",
			"width": 1115.9396493162535,
			"height": 617.9249877929688,
			"seed": 1080662908,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718692534459,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "18cc4074157ff008d62aa03731d04530a52b401e",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "text",
			"version": 105,
			"versionNonce": 297438588,
			"isDeleted": false,
			"id": "uIwvI3nh",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 28839.25816924614,
			"y": 6811.697397422679,
			"strokeColor": "#1e1e1e",
			"backgroundColor": "#f50f0f",
			"width": 2343.75,
			"height": 13752,
			"seed": 1653020484,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"boundElements": [],
			"updated": 1718693495730,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 3,
			"text": "given the lat/longs we would be able toidentify an aerial distance between them. Let's just say that the aerial distance\n\nbetween them is 10 kilometers, okay.  We also know that each segment is onekilometer by one kilometer in length and width right. So what we can say is we'll\n\nat max go... so because this is 10 kilometers on aerial distance, what wecan say is.. adding some buffers we will not cross more than 20 Segments on each\n\ndirections either going from North to South or going from East to West. That 20number is basically a buffer that you can come up with based on your\n\nconversation with your interviewer. But the idea is this number(10 KMs) will give us some input onto how many segments do I want to look at. So 20 segments on the\n\nNorth-South side and 20 segments on East-West side is what we'll look at to come up withthe optimal route from point A to point B. Because normally what would happen is\n\nthere will be millions of roads into the world. And if you start doing aDijkstra across the whole globe just to calculate distance between these two\n\npoints, that will be very un-optimal.  So we have to break that Dijkstra at some point in time.So this number would be used to break that Dijkstra saying that we will not go\n\nfurther that beyond this point. Now one obvious way to solve this is you haveall the roads connecting the whole city which cuts these two points as well.\n\nRun a Dijkstra across the city and then come up with the shortest distance betweenpoint A to point B. But if you look at it and if you look at it that way that\n\nthere are probably millions of users querying at the same time to finddistance between any two points, Running those many number of Dijkstra's Algorithms\n\nwould be heavily inefficient. So we'll do some slight optimization there.What we'll do is, there are... we'll basically say that there are two exits\n\nout of this block(Segment having A). Basically to reach this block(Segment having B) we need to exit this blockand there are these two ways. Let's say if we have calculated that these two are the only\n\nexists within this segment. Let's say this a segment S1. So A belongs to S1 andthese two are the exits, this is S1E1 and this is S1E2 and they have\n\nsome great W 1 and W 2 let's say.  Now what we'll do is, this segment...this junction is basically having two points. One is S1E1.. two identifiers basically,\n\nS1E1 and S2E1. this is segment ID S2 and this is exit number one of thatsegment so this has another identifier for S2. What we are saying then is this\n\nhas another point on the same route which is S2E1 and weight between them zero.similarly there'll be a lot of points. This graph will fan out.\n\nOn the other side for B, let's say B belongs to segment S4 thereare another two exits through which you can reach B. One is S4E2 and one\n\nis this one which is S4E1 even.Now if we just connect all the exits to exits\n\nfor ten blocks(Segments) on the North side, ten blocks(Segments) on the South side, ten blockson this side and ten blocks on that side, we'll basically be able to come up with a\n\ncrisscross of a lot of Road whichconnects these four points right and\n\nthere'll be a lot of junctions within that, there'll be a lot of roads, but thesewill be basically just entry points and exit points of the segments. We don't\n\nreally care what are... what is happening within the segment when we are cuttingacross segments. Why? -  because to reach this segment we anyway need to cross all\n\nof the other segments right. Now we don't care if this route which we are callingas let's say this is segment S6 and this point is S6E1, this point is S6E2\n\nNow this is basically a calculated path from these two exit points. Thisexit point to that exit point basically. This real path would look something like\n\nthis right but we don't really care what's happening within the segment.All we care about is from this point(S6E1) to this point(S6E2), I know the distance, and I'll use that.\n\nThen from this point to this point I know the distance I'll use that. So we'llbasically be using all the exit points distances and use them as weights,\n\nand come up with this graph at runtime.Now given like ten  segments on each side, we'll probably have\n\nthis graph of a couple of hundreds of edges at max right. Now we can run aDijkstra on this graph staying with that what is the shortest path to go from\n\nhere(A) to here(B). This Dijkstra runs on top of the graph which was created byjust entry points and exit points in everything else, and entry point and\n\nstart point and entry point and end point in the starting and ending segments.Everything else was just a connector from individual end point to individuals\n\nbasically exits of a particular segment. Now this is fine when we have to travelfor like ten odd kilometers we can still create a graph of these 100-200 edges\n\nand calculate. What if you want to go  inter-city? What if you want togo from City 1 to City 2 and then you want to calculate it? Then it becomes a\n\nbig trouble to... because let's say the distance between those two city isthousand kilometers then there are possibly thousands of segments\n\nmultiple thousands of segments that you'll look at, right. That would too complicatedto run a Dijkstra at runtime. Now like we extended the solution from one segment\n\nto multiple segments, we can basically create a Mega-Segment, right? We cansay this whole thing that you see here is 1 Mega-Segment and there could be\n\nthis exit to this Mega Segment this exit to this Mega Segment and probably anexit here to this Mega Segment, right? And then what we can say is, let's say you\n\nhave this whole map of a country. I know it looks terrible but let's say this isone country, what you can say this is 1 mega segment you can basically divide\n\nthis country into mega segments. And then recursively solve for it evenfurther. Now when you were to if you are to solve in the mega segment world you\n\nhave basically converted this whole country into possibly 50 mega segmentsand now if you want to go from here to here, you basically need to just connect\n\nthe exit points of individual Mega Segments. You don't reallycare what is happening within a mega segment, you don't really care what is\n\nhappening within segments under those mega segments and roads under thosesegments. All you care about it from my start point how do I get to the nearest\n\nexit or all the exits of that mega segment and from these exits of megasegments how do I get to further mega segments recursively and then somehow\n\nreach this end point, right. Now you can have n levels of nesting. Ideally threelevels of nesting is more than enough. Now what is the ideal size of this mega\n\nsegment? - Again there is no right answer you can come up with based on somecalculation with your interview again on this. But the idea if you still want\n\nto calculate this thing across cities or across states,  this segment approachwould still not scale you need to do an abstraction on top of segments which can\n\nbe represented as a Mega-Segment and then solve it recursively.All good so far but we have not really talked about how do we come up with the\n\nweights on an edge and how do...what all weights do we even consider? So thevery first obvious weight is the amount of distance between two points right so\n\nthat is one thing that will definitely have.  Along with that we will also keepan ETA that normally under normal traffic conditions, in the normal weather\n\nconditions, how much time does it take for a user to go from point A to point B.Now when we have both these information we can obviously keep a next\n\nobvious thing saying what is the average speed of vehicles.Speed = (distance/time) so  basis that will be able to come up with an average speed.\n\nNow you might think that the next obvious you things are weights liketraffic and weather condition and all of that but I would definitely not\n\nrecommend that. Even... let's assume this is what we have build already andnow somebody comes up and asks you to implement traffic data into this okay\n\nnow if you want to add traffic as a weight onto your edges that'll be avery very bad design. Why? - Because with an additional attribute that you are adding\n\nyou are basically changing the logic of your underlying Dijkstra which runs on asegment, right. Now let's say tomorrow somebody comes up asking you for a\n\nweather information you will again change the whole logic of your Dijkstra.That piece is a bad design, okay. So ideally.. basically the set of things that a good\n\ndesign should entail is basically that it should not restrict addition of newfeatures plus each change should be small enough and contained. It should not\n\nbasically impact the whole feature.  So what we'll say is traffic and all all ofthose in things are basically attributes which impact your speed okay and basis\n\nwhatever your average speed is you can calculate the ETA as a function ofdistance and average speed, right?  So all we'll say is traffic, weather, roadblocks all\n\nof those they'll never be weights on your graph, okay. They would just be attributesthat impact your average speed. So average speed would be a function of\n\ntraffic, it could be a function of weatherit could be a function of any number of fields that you want. Let's say if you\n\nwant to add a accident, or construction work going on someplace or whatever you want to add.So all of those would basically impact your average speed. Now normally\n\nyou don't have to do all these fancy things, never ever! Why? - Because it's for acompany like Google Maps they know... let's say there are hundreds of people\n\ngoing from point A to point B. They  anyway know how much time they tookright plus a very important feature about this kind of data is, this traffic\n\ndata would always be normally distributed. So if we want to plot, Let's saythis is basically any metrics let's say ETA of how much time it took for people\n\nto go from point A to point B on a graph it would always look like a normaldistribution, okay. What that means is you do kwow that there is this point which\n\nmost of the users are hitting and as a... with some statistical calculations ofone standard deviation from each of these point you will be easily be able to\n\ncalculate this range that normally for most of your users at least 50-60-70%of your users, this is the window of time that it will take. Let's say this is\n\n5 seconds this is 7 seconds and let's say average is 6 secondsfor example so statistically you can come up with this number as a function\n\nof lot of users who are crossing the roads. So you don't really care how muchis the traffic, what is the weather, when you anyway have this real-time information\n\nSo for all the geographies where you have people usingyour application, there you have organic data from real users at this point in\n\ntime so you don't really care about traffic and all of that. Traffic and allother things will come into picture only in places where you can either not get\n\nenough data from users or there is some other reason why you're maybe legallynot allowed to get information of users right because of which if you don't have\n\nreal data users, then is when you will bother about using traffic and weatherand all those attributes to come up with this average speed number basis\n\nthat you can even know the distance from point A to point B, you can come upwith a ETA, okay. Now how do we quantify traffic?\n\nyou cannot say that if there are 805 vehicles, it will take this much amountof time, right. The number of vehicles on a road and things like that cannot be\n\ncalculated at all. No matter how good technology you build right. So when thesethings cannot be quantified how do you use them as a measure? So what we\n\ncan say is basically create multiple \"Tiers\". Let's say this is traffic measurementand this is Weather Management.  All you can say is traffic is low or it is\n\nmedium or it is high and whether it is good or it is bad, right. So you willhave these kind of Tiers for each of the attributes that you have and all you can\n\nsay is every time traffic goes from here(Low) to here(Medium), it has a 20% increase ontoaverage speed or something of that sort. right every time traffic goes from low\n\nto medium, average speed reduces by 20 percent. Basis these transitions oftraffic volume... now you can always say that traffic is low or high based on the\n\nnumber of users that are probably using your application or from some othersources, right. Let's say you have this kind of a measure, so there are companies\n\nlike Waze and all, which will give you the kind of information that how's theweather, how is the traffic in a very abstracted form. Now once you have\n\nthis information you can calculate average speed as a relative number fromthe original value calculated. so let's say with the good weather, with the\n\nmedium traffic you knew the average speed was later 20 kilometers per hourNow if the traffic goes to high, you kind of reduce it by 20%, so it basically\n\nbecomes 16 kilometers per hour. Basis is this kind of a calculation, you willcalculate the ETA. Now as and when inputs are coming, you are making changes\n\ninto your weights on the graph. How does it impact the overall system? Socoming back to the previous drawing that we made remember we had something called\n\nas a segment and we had lots of roads within the segment and let's say thetraffic increase we got a signal from some third party saying traffic has\n\nincreased on a particular Road. Now do whatever you want to. Now let's say therewas this one exit point and one exit point and distance between this was some\n\nLet's say there are some X weight to this particular theoretically calculated road.And let's say it was actually using this particular road on which the\n\ntraffic is increased, let's say it  actually was following this kind of agraph, something of that sort. Now similarly all other roads are getting\n\nchanged. So all you can say is remember in this all the theoretically calculatedroads that we have to be calculated we were caching that what all real roads\n\nare a part of this theoretically calculated road. Which is... it is not areal route, but a calculated edge.  So each time this thing changes, weight\n\nchanges on any real road, you basically try to infer, what all actual cachedroads are impacted. And then you basically make a change into the cached roads\n\nalso. So you say that okay the time taken initially was 10 seconds, for thispath, now it has become 15. So let me increase the value of this particular\n\ncalculated road from point E1 to E2 by 5 secondsNow let's say you do this for one segment, then what basically happens is\n\nyou recursively bubble it up over a lot of cached things. So let's sayif there was a mega segment who's...  who had this kind of an entry-exit point\n\nthat this is ME1 and this was in ME2 and you know that ME1, the route fromevery ME1 to ME2 uses this E1-E2. So what you will do is you will basically bubble\n\nup the amount of time for this route by 5 seconds. So what we are essentiallysaying is as then when you get traffic data you basically update the ETA on a\n\nparticular road. Then update the ETA on all the calculated routes that this roadis a part of.  And update and then basically that becomes\n\nat a segment level. And then do the same thing recursively for all the segmentsthat are a part of a mega segment.  So basically what you are doing is you're\n\nbubbling of all the calculated values and then updating whole of the graph.Now these things are not happening at once not all the signals are coming\n\nup at one, right. So as in when something changes you bubble up till the level whereit goes and then stop. So let's say this road was not a part of this ME1 ME2\n\nfor example, then it will stop at the segment level, right. But if it is a partof a mega segment road also, then it will bubble up in the mega segment level.\n\nNow, other than just traffic and weather, there's also one very important factorthat you can use. So you can also use historical ETAs to come up with a real or\n\na predicted ETA for a particular Road. And this historical ETA isbasically calculated in a way that you basically look at the day of week and\n\nthe hour of day so let's say Monday, 5 p.m. this road takes 20 seconds tocover, but on Sundays 5 p.m. is this road takes just 10 seconds to cover so\n\nsomething of that sort is what you can cache at a level of a day of week and hour of day.And then use that historical data to infer. So let's say if you do not have traffic\n\ninformation also, then you can use this kind of an information to somehow comeup with the predicted ETA. Now coming back to the segment, due to some\n\nactivities within the segment so let's just say there are a lot of roads on thesegment. There is there are these two exit points and there are these points\n\nwhich have some roads now let's say we've calculated that the ETA of fastestway to go from point SE1 to SE2, involves 500 units of time.\n\nlet's say 500 seconds, okay. And it uses the route SE1 to A to B to C to SE2, okay.Now let's just say that there's a traffic increase on A to B. Now we could\n\nidentify it by a lot of attributes. Let's just say people moving between A to Btheir average time increases right. Or we get a signal saying you know the\n\ntraffic is increasing significantly. For whatever reasonlet's say we increase the time of basically the ETA for going from point A to\n\npoint B. So it would impact the ETA from SE11 to SE2. Now there is alimit to which it can bubble up right so let's say it increases from 500 to let's\n\nsay 550 due to some increase in A to B so all that is okay. But let's just saythat we have real data of users, and for some reason it is taking a lot of time\n\nfor some people but we put to go from point A to point B and let's just saythis increases to let's say 850. Now a jump from 500 units of time to 850 units\n\nof time is a very big jump. It is having a.. roughly a 70% right.So now it is possible that the fastest route from SE 1 to SE2 does not\n\ninclude this route ABC! It could be some other route. So what we will do is if ETAincreases or decreases, generally in case of increase only we'll do this.\n\nif ETA increases by greater than some percentage. It's a configurable amount.Let's just say we have it set that if the ETA increases by 30%\n\nthen we recalculate things within that segment. Because all the updatesthat you are getting are against a segment only. So whenever a\n\nparticular road's time increases you can calculate everything within thatsegment, right. Which means recalculating paths from SE1 to SE2.\n\nLet's just say, that we figured out that now the new shortest path is not thispath and it is basically the pass from SE1 to A to H to G to F to E and to SE2.\n\nSo, this basically becomes your new shortest path, right. Now if it is the shortestpath, then we need to bubble up that information, right. First of all we need\n\nto say that whoever was traveling from SE1 to SE2, now needs to follow a newpath right which is a path from  SE1-A- H - G - F - E - SE2, right. This is one\n\npart of the things. But what if there was a mega segment over here whichencompasses a lot of segments, whose exit points were also including this\n\nparticular path. This is let us say ME1 and let's say ME2.Now if the exit point path of this Mega Segment also includes this part\n\nthen even that mega segments path would change so the part where they use ABCnow that would get converted into this, right. So these are the things that\n\nyou'll have to do each time a weight changes. so when the increases beyond thethreshold then you have to do. So let's just say increase happen from 500 to 510\n\nthen all of this calculation is probably not even worth it. Because the best youcan get is probably somewhere between 500 to 510. Now let's say 10 seconds\n\nwould not be too much of an enhancement right. But if it is such a big jump from500 to 850 for example then you might as well recalculate everything within the\n\nsegment and then bubble up whatever is required. Now you'll not just calculatewith respect to exit points, you'll also calculate the shortest path to reach\n\nfrom let's say SE1 to A, or SE1 to B.  All of those will also be calculated butfor representation this was a good enough way to explain you the concept.\n\nNow let's look at the architecture of the whole system. So we will do it in two parts:First we'll look at the flow wherein all\n\nusers are connected to the system wherein we are capturing their locationinformation from all the users even if they are not using our map service. This\n\nis basically for improving our map service altogether and a bit of user profiling.In the next section we'll look at how does the actual navigation flow works\n\nfor the user who want to find the shortest route between two points andwhat are the systems required for that. And at the end we'll look at some of the analytics.\n\nWith that let's get started. A bit of a convention to start with:Things in green are basically user devices could be mostly these will be mobile\n\nphones, could be web browsers as well. Things in black are load balancers plusreverse proxies plus an authentication authorization layer in between which\n\nwill authenticate all the external requests comingto the system. Things in blue are the\n\nthings that we have built on our own. Itcould be web services, Kafka consumers or anything of that sort.\n\nThings in red are either some infrastructure component that we've used or somedatabases or some clusters like Kafka, Hadoop and all of that, cool. So let's look at\n\nhow the user flow begins. The very first interaction with the user is when theywhen they have the app installed on their phone, with their\n\nlocation services turn on, so we get regular pings from a user's device every few seconds.Now if the user is stationary, the device will have the\n\nlogic to not send the location ping every five seconds and maybe send itevery five minutes or ten minutes or something of that sort, because that will\n\nreduce the load on our system if the user is anyway at the same point + Better battery life.But while the user is in transit, we will increase the frequency, so as to make\n\nour data more accurate. This talks to.. this basicallykeeps the persistent connection with the device. The reason for a persistent\n\nconnection is, so that we don't have to create a new connection everytime. Also this wouldbe generally a Websocket connection, because sometimes we might need to send\n\nsome information on to the user devices as well. So this WebSocket handler isbasically the service that talks to all the user devices. Now there would normally\n\nbe thousands of such WebSocket handlers for talking to all the users thatare currently online. So we need somebody who can manage the fact that\n\nwhich handler machine is talking to which user. So then comes somethingcalled as a Web Socket Manager.  It basically keeps a track of which machine(read user)\n\nis connected to which WebSocket handler, so which user device is basicallyconnected to which machine of this WebSocket Handler Service.\n\nIt basically keeps that information in a Redis. If let's say it lost thatinformation is lost we can kind of pull that information again from the servers.\n\nSo we don't need to kind of store that information in a persistent Data Store.The next thing what happens is, as in when users are sending their locations\n\nthe frequency of the location pings is handled by the device and then thedevice location comes to us basically coming at the Location Service.\n\nNow Location Service is basically a repository of all the location related information .It basically has some endpoints through which you can ingest\n\nsome users information, something like a user ID with the timestamp with aparticular Lat/Long. That kind of a structure. It puts all of that\n\ninformation into a Cassandra as a permanent data source to keep a track ofthe fact that which user was at what location at what point in time.\n\nRemember this is not just for users who are using our app right now for navigation, but forall the users in the world. How this data would help us we'll come to in a while.\n\nNow, as and when it's getting location pings, it is also putting all of thosepings into a Kafka. All the location pings that are\n\ngoing into this Kafka, are basically read by this Spark Streaming Consumer.This does a lot of calculations,  some of them are here and some of them\n\nwe look at in the later sections. First of all what it does is, if let's say alot of users are traveling at a place where.. which we do not identify, okay. But\n\ntheir movement pattern tells us it looks like a road. So thisbasically is a job which would be a Streaming Job which would look at last\n\nten minutes of data and see how the users are moving and basically it'll be usedto add new roads into our system. Now as and when a new road is added each\n\ntime a new road is added that would basically impact the particular Segmentwithin which the roads are added and then basis that all the Segment\n\nrelated information that we calculated earlier that we talked about earlierthat would be recalculated. So that might impact a lot of segments and Mega Segments recursively\n\nif that's a very critical new road thatwe've found. The next thing is basically an average speed job. What that\n\ndoes is, it basically looks at again if we look at within a segment a lot ofpeople moving from point A to point B, it tries to figure out what is the average\n\nspeed that these users have over let's say last fifteen twenty minutes and usethat information to as a proxy for a real-time information and then suggest\n\nthat and basically it will then update theweights of the graph that we talked about earlier. Again that would\n\nbubble up to various Segments and Mega Segments if that's a part of a critical road.Now how would that bubble of process happen? - So this Spark Streaming Job,\n\nindividual jobs would actually write back things into Kafka. So let's say if anew road is identified, it would write that to a separate topic saying\n\nI've identified a new road which connects point X to point Y. Now therewill be a map update service which listens to that particular topic and it\n\nupdates it in a Data Store. It updates it in a graphs Cassandra, which is managedby this Graph Processing Service, so each time a new road is found,\n\nMap Update Service would invoke Graph Processing Service to tell that I havefound a new road just store that in your Datastore which sits on top of a Cassandra.\n\nNow what this service is, we'll look at in the next section in more detail.Now, each time average speed job finds out there is some change that has happened\n\nit would again put an event into Kafka in a separate topic now and there'll besomething called as a Traffic Update Service that listens to this topic which\n\nwould update the traffic related information again into the sameCassandra through Graph Processing Service. There is something called as a\n\nHotspot Identifier. So let's just say there's a particular locality on whichthere is some average number of people per given area kind of a metric that we\n\nhave. Now let's have suddenly a lot of people start gathering in that areait gives us a signal that there is some activity happening at that point. It\n\ncould be that there is some social event, some sports thing happening or butsomething is happening there so that could be able to identify hotspots\n\nwithin the graph. Because eventually once we identify that hotspot we'll know thatafter probably a while, there will be a lot of traffic in that area as well\n\nright. So that could help us in certain ways. Now for certain things SparkStreaming would itself insert a lot of information and put out\n\nevents but in general it will dump all of that data into Hadoop cluster, whichhas location pings of all the users across a lot of time. Now we could do\n\nsome ML Jobs onto it which classify these certain other things. Solet's say if you've identified a new road but we do not know what kind of a\n\nroad that is. If it's a one-way, if it's a two-way Road, if it's a single lane roador maybe a six-lane Road. So all of those\n\nthings would be identified by this RoadClassifier and this particular job could\n\nnow put that event into that road topicand Map Update Service could now store that additional information saying now\n\nthat I have not just identified that road but now I also know that this is aprobably a six-lane Road or something of that sort\n\nThere could be somethingcalled as a Vehicle Identifier.\n\nWhile you are getting location pings, if you start getting those pings at a veryhigh frequency let's say every one second if you are getting that you can\n\ninput a lot of information about the vehicle in which the person is traveling.So let's just say that the traffic is going normal at certain pace but one\n\nparticular person is stopping every few kilometres let's say, okay. Now what thatcould mean that could mean that either there's a red light or there's a traffic\n\njam there, possibly. But we know what are the junctions you know where the redlights can be we know how the traffic jam are because we know the\n\ndata for the user as well. Now if it's not any of these two criteria then thatmeans that the person is traveling in a public transport something like a bus\n\nand then the bus is stopping at each bus stop, all right. Other kind of things thatwe can infer is if let's say the ride is bumpy or if the person is going left and\n\nright here and there very frequently or having a very fast acceleration and veryfast breaking it's probably a two wheeler. if not in all other scenarios if\n\nit's a smooth enough right stable enough acceleration going straight in one roadit is very likely a four-wheeler. Now we do tell information to Google\n\nspecifically that we are actually traveling in a two wheeler or fourwheeler while we select a map but if let's say that option is not available\n\nthen this kind of data would be good enough to infer which kind of vehicle aperson is traveling in, which will help us in a lot of other attributes. So these\n\nindividual jobs what all they identify they could put that into back into thesame Kafka in probably a separate topic for each\n\njob and then those information could be analysed even further. Now let's look atthe user journey when they want to actually get the navigation from point A\n\nto point B. So normally what people do is they search for a particular locationwhich then gets converted into a particular lat/long right. So all of\n\nthose is being done by Area Search Service. This basically does two kind ofthings. One is, it has some areas within Elastic Search on which it provides fuzzy\n\nsearching and once the person has search for a particular area orlocality or location anything. It then gets converted into a lat/long. So\n\nbasically it stores the lat/long along with the place name, description all ofthat, in a document. The other thing is it tries to dynamically figure out: Given an\n\naddress kind of a thing which lat/long that address points to. So it does thataddress resolution into a lat/long as well. Now let's say... so post the response\n\nfrom this user will have a start point and end point as a latitude longitudeboth of them and then they would want to request the path, okay. First let's\n\nquickly go over what is this Navigation Tracking Service. So while the person isactually started the navigation and they're going towards the destination\n\nall of their location coordinates will be tracked as part of Navigation Tracking Service.This does two main things: 1)  If the user is deviating from the route\n\nthat we suggested, we will kind of inform the app back and then that will probablyshow a pop-up kind of a thing, saying that you are probably going wrong, maybe you\n\nwant to course-correct to the right path. 2) It will also store all thedata so it will push all of the data into Kafka, while the person is traveling\n\nthen that data could be used for later analysis saying, at this point in time aperson searched for a route from point A to point B, and this was the route that\n\nwe recommended. It could be used for figuring out how good the recommendationof the path is. That being said, let's jump to the main piece which actually\n\nfigures out how to connect point A to point B, okay. So all of those requestsare being handled by this Map Service. This Map Service over here is basically an\n\ninterface service which provides multiple interfaces for people torequest the directions from some point to some point. One of the interface is\n\ngiven to the user devices. A similar interface could be given out tocompanies where in all the rate-limiting and their throughput calculation against\n\ntheir account information is being calculated and stored, okay.It's not an intelligent service it just forwards the request to\n\nsomething called as a Graph Processing Service. Graph Processing Servicebasically does a lot of things.  First of all it queries Segment Service which\n\nsits on top of its own Database of Cassandra, in which it stores all thesegments and their corner coordinates along with a lot of information of those\n\nsegments. So let's see if they if the Graph Processing Service wants to figureout that what are the segment's for the start point and the end point, it\n\nwill get that information on the Segment Service. Now if it so happensthat both the points are within the same segment then it's a short duration ride.\n\nThen the Graph Processing Service might choose to do a couple of thingsit might look up that, Do have this data already cached? if yes, it will\n\ndirectly return to the Map Service saying there is a response. If not, it'll thendecide what do I do next? It can now if it is the same segment it\n\ncan probably say that I will run a proper Dijkstra's algorithm and then tryto figure out the shortest path between the two points. It can do that and then\n\nreturn the response. Alternatively, if it's in different segments then it willtry to fan out into the whole basically it will try to create a pick the sub\n\ngraph of the main whole world's graph that we want to look up as part of theDijkstra and run it, okay. Now for doing that it will look up on a lot of things.\n\nFirst of all it will look up for all the roads within those segments, theentry-exit points of the segments, into its Cassandra. It will also have\n\nlive traffic information which would have updated the ETAs into the graphagain from the same Cassandra. Now it\n\nwould have also got some input fromsomething called as a Third Party\n\nData Manager. Now it doesn't queryThird Party Data Manager at runtime.\n\nThird Party Data Manager in fact, pushesdata into Graph Service which then impacts the live traffic information so\n\nlet's say if it says that there is a huge amount of traffic at certain pointit'll update that. Let's say if it says that there is a massive kind of a\n\nrain happening somewhere, it will update the live traffic information thing there issome rain and that would probably cause some delays and the average speed would\n\nslow down and ETA would increase, something of that sort. Now using all ofthat information it basically creates the whole graph that we looked at in the\n\nprevious sections and then it either looks up in the cache and returns theresult or it might run the Dijkstra's Algorithm or some Algorithm to basically\n\nfigure out the shortest path between two points and then return the result.let's say if it doesn't have any traffic information, any ETA information it might\n\nalso query Historical Data Service tofind out at this point in time how much\n\nETA can expect from point A to point B.if it doesn't have that information for\n\nsome of the points. Now Historical Data Servicesits on top of its own Cassandra\n\nwhich basically stores the informationof the form that at some day, day of the\n\nweek like Sunday, Monday, Tuesday in somehour, let's say 4 PM, 5 PM, something of that sort,\n\nfrom point A to point B, how much was the average speed of people normallyand how much ETA did it take. So all of\n\nthat kind of information would be storedin Historical Data Service. Bases all of\n\nthat, Graph Processing Service willreturn back the response to Map Service and then to the user going by the exact\n\nsame set of logic that we looked at in the previous sections. Now all ofthis is done a lot of events have gone into Kafka. One of the common events was\n\nthat by the Area Search Service which we didn't go over. So each time a search ishappening the service will put an event into Kafka. Now what that would do is it\n\nwill basically give us a list of areas that are being searched most often. So wecan do some optimizations for them. Another thing\n\nwould happen is, so not we can do a lot of analytic on top of this data okaythat is coming into Kafka. One of the very first thing we need to do is to\n\nfigure out that out of all the third party that we are integrated with whichof them is actually giving right information and which of them is\n\nactually given the wrong information. How do we do that?So let's say some third party gave us some information saying from point A to\n\npoint B, there is a lot of traffic, and ETAs would increase. But our data if itsays that ETAs have not been impacted at all, that means that particular\n\ninformation was incorrect, right. Now if that happens from the same Third Party alot of times, then we can safely say that, that third party has a wrong\n\ninformation or it gives us wronginformation. right. Now this Third Party\n\nData Manager, abstracts out on a lot ofthird party companies, so we could be\n\npulling data from a lot of companies allof that is abstracted under this Third\n\nParty Data Manager but the reporting would be done at an individualorganization level. That being said, there are a lot of other kinds of analytics\n\nthat we might want to do. First of all we might want to identify what is the roadthat a particular person is on, right? so as part of navigation you want to\n\nprobably have a audio kind of a thing saying turn right in ninety meters toget on Mahatma Gandhi Road,or something of that sort, right. All of that inferences\n\ncould be done by the Spark Streaming saying where exactly I am in how muchtime am I about to reach a junction and what is the road name on\n\nwhich I will get to next. So all of that could be done by this. There are a lot ofother analytics that we could also do on top of this data. Let us look at it next.\n\nSo out of all the events that are being put into this Kafka, there is a lot ofanalytics that we can do and we should do. So one of the very important things\n\nto analyze is how accurate our ETA predictions are? So let's just say wepredicted that it will take 40 minutes to cover a distance from point A to\n\npoint B and if it takes something around 38-39 minutes then that's fairly accurate.But if in real world it takes somewhere around 20 minutes then that's a fairly\n\nbad prediction. So we need to have this data on how accurate our predictions areso that we can figure out that we need to invest more time into you know\n\nupgrading that algorithm that comes up with the ETAs. Along with that it willalso give us some information about which of the routes are the ones that we\n\nare recommending to people, but people are not taking. Maybe there is somethingwrong with the routes that exist in our database, right. So all of those things\n\ncould also be inferred. Some common things that we can infer is what are somecommon hotspots in the city that people gather at. These could be some social\n\ngathering places or things of that sort. So that will kind of give us some pointsof interest that we can build over time using this data to start with. Other than that\n\nsome obvious things that we can also figure out is, what are the homelocations and work locations of some of the people. We could also infer user\n\nprofile data. So for example if a person is going to a lot of pubs for examplethen they are more of a social kind of a person. If a person is traveling\n\noutside the city very frequently on weekends, the person likes travelling. Sothings like that can also be inferred basis just a location data. Coming to the\n\nlast thing, now this normally wouldn't be a part of a design interview but there'ssomething you should be aware of because this is an important thing that\n\ncompanies like Google Maps have to take care of. So how do you handle disputedareas? So while in Google Maps there is a clear-cut boundary of states and\n\ncountries and all of that but if there is a disputed region how does Google Mapsdecide where to make the boundary of the country or state right. So a classic\n\nexample of this would be a dispute between the countries of India, Pakistanand China in the state of Jammu and Kashmir. So India claims that whole of\n\nthe land is under their territory. China claims that some of the parts of thatstate belongs to China and Pakistan claims that some of the parts of that\n\nstate belongs to Pakistan. So now how does Google decide or any such mappingprovider decides, that how where do they define the country boundaries, right. Now\n\nthis becomes very tricky for Google because they cannot take anybody's sideand whichever decision they make they are going to kind of piss off some of\n\nthe countries. Plus that's even worse in this scenario because these three countries combined together have more than one third of the world's population.\n\nSo that's a very rich source of revenue for Google. So how can you handle? -  so what Google does is something very smart and also very tricky. So what they do is, based\n\non the country where you are coming from they'll show you a different country boundary. So for people who are coming from India, to all of those people they\n\nshow that the whole part belongs to India. Now to the people of Pakistan they show that the part that they are claiming belongs to Pakistan and the\n\nparts that are disputed between India and China are shown as the dotted line. Similarly for people coming from China they show the part that China claims is\n\ntheirs they show under China's territory and remaining disputed area between India and Pakistan is shown as a dotted line with no country boundary\n\nspecified. So this is something if if you come across this kind of the thing in aninterview could try to replicate but keep this out of the scope of the\n\ninterview at least, but still something good to know. ",
			"rawText": "given the lat/longs we would be able toidentify an aerial distance between them. Let's just say that the aerial distance\n\nbetween them is 10 kilometers, okay.  We also know that each segment is onekilometer by one kilometer in length and width right. So what we can say is we'll\n\nat max go... so because this is 10 kilometers on aerial distance, what wecan say is.. adding some buffers we will not cross more than 20 Segments on each\n\ndirections either going from North to South or going from East to West. That 20number is basically a buffer that you can come up with based on your\n\nconversation with your interviewer. But the idea is this number(10 KMs) will give us some input onto how many segments do I want to look at. So 20 segments on the\n\nNorth-South side and 20 segments on East-West side is what we'll look at to come up withthe optimal route from point A to point B. Because normally what would happen is\n\nthere will be millions of roads into the world. And if you start doing aDijkstra across the whole globe just to calculate distance between these two\n\npoints, that will be very un-optimal.  So we have to break that Dijkstra at some point in time.So this number would be used to break that Dijkstra saying that we will not go\n\nfurther that beyond this point. Now one obvious way to solve this is you haveall the roads connecting the whole city which cuts these two points as well.\n\nRun a Dijkstra across the city and then come up with the shortest distance betweenpoint A to point B. But if you look at it and if you look at it that way that\n\nthere are probably millions of users querying at the same time to finddistance between any two points, Running those many number of Dijkstra's Algorithms\n\nwould be heavily inefficient. So we'll do some slight optimization there.What we'll do is, there are... we'll basically say that there are two exits\n\nout of this block(Segment having A). Basically to reach this block(Segment having B) we need to exit this blockand there are these two ways. Let's say if we have calculated that these two are the only\n\nexists within this segment. Let's say this a segment S1. So A belongs to S1 andthese two are the exits, this is S1E1 and this is S1E2 and they have\n\nsome great W 1 and W 2 let's say.  Now what we'll do is, this segment...this junction is basically having two points. One is S1E1.. two identifiers basically,\n\nS1E1 and S2E1. this is segment ID S2 and this is exit number one of thatsegment so this has another identifier for S2. What we are saying then is this\n\nhas another point on the same route which is S2E1 and weight between them zero.similarly there'll be a lot of points. This graph will fan out.\n\nOn the other side for B, let's say B belongs to segment S4 thereare another two exits through which you can reach B. One is S4E2 and one\n\nis this one which is S4E1 even.Now if we just connect all the exits to exits\n\nfor ten blocks(Segments) on the North side, ten blocks(Segments) on the South side, ten blockson this side and ten blocks on that side, we'll basically be able to come up with a\n\ncrisscross of a lot of Road whichconnects these four points right and\n\nthere'll be a lot of junctions within that, there'll be a lot of roads, but thesewill be basically just entry points and exit points of the segments. We don't\n\nreally care what are... what is happening within the segment when we are cuttingacross segments. Why? -  because to reach this segment we anyway need to cross all\n\nof the other segments right. Now we don't care if this route which we are callingas let's say this is segment S6 and this point is S6E1, this point is S6E2\n\nNow this is basically a calculated path from these two exit points. Thisexit point to that exit point basically. This real path would look something like\n\nthis right but we don't really care what's happening within the segment.All we care about is from this point(S6E1) to this point(S6E2), I know the distance, and I'll use that.\n\nThen from this point to this point I know the distance I'll use that. So we'llbasically be using all the exit points distances and use them as weights,\n\nand come up with this graph at runtime.Now given like ten  segments on each side, we'll probably have\n\nthis graph of a couple of hundreds of edges at max right. Now we can run aDijkstra on this graph staying with that what is the shortest path to go from\n\nhere(A) to here(B). This Dijkstra runs on top of the graph which was created byjust entry points and exit points in everything else, and entry point and\n\nstart point and entry point and end point in the starting and ending segments.Everything else was just a connector from individual end point to individuals\n\nbasically exits of a particular segment. Now this is fine when we have to travelfor like ten odd kilometers we can still create a graph of these 100-200 edges\n\nand calculate. What if you want to go  inter-city? What if you want togo from City 1 to City 2 and then you want to calculate it? Then it becomes a\n\nbig trouble to... because let's say the distance between those two city isthousand kilometers then there are possibly thousands of segments\n\nmultiple thousands of segments that you'll look at, right. That would too complicatedto run a Dijkstra at runtime. Now like we extended the solution from one segment\n\nto multiple segments, we can basically create a Mega-Segment, right? We cansay this whole thing that you see here is 1 Mega-Segment and there could be\n\nthis exit to this Mega Segment this exit to this Mega Segment and probably anexit here to this Mega Segment, right? And then what we can say is, let's say you\n\nhave this whole map of a country. I know it looks terrible but let's say this isone country, what you can say this is 1 mega segment you can basically divide\n\nthis country into mega segments. And then recursively solve for it evenfurther. Now when you were to if you are to solve in the mega segment world you\n\nhave basically converted this whole country into possibly 50 mega segmentsand now if you want to go from here to here, you basically need to just connect\n\nthe exit points of individual Mega Segments. You don't reallycare what is happening within a mega segment, you don't really care what is\n\nhappening within segments under those mega segments and roads under thosesegments. All you care about it from my start point how do I get to the nearest\n\nexit or all the exits of that mega segment and from these exits of megasegments how do I get to further mega segments recursively and then somehow\n\nreach this end point, right. Now you can have n levels of nesting. Ideally threelevels of nesting is more than enough. Now what is the ideal size of this mega\n\nsegment? - Again there is no right answer you can come up with based on somecalculation with your interview again on this. But the idea if you still want\n\nto calculate this thing across cities or across states,  this segment approachwould still not scale you need to do an abstraction on top of segments which can\n\nbe represented as a Mega-Segment and then solve it recursively.All good so far but we have not really talked about how do we come up with the\n\nweights on an edge and how do...what all weights do we even consider? So thevery first obvious weight is the amount of distance between two points right so\n\nthat is one thing that will definitely have.  Along with that we will also keepan ETA that normally under normal traffic conditions, in the normal weather\n\nconditions, how much time does it take for a user to go from point A to point B.Now when we have both these information we can obviously keep a next\n\nobvious thing saying what is the average speed of vehicles.Speed = (distance/time) so  basis that will be able to come up with an average speed.\n\nNow you might think that the next obvious you things are weights liketraffic and weather condition and all of that but I would definitely not\n\nrecommend that. Even... let's assume this is what we have build already andnow somebody comes up and asks you to implement traffic data into this okay\n\nnow if you want to add traffic as a weight onto your edges that'll be avery very bad design. Why? - Because with an additional attribute that you are adding\n\nyou are basically changing the logic of your underlying Dijkstra which runs on asegment, right. Now let's say tomorrow somebody comes up asking you for a\n\nweather information you will again change the whole logic of your Dijkstra.That piece is a bad design, okay. So ideally.. basically the set of things that a good\n\ndesign should entail is basically that it should not restrict addition of newfeatures plus each change should be small enough and contained. It should not\n\nbasically impact the whole feature.  So what we'll say is traffic and all all ofthose in things are basically attributes which impact your speed okay and basis\n\nwhatever your average speed is you can calculate the ETA as a function ofdistance and average speed, right?  So all we'll say is traffic, weather, roadblocks all\n\nof those they'll never be weights on your graph, okay. They would just be attributesthat impact your average speed. So average speed would be a function of\n\ntraffic, it could be a function of weatherit could be a function of any number of fields that you want. Let's say if you\n\nwant to add a accident, or construction work going on someplace or whatever you want to add.So all of those would basically impact your average speed. Now normally\n\nyou don't have to do all these fancy things, never ever! Why? - Because it's for acompany like Google Maps they know... let's say there are hundreds of people\n\ngoing from point A to point B. They  anyway know how much time they tookright plus a very important feature about this kind of data is, this traffic\n\ndata would always be normally distributed. So if we want to plot, Let's saythis is basically any metrics let's say ETA of how much time it took for people\n\nto go from point A to point B on a graph it would always look like a normaldistribution, okay. What that means is you do kwow that there is this point which\n\nmost of the users are hitting and as a... with some statistical calculations ofone standard deviation from each of these point you will be easily be able to\n\ncalculate this range that normally for most of your users at least 50-60-70%of your users, this is the window of time that it will take. Let's say this is\n\n5 seconds this is 7 seconds and let's say average is 6 secondsfor example so statistically you can come up with this number as a function\n\nof lot of users who are crossing the roads. So you don't really care how muchis the traffic, what is the weather, when you anyway have this real-time information\n\nSo for all the geographies where you have people usingyour application, there you have organic data from real users at this point in\n\ntime so you don't really care about traffic and all of that. Traffic and allother things will come into picture only in places where you can either not get\n\nenough data from users or there is some other reason why you're maybe legallynot allowed to get information of users right because of which if you don't have\n\nreal data users, then is when you will bother about using traffic and weatherand all those attributes to come up with this average speed number basis\n\nthat you can even know the distance from point A to point B, you can come upwith a ETA, okay. Now how do we quantify traffic?\n\nyou cannot say that if there are 805 vehicles, it will take this much amountof time, right. The number of vehicles on a road and things like that cannot be\n\ncalculated at all. No matter how good technology you build right. So when thesethings cannot be quantified how do you use them as a measure? So what we\n\ncan say is basically create multiple \"Tiers\". Let's say this is traffic measurementand this is Weather Management.  All you can say is traffic is low or it is\n\nmedium or it is high and whether it is good or it is bad, right. So you willhave these kind of Tiers for each of the attributes that you have and all you can\n\nsay is every time traffic goes from here(Low) to here(Medium), it has a 20% increase ontoaverage speed or something of that sort. right every time traffic goes from low\n\nto medium, average speed reduces by 20 percent. Basis these transitions oftraffic volume... now you can always say that traffic is low or high based on the\n\nnumber of users that are probably using your application or from some othersources, right. Let's say you have this kind of a measure, so there are companies\n\nlike Waze and all, which will give you the kind of information that how's theweather, how is the traffic in a very abstracted form. Now once you have\n\nthis information you can calculate average speed as a relative number fromthe original value calculated. so let's say with the good weather, with the\n\nmedium traffic you knew the average speed was later 20 kilometers per hourNow if the traffic goes to high, you kind of reduce it by 20%, so it basically\n\nbecomes 16 kilometers per hour. Basis is this kind of a calculation, you willcalculate the ETA. Now as and when inputs are coming, you are making changes\n\ninto your weights on the graph. How does it impact the overall system? Socoming back to the previous drawing that we made remember we had something called\n\nas a segment and we had lots of roads within the segment and let's say thetraffic increase we got a signal from some third party saying traffic has\n\nincreased on a particular Road. Now do whatever you want to. Now let's say therewas this one exit point and one exit point and distance between this was some\n\nLet's say there are some X weight to this particular theoretically calculated road.And let's say it was actually using this particular road on which the\n\ntraffic is increased, let's say it  actually was following this kind of agraph, something of that sort. Now similarly all other roads are getting\n\nchanged. So all you can say is remember in this all the theoretically calculatedroads that we have to be calculated we were caching that what all real roads\n\nare a part of this theoretically calculated road. Which is... it is not areal route, but a calculated edge.  So each time this thing changes, weight\n\nchanges on any real road, you basically try to infer, what all actual cachedroads are impacted. And then you basically make a change into the cached roads\n\nalso. So you say that okay the time taken initially was 10 seconds, for thispath, now it has become 15. So let me increase the value of this particular\n\ncalculated road from point E1 to E2 by 5 secondsNow let's say you do this for one segment, then what basically happens is\n\nyou recursively bubble it up over a lot of cached things. So let's sayif there was a mega segment who's...  who had this kind of an entry-exit point\n\nthat this is ME1 and this was in ME2 and you know that ME1, the route fromevery ME1 to ME2 uses this E1-E2. So what you will do is you will basically bubble\n\nup the amount of time for this route by 5 seconds. So what we are essentiallysaying is as then when you get traffic data you basically update the ETA on a\n\nparticular road. Then update the ETA on all the calculated routes that this roadis a part of.  And update and then basically that becomes\n\nat a segment level. And then do the same thing recursively for all the segmentsthat are a part of a mega segment.  So basically what you are doing is you're\n\nbubbling of all the calculated values and then updating whole of the graph.Now these things are not happening at once not all the signals are coming\n\nup at one, right. So as in when something changes you bubble up till the level whereit goes and then stop. So let's say this road was not a part of this ME1 ME2\n\nfor example, then it will stop at the segment level, right. But if it is a partof a mega segment road also, then it will bubble up in the mega segment level.\n\nNow, other than just traffic and weather, there's also one very important factorthat you can use. So you can also use historical ETAs to come up with a real or\n\na predicted ETA for a particular Road. And this historical ETA isbasically calculated in a way that you basically look at the day of week and\n\nthe hour of day so let's say Monday, 5 p.m. this road takes 20 seconds tocover, but on Sundays 5 p.m. is this road takes just 10 seconds to cover so\n\nsomething of that sort is what you can cache at a level of a day of week and hour of day.And then use that historical data to infer. So let's say if you do not have traffic\n\ninformation also, then you can use this kind of an information to somehow comeup with the predicted ETA. Now coming back to the segment, due to some\n\nactivities within the segment so let's just say there are a lot of roads on thesegment. There is there are these two exit points and there are these points\n\nwhich have some roads now let's say we've calculated that the ETA of fastestway to go from point SE1 to SE2, involves 500 units of time.\n\nlet's say 500 seconds, okay. And it uses the route SE1 to A to B to C to SE2, okay.Now let's just say that there's a traffic increase on A to B. Now we could\n\nidentify it by a lot of attributes. Let's just say people moving between A to Btheir average time increases right. Or we get a signal saying you know the\n\ntraffic is increasing significantly. For whatever reasonlet's say we increase the time of basically the ETA for going from point A to\n\npoint B. So it would impact the ETA from SE11 to SE2. Now there is alimit to which it can bubble up right so let's say it increases from 500 to let's\n\nsay 550 due to some increase in A to B so all that is okay. But let's just saythat we have real data of users, and for some reason it is taking a lot of time\n\nfor some people but we put to go from point A to point B and let's just saythis increases to let's say 850. Now a jump from 500 units of time to 850 units\n\nof time is a very big jump. It is having a.. roughly a 70% right.So now it is possible that the fastest route from SE 1 to SE2 does not\n\ninclude this route ABC! It could be some other route. So what we will do is if ETAincreases or decreases, generally in case of increase only we'll do this.\n\nif ETA increases by greater than some percentage. It's a configurable amount.Let's just say we have it set that if the ETA increases by 30%\n\nthen we recalculate things within that segment. Because all the updatesthat you are getting are against a segment only. So whenever a\n\nparticular road's time increases you can calculate everything within thatsegment, right. Which means recalculating paths from SE1 to SE2.\n\nLet's just say, that we figured out that now the new shortest path is not thispath and it is basically the pass from SE1 to A to H to G to F to E and to SE2.\n\nSo, this basically becomes your new shortest path, right. Now if it is the shortestpath, then we need to bubble up that information, right. First of all we need\n\nto say that whoever was traveling from SE1 to SE2, now needs to follow a newpath right which is a path from  SE1-A- H - G - F - E - SE2, right. This is one\n\npart of the things. But what if there was a mega segment over here whichencompasses a lot of segments, whose exit points were also including this\n\nparticular path. This is let us say ME1 and let's say ME2.Now if the exit point path of this Mega Segment also includes this part\n\nthen even that mega segments path would change so the part where they use ABCnow that would get converted into this, right. So these are the things that\n\nyou'll have to do each time a weight changes. so when the increases beyond thethreshold then you have to do. So let's just say increase happen from 500 to 510\n\nthen all of this calculation is probably not even worth it. Because the best youcan get is probably somewhere between 500 to 510. Now let's say 10 seconds\n\nwould not be too much of an enhancement right. But if it is such a big jump from500 to 850 for example then you might as well recalculate everything within the\n\nsegment and then bubble up whatever is required. Now you'll not just calculatewith respect to exit points, you'll also calculate the shortest path to reach\n\nfrom let's say SE1 to A, or SE1 to B.  All of those will also be calculated butfor representation this was a good enough way to explain you the concept.\n\nNow let's look at the architecture of the whole system. So we will do it in two parts:First we'll look at the flow wherein all\n\nusers are connected to the system wherein we are capturing their locationinformation from all the users even if they are not using our map service. This\n\nis basically for improving our map service altogether and a bit of user profiling.In the next section we'll look at how does the actual navigation flow works\n\nfor the user who want to find the shortest route between two points andwhat are the systems required for that. And at the end we'll look at some of the analytics.\n\nWith that let's get started. A bit of a convention to start with:Things in green are basically user devices could be mostly these will be mobile\n\nphones, could be web browsers as well. Things in black are load balancers plusreverse proxies plus an authentication authorization layer in between which\n\nwill authenticate all the external requests comingto the system. Things in blue are the\n\nthings that we have built on our own. Itcould be web services, Kafka consumers or anything of that sort.\n\nThings in red are either some infrastructure component that we've used or somedatabases or some clusters like Kafka, Hadoop and all of that, cool. So let's look at\n\nhow the user flow begins. The very first interaction with the user is when theywhen they have the app installed on their phone, with their\n\nlocation services turn on, so we get regular pings from a user's device every few seconds.Now if the user is stationary, the device will have the\n\nlogic to not send the location ping every five seconds and maybe send itevery five minutes or ten minutes or something of that sort, because that will\n\nreduce the load on our system if the user is anyway at the same point + Better battery life.But while the user is in transit, we will increase the frequency, so as to make\n\nour data more accurate. This talks to.. this basicallykeeps the persistent connection with the device. The reason for a persistent\n\nconnection is, so that we don't have to create a new connection everytime. Also this wouldbe generally a Websocket connection, because sometimes we might need to send\n\nsome information on to the user devices as well. So this WebSocket handler isbasically the service that talks to all the user devices. Now there would normally\n\nbe thousands of such WebSocket handlers for talking to all the users thatare currently online. So we need somebody who can manage the fact that\n\nwhich handler machine is talking to which user. So then comes somethingcalled as a Web Socket Manager.  It basically keeps a track of which machine(read user)\n\nis connected to which WebSocket handler, so which user device is basicallyconnected to which machine of this WebSocket Handler Service.\n\nIt basically keeps that information in a Redis. If let's say it lost thatinformation is lost we can kind of pull that information again from the servers.\n\nSo we don't need to kind of store that information in a persistent Data Store.The next thing what happens is, as in when users are sending their locations\n\nthe frequency of the location pings is handled by the device and then thedevice location comes to us basically coming at the Location Service.\n\nNow Location Service is basically a repository of all the location related information .It basically has some endpoints through which you can ingest\n\nsome users information, something like a user ID with the timestamp with aparticular Lat/Long. That kind of a structure. It puts all of that\n\ninformation into a Cassandra as a permanent data source to keep a track ofthe fact that which user was at what location at what point in time.\n\nRemember this is not just for users who are using our app right now for navigation, but forall the users in the world. How this data would help us we'll come to in a while.\n\nNow, as and when it's getting location pings, it is also putting all of thosepings into a Kafka. All the location pings that are\n\ngoing into this Kafka, are basically read by this Spark Streaming Consumer.This does a lot of calculations,  some of them are here and some of them\n\nwe look at in the later sections. First of all what it does is, if let's say alot of users are traveling at a place where.. which we do not identify, okay. But\n\ntheir movement pattern tells us it looks like a road. So thisbasically is a job which would be a Streaming Job which would look at last\n\nten minutes of data and see how the users are moving and basically it'll be usedto add new roads into our system. Now as and when a new road is added each\n\ntime a new road is added that would basically impact the particular Segmentwithin which the roads are added and then basis that all the Segment\n\nrelated information that we calculated earlier that we talked about earlierthat would be recalculated. So that might impact a lot of segments and Mega Segments recursively\n\nif that's a very critical new road thatwe've found. The next thing is basically an average speed job. What that\n\ndoes is, it basically looks at again if we look at within a segment a lot ofpeople moving from point A to point B, it tries to figure out what is the average\n\nspeed that these users have over let's say last fifteen twenty minutes and usethat information to as a proxy for a real-time information and then suggest\n\nthat and basically it will then update theweights of the graph that we talked about earlier. Again that would\n\nbubble up to various Segments and Mega Segments if that's a part of a critical road.Now how would that bubble of process happen? - So this Spark Streaming Job,\n\nindividual jobs would actually write back things into Kafka. So let's say if anew road is identified, it would write that to a separate topic saying\n\nI've identified a new road which connects point X to point Y. Now therewill be a map update service which listens to that particular topic and it\n\nupdates it in a Data Store. It updates it in a graphs Cassandra, which is managedby this Graph Processing Service, so each time a new road is found,\n\nMap Update Service would invoke Graph Processing Service to tell that I havefound a new road just store that in your Datastore which sits on top of a Cassandra.\n\nNow what this service is, we'll look at in the next section in more detail.Now, each time average speed job finds out there is some change that has happened\n\nit would again put an event into Kafka in a separate topic now and there'll besomething called as a Traffic Update Service that listens to this topic which\n\nwould update the traffic related information again into the sameCassandra through Graph Processing Service. There is something called as a\n\nHotspot Identifier. So let's just say there's a particular locality on whichthere is some average number of people per given area kind of a metric that we\n\nhave. Now let's have suddenly a lot of people start gathering in that areait gives us a signal that there is some activity happening at that point. It\n\ncould be that there is some social event, some sports thing happening or butsomething is happening there so that could be able to identify hotspots\n\nwithin the graph. Because eventually once we identify that hotspot we'll know thatafter probably a while, there will be a lot of traffic in that area as well\n\nright. So that could help us in certain ways. Now for certain things SparkStreaming would itself insert a lot of information and put out\n\nevents but in general it will dump all of that data into Hadoop cluster, whichhas location pings of all the users across a lot of time. Now we could do\n\nsome ML Jobs onto it which classify these certain other things. Solet's say if you've identified a new road but we do not know what kind of a\n\nroad that is. If it's a one-way, if it's a two-way Road, if it's a single lane roador maybe a six-lane Road. So all of those\n\nthings would be identified by this RoadClassifier and this particular job could\n\nnow put that event into that road topicand Map Update Service could now store that additional information saying now\n\nthat I have not just identified that road but now I also know that this is aprobably a six-lane Road or something of that sort\n\nThere could be somethingcalled as a Vehicle Identifier.\n\nWhile you are getting location pings, if you start getting those pings at a veryhigh frequency let's say every one second if you are getting that you can\n\ninput a lot of information about the vehicle in which the person is traveling.So let's just say that the traffic is going normal at certain pace but one\n\nparticular person is stopping every few kilometres let's say, okay. Now what thatcould mean that could mean that either there's a red light or there's a traffic\n\njam there, possibly. But we know what are the junctions you know where the redlights can be we know how the traffic jam are because we know the\n\ndata for the user as well. Now if it's not any of these two criteria then thatmeans that the person is traveling in a public transport something like a bus\n\nand then the bus is stopping at each bus stop, all right. Other kind of things thatwe can infer is if let's say the ride is bumpy or if the person is going left and\n\nright here and there very frequently or having a very fast acceleration and veryfast breaking it's probably a two wheeler. if not in all other scenarios if\n\nit's a smooth enough right stable enough acceleration going straight in one roadit is very likely a four-wheeler. Now we do tell information to Google\n\nspecifically that we are actually traveling in a two wheeler or fourwheeler while we select a map but if let's say that option is not available\n\nthen this kind of data would be good enough to infer which kind of vehicle aperson is traveling in, which will help us in a lot of other attributes. So these\n\nindividual jobs what all they identify they could put that into back into thesame Kafka in probably a separate topic for each\n\njob and then those information could be analysed even further. Now let's look atthe user journey when they want to actually get the navigation from point A\n\nto point B. So normally what people do is they search for a particular locationwhich then gets converted into a particular lat/long right. So all of\n\nthose is being done by Area Search Service. This basically does two kind ofthings. One is, it has some areas within Elastic Search on which it provides fuzzy\n\nsearching and once the person has search for a particular area orlocality or location anything. It then gets converted into a lat/long. So\n\nbasically it stores the lat/long along with the place name, description all ofthat, in a document. The other thing is it tries to dynamically figure out: Given an\n\naddress kind of a thing which lat/long that address points to. So it does thataddress resolution into a lat/long as well. Now let's say... so post the response\n\nfrom this user will have a start point and end point as a latitude longitudeboth of them and then they would want to request the path, okay. First let's\n\nquickly go over what is this Navigation Tracking Service. So while the person isactually started the navigation and they're going towards the destination\n\nall of their location coordinates will be tracked as part of Navigation Tracking Service.This does two main things: 1)  If the user is deviating from the route\n\nthat we suggested, we will kind of inform the app back and then that will probablyshow a pop-up kind of a thing, saying that you are probably going wrong, maybe you\n\nwant to course-correct to the right path. 2) It will also store all thedata so it will push all of the data into Kafka, while the person is traveling\n\nthen that data could be used for later analysis saying, at this point in time aperson searched for a route from point A to point B, and this was the route that\n\nwe recommended. It could be used for figuring out how good the recommendationof the path is. That being said, let's jump to the main piece which actually\n\nfigures out how to connect point A to point B, okay. So all of those requestsare being handled by this Map Service. This Map Service over here is basically an\n\ninterface service which provides multiple interfaces for people torequest the directions from some point to some point. One of the interface is\n\ngiven to the user devices. A similar interface could be given out tocompanies where in all the rate-limiting and their throughput calculation against\n\ntheir account information is being calculated and stored, okay.It's not an intelligent service it just forwards the request to\n\nsomething called as a Graph Processing Service. Graph Processing Servicebasically does a lot of things.  First of all it queries Segment Service which\n\nsits on top of its own Database of Cassandra, in which it stores all thesegments and their corner coordinates along with a lot of information of those\n\nsegments. So let's see if they if the Graph Processing Service wants to figureout that what are the segment's for the start point and the end point, it\n\nwill get that information on the Segment Service. Now if it so happensthat both the points are within the same segment then it's a short duration ride.\n\nThen the Graph Processing Service might choose to do a couple of thingsit might look up that, Do have this data already cached? if yes, it will\n\ndirectly return to the Map Service saying there is a response. If not, it'll thendecide what do I do next? It can now if it is the same segment it\n\ncan probably say that I will run a proper Dijkstra's algorithm and then tryto figure out the shortest path between the two points. It can do that and then\n\nreturn the response. Alternatively, if it's in different segments then it willtry to fan out into the whole basically it will try to create a pick the sub\n\ngraph of the main whole world's graph that we want to look up as part of theDijkstra and run it, okay. Now for doing that it will look up on a lot of things.\n\nFirst of all it will look up for all the roads within those segments, theentry-exit points of the segments, into its Cassandra. It will also have\n\nlive traffic information which would have updated the ETAs into the graphagain from the same Cassandra. Now it\n\nwould have also got some input fromsomething called as a Third Party\n\nData Manager. Now it doesn't queryThird Party Data Manager at runtime.\n\nThird Party Data Manager in fact, pushesdata into Graph Service which then impacts the live traffic information so\n\nlet's say if it says that there is a huge amount of traffic at certain pointit'll update that. Let's say if it says that there is a massive kind of a\n\nrain happening somewhere, it will update the live traffic information thing there issome rain and that would probably cause some delays and the average speed would\n\nslow down and ETA would increase, something of that sort. Now using all ofthat information it basically creates the whole graph that we looked at in the\n\nprevious sections and then it either looks up in the cache and returns theresult or it might run the Dijkstra's Algorithm or some Algorithm to basically\n\nfigure out the shortest path between two points and then return the result.let's say if it doesn't have any traffic information, any ETA information it might\n\nalso query Historical Data Service tofind out at this point in time how much\n\nETA can expect from point A to point B.if it doesn't have that information for\n\nsome of the points. Now Historical Data Servicesits on top of its own Cassandra\n\nwhich basically stores the informationof the form that at some day, day of the\n\nweek like Sunday, Monday, Tuesday in somehour, let's say 4 PM, 5 PM, something of that sort,\n\nfrom point A to point B, how much was the average speed of people normallyand how much ETA did it take. So all of\n\nthat kind of information would be storedin Historical Data Service. Bases all of\n\nthat, Graph Processing Service willreturn back the response to Map Service and then to the user going by the exact\n\nsame set of logic that we looked at in the previous sections. Now all ofthis is done a lot of events have gone into Kafka. One of the common events was\n\nthat by the Area Search Service which we didn't go over. So each time a search ishappening the service will put an event into Kafka. Now what that would do is it\n\nwill basically give us a list of areas that are being searched most often. So wecan do some optimizations for them. Another thing\n\nwould happen is, so not we can do a lot of analytic on top of this data okaythat is coming into Kafka. One of the very first thing we need to do is to\n\nfigure out that out of all the third party that we are integrated with whichof them is actually giving right information and which of them is\n\nactually given the wrong information. How do we do that?So let's say some third party gave us some information saying from point A to\n\npoint B, there is a lot of traffic, and ETAs would increase. But our data if itsays that ETAs have not been impacted at all, that means that particular\n\ninformation was incorrect, right. Now if that happens from the same Third Party alot of times, then we can safely say that, that third party has a wrong\n\ninformation or it gives us wronginformation. right. Now this Third Party\n\nData Manager, abstracts out on a lot ofthird party companies, so we could be\n\npulling data from a lot of companies allof that is abstracted under this Third\n\nParty Data Manager but the reporting would be done at an individualorganization level. That being said, there are a lot of other kinds of analytics\n\nthat we might want to do. First of all we might want to identify what is the roadthat a particular person is on, right? so as part of navigation you want to\n\nprobably have a audio kind of a thing saying turn right in ninety meters toget on Mahatma Gandhi Road,or something of that sort, right. All of that inferences\n\ncould be done by the Spark Streaming saying where exactly I am in how muchtime am I about to reach a junction and what is the road name on\n\nwhich I will get to next. So all of that could be done by this. There are a lot ofother analytics that we could also do on top of this data. Let us look at it next.\n\nSo out of all the events that are being put into this Kafka, there is a lot ofanalytics that we can do and we should do. So one of the very important things\n\nto analyze is how accurate our ETA predictions are? So let's just say wepredicted that it will take 40 minutes to cover a distance from point A to\n\npoint B and if it takes something around 38-39 minutes then that's fairly accurate.But if in real world it takes somewhere around 20 minutes then that's a fairly\n\nbad prediction. So we need to have this data on how accurate our predictions areso that we can figure out that we need to invest more time into you know\n\nupgrading that algorithm that comes up with the ETAs. Along with that it willalso give us some information about which of the routes are the ones that we\n\nare recommending to people, but people are not taking. Maybe there is somethingwrong with the routes that exist in our database, right. So all of those things\n\ncould also be inferred. Some common things that we can infer is what are somecommon hotspots in the city that people gather at. These could be some social\n\ngathering places or things of that sort. So that will kind of give us some pointsof interest that we can build over time using this data to start with. Other than that\n\nsome obvious things that we can also figure out is, what are the homelocations and work locations of some of the people. We could also infer user\n\nprofile data. So for example if a person is going to a lot of pubs for examplethen they are more of a social kind of a person. If a person is traveling\n\noutside the city very frequently on weekends, the person likes travelling. Sothings like that can also be inferred basis just a location data. Coming to the\n\nlast thing, now this normally wouldn't be a part of a design interview but there'ssomething you should be aware of because this is an important thing that\n\ncompanies like Google Maps have to take care of. So how do you handle disputedareas? So while in Google Maps there is a clear-cut boundary of states and\n\ncountries and all of that but if there is a disputed region how does Google Mapsdecide where to make the boundary of the country or state right. So a classic\n\nexample of this would be a dispute between the countries of India, Pakistanand China in the state of Jammu and Kashmir. So India claims that whole of\n\nthe land is under their territory. China claims that some of the parts of thatstate belongs to China and Pakistan claims that some of the parts of that\n\nstate belongs to Pakistan. So now how does Google decide or any such mappingprovider decides, that how where do they define the country boundaries, right. Now\n\nthis becomes very tricky for Google because they cannot take anybody's sideand whichever decision they make they are going to kind of piss off some of\n\nthe countries. Plus that's even worse in this scenario because these three countries combined together have more than one third of the world's population.\n\nSo that's a very rich source of revenue for Google. So how can you handle? -  so what Google does is something very smart and also very tricky. So what they do is, based\n\non the country where you are coming from they'll show you a different country boundary. So for people who are coming from India, to all of those people they\n\nshow that the whole part belongs to India. Now to the people of Pakistan they show that the part that they are claiming belongs to Pakistan and the\n\nparts that are disputed between India and China are shown as the dotted line. Similarly for people coming from China they show the part that China claims is\n\ntheirs they show under China's territory and remaining disputed area between India and Pakistan is shown as a dotted line with no country boundary\n\nspecified. So this is something if if you come across this kind of the thing in aninterview could try to replicate but keep this out of the scope of the\n\ninterview at least, but still something good to know. ",
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "given the lat/longs we would be able toidentify an aerial distance between them. Let's just say that the aerial distance\n\nbetween them is 10 kilometers, okay.  We also know that each segment is onekilometer by one kilometer in length and width right. So what we can say is we'll\n\nat max go... so because this is 10 kilometers on aerial distance, what wecan say is.. adding some buffers we will not cross more than 20 Segments on each\n\ndirections either going from North to South or going from East to West. That 20number is basically a buffer that you can come up with based on your\n\nconversation with your interviewer. But the idea is this number(10 KMs) will give us some input onto how many segments do I want to look at. So 20 segments on the\n\nNorth-South side and 20 segments on East-West side is what we'll look at to come up withthe optimal route from point A to point B. Because normally what would happen is\n\nthere will be millions of roads into the world. And if you start doing aDijkstra across the whole globe just to calculate distance between these two\n\npoints, that will be very un-optimal.  So we have to break that Dijkstra at some point in time.So this number would be used to break that Dijkstra saying that we will not go\n\nfurther that beyond this point. Now one obvious way to solve this is you haveall the roads connecting the whole city which cuts these two points as well.\n\nRun a Dijkstra across the city and then come up with the shortest distance betweenpoint A to point B. But if you look at it and if you look at it that way that\n\nthere are probably millions of users querying at the same time to finddistance between any two points, Running those many number of Dijkstra's Algorithms\n\nwould be heavily inefficient. So we'll do some slight optimization there.What we'll do is, there are... we'll basically say that there are two exits\n\nout of this block(Segment having A). Basically to reach this block(Segment having B) we need to exit this blockand there are these two ways. Let's say if we have calculated that these two are the only\n\nexists within this segment. Let's say this a segment S1. So A belongs to S1 andthese two are the exits, this is S1E1 and this is S1E2 and they have\n\nsome great W 1 and W 2 let's say.  Now what we'll do is, this segment...this junction is basically having two points. One is S1E1.. two identifiers basically,\n\nS1E1 and S2E1. this is segment ID S2 and this is exit number one of thatsegment so this has another identifier for S2. What we are saying then is this\n\nhas another point on the same route which is S2E1 and weight between them zero.similarly there'll be a lot of points. This graph will fan out.\n\nOn the other side for B, let's say B belongs to segment S4 thereare another two exits through which you can reach B. One is S4E2 and one\n\nis this one which is S4E1 even.Now if we just connect all the exits to exits\n\nfor ten blocks(Segments) on the North side, ten blocks(Segments) on the South side, ten blockson this side and ten blocks on that side, we'll basically be able to come up with a\n\ncrisscross of a lot of Road whichconnects these four points right and\n\nthere'll be a lot of junctions within that, there'll be a lot of roads, but thesewill be basically just entry points and exit points of the segments. We don't\n\nreally care what are... what is happening within the segment when we are cuttingacross segments. Why? -  because to reach this segment we anyway need to cross all\n\nof the other segments right. Now we don't care if this route which we are callingas let's say this is segment S6 and this point is S6E1, this point is S6E2\n\nNow this is basically a calculated path from these two exit points. Thisexit point to that exit point basically. This real path would look something like\n\nthis right but we don't really care what's happening within the segment.All we care about is from this point(S6E1) to this point(S6E2), I know the distance, and I'll use that.\n\nThen from this point to this point I know the distance I'll use that. So we'llbasically be using all the exit points distances and use them as weights,\n\nand come up with this graph at runtime.Now given like ten  segments on each side, we'll probably have\n\nthis graph of a couple of hundreds of edges at max right. Now we can run aDijkstra on this graph staying with that what is the shortest path to go from\n\nhere(A) to here(B). This Dijkstra runs on top of the graph which was created byjust entry points and exit points in everything else, and entry point and\n\nstart point and entry point and end point in the starting and ending segments.Everything else was just a connector from individual end point to individuals\n\nbasically exits of a particular segment. Now this is fine when we have to travelfor like ten odd kilometers we can still create a graph of these 100-200 edges\n\nand calculate. What if you want to go  inter-city? What if you want togo from City 1 to City 2 and then you want to calculate it? Then it becomes a\n\nbig trouble to... because let's say the distance between those two city isthousand kilometers then there are possibly thousands of segments\n\nmultiple thousands of segments that you'll look at, right. That would too complicatedto run a Dijkstra at runtime. Now like we extended the solution from one segment\n\nto multiple segments, we can basically create a Mega-Segment, right? We cansay this whole thing that you see here is 1 Mega-Segment and there could be\n\nthis exit to this Mega Segment this exit to this Mega Segment and probably anexit here to this Mega Segment, right? And then what we can say is, let's say you\n\nhave this whole map of a country. I know it looks terrible but let's say this isone country, what you can say this is 1 mega segment you can basically divide\n\nthis country into mega segments. And then recursively solve for it evenfurther. Now when you were to if you are to solve in the mega segment world you\n\nhave basically converted this whole country into possibly 50 mega segmentsand now if you want to go from here to here, you basically need to just connect\n\nthe exit points of individual Mega Segments. You don't reallycare what is happening within a mega segment, you don't really care what is\n\nhappening within segments under those mega segments and roads under thosesegments. All you care about it from my start point how do I get to the nearest\n\nexit or all the exits of that mega segment and from these exits of megasegments how do I get to further mega segments recursively and then somehow\n\nreach this end point, right. Now you can have n levels of nesting. Ideally threelevels of nesting is more than enough. Now what is the ideal size of this mega\n\nsegment? - Again there is no right answer you can come up with based on somecalculation with your interview again on this. But the idea if you still want\n\nto calculate this thing across cities or across states,  this segment approachwould still not scale you need to do an abstraction on top of segments which can\n\nbe represented as a Mega-Segment and then solve it recursively.All good so far but we have not really talked about how do we come up with the\n\nweights on an edge and how do...what all weights do we even consider? So thevery first obvious weight is the amount of distance between two points right so\n\nthat is one thing that will definitely have.  Along with that we will also keepan ETA that normally under normal traffic conditions, in the normal weather\n\nconditions, how much time does it take for a user to go from point A to point B.Now when we have both these information we can obviously keep a next\n\nobvious thing saying what is the average speed of vehicles.Speed = (distance/time) so  basis that will be able to come up with an average speed.\n\nNow you might think that the next obvious you things are weights liketraffic and weather condition and all of that but I would definitely not\n\nrecommend that. Even... let's assume this is what we have build already andnow somebody comes up and asks you to implement traffic data into this okay\n\nnow if you want to add traffic as a weight onto your edges that'll be avery very bad design. Why? - Because with an additional attribute that you are adding\n\nyou are basically changing the logic of your underlying Dijkstra which runs on asegment, right. Now let's say tomorrow somebody comes up asking you for a\n\nweather information you will again change the whole logic of your Dijkstra.That piece is a bad design, okay. So ideally.. basically the set of things that a good\n\ndesign should entail is basically that it should not restrict addition of newfeatures plus each change should be small enough and contained. It should not\n\nbasically impact the whole feature.  So what we'll say is traffic and all all ofthose in things are basically attributes which impact your speed okay and basis\n\nwhatever your average speed is you can calculate the ETA as a function ofdistance and average speed, right?  So all we'll say is traffic, weather, roadblocks all\n\nof those they'll never be weights on your graph, okay. They would just be attributesthat impact your average speed. So average speed would be a function of\n\ntraffic, it could be a function of weatherit could be a function of any number of fields that you want. Let's say if you\n\nwant to add a accident, or construction work going on someplace or whatever you want to add.So all of those would basically impact your average speed. Now normally\n\nyou don't have to do all these fancy things, never ever! Why? - Because it's for acompany like Google Maps they know... let's say there are hundreds of people\n\ngoing from point A to point B. They  anyway know how much time they tookright plus a very important feature about this kind of data is, this traffic\n\ndata would always be normally distributed. So if we want to plot, Let's saythis is basically any metrics let's say ETA of how much time it took for people\n\nto go from point A to point B on a graph it would always look like a normaldistribution, okay. What that means is you do kwow that there is this point which\n\nmost of the users are hitting and as a... with some statistical calculations ofone standard deviation from each of these point you will be easily be able to\n\ncalculate this range that normally for most of your users at least 50-60-70%of your users, this is the window of time that it will take. Let's say this is\n\n5 seconds this is 7 seconds and let's say average is 6 secondsfor example so statistically you can come up with this number as a function\n\nof lot of users who are crossing the roads. So you don't really care how muchis the traffic, what is the weather, when you anyway have this real-time information\n\nSo for all the geographies where you have people usingyour application, there you have organic data from real users at this point in\n\ntime so you don't really care about traffic and all of that. Traffic and allother things will come into picture only in places where you can either not get\n\nenough data from users or there is some other reason why you're maybe legallynot allowed to get information of users right because of which if you don't have\n\nreal data users, then is when you will bother about using traffic and weatherand all those attributes to come up with this average speed number basis\n\nthat you can even know the distance from point A to point B, you can come upwith a ETA, okay. Now how do we quantify traffic?\n\nyou cannot say that if there are 805 vehicles, it will take this much amountof time, right. The number of vehicles on a road and things like that cannot be\n\ncalculated at all. No matter how good technology you build right. So when thesethings cannot be quantified how do you use them as a measure? So what we\n\ncan say is basically create multiple \"Tiers\". Let's say this is traffic measurementand this is Weather Management.  All you can say is traffic is low or it is\n\nmedium or it is high and whether it is good or it is bad, right. So you willhave these kind of Tiers for each of the attributes that you have and all you can\n\nsay is every time traffic goes from here(Low) to here(Medium), it has a 20% increase ontoaverage speed or something of that sort. right every time traffic goes from low\n\nto medium, average speed reduces by 20 percent. Basis these transitions oftraffic volume... now you can always say that traffic is low or high based on the\n\nnumber of users that are probably using your application or from some othersources, right. Let's say you have this kind of a measure, so there are companies\n\nlike Waze and all, which will give you the kind of information that how's theweather, how is the traffic in a very abstracted form. Now once you have\n\nthis information you can calculate average speed as a relative number fromthe original value calculated. so let's say with the good weather, with the\n\nmedium traffic you knew the average speed was later 20 kilometers per hourNow if the traffic goes to high, you kind of reduce it by 20%, so it basically\n\nbecomes 16 kilometers per hour. Basis is this kind of a calculation, you willcalculate the ETA. Now as and when inputs are coming, you are making changes\n\ninto your weights on the graph. How does it impact the overall system? Socoming back to the previous drawing that we made remember we had something called\n\nas a segment and we had lots of roads within the segment and let's say thetraffic increase we got a signal from some third party saying traffic has\n\nincreased on a particular Road. Now do whatever you want to. Now let's say therewas this one exit point and one exit point and distance between this was some\n\nLet's say there are some X weight to this particular theoretically calculated road.And let's say it was actually using this particular road on which the\n\ntraffic is increased, let's say it  actually was following this kind of agraph, something of that sort. Now similarly all other roads are getting\n\nchanged. So all you can say is remember in this all the theoretically calculatedroads that we have to be calculated we were caching that what all real roads\n\nare a part of this theoretically calculated road. Which is... it is not areal route, but a calculated edge.  So each time this thing changes, weight\n\nchanges on any real road, you basically try to infer, what all actual cachedroads are impacted. And then you basically make a change into the cached roads\n\nalso. So you say that okay the time taken initially was 10 seconds, for thispath, now it has become 15. So let me increase the value of this particular\n\ncalculated road from point E1 to E2 by 5 secondsNow let's say you do this for one segment, then what basically happens is\n\nyou recursively bubble it up over a lot of cached things. So let's sayif there was a mega segment who's...  who had this kind of an entry-exit point\n\nthat this is ME1 and this was in ME2 and you know that ME1, the route fromevery ME1 to ME2 uses this E1-E2. So what you will do is you will basically bubble\n\nup the amount of time for this route by 5 seconds. So what we are essentiallysaying is as then when you get traffic data you basically update the ETA on a\n\nparticular road. Then update the ETA on all the calculated routes that this roadis a part of.  And update and then basically that becomes\n\nat a segment level. And then do the same thing recursively for all the segmentsthat are a part of a mega segment.  So basically what you are doing is you're\n\nbubbling of all the calculated values and then updating whole of the graph.Now these things are not happening at once not all the signals are coming\n\nup at one, right. So as in when something changes you bubble up till the level whereit goes and then stop. So let's say this road was not a part of this ME1 ME2\n\nfor example, then it will stop at the segment level, right. But if it is a partof a mega segment road also, then it will bubble up in the mega segment level.\n\nNow, other than just traffic and weather, there's also one very important factorthat you can use. So you can also use historical ETAs to come up with a real or\n\na predicted ETA for a particular Road. And this historical ETA isbasically calculated in a way that you basically look at the day of week and\n\nthe hour of day so let's say Monday, 5 p.m. this road takes 20 seconds tocover, but on Sundays 5 p.m. is this road takes just 10 seconds to cover so\n\nsomething of that sort is what you can cache at a level of a day of week and hour of day.And then use that historical data to infer. So let's say if you do not have traffic\n\ninformation also, then you can use this kind of an information to somehow comeup with the predicted ETA. Now coming back to the segment, due to some\n\nactivities within the segment so let's just say there are a lot of roads on thesegment. There is there are these two exit points and there are these points\n\nwhich have some roads now let's say we've calculated that the ETA of fastestway to go from point SE1 to SE2, involves 500 units of time.\n\nlet's say 500 seconds, okay. And it uses the route SE1 to A to B to C to SE2, okay.Now let's just say that there's a traffic increase on A to B. Now we could\n\nidentify it by a lot of attributes. Let's just say people moving between A to Btheir average time increases right. Or we get a signal saying you know the\n\ntraffic is increasing significantly. For whatever reasonlet's say we increase the time of basically the ETA for going from point A to\n\npoint B. So it would impact the ETA from SE11 to SE2. Now there is alimit to which it can bubble up right so let's say it increases from 500 to let's\n\nsay 550 due to some increase in A to B so all that is okay. But let's just saythat we have real data of users, and for some reason it is taking a lot of time\n\nfor some people but we put to go from point A to point B and let's just saythis increases to let's say 850. Now a jump from 500 units of time to 850 units\n\nof time is a very big jump. It is having a.. roughly a 70% right.So now it is possible that the fastest route from SE 1 to SE2 does not\n\ninclude this route ABC! It could be some other route. So what we will do is if ETAincreases or decreases, generally in case of increase only we'll do this.\n\nif ETA increases by greater than some percentage. It's a configurable amount.Let's just say we have it set that if the ETA increases by 30%\n\nthen we recalculate things within that segment. Because all the updatesthat you are getting are against a segment only. So whenever a\n\nparticular road's time increases you can calculate everything within thatsegment, right. Which means recalculating paths from SE1 to SE2.\n\nLet's just say, that we figured out that now the new shortest path is not thispath and it is basically the pass from SE1 to A to H to G to F to E and to SE2.\n\nSo, this basically becomes your new shortest path, right. Now if it is the shortestpath, then we need to bubble up that information, right. First of all we need\n\nto say that whoever was traveling from SE1 to SE2, now needs to follow a newpath right which is a path from  SE1-A- H - G - F - E - SE2, right. This is one\n\npart of the things. But what if there was a mega segment over here whichencompasses a lot of segments, whose exit points were also including this\n\nparticular path. This is let us say ME1 and let's say ME2.Now if the exit point path of this Mega Segment also includes this part\n\nthen even that mega segments path would change so the part where they use ABCnow that would get converted into this, right. So these are the things that\n\nyou'll have to do each time a weight changes. so when the increases beyond thethreshold then you have to do. So let's just say increase happen from 500 to 510\n\nthen all of this calculation is probably not even worth it. Because the best youcan get is probably somewhere between 500 to 510. Now let's say 10 seconds\n\nwould not be too much of an enhancement right. But if it is such a big jump from500 to 850 for example then you might as well recalculate everything within the\n\nsegment and then bubble up whatever is required. Now you'll not just calculatewith respect to exit points, you'll also calculate the shortest path to reach\n\nfrom let's say SE1 to A, or SE1 to B.  All of those will also be calculated butfor representation this was a good enough way to explain you the concept.\n\nNow let's look at the architecture of the whole system. So we will do it in two parts:First we'll look at the flow wherein all\n\nusers are connected to the system wherein we are capturing their locationinformation from all the users even if they are not using our map service. This\n\nis basically for improving our map service altogether and a bit of user profiling.In the next section we'll look at how does the actual navigation flow works\n\nfor the user who want to find the shortest route between two points andwhat are the systems required for that. And at the end we'll look at some of the analytics.\n\nWith that let's get started. A bit of a convention to start with:Things in green are basically user devices could be mostly these will be mobile\n\nphones, could be web browsers as well. Things in black are load balancers plusreverse proxies plus an authentication authorization layer in between which\n\nwill authenticate all the external requests comingto the system. Things in blue are the\n\nthings that we have built on our own. Itcould be web services, Kafka consumers or anything of that sort.\n\nThings in red are either some infrastructure component that we've used or somedatabases or some clusters like Kafka, Hadoop and all of that, cool. So let's look at\n\nhow the user flow begins. The very first interaction with the user is when theywhen they have the app installed on their phone, with their\n\nlocation services turn on, so we get regular pings from a user's device every few seconds.Now if the user is stationary, the device will have the\n\nlogic to not send the location ping every five seconds and maybe send itevery five minutes or ten minutes or something of that sort, because that will\n\nreduce the load on our system if the user is anyway at the same point + Better battery life.But while the user is in transit, we will increase the frequency, so as to make\n\nour data more accurate. This talks to.. this basicallykeeps the persistent connection with the device. The reason for a persistent\n\nconnection is, so that we don't have to create a new connection everytime. Also this wouldbe generally a Websocket connection, because sometimes we might need to send\n\nsome information on to the user devices as well. So this WebSocket handler isbasically the service that talks to all the user devices. Now there would normally\n\nbe thousands of such WebSocket handlers for talking to all the users thatare currently online. So we need somebody who can manage the fact that\n\nwhich handler machine is talking to which user. So then comes somethingcalled as a Web Socket Manager.  It basically keeps a track of which machine(read user)\n\nis connected to which WebSocket handler, so which user device is basicallyconnected to which machine of this WebSocket Handler Service.\n\nIt basically keeps that information in a Redis. If let's say it lost thatinformation is lost we can kind of pull that information again from the servers.\n\nSo we don't need to kind of store that information in a persistent Data Store.The next thing what happens is, as in when users are sending their locations\n\nthe frequency of the location pings is handled by the device and then thedevice location comes to us basically coming at the Location Service.\n\nNow Location Service is basically a repository of all the location related information .It basically has some endpoints through which you can ingest\n\nsome users information, something like a user ID with the timestamp with aparticular Lat/Long. That kind of a structure. It puts all of that\n\ninformation into a Cassandra as a permanent data source to keep a track ofthe fact that which user was at what location at what point in time.\n\nRemember this is not just for users who are using our app right now for navigation, but forall the users in the world. How this data would help us we'll come to in a while.\n\nNow, as and when it's getting location pings, it is also putting all of thosepings into a Kafka. All the location pings that are\n\ngoing into this Kafka, are basically read by this Spark Streaming Consumer.This does a lot of calculations,  some of them are here and some of them\n\nwe look at in the later sections. First of all what it does is, if let's say alot of users are traveling at a place where.. which we do not identify, okay. But\n\ntheir movement pattern tells us it looks like a road. So thisbasically is a job which would be a Streaming Job which would look at last\n\nten minutes of data and see how the users are moving and basically it'll be usedto add new roads into our system. Now as and when a new road is added each\n\ntime a new road is added that would basically impact the particular Segmentwithin which the roads are added and then basis that all the Segment\n\nrelated information that we calculated earlier that we talked about earlierthat would be recalculated. So that might impact a lot of segments and Mega Segments recursively\n\nif that's a very critical new road thatwe've found. The next thing is basically an average speed job. What that\n\ndoes is, it basically looks at again if we look at within a segment a lot ofpeople moving from point A to point B, it tries to figure out what is the average\n\nspeed that these users have over let's say last fifteen twenty minutes and usethat information to as a proxy for a real-time information and then suggest\n\nthat and basically it will then update theweights of the graph that we talked about earlier. Again that would\n\nbubble up to various Segments and Mega Segments if that's a part of a critical road.Now how would that bubble of process happen? - So this Spark Streaming Job,\n\nindividual jobs would actually write back things into Kafka. So let's say if anew road is identified, it would write that to a separate topic saying\n\nI've identified a new road which connects point X to point Y. Now therewill be a map update service which listens to that particular topic and it\n\nupdates it in a Data Store. It updates it in a graphs Cassandra, which is managedby this Graph Processing Service, so each time a new road is found,\n\nMap Update Service would invoke Graph Processing Service to tell that I havefound a new road just store that in your Datastore which sits on top of a Cassandra.\n\nNow what this service is, we'll look at in the next section in more detail.Now, each time average speed job finds out there is some change that has happened\n\nit would again put an event into Kafka in a separate topic now and there'll besomething called as a Traffic Update Service that listens to this topic which\n\nwould update the traffic related information again into the sameCassandra through Graph Processing Service. There is something called as a\n\nHotspot Identifier. So let's just say there's a particular locality on whichthere is some average number of people per given area kind of a metric that we\n\nhave. Now let's have suddenly a lot of people start gathering in that areait gives us a signal that there is some activity happening at that point. It\n\ncould be that there is some social event, some sports thing happening or butsomething is happening there so that could be able to identify hotspots\n\nwithin the graph. Because eventually once we identify that hotspot we'll know thatafter probably a while, there will be a lot of traffic in that area as well\n\nright. So that could help us in certain ways. Now for certain things SparkStreaming would itself insert a lot of information and put out\n\nevents but in general it will dump all of that data into Hadoop cluster, whichhas location pings of all the users across a lot of time. Now we could do\n\nsome ML Jobs onto it which classify these certain other things. Solet's say if you've identified a new road but we do not know what kind of a\n\nroad that is. If it's a one-way, if it's a two-way Road, if it's a single lane roador maybe a six-lane Road. So all of those\n\nthings would be identified by this RoadClassifier and this particular job could\n\nnow put that event into that road topicand Map Update Service could now store that additional information saying now\n\nthat I have not just identified that road but now I also know that this is aprobably a six-lane Road or something of that sort\n\nThere could be somethingcalled as a Vehicle Identifier.\n\nWhile you are getting location pings, if you start getting those pings at a veryhigh frequency let's say every one second if you are getting that you can\n\ninput a lot of information about the vehicle in which the person is traveling.So let's just say that the traffic is going normal at certain pace but one\n\nparticular person is stopping every few kilometres let's say, okay. Now what thatcould mean that could mean that either there's a red light or there's a traffic\n\njam there, possibly. But we know what are the junctions you know where the redlights can be we know how the traffic jam are because we know the\n\ndata for the user as well. Now if it's not any of these two criteria then thatmeans that the person is traveling in a public transport something like a bus\n\nand then the bus is stopping at each bus stop, all right. Other kind of things thatwe can infer is if let's say the ride is bumpy or if the person is going left and\n\nright here and there very frequently or having a very fast acceleration and veryfast breaking it's probably a two wheeler. if not in all other scenarios if\n\nit's a smooth enough right stable enough acceleration going straight in one roadit is very likely a four-wheeler. Now we do tell information to Google\n\nspecifically that we are actually traveling in a two wheeler or fourwheeler while we select a map but if let's say that option is not available\n\nthen this kind of data would be good enough to infer which kind of vehicle aperson is traveling in, which will help us in a lot of other attributes. So these\n\nindividual jobs what all they identify they could put that into back into thesame Kafka in probably a separate topic for each\n\njob and then those information could be analysed even further. Now let's look atthe user journey when they want to actually get the navigation from point A\n\nto point B. So normally what people do is they search for a particular locationwhich then gets converted into a particular lat/long right. So all of\n\nthose is being done by Area Search Service. This basically does two kind ofthings. One is, it has some areas within Elastic Search on which it provides fuzzy\n\nsearching and once the person has search for a particular area orlocality or location anything. It then gets converted into a lat/long. So\n\nbasically it stores the lat/long along with the place name, description all ofthat, in a document. The other thing is it tries to dynamically figure out: Given an\n\naddress kind of a thing which lat/long that address points to. So it does thataddress resolution into a lat/long as well. Now let's say... so post the response\n\nfrom this user will have a start point and end point as a latitude longitudeboth of them and then they would want to request the path, okay. First let's\n\nquickly go over what is this Navigation Tracking Service. So while the person isactually started the navigation and they're going towards the destination\n\nall of their location coordinates will be tracked as part of Navigation Tracking Service.This does two main things: 1)  If the user is deviating from the route\n\nthat we suggested, we will kind of inform the app back and then that will probablyshow a pop-up kind of a thing, saying that you are probably going wrong, maybe you\n\nwant to course-correct to the right path. 2) It will also store all thedata so it will push all of the data into Kafka, while the person is traveling\n\nthen that data could be used for later analysis saying, at this point in time aperson searched for a route from point A to point B, and this was the route that\n\nwe recommended. It could be used for figuring out how good the recommendationof the path is. That being said, let's jump to the main piece which actually\n\nfigures out how to connect point A to point B, okay. So all of those requestsare being handled by this Map Service. This Map Service over here is basically an\n\ninterface service which provides multiple interfaces for people torequest the directions from some point to some point. One of the interface is\n\ngiven to the user devices. A similar interface could be given out tocompanies where in all the rate-limiting and their throughput calculation against\n\ntheir account information is being calculated and stored, okay.It's not an intelligent service it just forwards the request to\n\nsomething called as a Graph Processing Service. Graph Processing Servicebasically does a lot of things.  First of all it queries Segment Service which\n\nsits on top of its own Database of Cassandra, in which it stores all thesegments and their corner coordinates along with a lot of information of those\n\nsegments. So let's see if they if the Graph Processing Service wants to figureout that what are the segment's for the start point and the end point, it\n\nwill get that information on the Segment Service. Now if it so happensthat both the points are within the same segment then it's a short duration ride.\n\nThen the Graph Processing Service might choose to do a couple of thingsit might look up that, Do have this data already cached? if yes, it will\n\ndirectly return to the Map Service saying there is a response. If not, it'll thendecide what do I do next? It can now if it is the same segment it\n\ncan probably say that I will run a proper Dijkstra's algorithm and then tryto figure out the shortest path between the two points. It can do that and then\n\nreturn the response. Alternatively, if it's in different segments then it willtry to fan out into the whole basically it will try to create a pick the sub\n\ngraph of the main whole world's graph that we want to look up as part of theDijkstra and run it, okay. Now for doing that it will look up on a lot of things.\n\nFirst of all it will look up for all the roads within those segments, theentry-exit points of the segments, into its Cassandra. It will also have\n\nlive traffic information which would have updated the ETAs into the graphagain from the same Cassandra. Now it\n\nwould have also got some input fromsomething called as a Third Party\n\nData Manager. Now it doesn't queryThird Party Data Manager at runtime.\n\nThird Party Data Manager in fact, pushesdata into Graph Service which then impacts the live traffic information so\n\nlet's say if it says that there is a huge amount of traffic at certain pointit'll update that. Let's say if it says that there is a massive kind of a\n\nrain happening somewhere, it will update the live traffic information thing there issome rain and that would probably cause some delays and the average speed would\n\nslow down and ETA would increase, something of that sort. Now using all ofthat information it basically creates the whole graph that we looked at in the\n\nprevious sections and then it either looks up in the cache and returns theresult or it might run the Dijkstra's Algorithm or some Algorithm to basically\n\nfigure out the shortest path between two points and then return the result.let's say if it doesn't have any traffic information, any ETA information it might\n\nalso query Historical Data Service tofind out at this point in time how much\n\nETA can expect from point A to point B.if it doesn't have that information for\n\nsome of the points. Now Historical Data Servicesits on top of its own Cassandra\n\nwhich basically stores the informationof the form that at some day, day of the\n\nweek like Sunday, Monday, Tuesday in somehour, let's say 4 PM, 5 PM, something of that sort,\n\nfrom point A to point B, how much was the average speed of people normallyand how much ETA did it take. So all of\n\nthat kind of information would be storedin Historical Data Service. Bases all of\n\nthat, Graph Processing Service willreturn back the response to Map Service and then to the user going by the exact\n\nsame set of logic that we looked at in the previous sections. Now all ofthis is done a lot of events have gone into Kafka. One of the common events was\n\nthat by the Area Search Service which we didn't go over. So each time a search ishappening the service will put an event into Kafka. Now what that would do is it\n\nwill basically give us a list of areas that are being searched most often. So wecan do some optimizations for them. Another thing\n\nwould happen is, so not we can do a lot of analytic on top of this data okaythat is coming into Kafka. One of the very first thing we need to do is to\n\nfigure out that out of all the third party that we are integrated with whichof them is actually giving right information and which of them is\n\nactually given the wrong information. How do we do that?So let's say some third party gave us some information saying from point A to\n\npoint B, there is a lot of traffic, and ETAs would increase. But our data if itsays that ETAs have not been impacted at all, that means that particular\n\ninformation was incorrect, right. Now if that happens from the same Third Party alot of times, then we can safely say that, that third party has a wrong\n\ninformation or it gives us wronginformation. right. Now this Third Party\n\nData Manager, abstracts out on a lot ofthird party companies, so we could be\n\npulling data from a lot of companies allof that is abstracted under this Third\n\nParty Data Manager but the reporting would be done at an individualorganization level. That being said, there are a lot of other kinds of analytics\n\nthat we might want to do. First of all we might want to identify what is the roadthat a particular person is on, right? so as part of navigation you want to\n\nprobably have a audio kind of a thing saying turn right in ninety meters toget on Mahatma Gandhi Road,or something of that sort, right. All of that inferences\n\ncould be done by the Spark Streaming saying where exactly I am in how muchtime am I about to reach a junction and what is the road name on\n\nwhich I will get to next. So all of that could be done by this. There are a lot ofother analytics that we could also do on top of this data. Let us look at it next.\n\nSo out of all the events that are being put into this Kafka, there is a lot ofanalytics that we can do and we should do. So one of the very important things\n\nto analyze is how accurate our ETA predictions are? So let's just say wepredicted that it will take 40 minutes to cover a distance from point A to\n\npoint B and if it takes something around 38-39 minutes then that's fairly accurate.But if in real world it takes somewhere around 20 minutes then that's a fairly\n\nbad prediction. So we need to have this data on how accurate our predictions areso that we can figure out that we need to invest more time into you know\n\nupgrading that algorithm that comes up with the ETAs. Along with that it willalso give us some information about which of the routes are the ones that we\n\nare recommending to people, but people are not taking. Maybe there is somethingwrong with the routes that exist in our database, right. So all of those things\n\ncould also be inferred. Some common things that we can infer is what are somecommon hotspots in the city that people gather at. These could be some social\n\ngathering places or things of that sort. So that will kind of give us some pointsof interest that we can build over time using this data to start with. Other than that\n\nsome obvious things that we can also figure out is, what are the homelocations and work locations of some of the people. We could also infer user\n\nprofile data. So for example if a person is going to a lot of pubs for examplethen they are more of a social kind of a person. If a person is traveling\n\noutside the city very frequently on weekends, the person likes travelling. Sothings like that can also be inferred basis just a location data. Coming to the\n\nlast thing, now this normally wouldn't be a part of a design interview but there'ssomething you should be aware of because this is an important thing that\n\ncompanies like Google Maps have to take care of. So how do you handle disputedareas? So while in Google Maps there is a clear-cut boundary of states and\n\ncountries and all of that but if there is a disputed region how does Google Mapsdecide where to make the boundary of the country or state right. So a classic\n\nexample of this would be a dispute between the countries of India, Pakistanand China in the state of Jammu and Kashmir. So India claims that whole of\n\nthe land is under their territory. China claims that some of the parts of thatstate belongs to China and Pakistan claims that some of the parts of that\n\nstate belongs to Pakistan. So now how does Google decide or any such mappingprovider decides, that how where do they define the country boundaries, right. Now\n\nthis becomes very tricky for Google because they cannot take anybody's sideand whichever decision they make they are going to kind of piss off some of\n\nthe countries. Plus that's even worse in this scenario because these three countries combined together have more than one third of the world's population.\n\nSo that's a very rich source of revenue for Google. So how can you handle? -  so what Google does is something very smart and also very tricky. So what they do is, based\n\non the country where you are coming from they'll show you a different country boundary. So for people who are coming from India, to all of those people they\n\nshow that the whole part belongs to India. Now to the people of Pakistan they show that the part that they are claiming belongs to Pakistan and the\n\nparts that are disputed between India and China are shown as the dotted line. Similarly for people coming from China they show the part that China claims is\n\ntheirs they show under China's territory and remaining disputed area between India and Pakistan is shown as a dotted line with no country boundary\n\nspecified. So this is something if if you come across this kind of the thing in aninterview could try to replicate but keep this out of the scope of the\n\ninterview at least, but still something good to know. ",
			"lineHeight": 1.2
		},
		{
			"id": "UWK4HqU838u5H1oX_-nr8",
			"type": "image",
			"x": 29138.390520604975,
			"y": 5752.093603096411,
			"width": 1082.3141463056772,
			"height": 617.9249877929688,
			"angle": 0,
			"strokeColor": "transparent",
			"backgroundColor": "#f50f0f",
			"fillStyle": "solid",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"frameId": null,
			"roundness": null,
			"seed": 32198852,
			"version": 54,
			"versionNonce": 755438716,
			"isDeleted": false,
			"boundElements": null,
			"updated": 1718693500724,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "3a8b823b87bb195a9f4eec9206613525256cd793",
			"scale": [
				1,
				1
			]
		}
	],
	"appState": {
		"theme": "light",
		"viewBackgroundColor": "#ffffff",
		"currentItemStrokeColor": "#1e1e1e",
		"currentItemBackgroundColor": "#f50f0f",
		"currentItemFillStyle": "solid",
		"currentItemStrokeWidth": 2,
		"currentItemStrokeStyle": "solid",
		"currentItemRoughness": 0,
		"currentItemOpacity": 100,
		"currentItemFontFamily": 3,
		"currentItemFontSize": 20,
		"currentItemTextAlign": "left",
		"currentItemStartArrowhead": null,
		"currentItemEndArrowhead": "arrow",
		"scrollX": -25994.547593757812,
		"scrollY": 3170.1939793010497,
		"zoom": {
			"value": 0.1
		},
		"currentItemRoundness": "round",
		"gridSize": null,
		"gridColor": {
			"Bold": "#C9C9C9FF",
			"Regular": "#EDEDEDFF"
		},
		"currentStrokeOptions": null,
		"previousGridSize": null,
		"frameRendering": {
			"enabled": true,
			"clip": true,
			"name": true,
			"outline": true
		}
	},
	"files": {}
}
```
%%